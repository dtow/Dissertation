---
title: "Dissertation Hopping Analysis - Plots Removed"
author: "David Ortiz"
date: "1/31/2024"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Load - Libraries

```{r Load Libraries, message = FALSE , include = FALSE,results = 'hide'}
library(R.matlab)
library(ggplot2)
library(pander)
library(stargazer)
library(gridExtra)
library(ggpubr)
library(RColorBrewer)
library(reshape2)
library(effsize)
library(ggsignif)
library(lme4)
library(ggeffects)
library(effects)
library(clubSandwich)
library(DescTools)
library(readxl)
library(xlsx)
library(dplyr)
library(shadowtext)
library(MetBrewer)
library(sjstats)
library(coin)
library(rstatix)
library(tidyverse)
library(datarium)
library(svglite)
library(MASS)
library(car)
library(robustlmm)
library(robustbase)
library(showtext)
library(showtextdb)
library(sysfonts)
library(broom)
library(ggside)


font_add( 'Arial Black', regular = 'Arial Black.ttf' )
font_add( 'Arial Bold Italic', regular = 'Arial Bold Italic.ttf' )
font_add( 'Arial Bold', regular = 'Arial Bold.ttf' )
font_add( 'Arial Italic', regular = 'Arial Italic.ttf' )


setTimeLimit(cpu =  Inf, elapsed = Inf, transient = FALSE)
```

## Load Data

```{r Tendon Morphology}

TendonMorphology <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Morphology/ATx Tendon Morphology.xlsx' ) )

```



### Individual Hops

#### Power Data

```{r Whole Contact Phase - Individual Hops}


TotalPower <- as.data.frame(read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Power/PostQuals_Power_EntireContactPhase_Table.xlsx' ))

#TotalPower$Participant_ID <- factor(TotalPower$Participant_ID)

#Convert hop height from m to cm
TotalPower$HoppingHeight_cm <- TotalPower$HoppingHeight_m*100



TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID == 1) ] <- 'ATx07'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  2) ] <- 'ATx08'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  3) ] <- 'ATx10'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  4) ] <- 'ATx12'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  5) ] <- 'ATx17'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  6) ] <- 'ATx19'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  7) ] <- 'ATx21'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  8) ] <- 'ATx24'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  9) ] <- 'ATx25'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  10) ] <- 'ATx27'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  11) ] <- 'ATx34'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  12) ] <- 'ATx38'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  13) ] <- 'ATx41'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  14) ] <- 'ATx44'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  15) ] <- 'ATx50'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  16) ] <- 'ATx36'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  17) ] <- 'ATx49'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  18) ] <- 'ATx39'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  19) ] <- 'ATx74'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  20) ] <- 'ATx65'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Participant_ID ==  21) ] <- 'ATx14'




TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  1) ] <- 'HC05'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  2) ] <- 'HC06'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  3) ] <- 'HC11'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  4) ] <- 'HC12'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  5) ] <- 'HC17'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  6) ] <- 'HC18'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  7) ] <- 'HC19'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  8) ] <- 'HC20'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  9) ] <- 'HC21'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  10) ] <- 'HC25'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  11) ] <- 'HC42'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  12) ] <- 'HC45'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  13) ] <- 'HC44'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  14) ] <- 'HC48'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  15) ] <- 'HC65'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  16) ] <- 'HC67'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  17) ] <- 'HC68'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  18) ] <- 'HC30'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  19) ] <- 'HC31'

TotalPower$Participant_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Participant_ID ==  20) ] <- 'HC32'





TotalPower$MTU_ID[which( TotalPower$MTU_ID ==  1 ) ] <- 'GasMed'




TotalPower$Limb_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Limb_ID == 1) ] <- 'Involved'

TotalPower$Limb_ID[which(TotalPower$Group_ID ==  1 & TotalPower$Limb_ID == 2) ] <- 'Non-Involved'




TotalPower$Limb_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Limb_ID == 1) ] <- 'Matched Dominance'

TotalPower$Limb_ID[which(TotalPower$Group_ID ==  2 & TotalPower$Limb_ID == 2) ] <- 'Contralateral'


#Create an unfactored version of Limb_ID, for when splitting groups
TotalPower$Limb_ID_Unfactored <- TotalPower$Limb_ID

#Turn Limb_ID into a factor, unordered
TotalPower$Limb_ID_UnorderedFactor <- factor( TotalPower$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )

#Turn Limb_ID into a factor
TotalPower$Limb_ID <- factor( TotalPower$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )

                                                             
TotalPower$Group_ID[which(TotalPower$Group_ID == 1) ] <- 'ATx'
TotalPower$Group_ID[which(TotalPower$Group_ID == 2) ] <- 'Control'




TotalPower$Joint_ID[which(TotalPower$Joint_ID == 1) ] <- 'Ankle'
TotalPower$Joint_ID[which(TotalPower$Joint_ID == 2) ] <- 'Knee'
TotalPower$Joint_ID[which(TotalPower$Joint_ID == 3) ] <- 'Hip'





TotalPower <- TotalPower %>% filter( Participant_ID !=  'HC08' )


TotalPower$Group_by_Tendinopathy_Type <- 'Control'


TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx07' ) ] <- 'Unilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx08' ) ] <- 'Bilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx10' ) ] <- 'Bilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx12' ) ] <- 'Unilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx17' ) ] <- 'Unilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx18' ) ] <- 'Bilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx19' ) ] <- 'Bilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx21' ) ] <- 'Unilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx24' ) ] <- 'Bilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx25' ) ] <- 'Unilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx27' ) ] <- 'Bilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx34' ) ] <- 'Bilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx36' ) ] <- 'Bilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx38' ) ] <- 'Unilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx41' ) ] <- 'Unilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx44' ) ] <- 'Unilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx49' ) ] <- 'Bilateral'
TotalPower$Group_by_Tendinopathy_Type[ which( TotalPower$Participant_ID ==  'ATx50' ) ] <- 'Unilateral'


TotalPower$Group_by_Tendinopathy_Type <- factor( TotalPower$Group_by_Tendinopathy_Type, levels = c( 'Unilateral', 'Bilateral', 'Control'), ordered = T )



TotalPower$Group_by_Morphology <- 'Control'


TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx07' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx08' ) ] <- 'Minimum_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx10' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx12' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx17' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx18' ) ] <- 'Minimum_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx19' ) ] <- 'Minimum_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx21' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx24' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx25' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx27' ) ] <- 'Minimum_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx34' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx38' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx41' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx44' ) ] <- 'Minimum_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx50' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx36' ) ] <- 'LessThan_2mm_Diff'
TotalPower$Group_by_Morphology[ which( TotalPower$Participant_ID ==  'ATx49' ) ] <- 'LessThan_2mm_Diff'


TotalPower$Group_by_Morphology <- factor( TotalPower$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control'), ordered = T )



```



```{r Joint Behavior}


JointFunctionalIndex <- as.data.frame(read_xlsx( 'Dissertation Scripts/Excel Files/JointFunctionalIndex_Table.xlsx' ))




JointFunctionalIndex$Participant_ID[which(JointFunctionalIndex$Group_ID ==  1 ) ] <- 'ATx01'

JointFunctionalIndex$Participant_ID[which(JointFunctionalIndex$Group_ID ==  2 & JointFunctionalIndex$Participant_ID == 1) ] <- 'HP03'

JointFunctionalIndex$Participant_ID[which(JointFunctionalIndex$Group_ID ==  2 & JointFunctionalIndex$Participant_ID == 2) ] <- 'HP08'







JointFunctionalIndex$Limb_ID[which(JointFunctionalIndex$Group_ID ==  1 & JointFunctionalIndex$Limb_ID == 1) ] <- 'Involved'
JointFunctionalIndex$Limb_ID[which(JointFunctionalIndex$Group_ID ==  1 & JointFunctionalIndex$Limb_ID == 2) ] <- 'Non-Involved'

JointFunctionalIndex$Limb_ID[which(JointFunctionalIndex$Group_ID ==  2 & JointFunctionalIndex$Limb_ID == 1) ] <- 'Matched Dominance'
JointFunctionalIndex$Limb_ID[which(JointFunctionalIndex$Group_ID ==  2 & JointFunctionalIndex$Limb_ID == 2) ] <- 'Contralateral'


JointFunctionalIndex$Group_ID[which(JointFunctionalIndex$Group_ID == 1) ] <- 'ATx'
JointFunctionalIndex$Group_ID[which(JointFunctionalIndex$Group_ID == 2) ] <- 'Control'




JointFunctionalIndex$Joint_ID[which(JointFunctionalIndex$Joint_ID == 1) ] <- 'Ankle'
JointFunctionalIndex$Joint_ID[which(JointFunctionalIndex$Joint_ID == 2) ] <- 'Knee'
JointFunctionalIndex$Joint_ID[which(JointFunctionalIndex$Joint_ID == 3) ] <- 'Hip'



JointFunctionalIndex$Index_ID[which(JointFunctionalIndex$Index_ID == 1) ] <- 'Strut'

JointFunctionalIndex$Index_ID[which(JointFunctionalIndex$Index_ID == 2) ] <- 'Spring'

JointFunctionalIndex$Index_ID[which(JointFunctionalIndex$Index_ID == 3) ] <- 'Motor'

JointFunctionalIndex$Index_ID[which(JointFunctionalIndex$Index_ID == 4) ] <- 'Brake'


JointFunctionalIndex$GroupbyLimb <- c( rep( 'ATx - Left', 360 ), rep( 'ATx - Right', 360 ), rep( 'Control - Left', 120 ), rep( 'Control - Right', 120 ), rep( 'Control - Left', 240 ), rep( 'Control - Right', 240 ) )

```





### Participant Means

```{r Power, Participant Means}

Power_ParticipantMeans <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Power/PostQuals_JointPower_ParticipantMeansPerHoppingRate.xlsx' ) )



#Convert hop height from m to cm
Power_ParticipantMeans$HoppingHeight_cm <- Power_ParticipantMeans$Mean_HoppingHeight_m*100


Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID == 1) ] <- 'ATx07'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  2) ] <- 'ATx08'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  3) ] <- 'ATx10'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  4) ] <- 'ATx12'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  5) ] <- 'ATx17'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  6) ] <- 'ATx19'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  7) ] <- 'ATx21'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  8) ] <- 'ATx24'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  9) ] <- 'ATx25'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  10) ] <- 'ATx27'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  11) ] <- 'ATx34'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  12) ] <- 'ATx38'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  13) ] <- 'ATx41'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  14) ] <- 'ATx44'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  15) ] <- 'ATx50'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  16) ] <- 'ATx36'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  17) ] <- 'ATx49'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  18) ] <- 'ATx39'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  19) ] <- 'ATx74'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  20) ] <- 'ATx65'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Participant_ID ==  21) ] <- 'ATx14'




Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  1) ] <- 'HC05'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  2) ] <- 'HC06'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  3) ] <- 'HC11'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  4) ] <- 'HC12'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  5) ] <- 'HC17'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  6) ] <- 'HC18'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  7) ] <- 'HC19'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  8) ] <- 'HC20'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  9) ] <- 'HC21'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  10) ] <- 'HC25'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  11) ] <- 'HC42'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  12) ] <- 'HC45'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  13) ] <- 'HC44'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  14) ] <- 'HC48'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  15) ] <- 'HC65'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  16) ] <- 'HC67'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  17) ] <- 'HC68'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  18) ] <- 'HC30'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  19) ] <- 'HC31'

Power_ParticipantMeans$Participant_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Participant_ID ==  20) ] <- 'HC32'





Power_ParticipantMeans$MTU_ID[which( Power_ParticipantMeans$MTU_ID ==  1 ) ] <- 'GasMed'




Power_ParticipantMeans$Limb_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Limb_ID == 1) ] <- 'Involved'

Power_ParticipantMeans$Limb_ID[which(Power_ParticipantMeans$Group_ID ==  1 & Power_ParticipantMeans$Limb_ID == 2) ] <- 'Non-Involved'




Power_ParticipantMeans$Limb_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Limb_ID == 1) ] <- 'Matched Dominance'

Power_ParticipantMeans$Limb_ID[which(Power_ParticipantMeans$Group_ID ==  2 & Power_ParticipantMeans$Limb_ID == 2) ] <- 'Contralateral'

#Create an unfactored version of Limb_ID, for when splitting groups
Power_ParticipantMeans$Limb_ID_Unfactored <- Power_ParticipantMeans$Limb_ID

#Create a factored, unordered version of Limb_ID - for regression
Power_ParticipantMeans$Limb_ID_UnorderedFactor <- factor( Power_ParticipantMeans$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )

#Create a factored, ordered version of Limb_ID - for plotting
Power_ParticipantMeans$Limb_ID <- factor( Power_ParticipantMeans$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )


Power_ParticipantMeans$Limb_ID_Unordered <- factor( Power_ParticipantMeans$Limb_ID )
                                                                         

Power_ParticipantMeans$Group_ID[which(Power_ParticipantMeans$Group_ID == 1) ] <- 'ATx'
Power_ParticipantMeans$Group_ID[which(Power_ParticipantMeans$Group_ID == 2) ] <- 'Control'

#Round HoppingRate_ID to avoid weird errors
Power_ParticipantMeans$HoppingRate_ID <- round( Power_ParticipantMeans$HoppingRate_ID, digits = 1)

Power_ParticipantMeans$Joint_ID[which(Power_ParticipantMeans$Joint_ID == 1) ] <- 'Ankle'
Power_ParticipantMeans$Joint_ID[which(Power_ParticipantMeans$Joint_ID == 2) ] <- 'Knee'
Power_ParticipantMeans$Joint_ID[which(Power_ParticipantMeans$Joint_ID == 3) ] <- 'Hip'



Power_ParticipantMeans <- Power_ParticipantMeans %>% filter( Participant_ID !=  'HC08' )


Power_ParticipantMeans$Group_by_Tendinopathy_Type <- 'Control'


Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx07' ) ] <- 'Unilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx08' ) ] <- 'Bilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx10' ) ] <- 'Bilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx12' ) ] <- 'Unilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx17' ) ] <- 'Unilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx18' ) ] <- 'Bilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx19' ) ] <- 'Bilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx21' ) ] <- 'Unilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx24' ) ] <- 'Bilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx25' ) ] <- 'Unilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx27' ) ] <- 'Bilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx34' ) ] <- 'Bilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx36' ) ] <- 'Bilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx38' ) ] <- 'Unilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx41' ) ] <- 'Unilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx44' ) ] <- 'Unilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx49' ) ] <- 'Bilateral'
Power_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_ParticipantMeans$Participant_ID ==  'ATx50' ) ] <- 'Unilateral'



Power_ParticipantMeans$Group_by_Tendinopathy_Type <- factor( Power_ParticipantMeans$Group_by_Tendinopathy_Type, levels = c( 'Unilateral', 'Bilateral', 'Control'), ordered = T )





Power_ParticipantMeans$Group_by_Morphology <- 'Control'


Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx07' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx08' ) ] <- 'Minimum_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx10' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx12' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx17' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx18' ) ] <- 'Minimum_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx19' ) ] <- 'Minimum_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx21' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx24' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx25' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx27' ) ] <- 'Minimum_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx34' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx38' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx41' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx44' ) ] <- 'Minimum_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx50' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx36' ) ] <- 'LessThan_2mm_Diff'
Power_ParticipantMeans$Group_by_Morphology[ which( Power_ParticipantMeans$Participant_ID ==  'ATx49' ) ] <- 'LessThan_2mm_Diff'


Power_ParticipantMeans$Group_by_Morphology_NotFactored <- factor( Power_ParticipantMeans$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control') )

Power_ParticipantMeans$Group_by_Morphology_NotOrdered <- factor( Power_ParticipantMeans$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control') )

Power_ParticipantMeans$Group_by_Morphology <- factor( Power_ParticipantMeans$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control'), ordered = T )

#Add Age to Power_ParticipantMeans
Power_ParticipantMeans$Age <- NA
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx07' ) ] <- 24
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx08' ) ] <- 45
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx10' ) ] <- 42
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx12' ) ] <- 53
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx17' ) ] <- 41
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx18' ) ] <- 67
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx19' ) ] <- 51
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx21' ) ] <- 50
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx24' ) ] <- 50
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx25' ) ] <- 73
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx27' ) ] <- 52
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx34' ) ] <- 49
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx36' ) ] <- 23
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx38' ) ] <- 48
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx41' ) ] <- 23
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx44' ) ] <- 41
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx49' ) ] <- 35
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'ATx50' ) ] <- 27


Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC01' ) ] <- 30
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC05' ) ] <- 58
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC06' ) ] <- 38
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC11' ) ] <- 52
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC12' ) ] <- 40
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC17' ) ] <- 53
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC18' ) ] <- 50
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC19' ) ] <- 41
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC20' ) ] <- 50
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC21' ) ] <- 48
Power_ParticipantMeans$Age[ which( Power_ParticipantMeans$Participant_ID ==  'HC25' ) ] <- 52


```



```{r Joint Functional Index }

JointFunctionalIndex_ParticipantMeansPerRate <- as.data.frame(read_xlsx( 'Dissertation Scripts/Excel Files/JointFunctionalIndex_ParticipantMeansPerRate_Table.xlsx' ))



JointFunctionalIndex_ParticipantMeansPerRate$Participant_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Group_ID ==  1 ) ] <- 'ATx01'

JointFunctionalIndex_ParticipantMeansPerRate$Participant_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Group_ID ==  2 & JointFunctionalIndex_ParticipantMeansPerRate$Participant_ID == 1) ] <- 'HP03'

JointFunctionalIndex_ParticipantMeansPerRate$Participant_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Group_ID ==  2 & JointFunctionalIndex_ParticipantMeansPerRate$Participant_ID == 2) ] <- 'HP08'







JointFunctionalIndex_ParticipantMeansPerRate$Limb_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Group_ID ==  1 & JointFunctionalIndex_ParticipantMeansPerRate$Limb_ID == 1) ] <- 'Involved'
JointFunctionalIndex_ParticipantMeansPerRate$Limb_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Group_ID ==  1 & JointFunctionalIndex_ParticipantMeansPerRate$Limb_ID == 2) ] <- 'Non-Involved'

JointFunctionalIndex_ParticipantMeansPerRate$Limb_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Group_ID ==  2 & JointFunctionalIndex_ParticipantMeansPerRate$Limb_ID == 1) ] <- 'Matched Dominance'
JointFunctionalIndex_ParticipantMeansPerRate$Limb_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Group_ID ==  2 & JointFunctionalIndex_ParticipantMeansPerRate$Limb_ID == 2) ] <- 'Contralateral'


JointFunctionalIndex_ParticipantMeansPerRate$Group_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Group_ID == 1) ] <- 'ATx'
JointFunctionalIndex_ParticipantMeansPerRate$Group_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Group_ID == 2) ] <- 'Control'




JointFunctionalIndex_ParticipantMeansPerRate$Joint_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Joint_ID == 1) ] <- 'Ankle'
JointFunctionalIndex_ParticipantMeansPerRate$Joint_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Joint_ID == 2) ] <- 'Knee'
JointFunctionalIndex_ParticipantMeansPerRate$Joint_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Joint_ID == 3) ] <- 'Hip'



JointFunctionalIndex_ParticipantMeansPerRate$Index_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Index_ID == 1) ] <- 'Strut'

JointFunctionalIndex_ParticipantMeansPerRate$Index_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Index_ID == 2) ] <- 'Spring'

JointFunctionalIndex_ParticipantMeansPerRate$Index_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Index_ID == 3) ] <- 'Motor'

JointFunctionalIndex_ParticipantMeansPerRate$Index_ID[which(JointFunctionalIndex_ParticipantMeansPerRate$Index_ID == 4) ] <- 'Brake'









JointFunctionalIndex_ParticipantMeansPerRate <- JointFunctionalIndex_ParticipantMeansPerRate %>% filter( Participant_ID !=  'HC08' )

```




### Group Means

```{r Power, Group Means}

Power_GroupMeans <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Power/PostQuals_JointPower_GroupMeansPerHoppingRate.xlsx' ) )



#MTU ID is Medial Gastroc or
Power_GroupMeans$MTU_ID[which( Power_GroupMeans$MTU_ID ==  1 ) ] <- 'MedGas'



#Limb 1 of Group 1 is the Involved Limb
Power_GroupMeans$Limb_ID[which(Power_GroupMeans$Group_ID ==  1 & Power_GroupMeans$Limb_ID == 1) ] <- 'Involved'

#Limb 1 of Group 1 is the Non-Involved Limb
Power_GroupMeans$Limb_ID[which(Power_GroupMeans$Group_ID ==  1 & Power_GroupMeans$Limb_ID == 2) ] <- 'Non-Involved'





#Limb 1 of Group 2 is the Matched Dominance Limb of the healthy control group
Power_GroupMeans$Limb_ID[which(Power_GroupMeans$Group_ID ==  2 & Power_GroupMeans$Limb_ID == 1) ] <- 'Matched Dominance'

#Limb 2 of Group 2 is the Contralateral Limb of the healthy control group
Power_GroupMeans$Limb_ID[which(Power_GroupMeans$Group_ID ==  2 & Power_GroupMeans$Limb_ID == 1) ] <- 'Contralateral'



Power_GroupMeans$Limb_ID <- factor( Power_GroupMeans$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )





#Group 1 is the ATx group
Power_GroupMeans$Group_ID[which(Power_GroupMeans$Group_ID == 1) ] <- 'ATx'

#Group 2 is the Control group
Power_GroupMeans$Group_ID[which(Power_GroupMeans$Group_ID == 2) ] <- 'Control'



#Joint 1 is the ankle
Power_GroupMeans$Joint_ID[which(Power_GroupMeans$Joint_ID == 1) ] <- 'Ankle'

#Joint 2 is the knee
Power_GroupMeans$Joint_ID[which(Power_GroupMeans$Joint_ID == 2) ] <- 'Knee'

#Joint 3 is the hip
Power_GroupMeans$Joint_ID[which(Power_GroupMeans$Joint_ID == 3) ] <- 'Hip'





```

### Between-Limb Differences


```{r Power, Between-Limb Differences}

Power_BetweenLimbDiff_ParticipantMeans <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Power/PostQuals_JointPower_BetweenLimbDiff_ParticipantMeans.xlsx' ) )




Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID == 1) ] <- 'ATx07'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  2) ] <- 'ATx08'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  3) ] <- 'ATx10'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  4) ] <- 'ATx12'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  5) ] <- 'ATx17'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  6) ] <- 'ATx19'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  7) ] <- 'ATx21'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  8) ] <- 'ATx24'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  9) ] <- 'ATx25'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  10) ] <- 'ATx27'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  11) ] <- 'ATx34'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  12) ] <- 'ATx38'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  13) ] <- 'ATx41'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  14) ] <- 'ATx44'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  15) ] <- 'ATx50'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  16) ] <- 'ATx36'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  17) ] <- 'ATx49'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  18) ] <- 'ATx39'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  19) ] <- 'ATx74'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  20) ] <- 'ATx65'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  1 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  21) ] <- 'ATx14'




Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  1) ] <- 'HC05'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  2) ] <- 'HC06'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  3) ] <- 'HC11'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  4) ] <- 'HC12'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  5) ] <- 'HC17'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  6) ] <- 'HC18'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  7) ] <- 'HC19'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  8) ] <- 'HC20'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  9) ] <- 'HC21'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  10) ] <- 'HC25'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  11) ] <- 'HC42'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  12) ] <- 'HC45'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  13) ] <- 'HC44'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  14) ] <- 'HC48'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  15) ] <- 'HC65'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  16) ] <- 'HC67'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  17) ] <- 'HC68'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  18) ] <- 'HC30'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  19) ] <- 'HC31'

Power_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID ==  2 & Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  20) ] <- 'HC32'





                                                                         

Power_BetweenLimbDiff_ParticipantMeans$Group_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID == 1) ] <- 'ATx'
Power_BetweenLimbDiff_ParticipantMeans$Group_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Group_ID == 2) ] <- 'Control'




Power_BetweenLimbDiff_ParticipantMeans$Joint_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Joint_ID == 1) ] <- 'Ankle'
Power_BetweenLimbDiff_ParticipantMeans$Joint_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Joint_ID == 2) ] <- 'Knee'
Power_BetweenLimbDiff_ParticipantMeans$Joint_ID[which(Power_BetweenLimbDiff_ParticipantMeans$Joint_ID == 3) ] <- 'Hip'




Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type <- 'Control'


Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx07' ) ] <- 'Unilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx08' ) ] <- 'Bilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx10' ) ] <- 'Bilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx12' ) ] <- 'Unilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx17' ) ] <- 'Unilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx18' ) ] <- 'Bilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx19' ) ] <- 'Bilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx21' ) ] <- 'Unilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx24' ) ] <- 'Bilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx25' ) ] <- 'Unilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx27' ) ] <- 'Bilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx34' ) ] <- 'Bilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx36' ) ] <- 'Bilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx38' ) ] <- 'Unilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx41' ) ] <- 'Unilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx44' ) ] <- 'Unilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx49' ) ] <- 'Bilateral'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx50' ) ] <- 'Unilateral'



Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type <- factor( Power_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type, levels = c( 'Unilateral', 'Bilateral', 'Control'), ordered = T )





Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology <- 'Control'


Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx07' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx08' ) ] <- 'Minimum_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx10' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx12' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx17' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx18' ) ] <- 'Minimum_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx19' ) ] <- 'Minimum_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx21' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx24' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx25' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx27' ) ] <- 'Minimum_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx34' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx38' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx41' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx44' ) ] <- 'Minimum_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx50' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx36' ) ] <- 'LessThan_2mm_Diff'
Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( Power_BetweenLimbDiff_ParticipantMeans$Participant_ID ==  'ATx49' ) ] <- 'LessThan_2mm_Diff'


Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology <- factor( Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control'), ordered = T )

```




## Calculations

### Convert Degrees to Rads

```{r}

DegreestoRads <- 1/57.3

ATx01_Contralateral_DataFor2Point3Hz$AnkleAngle_inRads <- ATx01_Contralateral_DataFor2Point3Hz$AnkleAngle*DegreestoRads

ATx01_Contralateral_DataFor2Point3Hz$KneeAngle_inRads <- ATx01_Contralateral_DataFor2Point3Hz$KneeAngle*DegreestoRads

ATx01_Contralateral_DataFor2Point3Hz$HipAngle_inRads <- ATx01_Contralateral_DataFor2Point3Hz$HipAngle*DegreestoRads




ATx01_R_GasMed_Trial1$AnkleAngle_inRads <- ATx01_R_GasMed_Trial1$AnkleAngle*DegreestoRads

ATx01_R_GasMed_Trial1$KneeAngle_inRads <- ATx01_R_GasMed_Trial1$KneeAngle*DegreestoRads

ATx01_R_GasMed_Trial1$HipAngle_inRads <- ATx01_R_GasMed_Trial1$HipAngle*DegreestoRads




ATx01_R_GasMed_Trial2$AnkleAngle_inRads <- ATx01_R_GasMed_Trial2$AnkleAngle*DegreestoRads

ATx01_R_GasMed_Trial2$KneeAngle_inRads <- ATx01_R_GasMed_Trial2$KneeAngle*DegreestoRads

ATx01_R_GasMed_Trial2$HipAngle_inRads <- ATx01_R_GasMed_Trial2$HipAngle*DegreestoRads

```





## DPLYR

### For Raster Plots

```{r Segment Out Each Hop for Raster Plot}

ATx01_R_GasMed_Hop1 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 1 & Trial_ID ==  1)


ATx01_R_GasMed_Hop2 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 2)

ATx01_R_GasMed_Hop3 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 3)

ATx01_R_GasMed_Hop4 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 4)

ATx01_R_GasMed_Hop5 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 5)

ATx01_R_GasMed_Hop6 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 6)

ATx01_R_GasMed_Hop7 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 7)

ATx01_R_GasMed_Hop8 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 8)

ATx01_R_GasMed_Hop9 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 9)

ATx01_R_GasMed_Hop10 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 10)

ATx01_R_GasMed_Hop11 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 11)

ATx01_R_GasMed_Hop12 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 12)

ATx01_R_GasMed_Hop13 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 13)

ATx01_R_GasMed_Hop14 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 14)

ATx01_R_GasMed_Hop15 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 15)

ATx01_R_GasMed_Hop16 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 16)

ATx01_R_GasMed_Hop17 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 17)

ATx01_R_GasMed_Hop18 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 18)

ATx01_R_GasMed_Hop19 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 19)

ATx01_R_GasMed_Hop20 <- ATx01_R_GasMed_Trial1AND2 %>% filter(Hop_ID == 20)
```



### 2.3 Hz Only

### All 4 Limbs

#### Power Data

```{r Both Groups}


#Create new data frame Power_ParticipantMeans but containing only the 2.3 Hz hopping rate
Power_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3')

Power_Ankle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle' )

Power_Knee_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Knee' )

Power_Hip_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Hip' )



#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
Power_ParticipantMeans_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3')

#Same as above but with only Ankle joint data
Power_ParticipantMeans_Ankle_2.3Hz <- Power_ParticipantMeans %>% filter( HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle' )

#Same as above but with only Knee joint data
Power_ParticipantMeans_Knee_2.3Hz <- Power_ParticipantMeans %>% filter( HoppingRate_ID ==  '2.3', Joint_ID ==  'Knee' )

#Same as above but with only Hip joint data
Power_ParticipantMeans_Hip_2.3Hz <- Power_ParticipantMeans %>% filter( HoppingRate_ID ==  '2.3', Joint_ID ==  'Hip' )


#Create a new data frame from Power_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology, but containing only the 2.3 Hz hopping rate 
Power_BetweenLimbDiff_ParticipantMeans_2.3Hz <- Power_BetweenLimbDiff_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3' )


#Same as above but with only Ankle joint data
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz <- Power_BetweenLimbDiff_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle' )


#Same as above but with only Knee joint data
Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz <- Power_BetweenLimbDiff_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Knee' )

Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_BetweenLimbTendonThickness_mm <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm

#Same as above but with only Hip joint data
Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz <- Power_BetweenLimbDiff_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Hip' )

Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_BetweenLimbTendonThickness_mm <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm


#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
Power_GroupMeans_2.3Hz <- Power_GroupMeans %>% filter(HoppingRate_ID ==  '2.3')

Power_GroupMeans_Ankle_2.3Hz <- Power_GroupMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle' )




```



```{r ATx only}

#Next block of code is for BOTH limbs

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
Power_ATx_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'ATx')

Power_ATx_Ankle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'ATx', Joint_ID ==  'Ankle' )


#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
Power_ATx_InvolvedAnkle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'ATx', Joint_ID ==  'Ankle', Limb_ID ==  'Involved' )

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
Power_ATx_NonInvolvedAnkle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'ATx', Joint_ID ==  'Ankle', Limb_ID ==  'Non-Involved' )






#Create a new data frame from the Power_ParticipantMeans data, but containing only the ATx group and the 2.3 Hz hopping rate
Power_ParticipantMeans_ATx_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'ATx')


### Participant Means, Ankle Only
Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'ATx', Joint_ID ==  'Ankle')


#Create new data frame from Power_BetweenLimbDiff_ParticipantMeans, containing ankle data for ATx group only
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz <- Power_BetweenLimbDiff_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle', Group_ID ==  'ATx' )


#Create new data frame from Power_BetweenLimbDiff_ParticipantMeans, containing Knee data for ATx group only
Power_BetweenLimbDiff_ATxParticipantMeans_Knee_2.3Hz <- Power_BetweenLimbDiff_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Knee', Group_ID ==  'ATx' )

Power_BetweenLimbDiff_ATxParticipantMeans_Knee_2.3Hz$Mean_BetweenLimbTendonThickness_mm <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm

#Create new data frame from Power_BetweenLimbDiff_ParticipantMeans, containing Hip data for ATx group only
Power_BetweenLimbDiff_ATxParticipantMeans_Hip_2.3Hz <- Power_BetweenLimbDiff_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Hip', Group_ID ==  'ATx' )

Power_BetweenLimbDiff_ATxParticipantMeans_Hip_2.3Hz$Mean_BetweenLimbTendonThickness_mm <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm




#Next block of code is for INVOLVED limb only

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
Power_ATxInvolvedLimb_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Limb_ID ==  'Involved')

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate and only the Ankle joint
Power_InvolvedAnkle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Limb_ID ==  'Involved',Joint_ID == 'Ankle')


Power_ParticipantMeans_ATxInvolvedLimb_2.3Hz <- Power_ParticipantMeans_ATx_2.3Hz %>% filter( Limb_ID ==  'Involved' )


Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz <- Power_ParticipantMeans_ATx_2.3Hz %>%
   filter( Limb_ID ==  'Involved', Joint_ID == 'Ankle' )


Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz <- Power_ParticipantMeans_ATx_2.3Hz %>%
   filter( Limb_ID ==  'Involved', Joint_ID == 'Knee' )

Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Mean_BetweenLimbTendonThickness_mm <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_BetweenLimbTendonThickness_mm

Power_ParticipantMeans_ATxInvolvedHip_2.3Hz <- Power_ParticipantMeans_ATx_2.3Hz %>%
   filter( Limb_ID ==  'Involved', Joint_ID == 'Hip' )

Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Mean_BetweenLimbTendonThickness_mm <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_BetweenLimbTendonThickness_mm


#Create a new data frame from the Power_GroupMeans data, but containing only the ATx group Involved limb, only the 2.3 Hz hopping rate and only the Ankle joint
Power_GroupMeans_InvolvedAnkle_2.3Hz <- Power_GroupMeans %>% filter(HoppingRate_ID ==  '2.3', Limb_ID ==  'Involved',Joint_ID == 'Ankle' )









#Next block of code is for NON-INVOLVED limb only

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate and only the Ankle joint
Power_NonInvolvedAnkle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Limb_ID ==  'Non-Involved',Joint_ID == 'Ankle')



Power_ParticipantMeans_ATxNonInvolved_2.3Hz <- Power_ParticipantMeans_ATx_2.3Hz %>% filter( Limb_ID ==  'Non-Involved' )



Power_ParticipantMeans_ATxNonInvolvedAnkle_2.Hz <- Power_ParticipantMeans_ATx_2.3Hz %>%
   filter( Limb_ID ==  'Non-Involved', Joint_ID == 'Ankle' )


#Create a new data frame from the Power_GroupMeans data, but containing only the ATx group Involved limb, only the 2.3 Hz hopping rate and only the Ankle joint
Power_GroupMeans_NonInvolvedAnkle_2.3Hz <- Power_GroupMeans %>% filter(HoppingRate_ID ==  '2.3', Limb_ID ==  'Non-Involved',Joint_ID == 'Ankle' )








#Create new data frame from Power_BetweenLimbDiff_ParticipantMeans, containing only ATx group ankle and 2.0 vs 2.3 Hz
Power_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2.3Hz <- Power_BetweenLimbDiff_ParticipantMeans %>% filter( Group_ID ==  'ATx', HoppingRate_ID ==  2.3, Joint_ID ==  'Ankle' )


```


```{r Remove ATx Participants}
 
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' )

Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx12' )

Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx12'  & Participant_ID !=  'ATx07' )

Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx12'  & Participant_ID !=  'ATx07' )

```



```{r Control Only}

#Create new data frame Power but containing only the Control group and 2.3 Hz hopping rate
Power_Control_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control')

#Create new data frame Power but containing only the Control group and 2.3 Hz hopping rate and only the Ankle
Power_ControlAnkle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control',Joint_ID == 'Ankle')


#Create new data frame Power_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
Power_Control_ContralateralAnkle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control', Joint_ID ==  'Ankle',Limb_ID == 'Contralateral')


#Create new data frame Power_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
Power_Control_MatchedDominanceAnkle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control', Joint_ID ==  'Ankle',Limb_ID == 'Matched Dominance')




#Create a new data frame from the Power_ParticipantMeans data, but containing only the Control group and the 2.3 Hz hopping rate
Power_ParticipantMeans_Control_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control')

#Create a new data frame from the Power_ParticipantMeans data, but containing only the Control group and the 2.3 Hz hopping rate and only the Ankle joint
Power_ParticipantMeans_ControlAnkle_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control',Joint_ID ==  'Ankle')





#Create a new data frame from the Power_GroupMeans data, but containing only the Control group, only the 2.3 Hz hopping rate and only the Ankle joint
Power_GroupMeans_ControlAnkle_2.3Hz <- Power_GroupMeans %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control',Joint_ID == 'Ankle' )







#Create new data frame from Power_BetweenLimbDiff_ParticipantMeans, containing only ATx group ankle and 2.0 vs 2.3 Hz
Power_BetweenLimbDiff_ParticipantMeans_ControlAnkle_2.3Hz <- Power_BetweenLimbDiff_ParticipantMeans %>% filter( Group_ID ==  'Control', HoppingRate_ID ==  2.3, Joint_ID ==  'Ankle' )
```


```{r Separate The Joints}

#Make a new data frame containing only the ankle joint data - this is for the Involved limb of the ATx group versus the Control group, at 2.3 Hz
Power_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz <- Power_ParticipantMeans_InvolvedVsControl_2.3Hz %>% filter( Joint_ID ==  'Ankle' )



#Make a new data frame containing only the knee joint data - this is for the Involved limb of the ATx group versus the Control group, at 2.3 Hz
Power_ParticipantMeans_InvolvedVsControlKnee_2.3Hz <- Power_ParticipantMeans_InvolvedVsControl_2.3Hz %>% filter( Joint_ID ==  'Knee' )



#Make a new data frame containing only the hip joint data - this is for the Involved limb of the ATx group versus the Control group, at 2.3 Hz
Power_ParticipantMeans_InvolvedVsControlHip_2.3Hz <- Power_ParticipantMeans_InvolvedVsControl_2.3Hz %>% filter( Joint_ID ==  'Hip' )

```






### Dominance Matched Limb Only


#### 2.3 Hz Only

##### Power Data

```{r Both Groups}


#Create new data frame Power_ParticipantMeans but containing only the 2.3 Hz hopping rate
Power_3Limbs_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Limb_ID !=  'Contralateral')

Power_3Limbs_Ankle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle', Limb_ID !=  'Contralateral' )



#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
Power_ParticipantMeans_3Limbs_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Limb_ID !=  'Contralateral')

Power_ParticipantMeans_3Limbs_Ankle_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle', Limb_ID !=  'Contralateral' )



#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
Power_GroupMeans_3Limbs_2.3Hz <- Power_GroupMeans %>% filter(HoppingRate_ID ==  '2.3', Limb_ID !=  'Contralateral')

Power_GroupMeans_3Limbs_Ankle_2.3Hz <- Power_GroupMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle', Limb_ID !=  'Contralateral' )








#Create new data frame Power_ParticipantMeans but containing only the 2.3 Hz hopping rate
Power_1LimbPer3Groups_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Limb_ID !=  'Contralateral' & Limb_ID !=  'Non-Involved' )

Power_1LimbPer3Groups_Ankle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle', Limb_ID !=  'Contralateral' & Limb_ID !=  'Non-Involved'  )






#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate and only the Involved and Matched Dominance Limbs
Power_ParticipantMeans_1LimbPer3Groups_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Limb_ID !=  'Contralateral' & Limb_ID !=  'Non-Involved' )

#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate and only the Involved and Matched Dominance Limbs, ANKLE ONLY
Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle', Limb_ID !=  'Contralateral' & Limb_ID !=  'Non-Involved'  )

#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate and only the Involved and Matched Dominance Limbs, KNEE ONLY
Power_ParticipantMeans_1LimbPer3Groups_Knee_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Knee', Limb_ID !=  'Contralateral' & Limb_ID !=  'Non-Involved'  )

#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate and only the Involved and Matched Dominance Limbs, HIP ONLY
Power_ParticipantMeans_1LimbPer3Groups_Hip_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Hip', Limb_ID !=  'Contralateral' & Limb_ID !=  'Non-Involved'  )






#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate and only the Involved and Matched Dominance Limbs
Power_ParticipantMeans_1LimbPer2Groups_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Limb_ID !=  'Non-Involved' & Limb_ID !=  'Contralateral' )

#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate and only the Involved and Matched Dominance Limbs, ANKLE ONLY
Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle', Limb_ID !=  'Non-Involved' & Limb_ID !=  'Contralateral'  )


#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate and only the Involved and Matched Dominance Limbs, KNEE ONLY
Power_ParticipantMeans_1LimbPer2Groups_Knee_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Knee', Limb_ID !=  'Non-Involved' & Limb_ID !=  'Contralateral'  )

#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate and only the Involved and Matched Dominance Limbs, HIP ONLY
Power_ParticipantMeans_1LimbPer2Groups_Hip_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Hip', Limb_ID !=  'Non-Involved' & Limb_ID !=  'Contralateral'  )




#Create a new data frame from the Power_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
Power_GroupMeans_1LimbPer3Groups_2.3Hz <- Power_GroupMeans %>% filter(HoppingRate_ID ==  '2.3', Limb_ID !=  'Contralateral' & Limb_ID !=  'Non-Involved' )

Power_GroupMeans_1LimbPer3Groups_Ankle_2.3Hz <- Power_GroupMeans %>% filter(HoppingRate_ID ==  '2.3', Joint_ID ==  'Ankle', Limb_ID !=  'Contralateral' & Limb_ID !=  'Non-Involved'  )


```






```{r Control Only}



#Create new data frame Power but containing only the Control group and 2.3 Hz hopping rate
Power_Control_MatchedDominance_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control', Limb_ID ==  'Matched Dominance' )

#Create new data frame Power_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
Power_Control_MatchedDominanceAnkle_2.3Hz <- TotalPower %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control', Joint_ID ==  'Ankle',Limb_ID == 'Matched Dominance')






#Create a new data frame from the Power_ParticipantMeans data, but containing only the Control group and the 2.3 Hz hopping rate
Power_ParticipantMeans_Control_MatchedDominance_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control', Limb_ID ==  'Matched Dominance' )

#Create a new data frame from the Power_ParticipantMeans data, but containing only the Control group and the 2.3 Hz hopping rate and only the Ankle joint
Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz <- Power_ParticipantMeans %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control',Joint_ID ==  'Ankle', Limb_ID ==  'Matched Dominance' )





#Create a new data frame from the Power_GroupMeans data, but containing only the Control group, only the 2.3 Hz hopping rate and only the Ankle joint
Power_GroupMeans_Control_MatchedDominanceAnkle_2.3Hz <- Power_GroupMeans %>% filter(HoppingRate_ID ==  '2.3', Group_ID ==  'Control', Joint_ID == 'Ankle', Limb_ID ==  'Matched Dominance' )



```





### Joint Functional Index

```{r Joint Functional Index}

JointFunctionalIndex_2.3Hz <- JointFunctionalIndex %>% filter( HoppingRate_ID ==  2.3 )


JointFunctionalIndex_2.3Hz_ParticipantMeansPerRate <- JointFunctionalIndex_ParticipantMeansPerRate %>% filter( HoppingRate_ID ==  2.3 )




JointFunctionalIndex_2.3Hz_ATx <- JointFunctionalIndex %>% filter( HoppingRate_ID ==  2.3, Group_ID ==  'ATx' )


InvolvedAnkleStrutIndex_2.3Hz_ATx <- JointFunctionalIndex_2.3Hz_ATx %>% filter( Joint_ID ==  'Ankle', Index_ID ==  'Strut', Limb_ID ==  'Involved' )

InvolvedAnkleSpringIndex_2.3Hz_ATx <- JointFunctionalIndex_2.3Hz_ATx %>% filter( Joint_ID ==  'Ankle', Index_ID ==  'Spring', Limb_ID ==  'Involved' )

InvolvedAnkleMotorIndex_2.3Hz_ATx <- JointFunctionalIndex_2.3Hz_ATx %>% filter( Joint_ID ==  'Ankle', Index_ID ==  'Motor', Limb_ID ==  'Involved' )

InvolvedAnkleBrakeIndex_2.3Hz_ATx <- JointFunctionalIndex_2.3Hz_ATx %>% filter( Joint_ID ==  'Ankle', Index_ID ==  'Brake', Limb_ID ==  'Involved' )





JointFunctionalIndex_2.3Hz_NoHP08 <- JointFunctionalIndex_2.3Hz %>% filter( Participant_ID !=  'HP08' )


```



##Pandoc Tables

### Support Moment

#### Braking Phase

```{r % Contribution, echo = FALSE}



pandoc.table( t = cbind( Power_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2vs2.3Hz$Participant_ID, Power_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2vs2.3Hz$HoppingRate_ID, Power_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2vs2.3Hz$Mean_JointContribution_PeakSupportMoment_BrakingPhase ), 'Ankle Contribution to Peak Braking Phase Support Moment', col.names = c( 'Participant ID', 'Hopping Rate', '% Peak Support Moment'), style = 'multiline',split.tables = 200,emphasize.rownames = T )


```




## Data Manipulations

```{r Limb-Mean Centered Hop}



#Initialize varible to hold hopping height but centered by limb means
Power_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered <- Power_Ankle_2.3Hz$HoppingHeight_cm

#Subtract Involved limb mean from hopping height
Power_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Involved' ) ] <- Power_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Involved' ) ] - mean( Power_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Involved' ) ] )

#Subtract Non-Involved limb mean from hopping height
Power_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Non-Involved' ) ] <- Power_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Non-Involved' ) ] - mean( Power_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Non-Involved' ) ] )

#Subtract Matched Limb mean from hopping height (for control group)
Power_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Matched Dominance' ) ] <- Power_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Matched Dominance' ) ] - mean( Power_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Matched Dominance' ) ] )

#Subtract Contralateral limb mean from hopping height (for control group)
Power_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Contralateral' ) ] <- Power_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Contralateral' ) ] - mean( Power_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_Ankle_2.3Hz$Limb_ID ==  'Contralateral' ) ] )







## SAME AS ABOVE BUT FOR PARTICIPANT MEANS

#Initialize varible to hold hopping height but centered by limb means
Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered <- Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm

#Subtract Involved limb mean from hopping height
Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Involved' ) ] <- Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Involved' ) ] - mean( Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Involved' ) ] )

#Subtract Non-Involved limb mean from hopping height
Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Non-Involved' ) ] <- Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Non-Involved' ) ] - mean( Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Non-Involved' ) ] )

#Subtract Matched Limb mean from hopping height (for control group)
Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Matched Dominance' ) ] <- Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Matched Dominance' ) ] - mean( Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Matched Dominance' ) ] )

#Subtract Contralateral limb mean from hopping height (for control group)
Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Contralateral' ) ] <- Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Contralateral' ) ] - mean( Power_ParticipantMeans_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID ==  'Contralateral' ) ] )









#Initialize varible to hold hopping height but centered by limb means
Power_ATx_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered <- Power_ATx_Ankle_2.3Hz$HoppingHeight_cm

#Subtract Involved limb mean from hopping height
Power_ATx_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered[ which( Power_ATx_Ankle_2.3Hz$Limb_ID ==  'Involved' ) ] <- Power_ATx_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ATx_Ankle_2.3Hz$Limb_ID ==  'Involved' ) ] - mean( Power_ATx_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ATx_Ankle_2.3Hz$Limb_ID ==  'Involved' ) ] )

#Subtract Non-Involved limb mean from hopping height
Power_ATx_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered[ which( Power_ATx_Ankle_2.3Hz$Limb_ID ==  'Non-Involved' ) ] <- Power_ATx_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ATx_Ankle_2.3Hz$Limb_ID ==  'Non-Involved' ) ] - mean( Power_ATx_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ATx_Ankle_2.3Hz$Limb_ID ==  'Non-Involved' ) ] )

```



```{r Hop Number Mean/Range}


UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )



HopNumberMeanRange <- data.frame( Group_ID = rep( 'Group', 2*length( UniqueParticipant ) ), Participant_ID = rep( 'Participant', 2*length( UniqueParticipant ) ), Limb_ID = rep( 'Limb', 2*length( UniqueParticipant ) ), HopNumber = rep( 0, 2*length( UniqueParticipant ) ) )




RowtoFill <- 1

for (k in 1:length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for (l in 1:length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      HopNumberMeanRange$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      HopNumberMeanRange$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      HopNumberMeanRange$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      #Add Participant K's Lth Limb ID
      HopNumberMeanRange$HopNumber[ RowtoFill ] <- max( Power_Ankle_2.3Hz_ParticipantKOnly$Hop_ID[ which( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID ==  UniqueLimb[ l ] ) ] )
      
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill + 1
      
   }#End L for loop
   
}#End K for loop



```



## STATS

### Normality Testing

#### ATx - Involved Limb


```{r 2.3 Hz}

## Whole-limb MEE, Braking Phase
Power_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>% 
   shapiro_test( Mean_Limb_Absorption_MEE )
# Normally distributed!

## Whole-limb MEE, Propulsion Phase
Power_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>%
   shapiro_test( Mean_Limb_Generation_MEE )
# Normally distributed!



## Ankle contribution to whole-limb MEE, Braking Phase
Power_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Ankle contribution to whole-limb power absorption, Braking Phase
Power_ParticipantMeans_ATxInvolvedLimb_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>% 
   shapiro_test( Mean_JointContribution_AveragePower_GenerationNeutralized )
# Normally distributed!


## Ankle contribution to whole-limb MEE, Propulsion Phase
Power_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!



## Ankle contribution to whole-limb power generation, Propulsion Phase
Power_ParticipantMeans_ATxInvolvedLimb_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>% 
   shapiro_test( Mean_JointContribution_AveragePower_AbsorptionNeutralized )
# Normally distributed!



## Knee contribution to whole-limb MEE, Braking Phase
Power_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID ==  'Knee' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Knee contribution to whole-limb MEE, Propulsion Phase
Power_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID ==  'Knee' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!








## Hip contribution to whole-limb MEE, Braking Phase
Power_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID ==  'Hip' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Hip contribution to whole-limb MEE, Propulsion Phase
Power_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID ==  'Hip' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!

```

#### Control Group



```{r 2.3 Hz}

## Whole-limb MEE, Braking Phase
Power_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>% 
   shapiro_test( Mean_Limb_Absorption_MEE )
# Normally distributed!

## Whole-limb MEE, Propulsion Phase
Power_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>%
   shapiro_test( Mean_Limb_Generation_MEE )
# NOT Normally distributed! - Need Wilcoxon rank sum test for whole-limb generation MEE





## Ankle contribution to whole-limb MEE, Braking Phase
Power_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!


## Ankle contribution to whole-limb power absorption, Braking Phase
Power_ParticipantMeans_Control_MatchedDominance_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>% 
   shapiro_test( Mean_JointContribution_AveragePower_GenerationNeutralized )
# Normally distributed!


## Ankle contribution to whole-limb MEE, Propulsion Phase
Power_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!



## Ankle contribution to whole-limb power generation, Propulsion Phase
Power_ParticipantMeans_Control_MatchedDominance_2.3Hz %>% 
   filter( Joint_ID ==  'Ankle' ) %>% 
   shapiro_test( Mean_JointContribution_AveragePower_AbsorptionNeutralized )
# Normally distributed!



## Knee contribution to whole-limb MEE, Braking Phase
Power_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID ==  'Knee' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Knee contribution to whole-limb MEE, Propulsion Phase
Power_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID ==  'Knee' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!







## Hip contribution to whole-limb MEE, Braking Phase
Power_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID ==  'Hip' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Hip contribution to whole-limb MEE, Propulsion Phase
Power_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID ==  'Hip' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!


```

###ANOVAs

```{r % MEE Absorption vs Group}



bxp <- ggboxplot(Power_ParticipantMeans_3Limbs_Ankle_2.3Hz, x = "Group_by_Morphology_NotOrdered", y = 'Mean_Joint_Percent_MEE_Absorption', add = "point")
bxp


Power_ParticipantMeans_3Limbs_Ankle_2.3Hz %>%
  group_by(Group_by_Morphology_NotOrdered) %>%
  identify_outliers(Mean_Joint_Percent_MEE_Absorption)


Power_ParticipantMeans_3Limbs_Ankle_2.3Hz %>%
  group_by(Group_by_Morphology_NotOrdered) %>%
  shapiro_test(Mean_Joint_Percent_MEE_Absorption)
#All are normally distributed



#Are variances equal?
DancerKinematics %>% levene_test(GContactDuration_sec~factor( Series_ID) )


#wid = participant ID, within = repeated measures variable
ANOVA_PercentMEEAbsorptionvsGroup <- Power_ParticipantMeans_3Limbs_Ankle_2.3Hz %>% anova_test(Mean_Joint_Percent_MEE_Absorption~Group_by_Morphology_NotOrdered, wid = Participant_ID,within = Group_by_Morphology_NotOrdered, effect.size = 'pes' )


get_anova_table(mANOVA)





#wid = participant ID, within = repeated measures variable
mANOVA <- Power_ParticipantMeans_3Limbs_Ankle_2.3Hz %>% anova_test(PercentPositivePower_JointContribution_EntireContactPhase~Group_by_Morphology_NotOrdered, wid = Participant_ID,within = Group_by_Morphology_NotOrdered, effect.size = 'pes' )


get_anova_table(mANOVA)



PercentNegativePower_Ankle_2.3Hz_ATx <- data.frame( x = Power_ParticipantMeans_3Limbs_Ankle_2.3Hz$Mean_Joint_Percent_MEE_Absorption[ which( Power_ParticipantMeans_3Limbs_Ankle_2.3Hz$Group_by_Morphology_NotOrdered == 'Involved' ) ] )


PercentNegativePower_Ankle_2.3Hz_ATx$Non_Involved <- Power_ParticipantMeans_3Limbs_Ankle_2.3Hz$Mean_Joint_Percent_MEE_Absorption[ which( Power_ParticipantMeans_3Limbs_Ankle_2.3Hz$Group_by_Morphology_NotOrdered == 'Non-Involved' ) ]

colnames( PercentNegativePower_Ankle_2.3Hz_ATx ) <- c( 'Involved', ' Non-Involved' )

cor( PercentNegativePower_Ankle_2.3Hz_ATx, method = 'pearson' )




PercentPositivePower_Ankle_2.3Hz_ATx <- data.frame( x = Power_ParticipantMeans_3Limbs_Ankle_2.3Hz$PercentPositivePower_JointContribution_EntireContactPhase[ which( Power_ParticipantMeans_3Limbs_Ankle_2.3Hz$Group_by_Morphology_NotOrdered == 'Involved' ) ] )


PercentPositivePower_Ankle_2.3Hz_ATx$Non_Involved <- Power_ParticipantMeans_3Limbs_Ankle_2.3Hz$PercentPositivePower_JointContribution_EntireContactPhase[ which( Power_ParticipantMeans_3Limbs_Ankle_2.3Hz$Group_by_Morphology_NotOrdered == 'Non-Involved' ) ]

colnames( PercentPositivePower_Ankle_2.3Hz_ATx ) <- c( 'Involved', ' Non-Involved' )

cor( PercentPositivePower_Ankle_2.3Hz_ATx, method = 'pearson' )

```

### ANCOVA
```{r Power Absorption Contribution vs Group and Age}

## Assumption: no perfect correlation between IVs - doesn't apply since one IV is categorical and one is continuous


## Assumption: model is linear
ggplot( data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes( x = Age, y = Mean_JointContribution_AveragePower_GenerationNeutralized ) ) +
            
            geom_point( size = 5, aes( group = Group_ID, color = Group_ID ) ) +
            
            geom_smooth( method = 'lm', aes( group = Group_ID, color = Group_ID ), linewidth = 2 )
#Linearity seems reasonable


#Assumption: regression slopes are homogenous
LM_AnklePercentAbsorptionvsGroupAge <- lm( formula = Mean_JointContribution_AveragePower_GenerationNeutralized ~ Age*Group_ID, data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz )
summary( LM_AnklePercentAbsorptionvsGroupAge )
#Interaction term isn't significant, so assumption is met

#Create linear model to test the error assumptions
LM_AnklePercentAbsorptionvsGroupAge <- lm( formula = Mean_JointContribution_AveragePower_GenerationNeutralized ~ Age + Group_ID, data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz )

#Assumption: Error terms are uncorrelated
ggplot( data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes( x = Participant_ID, y = Mean_JointContribution_AveragePower_GenerationNeutralized ) ) +
            
            geom_point( size = 5, aes( group = Participant_ID, color = Participant_ID ) ) +
   
   geom_line() +

scale_x_discrete( limits = c( 'ATx18', 'HC01', 'ATx10', 'ATx12', 'ATx19', 'ATx07', 'HC05', 'ATx21', 'ATx17', 'HC06', 'HC12', 'ATx27', 'HC11', 'ATx25', 'HC17', 'ATx08', 'HC19', 'ATx24', 'ATx34', 'HC20', 'HC21', 'HC25', 'ATx41', 'ATx38', 'ATx44', 'ATx50', 'ATx36', 'ATx49'  ) )
#Assumption seems to be met

#Assumption: error terms follow normal distribution
   #Augment model with model metrics
LM_AnklePercentAbsorptionvsGroupAge_Augmented <- augment( LM_AnklePercentAbsorptionvsGroupAge )
   #Check the first 3 rows of LM_AnklePercentAbsorptionvsGroupAge_Augmented to check that augmentation worked
head( LM_AnklePercentAbsorptionvsGroupAge_Augmented, 3 )
   #Use Shapiro-Wilk test to test normality
   LM_AnklePercentAbsorptionvsGroupAge_Augmented %>%
      shapiro_test( .resid )
#Error terms are normally distributed

#Assumption: error terms have constant variance
   #Use Levene's test to test variance constancy across groups
   LM_AnklePercentAbsorptionvsGroupAge_Augmented %>%
      levene_test( .resid ~ Group_ID )
#Levene's test is not significant, so error terms have constant variane across groups


#Assumption: independent variables are not correlated with error terms
cor.test( y = LM_AnklePercentAbsorptionvsGroupAge_Augmented$.resid, x = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Age, method = 'pearson'  )
#Age is not correlated with error terms

#Perform ANCOVA
( ANCOVA_AnklePercentAbsorptionvsGroupAge <- Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz %>%
   anova_test( Mean_JointContribution_AveragePower_GenerationNeutralized ~ Age*Group_ID ) )
#No significant difference between groups after adjusting for age


#Perform pair-wise comparisons to check adjusted means
   #use emmeans_test to perform estimated marginal means testing between groups
( ANCOVA_AnklePercentAbsorptionvsGroupAge_PairwiseComparisons <- Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz %>%
   emmeans_test( Mean_JointContribution_AveragePower_GenerationNeutralized ~ Group_ID, covariate = Age, p.adjust.method = 'bonferroni' ) )
   #Use get_emmeans to get adjusted group means, SE, confidence intervals
( ANCOVA_AnklePercentAbsorptionvsGroupAge_PairwiseComparisons_EMMeans <- get_emmeans( ANCOVA_AnklePercentAbsorptionvsGroupAge_PairwiseComparisons ) )

#Find the CI arm for each group
ANCOVA_AnklePercentAbsorptionvsGroupAge_PairwiseComparisons_EMMeans$conf.high - ANCOVA_AnklePercentAbsorptionvsGroupAge_PairwiseComparisons_EMMeans$emmean

#Find the average CI arm between groups
mean( ANCOVA_AnklePercentAbsorptionvsGroupAge_PairwiseComparisons_EMMeans$conf.high - ANCOVA_AnklePercentAbsorptionvsGroupAge_PairwiseComparisons_EMMeans$emmean )

#Overlap between CI arms
57.1 - 51.9
#Overlap is more than half of average CI arm - not significantly different

```


### T-Test


#### 2.33 Hz
```{r 2.3 Hz}


## Whole-limb MEE - Braking Phase
Power_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   t_test( Mean_Limb_Absorption_MEE ~ Group_ID, conf.level = 0.95, detailed = T )





## Ankle contribution to whole-limb MEE - Braking Phase
Power_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   t_test( Mean_Joint_Percent_MEE_Absorption ~ Group_ID, conf.level = 0.95, detailed = T )


## Ankle contribution to whole-limb MEE - Propulsion Phase
Power_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   t_test( Mean_Joint_Percent_MEE_Generation ~ Group_ID, conf.level = 0.95, detailed = T )


#Identify outliers in Mean_JointContribution_AveragePower_GenerationNeutralized
Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz %>%
  group_by(Group_ID) %>%
  identify_outliers(Mean_JointContribution_AveragePower_GenerationNeutralized)

#Test equality of variances for Mean_JointContribution_AveragePower_GenerationNeutralized
Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz %>% levene_test(Mean_JointContribution_AveragePower_GenerationNeutralized ~ Group_ID)



## Knee contribution to whole-limb MEE - Braking Phase
Power_ParticipantMeans_InvolvedVsControlKnee_2.3Hz %>%
   t_test( Mean_Joint_Percent_MEE_Absorption ~ Group_ID, conf.level = 0.95, detailed = T )





## Hip contribution to whole-limb MEE - Propulsion Phase
Power_ParticipantMeans_InvolvedVsControlHip_2.3Hz %>%
   t_test( Mean_Joint_Percent_MEE_Generation ~ Group_ID, conf.level = 0.95, detailed = T )

```




```{r % Power Absorption}

#Test normality
Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz %>%
  group_by( Group_ID ) %>%
  shapiro_test(Mean_JointContribution_AveragePower_GenerationNeutralized )
#Both groups are normally distributed!

#Identify outliers in Mean_JointContribution_AveragePower_GenerationNeutralized
   #ATx Group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers( Mean_JointContribution_AveragePower_GenerationNeutralized )
#No outliers

   #Control Group
Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz %>%
  identify_outliers( Mean_JointContribution_AveragePower_GenerationNeutralized )
#No outliers


#Test equality of variances for Mean_JointContribution_AveragePower_GenerationNeutralized
Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz %>% levene_test(Mean_JointContribution_AveragePower_GenerationNeutralized ~ Group_ID)


## Ankle contribution to whole-limb power absorption - Braking Phase
Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz %>%
   t_test( Mean_JointContribution_AveragePower_GenerationNeutralized ~ Group_ID, conf.level = 0.95, detailed = T )

```



```{r % Power Generation}

#Test normality
Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz %>%
  group_by( Group_ID ) %>%
  shapiro_test(Mean_JointContribution_AveragePower_AbsorptionNeutralized )
#Both groups are normally distributed!

#Identify outliers in Mean_JointContribution_AveragePower_AbsorptionNeutralized
   #ATx Group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers( Mean_JointContribution_AveragePower_AbsorptionNeutralized )
#ATx24 is an outlier

#Retest outliers without ATx24
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
   filter( Participant_ID !=  'ATx24' ) %>%
  identify_outliers( Mean_JointContribution_AveragePower_AbsorptionNeutralized )
#No remaining outliers

   #Control Group
Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz %>%
  identify_outliers( Mean_JointContribution_AveragePower_AbsorptionNeutralized )
#No outliers


#Test equality of variances for Mean_JointContribution_AveragePower_AbsorptionNeutralized
Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz %>%
   filter( Participant_ID !=  'ATx24' ) %>%
   levene_test(Mean_JointContribution_AveragePower_AbsorptionNeutralized ~ Group_ID)
#Variances are equal!

## Ankle contribution to whole-limb power generation - Propulsion Phase
Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz %>%
   filter( Participant_ID !=  'ATx24' ) %>%
   t_test( Mean_JointContribution_AveragePower_AbsorptionNeutralized ~ Group_ID, conf.level = 0.95, detailed = T )



```



### Wilcoxon Rank Sum Test

```{r 2.3 Hz}

## Whole-limb MEE - Propulsion Phase
Power_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   wilcox_test( Mean_Limb_Generation_MEE ~ Group_ID, conf.level = 0.95, detailed = T )


## Knee contribution to whole-limb MEE - Propulsion Phase
Power_ParticipantMeans_InvolvedVsControlKnee_2.3Hz %>%
   wilcox_test( Mean_Joint_Percent_MEE_Generation ~ Group_ID, conf.level = 0.95, detailed = T )


## Hip contribution to whole-limb MEE - Braking Phase
Power_ParticipantMeans_InvolvedVsControlHip_2.3Hz %>% 
   wilcox_test( Mean_Joint_Percent_MEE_Absorption ~ Group_ID, conf.level = 0.95, detailed = T )




```

### Hedges G

```{r 2.3 Hz}

## Whole-limb MEE - Braking Phase
Power_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   cohens_d( Mean_Limb_Absorption_MEE ~ Group_ID, conf.level = 0.95, ci = T )


## Ankle contribution to whole-limb MEE - Braking Phase
Power_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   cohens_d( Mean_Joint_Percent_MEE_Absorption ~ Group_ID, conf.level = 0.95, ci = T )


## Ankle contribution to whole-limb MEE - Propulsion Phase
Power_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   cohens_d( Mean_Joint_Percent_MEE_Generation ~ Group_ID, conf.level = 0.95, ci = T )




## Knee contribution to whole-limb MEE - Braking Phase
Power_ParticipantMeans_InvolvedVsControlKnee_2.3Hz %>%
   cohens_d( Mean_Joint_Percent_MEE_Absorption ~ Group_ID, conf.level = 0.95, ci = T )


## Hip contribution to whole-limb MEE - Propulsion Phase
Power_ParticipantMeans_InvolvedVsControlHip_2.3Hz %>%
   cohens_d( Mean_Joint_Percent_MEE_Generation ~ Group_ID, conf.level = 0.95, ci = T )




```


### Wilcoxon Effect Size

```{r 2.3 Hz}

## Whole-limb MEE - Propulsion Phase
Power_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   wilcox_effsize( Mean_Limb_Generation_MEE ~ Group_ID, ci = T, comparisons = list( c( 'ATx', 'Control' ) ) )


```


#Correlation



#### Ankle Work

##### vs Morphology
```{r Braking}

AnkleWorkvsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  Participant_ID = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointWork_Braking_GenerationNeutralized = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized,
                                                                  Mean_JointWork_Propulsion_AbsorptionNeutralized = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#ATx08 and ATx27 are outliers, but not extreme outliers





#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)





#Determine whether Mean_JointWork_Braking_GenerationNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  shapiro_test(Mean_JointWork_Braking_GenerationNeutralized)


#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed




#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Pearson_BrakingPhaseJointWorkvsATxMorphology <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz, method = 'pearson', alternative = 'two.sided' ) )


```




```{r Propulsion}




#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers




#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24, method = 'spearman', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24, method = 'pearson', alternative = 'two.sided' ) )



summary(LM_Joint_Work_AbsorptionvsATxMorphology)
confint(LM_Joint_Work_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant




( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRateLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRateLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



```


#### Ankle Work, Limb Diff

##### vs Morphology
```{r Braking}

LimbDiffAnkleWorkvsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Group_ID,
                                                                  Participant_ID = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointWork_Braking_GenerationNeutralized = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized,
                                                                  Mean_JointWork_Propulsion_AbsorptionNeutralized = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)





#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)





#Determine whether Mean_JointWork_Braking_GenerationNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_JointWork_Braking_GenerationNeutralized)
#All are normally distributed


#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed




#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Pearson_BrakingPhaseJointWorkvsATxMorphology <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided' ) )


```




```{r Propulsion}




#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier



Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter(Participant_ID != 'ATx38', Participant_ID != 'ATx44') %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier


#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers


#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed



#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed



#Pearson' r for correlation
( Pearson_PropulsionPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided' ) )



#Pearson' r for correlation
( Pearson_PropulsionPhaseJointWorkRatevsATxMorphology <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
    cor_test( Mean_JointWork_Propulsion_AbsorptionNeutralized, Mean_BetweenLimbTendonThickness_mm, method = 'pearson', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )



summary(LM_Joint_Work_AbsorptionvsATxMorphology)
confint(LM_Joint_Work_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant



```



#### Knee Work

##### vs Morphology
```{r Braking}

KneeWorkvsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  Participant_ID = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointWork_Braking_GenerationNeutralized = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized,
                                                                  Mean_JointWork_Propulsion_AbsorptionNeutralized = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#ATx08 and ATx27 are outliers, but not extreme outliers


Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or27 <- Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#No outliers




#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#ATx18 is an outlier


Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27 <- Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#No outliers

#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers





#Determine whether Mean_JointWork_Braking_GenerationNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_JointWork_Braking_GenerationNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRatevsATxMorphology_NoATx08or18or27 <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27, method = 'spearman', alternative = 'two.sided' ) )




( Spearman_BrakingPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz, method = 'spearman', alternative = 'two.sided', na.action = na.omit ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRateLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Knee_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRateLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )





```




```{r Propulsion}




#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier


#
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz %>% 
   filter( Participant_ID !=  'ATx24' )


#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers




#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24, method = 'spearman', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24, method = 'pearson', alternative = 'two.sided' ) )



summary(LM_Joint_Work_AbsorptionvsATxMorphology)
confint(LM_Joint_Work_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant




( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRateLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Knee_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRateLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



```


#### Ankle Work, Limb Diff

##### vs Morphology
```{r Braking}

LimbDiffAnkleWorkvsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Group_ID,
                                                                  Participant_ID = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointWork_Braking_GenerationNeutralized = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized,
                                                                  Mean_JointWork_Propulsion_AbsorptionNeutralized = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)





#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)





#Determine whether Mean_JointWork_Braking_GenerationNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_JointWork_Braking_GenerationNeutralized)
#All are normally distributed


#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed




#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Pearson_BrakingPhaseJointWorkvsATxMorphology <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided' ) )


```




```{r Propulsion}




#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier



Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter(Participant_ID != 'ATx38', Participant_ID != 'ATx44') %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier


#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers


#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed



#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed



#Pearson' r for correlation
( Pearson_PropulsionPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided' ) )



#Pearson' r for correlation
( Pearson_PropulsionPhaseJointWorkRatevsATxMorphology <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
    cor_test( Mean_JointWork_Propulsion_AbsorptionNeutralized, Mean_BetweenLimbTendonThickness_mm, method = 'pearson', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )



summary(LM_Joint_Work_AbsorptionvsATxMorphology)
confint(LM_Joint_Work_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant



```



#### Hip Work

##### vs Morphology
```{r Braking}

HipWorkvsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  Participant_ID = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointWork_Braking_GenerationNeutralized = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized,
                                                                  Mean_JointWork_Propulsion_AbsorptionNeutralized = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#ATx08 and ATx27 are outliers, but not extreme outliers


Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or27 <- Power_ParticipantMeans_ATxInvolvedHip_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#No outliers




#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#ATx18 is an outlier


Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27 <- Power_ParticipantMeans_ATxInvolvedHip_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#No outliers

#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers





#Determine whether Mean_JointWork_Braking_GenerationNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_JointWork_Braking_GenerationNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRatevsATxMorphology_NoATx08or18or27 <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27, method = 'spearman', alternative = 'two.sided' ) )


( Spearman_BrakingPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz, method = 'spearman', alternative = 'two.sided', na.action = na.omit ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRateLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Hip_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRateLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )





```




```{r Propulsion}




#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier


#
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedHip_2.3Hz %>% 
   filter( Participant_ID !=  'ATx24' )


#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers




#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24, method = 'spearman', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24, method = 'pearson', alternative = 'two.sided' ) )



summary(LM_Joint_Work_AbsorptionvsATxMorphology)
confint(LM_Joint_Work_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant




( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRateLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Hip_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRateLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



```


#### Ankle Work, Limb Diff

##### vs Morphology
```{r Braking}

LimbDiffAnkleWorkvsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Group_ID,
                                                                  Participant_ID = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointWork_Braking_GenerationNeutralized = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized,
                                                                  Mean_JointWork_Propulsion_AbsorptionNeutralized = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)





#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)





#Determine whether Mean_JointWork_Braking_GenerationNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_JointWork_Braking_GenerationNeutralized)
#All are normally distributed


#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed




#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Pearson_BrakingPhaseJointWorkvsATxMorphology <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided' ) )


```




```{r Propulsion}




#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier



Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter(Participant_ID != 'ATx38', Participant_ID != 'ATx44') %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier


#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers


#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed



#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed



#Pearson' r for correlation
( Pearson_PropulsionPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided' ) )



#Pearson' r for correlation
( Pearson_PropulsionPhaseJointWorkRatevsATxMorphology <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx38', Participant_ID != 'ATx44' ) %>%
    cor_test( Mean_JointWork_Propulsion_AbsorptionNeutralized, Mean_BetweenLimbTendonThickness_mm, method = 'pearson', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )



summary(LM_Joint_Work_AbsorptionvsATxMorphology)
confint(LM_Joint_Work_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant



```



#### Ankle Work Rate

##### vs Morphology
```{r Braking}

AnkleAveragePowervsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  Participant_ID = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointAveragePower_Braking_GenerationNeutralized = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized,
                                                                  Mean_JointAveragePower_Propulsion_AbsorptionNeutralized = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointAveragePower_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers(Mean_JointAveragePower_Braking_GenerationNeutralized)
#ATx08 and ATx27 are outliers, but not extreme outliers


Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointAveragePower_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_JointAveragePower_Braking_GenerationNeutralized)
#No outliers




#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#ATx18 is an outlier


Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointAveragePower_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_JointAveragePower_Braking_GenerationNeutralized)
#No outliers

#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers





#Determine whether Mean_JointAveragePower_Braking_GenerationNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_JointAveragePower_Braking_GenerationNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointAveragePower_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRatevsATxMorphology_NoATx08or18or19or24or27or44 <- cor.test( formula = ~Mean_JointAveragePower_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44, method = 'spearman', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointAveragePower_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRatevsATxMorphology_NoATx08or18or27 <- cor.test( formula = ~Mean_JointAveragePower_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27, method = 'pearson', alternative = 'two.sided' ) )





```




```{r Propulsion}

AnkleAveragePowervsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  Participant_ID = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointAveragePower_Braking_GenerationNeutralized = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized,
                                                                  Mean_JointAveragePower_Propulsion_AbsorptionNeutralized = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointAveragePower_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers(Mean_JointAveragePower_Propulsion_AbsorptionNeutralized)
#ATx08 is an outlier, but not extreme outlier


#
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' )


#Find outliers in Mean_JointAveragePower_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08 %>%
  identify_outliers(Mean_JointAveragePower_Propulsion_AbsorptionNeutralized)
#ATx50 is an outlier





Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or50 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx50' )


#Find outliers in Mean_JointAveragePower_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or50 %>%
  identify_outliers(Mean_JointAveragePower_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier




Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or50 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx24'  & Participant_ID !=  'ATx50' )


#Find outliers in Mean_JointAveragePower_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or50 %>%
  identify_outliers(Mean_JointAveragePower_Propulsion_AbsorptionNeutralized)
#ATx27 is an outlier





Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or27or50 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx27'  & Participant_ID !=  'ATx50' )


#Find outliers in Mean_JointAveragePower_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or27or50 %>%
  identify_outliers(Mean_JointAveragePower_Propulsion_AbsorptionNeutralized)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or27or50 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#ATx18 is an outlier








Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or24or27or50 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx27'  & Participant_ID !=  'ATx50' )


#Find outliers in Mean_JointAveragePower_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or24or27or50 %>%
  identify_outliers(Mean_JointAveragePower_Propulsion_AbsorptionNeutralized)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or24or27or50 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers






#Determine whether Mean_JointAveragePower_Propulsion_AbsorptionNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or24or27or50 %>%
  shapiro_test(Mean_JointAveragePower_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or24or27or50 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointAveragePower_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx08or18or24or27or50 <- cor.test( formula = ~Mean_JointAveragePower_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or24or27or50, method = 'spearman', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointAveragePower_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx08or18or24or27or50 <- cor.test( formula = ~Mean_JointAveragePower_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or24or27or50, method = 'pearson', alternative = 'two.sided' ) )



summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant




```


#### % Ankle Work

##### vs Morphology
```{r Braking}

AnkleWorkContributionvsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  Participant_ID = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointWork_Braking_GenerationNeutralized = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_JointWorkContribution_Braking_GenerationNeutralized,
                                                                  Mean_JointWork_Propulsion_AbsorptionNeutralized = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#ATx08 and ATx27 are outliers, but not extreme outliers


Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#No outliers




#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#ATx18 is an outlier


Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#No outliers

#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers





#Determine whether Mean_JointWork_Braking_GenerationNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_JointWork_Braking_GenerationNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRatevsATxMorphology_NoATx08or18or27 <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or27, method = 'spearman', alternative = 'two.sided' ) )




( Spearman_BrakingPhaseJointWorkContributionvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWorkContribution_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkContributionLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWorkContribution_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkContributionLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )





```




```{r Propulsion}




#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier


#
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx24' )


#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers




#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24, method = 'spearman', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24, method = 'pearson', alternative = 'two.sided' ) )



summary(LM_Joint_Work_AbsorptionvsATxMorphology)
confint(LM_Joint_Work_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant




( Spearman_PropulsionPhaseJointWorkContributionvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkContributionLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkContributionLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )





```


#### % Ankle Work, Limb Diff

##### vs Morphology
```{r Braking}

LimbDiffAnkleWorkvsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Group_ID,
                                                                  Participant_ID = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointWorkContribution_Braking_GenerationNeutralized = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_JointWorkContribution_Braking_GenerationNeutralized,
                                                                  Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_JointWorkContribution_Braking_GenerationNeutralized)





#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)





#Determine whether Mean_JointWorkContribution_Braking_GenerationNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_JointWorkContribution_Braking_GenerationNeutralized)
#All are normally distributed


#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed




#Spearman's rho for correlation - use this because of outliers in Mean_JointWorkContribution_Braking_GenerationNeutralized
( Pearson_BrakingPhaseJointWorkContributionvsATxMorphology <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
    cor_test( vars = c( Mean_JointWorkContribution_Braking_GenerationNeutralized, Mean_BetweenLimbTendonThickness_mm ),
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided' ) )




#Spearman's rho for correlation - use this because of outliers in Mean_JointWorkContribution_Braking_GenerationNeutralized
( Pearson_BrakingPhaseJointWorkContributionvsATxMorphology <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
    filter( Participant_ID!='ATx07', Participant_ID!='ATx12', Participant_ID!='ATx49', Participant_ID!='ATx50' ) %>%
    cor_test( vars = c( Mean_JointWorkContribution_Braking_GenerationNeutralized, Mean_BetweenLimbTendonThickness_mm ),
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided' ) )



```




```{r Propulsion}




#Find outliers in Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier



Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter(Participant_ID != 'ATx39' ) %>%
  identify_outliers(Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier


#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx39' ) %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers


#Determine whether Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx39' ) %>%
  shapiro_test(Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized)
#All are normally distributed



#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx39' ) %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed




#Pearson' r for correlation
( Pearson_PropulsionPhaseJointWorkContributionRatevsATxMorphology <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
    cor_test( Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized, Mean_BetweenLimbTendonThickness_mm, method = 'pearson', alternative = 'two.sided' ) )


#Pearson' r for correlation
( Pearson_PropulsionPhaseJointWorkContributionRatevsATxMorphology <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  filter( Participant_ID != 'ATx39' ) %>%
    cor_test( Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized, Mean_BetweenLimbTendonThickness_mm, method = 'pearson', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkContributionRatevsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'spearman', alternative = 'two.sided', exact = F ) )



summary(LM_Joint_WorkContribution_AbsorptionvsATxMorphology)
confint(LM_Joint_WorkContribution_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant



```



#### % Knee Work

##### vs Morphology
```{r Braking}

KneeWorkContributionvsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  Participant_ID = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointWork_Braking_GenerationNeutralized = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Mean_JointWorkContribution_Braking_GenerationNeutralized,
                                                                  Mean_JointWork_Propulsion_AbsorptionNeutralized = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz$Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#ATx08 and ATx27 are outliers, but not extreme outliers


Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or27 <- Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#No outliers




#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#ATx18 is an outlier


Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27 <- Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#No outliers

#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers





#Determine whether Mean_JointWork_Braking_GenerationNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_JointWork_Braking_GenerationNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRatevsATxMorphology_NoATx08or18or27 <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx08or18or27, method = 'spearman', alternative = 'two.sided' ) )




( Spearman_BrakingPhaseJointWorkContributionvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWorkContribution_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkContributionLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Knee_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWorkContribution_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkContributionLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )





```




```{r Propulsion}




#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier


#
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz %>% 
   filter( Participant_ID !=  'ATx24' )


#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers




#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24, method = 'spearman', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz_NoATx24, method = 'pearson', alternative = 'two.sided' ) )



summary(LM_Joint_Work_AbsorptionvsATxMorphology)
confint(LM_Joint_Work_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant




( Spearman_PropulsionPhaseJointWorkContributionvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedKnee_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkContributionLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Knee_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkContributionLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )





```







#### % Hip Work

##### vs Morphology
```{r Braking}

HipWorkContributionvsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  Participant_ID = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointWork_Braking_GenerationNeutralized = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Mean_JointWorkContribution_Braking_GenerationNeutralized,
                                                                  Mean_JointWork_Propulsion_AbsorptionNeutralized = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz$Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#ATx08 and ATx27 are outliers, but not extreme outliers


Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or27 <- Power_ParticipantMeans_ATxInvolvedHip_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#No outliers




#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#ATx18 is an outlier


Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27 <- Power_ParticipantMeans_ATxInvolvedHip_2.3Hz %>% 
   filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_JointWork_Braking_GenerationNeutralized)
#No outliers

#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers





#Determine whether Mean_JointWork_Braking_GenerationNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_JointWork_Braking_GenerationNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkRatevsATxMorphology_NoATx08or18or27 <- cor.test( formula = ~Mean_JointWork_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx08or18or27, method = 'spearman', alternative = 'two.sided' ) )




( Spearman_BrakingPhaseJointWorkContributionvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWorkContribution_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkContributionLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Hip_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWorkContribution_Braking_GenerationNeutralized
( Spearman_BrakingPhaseJointWorkContributionLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Braking_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )





```




```{r Propulsion}




#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#ATx24 is an outlier, but not extreme outlier


#
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedHip_2.3Hz %>% 
   filter( Participant_ID !=  'ATx24' )


#Find outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers




#Determine whether Mean_JointWork_Propulsion_AbsorptionNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_JointWork_Propulsion_AbsorptionNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24, method = 'spearman', alternative = 'two.sided' ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkRatevsATxMorphology_NoATx24 <- cor.test( formula = ~Mean_JointWork_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz_NoATx24, method = 'pearson', alternative = 'two.sided' ) )



summary(LM_Joint_Work_AbsorptionvsATxMorphology)
confint(LM_Joint_Work_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant




( Spearman_PropulsionPhaseJointWorkContributionvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedHip_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )





#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkContributionLimbDiffvsATxMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Hip_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )



#Spearman's rho for correlation - use this because of outliers in Mean_JointWork_Propulsion_AbsorptionNeutralized
( Spearman_PropulsionPhaseJointWorkContributionLimbDiffvsMorphology <- cor.test( formula = ~Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz, method = 'pearson', alternative = 'two.sided', na.action = na.omit ) )





```



#### ATx Ankle % Average Work

##### vs Morphology
```{r Braking}


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_JointContribution_AveragePower_GenerationNeutralized)
#No outliers



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers


#Determine whether Mean_JointContribution_AveragePower_GenerationNeutralized is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_JointContribution_AveragePower_GenerationNeutralized)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Pearson's correlation coefficient
( PearsonR_AnkleAverageAbsorptionvsATxMorphology <- cor.test( formula = ~Mean_JointContribution_AveragePower_GenerationNeutralized+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'pearson', alternative = 'two.sided' ) )
#Correlation is not significant


```



#### ATx Ankle % Average Power

##### vs Morphology
```{r Braking}


Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% mutate( Mean_JointContribution_AveragePower_AbsorptionNeutralized_Decimal = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100 )


Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Participant_ID !=  'ATx24' )


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_JointContribution_AveragePower_AbsorptionNeutralized_Decimal)
#ATx24 is an outlier but not extreme



#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers


#Determine whether Mean_JointContribution_AveragePower_GenerationNeutralized is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_JointContribution_AveragePower_AbsorptionNeutralized_Decimal)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Pearson's correlation coefficient
( PearsonR_AnkleAverageAbsorptionvsATxMorphology <- cor.test( formula = ~Mean_JointContribution_AveragePower_AbsorptionNeutralized_Decimal+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24, method = 'pearson', alternative = 'two.sided' ) )
#Correlation is not significant


```




#### ATx Ankle Average Ang Vel

##### vs Morphology
```{r Braking}


#Find outliers in Mean_JointWork_Braking_GenerationNeutralized - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_AverageJointAngVel_BrakingPhase)
#ATx38 is an outlier



#Remove ATx38 to retest for outliers
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx38 <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
   filter( Participant_ID !=  'ATx38' )


#Retest for outliers without ATx38
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx38 %>%
  identify_outliers(Mean_AverageJointAngVel_BrakingPhase)
#No remaining outliers


#Find outliers in Mean_BetweenLimbTendonThickness_mm - the data frame contains only the Achilles tendinopathy group
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers

#Retest for outliers after removing ATx38
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx38 %>%
  identify_outliers(Mean_BetweenLimbTendonThickness_mm)
#No outliers

#Determine whether Mean_AverageJointAngVel_BrakingPhase is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_AverageJointAngVel_BrakingPhase)
#All are normally distributed

#Retest after removing ATx38
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx38 %>%
  shapiro_test(Mean_AverageJointAngVel_BrakingPhase)
#All are normally distributed

#Determine whether Mean_BetweenLimbTendonThickness_mm is normally distributed
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed

#Retest after removing ATx38
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx38 %>%
  shapiro_test(Mean_BetweenLimbTendonThickness_mm)
#All are normally distributed


#Use Spearman's rho because of outlier in Mean_AverageJointAngVel_BrakingPhase
( SpearmanRho_AnkleAverageAbsorptionvsATxMorphology <- cor.test( formula = ~Mean_AverageJointAngVel_BrakingPhase+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, method = 'spearman', alternative = 'two.sided' ) )
#Correlation is not significant


#Use Pearson's R after removing ATx8
( SpearmanRho_AnkleAverageAbsorptionvsATxMorphology <- cor.test( formula = ~Mean_AverageJointAngVel_BrakingPhase+Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx38, method = 'pearson', alternative = 'two.sided' ) )
#Correlation is not significant

```



#Linear Regression

### Between-Limb DIff

#### Ankle Absorption Work - Generation Neutralized

##### vs Morphology
```{r Braking}

LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm*Group_ID,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz, na.action = na.exclude )
summary(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff)
confint(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant


#Recalculate without ATx34
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  Participant_ID[12] )

LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm*Group_ID,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34, na.action = na.exclude )
summary(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff)
confint(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant

#Find the ID of the participant we need to remove
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34$Participant_ID[31]


#Recalculate without ATx34, HC42
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34orHC42 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34 %>% filter( Participant_ID !=  Participant_ID[31] )

LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm*Group_ID,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34orHC42, na.action = na.exclude )
summary(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff)
confint(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant






#Find the ID of the participant we need to remove
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34orHC42$Participant_ID[21]


#Recalculate without ATx34, HC42
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34orHC42orHC05 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34orHC42 %>% filter( Participant_ID !=  Participant_ID[21] )

LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm*Group_ID,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34orHC42orHC05, na.action = na.exclude )
summary(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff)
confint(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant

```




```{r Check Leverage and Cook's}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- hatvalues( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- mean( Leverage_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff > 2*AverageLeverage_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08, 18, 19, 27, 44





#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- cooks.distance( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff ) )


#Any data points with Cook's Distance  >0.5 the mean CookD may have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff > 0.5 )

#Any data points with Cook's Distance > 1 have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff > 1 )


#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff > 3*mean(CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,na.rm = T) )

#Any data points with Cook's Distance of >4/ (n-k-1) the mean CookD have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff > 4/ ( length( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff$fitted.values ) - 1 - 1  ) )

#Data Point 6 has high leverage


plot( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,type = "b",pch = 18,col = "red")
N = length( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff$fitted.values )
k = 1
cutoff = 4 / (N-k-1)
abline(h = cutoff,lty = 2)


```

```{r Check Other Assumptions}
#Check for multicollinearity
# vif( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff )

residualPlots(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,type = 'rstudent')


```



####Ankle %Absor Work - Generation Neutralized

##### vs Morphology
```{r Braking}

LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- lm( formula = Mean_JointWorkContribution_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm*Group_ID,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz, na.action = na.exclude )
summary(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff)
confint(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant



#Find the ID of the participant we need to remove
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Participant_ID[c(6,17)]



#Recalculate without ATx19, ATx49
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx19or49 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  Participant_ID[6], Participant_ID !=  Participant_ID[17] )


LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- lm( formula = Mean_JointWorkContribution_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm*Group_ID,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx19or49, na.action = na.exclude )
summary(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff)
confint(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant

#Find the ID of the participant we need to remove
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx19or49$Participant_ID[11]



#Recalculate without ATx19, 49, 38
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx19or49or38 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx19or49 %>% filter( Participant_ID !=  Participant_ID[11] )

LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- lm( formula = Mean_JointWorkContribution_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm*Group_ID,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx19or49or38, na.action = na.exclude )
summary(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff)
confint(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant






#Find the ID of the participant we need to remove
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx19or49or38$Participant_ID[15]


#Recalculate without ATx34, HC42
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34orHC42orHC05 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34orHC42 %>% filter( Participant_ID !=  Participant_ID[21] )

LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm*Group_ID,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx34orHC42orHC05, na.action = na.exclude )
summary(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff)
confint(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant

```




```{r Check Leverage and Cook's}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- hatvalues( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- mean( Leverage_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff > 2*AverageLeverage_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08, 18, 19, 27, 44





#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff <- cooks.distance( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff ) )


#Any data points with Cook's Distance  >0.5 the mean CookD may have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff > 0.5 )

#Any data points with Cook's Distance > 1 have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff > 1 )


#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff > 3*mean(CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,na.rm = T) )

#Any data points with Cook's Distance of >4/ (n-k-1) the mean CookD have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff > 4/ ( length( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff$fitted.values ) - 1 - 1  ) )

#Data Point 6 has high leverage


plot( CookD_LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,type = "b",pch = 18,col = "red")
N = length( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff$fitted.values )
k = 1
cutoff = 4 / (N-k-1)
abline(h = cutoff,lty = 2)


```



```{r Check Other Assumptions}
#Check for multicollinearity
# vif( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff )

residualPlots(LM_Joint_Work_AbsorptionvsMorphology_BetweenLimbDiff,type = 'rstudent')


```




### % Ankle MEE Absorption

#### vs Morphology Group
```{r Braking}



LM_Joint_Percent_MEE_AbsorptionvsGroup <- lm(formula = sqrt(Mean_Joint_Percent_MEE_Absorption)~Group_by_Morphology_NotOrdered,data = Power_ParticipantMeans_3Limbs_Ankle_2.3Hz)
summary(LM_Joint_Percent_MEE_AbsorptionvsGroup)
confint(LM_Joint_Percent_MEE_AbsorptionvsGroup,method = 'boot') # significant


LM_Joint_Percent_MEE_AbsorptionvsGroup$xlevels

```



```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Percent_MEE_AbsorptionvsGroup <- hatvalues( LM_Joint_Percent_MEE_AbsorptionvsGroup ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Percent_MEE_AbsorptionvsGroup <- mean( Leverage_LM_Joint_Percent_MEE_AbsorptionvsGroup ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Percent_MEE_AbsorptionvsGroup > 2*AverageLeverage_LM_Joint_Percent_MEE_AbsorptionvsGroup )
#No data points with high leverage based on hat values alone


#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Percent_MEE_AbsorptionvsGroup <- cooks.distance( LM_Joint_Percent_MEE_AbsorptionvsGroup ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_MEE_AbsorptionvsGroup > 3*mean(CookD_LM_Joint_Percent_MEE_AbsorptionvsGroup,na.rm = T) )

#Data Point 6 has high leverage

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Joint_Percent_MEE_AbsorptionvsGroup ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data = LM_Joint_Percent_MEE_AbsorptionvsGroup, aes(x = LM_Joint_Percent_MEE_AbsorptionvsGroup$fitted.values,y = StudResiduals )) +
     geom_point() +
     stat_smooth(method = "lm", se = FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Joint_Percent_MEE_AbsorptionvsGroup, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Percent_MEE_AbsorptionvsGroup )

residualPlots(LM_Joint_Percent_MEE_AbsorptionvsGroup,type = 'rstudent')


```



### Ankle % Average Work Absorption

#### vs Morphology, Group, Limb
```{r Braking}



LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb <- lm(formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Group_ID+Limb_ID_Unordered+Mean_BetweenLimbTendonThickness_mm,data = Power_ParticipantMeans_Ankle_2.3Hz)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb,method = 'boot') # significant



LM_Joint_Percent_AveragePower_AbsorptionvsGroupLimb <- lm(formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Group_ID+Limb_ID_Unordered,data = Power_ParticipantMeans_Ankle_2.3Hz)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsGroupLimb)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb,method = 'boot') # significant



LM_Joint_Percent_AveragePower_AbsorptionvsLimb <- lm(formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Limb_ID_Unordered,data = Power_ParticipantMeans_Ankle_2.3Hz)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsLimb)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb,method = 'boot') # significant


#Linear regression for ankle % absorption vs limb ID, ATx limbs only
LM_Joint_Percent_AveragePower_AbsorptionvsATxLimbs <- lm(formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Limb_ID,data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxLimbs)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb,method = 'boot') # significant


#Linear regression for ankle % absorption vs limb ID, Control limbs only
LM_Joint_Percent_AveragePower_AbsorptionvsControlLimbs <- lm(formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Limb_ID,data = Power_ParticipantMeans_ControlAnkle_2.3Hz)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsControlLimbs)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb,method = 'boot') # significant

```



```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb <- hatvalues( LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb <- mean( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb > 2*AverageLeverage_LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb )
#No data points with high leverage based on hat values alone


#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb <- cooks.distance( LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb > 3*mean(CookD_LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb,na.rm = T) )

#Data Point 6 has high leverage

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data = LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb, aes(x = LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb$fitted.values,y = StudResiduals )) +
     geom_point() +
     stat_smooth(method = "lm", se = FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb )

residualPlots(LM_Joint_Percent_AveragePower_AbsorptionvsMorphologyGroupLimb,type = 'rstudent')


```



#### Interlimb Diff vs Morphology
```{r Braking}


LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology <- rlm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm*Group_ID, psi = psi.bisquare,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz)
summary(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant

#Recalculate without ATx24
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx24 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  'ATx24' )

#Recalculate without ATx18
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx18 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  'ATx18' )


LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_GenerationNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx18)
summary(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx18or44 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_GenerationNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx18or44)
summary(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant


#Recalculate without ATx24 and 44
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx24or44 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' )

LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_GenerationNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx24or44)
summary(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant


#Recalculate without ATx08 or ATx24 and without 44
Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx08or24or44 <- Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx08' )

LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_GenerationNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz_NoATx08or24or44)
summary(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology <- hatvalues( LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology <- mean( Leverage_LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology > 2*AverageLeverage_LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology <- cooks.distance( LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology > 3*mean(CookD_LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology,na.rm = T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology > 4/length( LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data = LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology, aes(x = LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology$fitted.values,y = StudResiduals )) +
     geom_point() +
     stat_smooth(method = "lm", se = FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology )

residualPlots(LM_InterlimbDiffAnkle_Percent_AveragePower_AbsorptionvsATxMorphology,type = 'rstudent')


```




### ATx Only

#### % Ankle MEE Absorption

##### vs Morphology
```{r Braking}



LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant


#Recalculate without ATx18
LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method = 'boot') # only intercept i significant


#Recalculate without ATx12 and without 18
LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method = 'boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method = 'boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- hatvalues( LM_Joint_Percent_MEE_AbsorptionvsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- mean( Leverage_LM_Joint_Percent_MEE_AbsorptionvsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Percent_MEE_AbsorptionvsATxMorphology > 2*AverageLeverage_LM_Joint_Percent_MEE_AbsorptionvsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- cooks.distance( LM_Joint_Percent_MEE_AbsorptionvsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_MEE_AbsorptionvsATxMorphology > 3*mean(CookD_LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,na.rm = T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_MEE_AbsorptionvsATxMorphology > 4/length( LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Joint_Percent_MEE_AbsorptionvsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology, aes(x = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$fitted.values,y = StudResiduals )) +
     geom_point() +
     stat_smooth(method = "lm", se = FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Joint_Percent_MEE_AbsorptionvsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Percent_MEE_AbsorptionvsATxMorphology )

residualPlots(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,type = 'rstudent')


```




##### vs Laterality
```{r Braking}



LM_Joint_Percent_MEE_AbsorptionvsLaterality <- lm( formula = log(Mean_Joint_Percent_MEE_Absorption,base = 10)~Group_by_Tendinopathy_Type,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Percent_MEE_AbsorptionvsLaterality)
confint(LM_Joint_Percent_MEE_AbsorptionvsLaterality,method = 'boot') # only intercept is significant


#Recalculate without ATx18
LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method = 'boot') # only intercept i significant


#Recalculate without ATx12 and without 18
LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method = 'boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method = 'boot') # only intercept i significant

```


```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Percent_MEE_AbsorptionvsLaterality <- hatvalues( LM_Joint_Percent_MEE_AbsorptionvsLaterality ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Percent_MEE_AbsorptionvsLaterality <- mean( Leverage_LM_Joint_Percent_MEE_AbsorptionvsLaterality ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Percent_MEE_AbsorptionvsLaterality > 2*AverageLeverage_LM_Joint_Percent_MEE_AbsorptionvsLaterality )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Percent_MEE_AbsorptionvsLaterality <- cooks.distance( LM_Joint_Percent_MEE_AbsorptionvsLaterality ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_MEE_AbsorptionvsLaterality > 3*mean(CookD_LM_Joint_Percent_MEE_AbsorptionvsLaterality,na.rm = T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_MEE_AbsorptionvsLaterality > 4/length( LM_Joint_Percent_MEE_AbsorptionvsLaterality$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Joint_Percent_MEE_AbsorptionvsLaterality ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data = LM_Joint_Percent_MEE_AbsorptionvsLaterality, aes(x = LM_Joint_Percent_MEE_AbsorptionvsLaterality$fitted.values,y = StudResiduals )) +
     geom_point() +
     stat_smooth(method = "lm", se = FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Joint_Percent_MEE_AbsorptionvsLaterality, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Percent_MEE_AbsorptionvsLaterality )

residualPlots(LM_Joint_Percent_MEE_AbsorptionvsLaterality,type = 'rstudent')


```


#### Ankle Absorption Work - Generation Neutralized

##### vs Morphology
```{r Braking}


LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- rlm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant

LM_Joint_Work_AbsorptionvsATxMorphology_BiSquare <- rlm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm, psi = psi.bisquare,data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant




LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx27 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx27' )

LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx27 )
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx27' )

LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27 )
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )


LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27or44 )
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27or44or18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' & Participant_ID !=  'ATx18' )


LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27or44or18 )
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant




#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27or44or18or19 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' )


LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or27or44or18or19 )
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


#Recalculate without ATx18 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or19or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx24
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx24' )

#Recalculate without ATx18
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' )


LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44)
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44)
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx24 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' )

LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44)
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx08 or ATx24 and without 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx08' )

LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44)
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant

```




```{r Check Leverage and Cook's}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- hatvalues( LM_Joint_Work_AbsorptionvsATxMorphology_Huber ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- mean( Leverage_LM_Joint_Work_AbsorptionvsATxMorphology_Huber ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Work_AbsorptionvsATxMorphology_Huber > 2*AverageLeverage_LM_Joint_Work_AbsorptionvsATxMorphology_Huber )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08, 18, 19, 27, 44





#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Work_AbsorptionvsATxMorphology_Huber <- cooks.distance( LM_Joint_Work_AbsorptionvsATxMorphology_Huber ) )


#Any data points with Cook's Distance  >0.5 the mean CookD may have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsATxMorphology_Huber > 0.5 )

#Any data points with Cook's Distance > 1 have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsATxMorphology_Huber > 1 )


#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsATxMorphology_Huber > 3*mean(CookD_LM_Joint_Work_AbsorptionvsATxMorphology_Huber,na.rm = T) )

#Any data points with Cook's Distance of >4/ (n-k-1) the mean CookD have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsATxMorphology_Huber > 4/ ( length( LM_Joint_Work_AbsorptionvsATxMorphology_Huber$fitted.values ) - 1 - 1  ) )

#Data Point 6 has high leverage


plot( CookD_LM_Joint_Work_AbsorptionvsATxMorphology_Huber,type = "b",pch = 18,col = "red")
N = length( LM_Joint_Work_AbsorptionvsATxMorphology_Huber$fitted.values )
k = 1
cutoff = 4 / (N-k-1)
abline(h = cutoff,lty = 2)


```

```{r Check Other Assumptions}
#Check for multicollinearity
# vif( LM_Joint_Work_AbsorptionvsATxMorphology_Huber, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Work_AbsorptionvsATxMorphology_Huber )

residualPlots(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,type = 'rstudent')


```


##### vs Morphology, Hop Height
```{r Braking}


LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight_Huber <- rlm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant

LM_Joint_Work_AbsorptionvsATxMorphology_BiSquare <- rlm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm, psi = psi.bisquare,data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Work_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_Work_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant




LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight_Original <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm+HoppingHeight_cm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight_Original)
confint(LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight_Original,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' )


LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm+HoppingHeight_cm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx44 )
summary(LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight)
confint(LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight,method = 'boot') # only intercept is significant





#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx44or08 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx08')


LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm+HoppingHeight_cm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx44or08 )
summary(LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight)
confint(LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight,method = 'boot') # only intercept is significant



#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx44or08or18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18')


LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight <- lm( formula = Mean_JointWork_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm+HoppingHeight_cm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx44or08or18 )
summary(LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight)
confint(LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight,method = 'boot') # only intercept is significant

```




```{r Check Leverage and Cook's}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight <- hatvalues( LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight <- mean( Leverage_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight > 2*AverageLeverage_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08, 18, 19, 27, 44





#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight <- cooks.distance( LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight ) )


#Any data points with Cook's Distance  >0.5 the mean CookD may have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight > 0.5 )

#Any data points with Cook's Distance > 1 have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight > 1 )


#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight > 3*mean(CookD_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight,na.rm = T) )

#Any data points with Cook's Distance of >4/ (n-k-1) the mean CookD have high leverage
which( CookD_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight > 4/ ( length( LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight$fitted.values ) - 1 - 1  ) )

#Data Point 6 has high leverage


plot( CookD_LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight,type = "b",pch = 18,col = "red")
N = length( LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight$fitted.values )
k = 1
cutoff = 4/ (N-k-1)
abline(h = cutoff,lty = 2)


```

```{r Check Other Assumptions}

#Check for multicollinearity
vif( LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight )

residualPlots(LM_Joint_Work_AbsorptionvsATxMorphologyandHopHeight,type = 'rstudent')


```


#### Ankle Work Rate Absorption - Generation Neutralized

##### vs Morphology
```{r Braking}


LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- rlm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant

LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare <- rlm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm, psi = psi.bisquare,data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


#Recalculate without ATx18 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or19or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx24
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx24' )

#Recalculate without ATx18
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' )


LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx24 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' )

LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx08 or ATx24 and without 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx08' )

LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- hatvalues( LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- mean( Leverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber > 2*AverageLeverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08, 18, 19, 27, 44





#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- cooks.distance( LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber > 3*mean(CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,na.rm = T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber > 4/length( LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber$fitted.values ) )

#Data Point 6 has high leverage








#Check for multicollinearity
# vif( LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber )

residualPlots(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,type = 'rstudent')


```


##### vs Morphology
```{r Braking}


LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- rlm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant

LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare <- rlm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm, psi = psi.bisquare,data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


#Recalculate without ATx18 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or19or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx24
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx24' )

#Recalculate without ATx18
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' )


LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx24 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' )

LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx08 or ATx24 and without 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx08' )

LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant

```




#### %Ankle Power Absorption - Generation Neutralized


##### vs Morphology
```{r Braking}


Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_HoppingHeight_cm <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_HoppingHeight_m*100

LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant

#Recalculate without ATx24
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx24' )

#Recalculate without ATx18
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' )


LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant

#Recalculate without ATx18, 27, 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44'& Participant_ID !=  'ATx27' )

LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or27or44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant







#Recalculate without ATx24 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' )

LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant


#Recalculate without ATx08 or ATx24 and without 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx08' )

LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- hatvalues( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- mean( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology > 2*AverageLeverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- cooks.distance( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology > 3*mean(CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,na.rm = T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology > 4/length( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data = LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology, aes(x = LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology$fitted.values,y = StudResiduals )) +
     geom_point() +
     stat_smooth(method = "lm", se = FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology )

residualPlots(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,type = 'rstudent')


```

##### vs Morphology + Hop Height
```{r Braking}


Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_HoppingHeight_cm <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_HoppingHeight_m*100

LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm+Mean_HoppingHeight_cm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant

#Recalculate without ATx24
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx24' )

#Recalculate without ATx18
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' )


LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant


#Recalculate without ATx24 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' )

LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant


#Recalculate without ATx08 or ATx24 and without 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx08' )

LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- hatvalues( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- mean( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology > 2*AverageLeverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology <- cooks.distance( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology > 3*mean(CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,na.rm = T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology > 4/length( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data = LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology, aes(x = LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology$fitted.values,y = StudResiduals )) +
     geom_point() +
     stat_smooth(method = "lm", se = FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology )

residualPlots(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology,type = 'rstudent')


```




##### vs Morphology  - Between Limb Diff
```{r Braking}

Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_HoppingHeight_cm <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz$Mean_HoppingHeight_m*100

LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff <- lm( formula = (Mean_JointContribution_AveragePower_AbsorptionNeutralized/100)~Mean_BetweenLimbTendonThickness_mm+Mean_HoppingHeight_cm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant

#Recalculate without ATx24
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx24 <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  'ATx24' )

#Recalculate without ATx18
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx18 <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  'ATx18' )

#Recalculate without ATx18 and ATx44
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx18and44 <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx18 %>% filter( Participant_ID !=  'ATx44' )

#Recalculate linear regression without ATx18
LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx18)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff,method = 'boot') # neither intercept nor slope are significant

#Recalculate linear regression without ATx18 and 44
LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx18and44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff,method = 'boot') # neither intercept nor slope are significant


#Recalculate without ATx18 and 44
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx18or44 <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx18or44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant


#Recalculate without ATx24 and 44
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx24or44 <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' )

LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx24or44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant


#Recalculate without ATx08 or ATx24 and without 44
Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx08or24or44 <- Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx08' )

LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff <- lm( formula = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz_NoATx08or24or44)
summary(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff)
confint(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff,method = 'boot') # only intercept is significant

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff <- hatvalues( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff <- mean( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff > 2*AverageLeverage_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff <- cooks.distance( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff > 3*mean(CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff,na.rm = T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff > 4/length( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data = LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff, aes(x = LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff$fitted.values,y = StudResiduals )) +
     geom_point() +
     stat_smooth(method = "lm", se = FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff )

residualPlots(LM_Joint_Percent_AveragePower_AbsorptionvsATxMorphology_BetweenLimbDiff,type = 'rstudent')


```



### ATx vs Control

#### 
```{r}


LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method = 'boot') # only intercept is significant

```


#Robust LR

### Ankle Work Rate Absorption - Generation Neutralized

#### vs Morphology
```{r Braking}

Power_ParticipantMeans_ATxInvolvedLimb_2.3Hz$Participant_ID[ which( Power_ParticipantMeans_ATxInvolvedLimb_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized[ which( Power_ParticipantMeans_ATxInvolvedLimb_2.3Hz$Joint_ID == 'Ankle' ) ] < Power_ParticipantMeans_ATxInvolvedLimb_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized[ which( Power_ParticipantMeans_ATxInvolvedLimb_2.3Hz$Joint_ID == 'Knee' ) ] ) ]


##Remove all participants with non-zero VAS during hopping
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_VASBelow2_AnkleLessThanKnee <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% 
   filter( Mean_VAS_Rating < 2, Participant_ID !=  'ATx24' & Participant_ID !=  'ATx27'  )


LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- rlm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_VASBelow2_AnkleLessThanKnee)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


#Recalculate without ATx18 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or19or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx24
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx24' )

#Recalculate without ATx18
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' )


LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx24 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' )

LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant


#Recalculate without ATx08 or ATx24 and without 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx08' )

LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,method = 'boot') # only intercept is significant

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- hatvalues( LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- mean( Leverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber > 2*AverageLeverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08, 18, 19, 27, 44





#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber <- cooks.distance( LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber > 3*mean(CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,na.rm = T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber > 4/length( LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber$fitted.values ) )

#Data Point 6 has high leverage








#Check for multicollinearity
# vif( LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber )

residualPlots(LM_Joint_AveragePower_AbsorptionvsATxMorphology_Huber,type = 'rstudent')


```

###### BiSquare

```{r Braking}


LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare <- rlm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_VASBelow2_AnkleLessThanKnee, psi = psi.bisquare)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


#Recalculate without ATx18 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or19or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx18 and 19 and 27 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx08' & Participant_ID !=  'ATx18' & Participant_ID !=  'ATx19' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx27' & Participant_ID !=  'ATx44' )



#Recalculate without ATx24
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx24' )

#Recalculate without ATx18
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' )


LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or18or19or24or27or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare,method = 'boot') # only intercept is significant


#Recalculate without ATx18 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx18' & Participant_ID !=  'ATx44' )


LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare,method = 'boot') # only intercept is significant


#Recalculate without ATx24 and 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' )

LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx24or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare,method = 'boot') # only intercept is significant


#Recalculate without ATx08 or ATx24 and without 44
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44 <- Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID !=  'ATx44' & Participant_ID !=  'ATx24' & Participant_ID !=  'ATx08' )

LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare <- lm( formula = Mean_JointAveragePower_Braking_GenerationNeutralized~Mean_BetweenLimbTendonThickness_mm,
                                                      data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08or24or44)
summary(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare)
confint(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare,method = 'boot') # only intercept is significant

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare <- hatvalues( LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare <- mean( Leverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare > 2*AverageLeverage_LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08, 18, 19, 27, 44





#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare <- cooks.distance( LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare > 3*mean(CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare,na.rm = T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare > 4/length( LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare$fitted.values ) )

#Data Point 6 has high leverage








#Check for multicollinearity
# vif( LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare,color.palette = xy)
abline(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare, col = "blue")

residualPlots(LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare,type = 'rstudent')


( ggplot( data  = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz, aes(y = Mean_JointAveragePower_Braking_GenerationNeutralized, x = Mean_BetweenLimbTendonThickness_mm ), ) +
   
   geom_point( aes(color = LM_Joint_AveragePower_AbsorptionvsATxMorphology_BiSquare$w) ) + 
      
  geom_smooth(method = "rlm", colour = "blue", se = FALSE) +
      
  geom_smooth(method = "lm", colour = "red", se = FALSE)
)
      
      

```

#Mixed Effects Models

## % Ankle MEE Absorption vs Group
```{r Braking}

LM_Joint_Percent_MEE_AbsorptionvsGroup <- lm(formula = Joint_Percent_MEE_Absorption~Group_by_Morphology,data = Power_ParticipantMeans_3Limbs_Ankle_2.3Hz)
summary(LM_Joint_Percent_MEE_AbsorptionvsGroup)
confint(LM_Joint_Percent_MEE_AbsorptionvsGroup,method = 'boot') # significant


MME_Joint_Percent_MEE_AbsorptionvsGroup_forICC <- lme(fixed = Joint_Percent_MEE_Absorption~1,data = Power_ParticipantMeans_3Limbs_Ankle_2.3Hz,random = ~1|Participant_ID)


summary(MME_Joint_Percent_MEE_AbsorptionvsGroup_forICC)
(Joint_Percent_MEE_AbsorptionvsGroup_VarExplained = (8.630181^2) / ( (8.630181^2) + (3.823851^2) ) )
#ICC = 0.84 - significant clustering

MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly <- lme(fixed = Joint_Percent_MEE_Absorption~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_by_Morphology,data = Power_ParticipantMeans_3Limbs_Ankle_2.3Hz,random =  ~1|Participant_ID,method = 'REML')


MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomSlopeOnly <- lme(fixed = Joint_Percent_MEE_Absorption~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_by_Morphology,data = Power_ParticipantMeans_3Limbs_Ankle_2.3Hz,random =  ~TSContributiontoPFActivity_PropulsionPhase_Centered-1|Participant_ID,method = 'REML')


MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffects <- lme(fixed = Joint_Percent_MEE_Absorption~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_by_Morphology,data = Power_ParticipantMeans_3Limbs_Ankle_2.3Hz,random =  ~TSContributiontoPFActivity_PropulsionPhase_Centered|Participant_ID,method = 'REML')


summary(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly)#significant
intervals(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly)
summary(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomSlopeOnly)#significant
intervals(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomSlopeOnly)
summary(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffects)
intervals(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffects)#significant, but positive-definite covariance may not be necessary


MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffectsDiagonalCovar <- lme(fixed = Joint_Percent_MEE_Absorption~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_by_Morphology,data = Power_ParticipantMeans_3Limbs_Ankle_2.3Hz,random =  list(Participant_ID = pdDiag(~TSContributiontoPFActivity_PropulsionPhase_Centered)),method = 'REML')
summary(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffectsDiagonalCovar) #significant
intervals(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffectsDiagonalCovar)

logLik(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly)*-2
logLik(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomSlopeOnly)*-2
logLik(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffects)*-2
logLik(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffectsDiagonalCovar)*-2


### No diff between Both Effects and Both Effects with Diagonal Covar Matrix - Diagonal Matrix for effect of time on Gastroc Hz is best model. Intercept is 64.9 (62.1, 67.7); p = 0, slope is -0.3 (-0.5, -0.2); p = 0.  


anova(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly,LM_Joint_Percent_MEE_AbsorptionvsGroup)
##MME improves up on LM



plot(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly,Joint_Percent_MEE_Absorption~TSContributiontoPFActivity_PropulsionPhase_Centered,abline = c(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly$coefficients$fixed[1],MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly$coefficients$fixed[2]) )


plot( MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly, Participant_ID~resid(.,type = 'p'))

plot( MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly, resid(.,type = 'p')~fitted(.),abline = 0  )

qqnorm(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly,abline = c(0,1))

```


# Robust Mixed Effects Models

### Hop Height vs

#### Limb
```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_HopHeightvsLimb_2.3Hz <- rlmer( HoppingHeight_cm~Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz )

#Check results structure
summary( RMME_HopHeightvsLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_HopHeightvsLimb_Braking_forICC <- rlmer(HoppingHeight_cm~1|Participant_ID,data = Power_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_HopHeightvsLimb_Braking_forICC) )

#ICC = within-subject / (within-subject+residual)
(HopHeightvsLimb_Braking_VarExplained = (0.3472) / ( (0.3472) + (0.1544) ) )
#ICC = 0.69 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( HoppingHeight_cm~Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( 0.3353 + sum(X$coefficients[,2]^2)  + 0.1471 )
#R2 = 0.15

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.3353 + sum(X$coefficients[,2]^2)  ) / ( 0.3353 + sum(X$coefficients[,2]^2)  + 0.1471 )
#R2 = 0.74



#Calculate Mean Squared Error for RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly
( MSE_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.18



##Only use random intercept. Doesn't make sense to have random slope for effect of group
( X <- summary( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb


( HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1,1], X$coefficients[2:4,1] + X$coefficients[1,1] ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1,1] - (2*X$coefficients[1,2]), X$coefficients[1,1] + X$coefficients[2:4,1] - (2*X$coefficients[2:4,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1,1] + (2*X$coefficients[1,2]), X$coefficients[1,1] + X$coefficients[2:4,1] + (2*X$coefficients[2:4,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )
#Height for Non-Involved limb is 0.46 mm > Non-Involved


#Round the data to only have 3 digits
HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI[,1:3] <- round( HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI[,1:3], digits = 3 )



#Create labels for adding text to plots
HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$Label = cbind( c( paste0( 'Mean = ', round( HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI )

write.csv( HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI, 'HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI.csv' )

#Create labels for adding text to plots
HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$Label = cbind( c( NA, paste0( 'Diff = ', HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$Estimate[ -1 ], ' cm ', '(95% CI:', HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )



```




```{r Create Data Frames with Averages from RMME }

HopHeightAverages_FromRMME <- data.frame( Mean_HoppingHeight_cm = c( fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 1 ], fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 1 ] + fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 2 ], fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 1 ] + fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 3 ], fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 1 ] + fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 4 ] ), Limb_ID = factor( c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'  ) ), Group_ID = c('ATx', 'ATx', 'Control', 'Control') )


HopHeightParticipantAverages_FromRMME <- data.frame( Participant_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ) , Mean_HoppingHeight_cm = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ) )

UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )

RowtoFill <- 1


for (k in 1:length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID == UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   
   for (l in 1:length(UniqueLimb) ) {
      
   
      #Add Participant K's Participant ID
      HopHeightParticipantAverages_FromRMME$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      HopHeightParticipantAverages_FromRMME$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           HopHeightParticipantAverages_FromRMME$Mean_HoppingHeight_cm[ RowtoFill ] <- fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 1 ] + ranef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )$Participant_ID[ k, 1 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           HopHeightParticipantAverages_FromRMME$Mean_HoppingHeight_cm[ RowtoFill ] <- fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 1 ] + fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 2 ] + ranef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )$Participant_ID[ k, 1 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( HopHeightParticipantAverages_FromRMME$Mean_HoppingHeight_cm[ RowtoFill ] <- fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 1 ] + fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 3 ] + ranef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )$Participant_ID[ k, 1 ] )
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           HopHeightParticipantAverages_FromRMME$Mean_HoppingHeight_cm[ RowtoFill ] <- fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 1 ] + fixef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )[ 4 ] + ranef( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly )$Participant_ID[ k, 1 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill + 1
      
   }#End L for loop
   
}#End K for loop


View(HopHeightAverages_FromRMME)

```



### Ankle Absorption Work

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz <- rlmer( JointWork_Braking_GenerationNeutralized~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz )


#Check results structure
summary( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionWorkvsTendonMorphology_Braking_forICC <- rlmer(JointWork_Braking_GenerationNeutralized~1|Participant_ID,data = Power_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_AnkleAbsorptionWorkvsTendonMorphology_Braking_forICC) )

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionWorkvsTendonMorphology_Braking_VarExplained = (0.025091) / ( (0.004205) + (0.025091) ) )
#ICC = 0.86 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( JointWork_Braking_GenerationNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( 0.021909 + sum(X$coefficients[,2]^2)  + 0.003959 )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.021909 + sum(X$coefficients[,2]^2)  ) / ( 0.021909 + sum(X$coefficients[,2]^2)  + 0.003959 )
#R2 = 0.87



#Calculate Mean Squared Error for RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( MSE_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.004396






##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer(JointWork_Braking_GenerationNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( 0.018984 + sum(X$coefficients[,2]^2)  + 0.009756 )
#R2 = 0.1550

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.018984 + sum(X$coefficients[,2]^2)  ) / ( 0.018984 + sum(X$coefficients[,2]^2)  + 0.009756 )
#R2 = 0.7132


#Calculate Mean Squared Error for RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( MSE_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.010







#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer(JointWork_Braking_GenerationNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( 0.0188450 + 0.0008726 + sum(X$coefficients[,2]^2)  + 0.0037115 )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.0188450 + 0.0008726 + sum(X$coefficients[,2]^2)  ) / ( 0.0188450 + 0.0008726 + sum(X$coefficients[,2]^2)  + 0.0037115 )
#R2 = 0.87



#Calculate Mean Squared Error for RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( MSE_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.004199


##Both effects is best model.
( X <- summary( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

#Create a data frame to hold the coefficient estimates and confidence intervals. XMin, XMax, YPosition is for adding significance bars to plot
( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )
#Height for Non-Involved limb is 0.46 mm > Non-Involved


#Round the data to only have 3 digits
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ) )


AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop


View( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates )

```


### Ankle Generation Work

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz <- rlmer( JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz )


#Check results structure
summary( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionWorkvsTendonMorphology_Braking_forICC <- rlmer(JointWork_Propulsion_AbsorptionNeutralized~1|Participant_ID,data = Power_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_AnkleAbsorptionWorkvsTendonMorphology_Braking_forICC) )

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionWorkvsTendonMorphology_Braking_VarExplained = (0.025091) / ( (0.004205) + (0.025091) ) )
#ICC = 0.86 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( 0.021909 + sum(X$coefficients[,2]^2)  + 0.003959 )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.021909 + sum(X$coefficients[,2]^2)  ) / ( 0.021909 + sum(X$coefficients[,2]^2)  + 0.003959 )
#R2 = 0.87



#Calculate Mean Squared Error for RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( MSE_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.004396






##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer(JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( 0.018984 + sum(X$coefficients[,2]^2)  + 0.009756 )
#R2 = 0.1550

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.018984 + sum(X$coefficients[,2]^2)  ) / ( 0.018984 + sum(X$coefficients[,2]^2)  + 0.009756 )
#R2 = 0.7132


#Calculate Mean Squared Error for RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( MSE_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.010







#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer(JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( 0.0188450 + 0.0008726 + sum(X$coefficients[,2]^2)  + 0.0037115 )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.0188450 + 0.0008726 + sum(X$coefficients[,2]^2)  ) / ( 0.0188450 + 0.0008726 + sum(X$coefficients[,2]^2)  + 0.0037115 )
#R2 = 0.87



#Calculate Mean Squared Error for RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( MSE_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.004199


##Both effects is best model.
( X <- summary( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

#Create a data frame to hold the coefficient estimates and confidence intervals. XMin, XMax, YPosition is for adding significance bars to plot
( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )
#Height for Non-Involved limb is 0.46 mm > Non-Involved


#Round the data to only have 3 digits
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ) )


AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop


View( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates )

```


### Knee Absorption Work

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


Power_Knee_2.3Hz$HoppingHeight_cm_LimbMeanCentered <- Power_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered


#Perform normal robust mixed effects model, to check the results structure
RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz <- rlmer( JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Knee_2.3Hz )


#Check results structure
summary( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_KneeAbsorptionWorkvsTendonMorphology_Braking_forICC <- rlmer(JointWork_Braking_GenerationNeutralized~1|Participant_ID,data = Power_Knee_2.3Hz)


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_KneeAbsorptionWorkvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(KneeAbsorptionWorkvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.68- significant clustering. Appropriate to use mixed effects






##Create mixed effects model for random intercept only.
RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( JointWork_Braking_GenerationNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Knee_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.87



#Calculate Mean Squared Error for RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( MSE_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.004396






##Create mixed effects model for random slope only.
RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer(JointWork_Braking_GenerationNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Knee_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.87


#Calculate Mean Squared Error for RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( MSE_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.010







#Create robust mixed effects model with both random slope and random intercept
RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer(JointWork_Braking_GenerationNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Knee_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 3 ] )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 3 ] )
#R2 = 0.87







#Calculate Mean Squared Error for RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( MSE_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.004199


##Both effects is best model.
( X <- summary( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )
#Height for Non-Involved limb is 0.46 mm > Non-Involved


#Round the data to only have 3 digits
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots. Label = Mean or Effect, 95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Knee_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Knee_2.3Hz$Participant_ID ) ) ) )


KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Knee_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Knee_2.3Hz
   Power_Knee_2.3Hz_ParticipantKOnly <- Power_Knee_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Knee_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Knee_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop


View( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates )


```


### Knee Generation Work

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


Power_Knee_2.3Hz$HoppingHeight_cm_LimbMeanCentered <- Power_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered


#Perform normal robust mixed effects model, to check the results structure
RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz <- rlmer( JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Knee_2.3Hz )


#Check results structure
summary( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_KneeAbsorptionWorkvsTendonMorphology_Braking_forICC <- rlmer(JointWork_Propulsion_AbsorptionNeutralized~1|Participant_ID,data = Power_Knee_2.3Hz)


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_KneeAbsorptionWorkvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(KneeAbsorptionWorkvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.68- significant clustering. Appropriate to use mixed effects






##Create mixed effects model for random intercept only.
RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Knee_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.87



#Calculate Mean Squared Error for RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( MSE_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.004396






##Create mixed effects model for random slope only.
RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer(JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Knee_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.87


#Calculate Mean Squared Error for RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( MSE_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.010







#Create robust mixed effects model with both random slope and random intercept
RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer(JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Knee_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 3 ] )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 3 ] )
#R2 = 0.87







#Calculate Mean Squared Error for RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( MSE_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.004199


##Both effects is best model.
( X <- summary( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )
#Height for Non-Involved limb is 0.46 mm > Non-Involved


#Round the data to only have 3 digits
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots. Label = Mean or Effect, 95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Knee_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Knee_2.3Hz$Participant_ID ) ) ) )


KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Knee_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Knee_2.3Hz
   Power_Knee_2.3Hz_ParticipantKOnly <- Power_Knee_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Knee_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Knee_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop


View( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates )


```



### Hip Absorption Work

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


Power_Hip_2.3Hz$HoppingHeight_cm_LimbMeanCentered <- Power_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered


#Perform normal robust mixed effects model, to check the results structure
RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz <- rlmer( JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Hip_2.3Hz )


#Check results structure
summary( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_HipAbsorptionWorkvsTendonMorphology_Braking_forICC <- rlmer(JointWork_Braking_GenerationNeutralized~1|Participant_ID,data = Power_Hip_2.3Hz)


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_HipAbsorptionWorkvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(HipAbsorptionWorkvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.72- significant clustering. Appropriate to use mixed effects






##Create mixed effects model for random intercept only.
RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( JointWork_Braking_GenerationNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Hip_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.17

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.78



#Calculate Mean Squared Error for RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( MSE_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.00209






##Create mixed effects model for random slope only.
RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer(JointWork_Braking_GenerationNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Hip_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.17

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.78


#Calculate Mean Squared Error for RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( MSE_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.0035







#Create robust mixed effects model with both random slope and random intercept
RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer(JointWork_Braking_GenerationNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Hip_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 3 ] )
#R2 = 0.2

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 3 ] )
#R2 = 0.92







#Calculate Mean Squared Error for RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( MSE_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.0018


##Both effects is best model.
( X <- summary( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )
#Height for Non-Involved limb is 0.46 mm > Non-Involved


#Round the data to only have 3 digits
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots. Label = Mean or Effect, 95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Hip_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Hip_2.3Hz$Participant_ID ) ) ) )


HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Hip_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Hip_2.3Hz
   Power_Hip_2.3Hz_ParticipantKOnly <- Power_Hip_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Hip_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Hip_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop


View( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates )


```



### Hip Generation Work

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


Power_Hip_2.3Hz$HoppingHeight_cm_LimbMeanCentered <- Power_Ankle_2.3Hz$HoppingHeight_cm_LimbMeanCentered


#Perform normal robust mixed effects model, to check the results structure
RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz <- rlmer( JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Hip_2.3Hz )


#Check results structure
summary( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_HipAbsorptionWorkvsTendonMorphology_Braking_forICC <- rlmer(JointWork_Propulsion_AbsorptionNeutralized~1|Participant_ID,data = Power_Hip_2.3Hz)


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_HipAbsorptionWorkvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(HipAbsorptionWorkvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.72- significant clustering. Appropriate to use mixed effects






##Create mixed effects model for random intercept only.
RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Hip_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.17

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.78



#Calculate Mean Squared Error for RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( MSE_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.00209






##Create mixed effects model for random slope only.
RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer(JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Hip_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.17

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.78


#Calculate Mean Squared Error for RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( MSE_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.0035







#Create robust mixed effects model with both random slope and random intercept
RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer(JointWork_Propulsion_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Hip_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects),comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 3 ] )
#R2 = 0.2

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 3 ] )
#R2 = 0.92







#Calculate Mean Squared Error for RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( MSE_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.0018


##Both effects is best model.
( X <- summary( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )
#Height for Non-Involved limb is 0.46 mm > Non-Involved


#Round the data to only have 3 digits
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots. Label = Mean or Effect, 95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Hip_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Hip_2.3Hz$Participant_ID ) ) ) )


HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Hip_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Hip_2.3Hz
   Power_Hip_2.3Hz_ParticipantKOnly <- Power_Hip_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Hip_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Hip_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop


View( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates )


```


### Ankle Absorption Work Rate vs...

#### Tendon Morphology
```{r Create new data frame}

#Create a new data frame to contain Group_ID, Participant_ID, Group_by_Morphology, Mean_JointContribution_AveragePower_AbsorptionNeutralized, Mean_SegmentAverageEnergy_Braking. This will contain one data point for each hop, rather than participant means
AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_1LimbPer3Groups_Ankle_2.3Hz$Group_ID, 
                                                                                       
                                                                                        Participant_ID = Power_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,
                                                                                    
BetweenLimbTendonThickness_mm <- Power_1LimbPer3Groups_Ankle_2.3Hz$BetweenLimbTendonThickness_mm,                                                                                  
                                                                                        AnkleWorkRate_Propulsion_AbsorptionNeutralized = Power_1LimbPer3Groups_Ankle_2.3Hz$JointAveragePower_Propulsion_AbsorptionNeutralized,
                                                                                        AnkleWorkRate_Braking_AbsorptionNeutralized = Power_1LimbPer3Groups_Ankle_2.3Hz$JointAveragePower_Propulsion_AbsorptionNeutralized )
#Multiply shank power transfer by -1 to equal to the power transfer for the thigh.


```



```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionWorkRatevsTendonMorphology_2.3Hz_1LimbPer3Groups <- rlmer( AnkleWorkRate_Braking_GenerationNeutralized~BetweenLimbTendonThickness_mm*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups )


##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_forICC <- rlmer(AnkleWorkRate_Braking_GenerationNeutralized~1|Participant_ID,data = AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance for random slope and residuals 
summary(RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionWorkRatevsTendonMorphology_Braking_VarExplained = (1.0841) / ( (1.0841) + (0.1201) ) )
#ICC = 0.90 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomInterceptOnly <- rlmer( AnkleWorkRate_Braking_GenerationNeutralized~BetweenLimbTendonThickness_mm*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1) / (n-#ofpredictors-1) ]. 1 predictor
( AdjustR2_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RIOnly <- (1 - ( var(residuals(RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomInterceptOnly,type = 'response' )) / (var(getME(RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomInterceptOnly,'y')))*( (dim(AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)[1] - 1) / (dim(AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)[1] - 1-1)) ) ) )
##Adjusted R2 = 0.9

#Calculate R2 for mixed effects model. Numerator = variance for all fixed effects, denominator = variance for all fixed and random effects and residual
( 0.5604^2 + 0.2914^2 + 2.7969^2 + 4.9935^2 ) / ( 1.2034 + 0.5604^2 + 0.2914^2 + 2.7969^2 + 4.9935^2 + 0.1201 ) 
#R2 = 0.96

#Calculate R2 for mixed effects model. Numerator = variance for all fixed effects and random effects, denominator = variance for all fixed and random effects and residual
( 1.2034 + 0.5604^2 + 0.2914^2 + 2.7969^2 + 4.9935^2 ) / ( 1.2034 + 0.5604^2 + 0.2914^2 + 2.7969^2 + 4.9935^2 + 0.1201 ) 
#R2 = 0.996

#Calculate Mean Squared Error for RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomInterceptOnly
( MSE_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.14


##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomSlopeOnly <- rlmer(AnkleWorkRate_Braking_GenerationNeutralized~BetweenLimbTendonThickness_mm*Group_ID+(BetweenLimbTendonThickness_mm-1|Participant_ID), data = AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1) / (n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RSOnly <- (1 - ( ( var(residuals(RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomSlopeOnly,type = 'response' )) / var(getME(RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomSlopeOnly,'y')) )*((dim(AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)[1] - 1) / (dim(AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)[1] - 1-1)) ) ) )
#Adjusted R2 = 0.68

#Calculate R2 for mixed effects model. Numerator = variance for all fixed effects, denominator = variance for all fixed and random effects and residual
( 0.4826^2 + 0.4844^2 + 1.1763^2 + 2.0945^2 ) / ( 1.2270 + 0.4826^2 + 0.4844^2 + 1.1763^2 + 2.0945^2 + 0.1203 ) 
#R2 = 0.82

#Calculate R2 for mixed effects model. Numerator = variance for all fixed effects and random effects, denominator = variance for all fixed and random effects and residual
( 1.2270 + 0.4826^2 + 0.4844^2 + 1.1763^2 + 2.0945^2 ) / ( 1.2270 + 0.4826^2 + 0.4844^2 + 1.1763^2 + 2.0945^2 + 0.1203) 
#R2 = 0.98

#Calculate Mean Squared Error for RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomSlopeOnly
( MSE_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.14




#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_BothEffects <- rlmer(AnkleWorkRate_Braking_GenerationNeutralized~BetweenLimbTendonThickness_mm*Group_ID+(BetweenLimbTendonThickness_mm|Participant_ID), data = AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1) / (n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_BothEffects <- (1 - ( ( var(residuals(RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_BothEffects,type = 'response' )) / var(getME(RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_BothEffects,'y')) )*((dim(AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)[1] - 1) / (dim(AnkleWorkRatevsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)[1] - 1-1)) ) ) )
#Adjusted R2 = 0.8

#Calculate R2 for mixed effects model. Numerator = variance for all fixed effects, denominator = variance for all fixed and random effects and residual
( 0.5701^2 + 0.3555^2 + 2.3486^2 + 4.1781^2 ) / ( 0.66485 + 0.07079 + 0.5701^2 + 0.3555^2 + 2.3486^2 + 4.1781^2 + 0.12012 ) 
#R2 = 0.96

#Calculate R2 for mixed effects model. Numerator = variance for all fixed effects and random effects, denominator = variance for all fixed and random effects and residual
( 0.66485 + 0.07079 + 0.5701^2 + 0.3555^2 + 2.3486^2 + 4.1781^2 ) / ( 0.66485 + 0.07079 + 0.5701^2 + 0.3555^2 + 2.3486^2 + 4.1781^2 + 0.12012 ) 
#R2 = 0.99

#Calculate Mean Squared Error for RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_BothEffects
( MSE_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.14


##Both effects is best model.
summary( RMME_AnkleAbsorptionWorkRatevsTendonMorphology_Braking_BothEffects )

```



### Ankle Contribution vs...


#### Tendon Morphology, ATx Only

```{r Create new data frame}

#Create a new data frame to contain Group_ID, Participant_ID, Group_by_Morphology, Mean_JointContribution_AveragePower_AbsorptionNeutralized, Mean_SegmentAverageEnergy_Braking. This will contain one data point for each hop, rather than participant means
AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly <- data.frame( Group_ID = Power_1LimbPer3Groups_Ankle_2.3Hz$Group_ID, 
                                                                                        Group_by_Morphology = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly$Group_by_Morphology_NotFactored, 
                                                                                        Participant_ID = Power_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,
                                                                                        
        BetweenLimbTendonThickness_mm = Power_1LimbPer3Groups_Ankle_2.3Hz$BetweenLimbTendonThickness_mm,
        
        VAS_Rating = Power_1LimbPer3Groups_Ankle_2.3Hz$VAS_Rating,
        
        AnkleContribution_AveragePower_GenerationNeutralized = Power_1LimbPer3Groups_Ankle_2.3Hz$JointContribution_AveragePower_GenerationNeutralized/100,
                                                                                        AnkleContribution_AveragePower_AbsorptionNeutralized = Power_1LimbPer3Groups_Ankle_2.3Hz$JointContribution_AveragePower_AbsorptionNeutralized/100,
                                                                                        FootAverageEnergy_Braking = EnergyFlow_ProximalFootOnly_1LimbPer3Groups_2.3Hz$SegmentAverageEnergy_Braking,
                                                                                        ThighAverageEnergy_Braking = EnergyFlow_ProximalThighOnly_1LimbPer3Groups_2.3Hz$SegmentAverageEnergy_Braking,
                                                                                        ThighAverageEnergyTransfer_Braking = EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Braking*(-1),
                                                                                        ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer = EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Braking,
        
        HoppingHeight_cm = Power_1LimbPer3Groups_Ankle_2.3Hz$HoppingHeight_m*100)
#Multiply shank power transfer by -1 to equal to the power transfer for the thigh.




#Remove morphology for all Control participants!!
AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm_NoHCMorphology <- AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm

AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm_NoHCMorphology[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm ==  0.55 ) ] <- NA



#Initialize variable to hold group-mean centered interlimb difference in tendon thickness
AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm_NoHCMorphology_GroupMeanCentered <- AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm_NoHCMorphology

#Subtract ATx group mean from all ATx interlimb diff in tendon thickness values
AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm_NoHCMorphology_GroupMeanCentered[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$Group_ID ==  'ATx' ) ] <- AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm_NoHCMorphology[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$Group_ID ==  'ATx' ) ] - mean( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm_NoHCMorphology[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$Group_ID ==  'ATx' ) ], na.rm = T )

#Subtract Control group mean from all Control interlimb diff in tendon thickness values
AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm_NoHCMorphology_GroupMeanCentered[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$Group_ID ==  'Control' ) ] <- AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm_NoHCMorphology[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$Group_ID ==  'Control' ) ] - mean( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$BetweenLimbTendonThickness_mm_NoHCMorphology[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly$Group_ID ==  'Control' ) ], na.rm = T )




```



```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionContributionvsTendonMorphology_2.3Hz_1LimbPer3Groups <- rlmer( JointContribution_AveragePower_GenerationNeutralized~BetweenLimbTendonThickness_mm*Group_by_Morphology+(1|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly )


##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC <- rlmer(AnkleContribution_AveragePower_GenerationNeutralized~1|Participant_ID,data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly)


#Use summary to find variance for random slope and residuals 
summary(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionContributionvsTendonMorphology_Braking_VarExplained = (250.74) / ( (250.74) + (22.62) ) )
#ICC = 0.92 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomInterceptOnly <- rlmer( AnkleContribution_AveragePower_GenerationNeutralized~Group_ID*BetweenLimbTendonThickness_mm_NoHCMorphology+VAS_Rating+(1|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly)



#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomInterceptOnly )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( 8.7026^2 + 42.0762^2 + 4.3579^2 + 2.4810^2 + 75.1303^2 ) / ( 269.24 + 8.7026^2 + 42.0762^2 + 4.3579^2 + 2.4810^2 + 75.1303^2 + 24.36 )
#R2 = 0.96
#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 269.24 + 8.7026^2 + 42.0762^2 + 4.3579^2 + 2.4810^2 + 75.1303^2 ) / ( 269.24 + 8.7026^2 + 42.0762^2 + 4.3579^2 + 2.4810^2 + 75.1303^2 + 24.36 )
#R2 = 0.99



#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomInterceptOnly
( MSE_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 25.33


##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomSlopeOnly <- rlmer(AnkleContribution_AveragePower_GenerationNeutralized~Group_ID*BetweenLimbTendonThickness_mm_NoHCMorphology+VAS_Rating+(BetweenLimbTendonThickness_mm_NoHCMorphology-1|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly)


#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomSlopeOnly )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects
( 5.1617^2 + 11.8879^2 + 4.7136^2 + 1.0517^2 + 22.9366^2 ) / ( 110.96 + 5.1617^2 + 11.8879^2 + 4.7136^2 + 1.0517^2 + 22.9366^2 + 24.37 )
#R2 = 0.84

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects
( 110.96 + 5.1617^2 + 11.8879^2 + 4.7136^2 + 1.0517^2 + 22.9366^2 ) / ( 110.96 + 5.1617^2 + 11.8879^2 + 4.7136^2 + 1.0517^2 + 22.9366^2 + 24.37 )
#R2 = 0.97

#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomSlopeOnly
( MSE_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 25.33




#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects <- rlmer(AnkleContribution_AveragePower_GenerationNeutralized~Group_ID*BetweenLimbTendonThickness_mm_NoHCMorphology+VAS_Rating+(BetweenLimbTendonThickness_mm_NoHCMorphology|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_ATxInvolvedOnly)


#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects
( 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 ) / ( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 + 24.36 )
#R2 = 0.96

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects
( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 ) / ( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 + 24.36 )
#R2 = 0.99

#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects
( MSE_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 23.29


##Both effects is best model.
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects )

```




#### Tendon Morphology, VAS
```{r Create new data frame}

#Create a new data frame to contain Group_ID, Participant_ID, Group_by_Morphology, Mean_JointContribution_AveragePower_AbsorptionNeutralized, Mean_SegmentAverageEnergy_Braking. This will contain one data point for each hop, rather than participant means
AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_1LimbPer3Groups_Ankle_2.3Hz$Group_ID, 
                                                                                        Group_by_Morphology = EnergyFlow_ProximalFootOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                                        Participant_ID = Power_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,
                                                                                        
        BetweenLimbTendonThickness_mm = Power_1LimbPer3Groups_Ankle_2.3Hz$BetweenLimbTendonThickness_mm,
        
        VAS_Rating = Power_1LimbPer3Groups_Ankle_2.3Hz$VAS_Rating,
        
        AnkleContribution_AveragePower_GenerationNeutralized = Power_1LimbPer3Groups_Ankle_2.3Hz$JointContribution_AveragePower_GenerationNeutralized/100,
                                                                                        AnkleContribution_AveragePower_AbsorptionNeutralized = Power_1LimbPer3Groups_Ankle_2.3Hz$JointContribution_AveragePower_AbsorptionNeutralized/100,
                                                                                        FootAverageEnergy_Braking = EnergyFlow_ProximalFootOnly_1LimbPer3Groups_2.3Hz$SegmentAverageEnergy_Braking,
                                                                                        ThighAverageEnergy_Braking = EnergyFlow_ProximalThighOnly_1LimbPer3Groups_2.3Hz$SegmentAverageEnergy_Braking,
                                                                                        ThighAverageEnergyTransfer_Braking = EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Braking*(-1),
                                                                                        ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer = EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Braking,
        
        HoppingHeight_cm = Power_1LimbPer3Groups_Ankle_2.3Hz$HoppingHeight_m*100)
#Multiply shank power transfer by -1 to equal to the power transfer for the thigh.




#Remove morphology for all Control participants!!
AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm_NoHCMorphology <- AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm

AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm_NoHCMorphology[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm ==  0.55 ) ] <- NA



#Initialize variable to hold group-mean centered interlimb difference in tendon thickness
AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm_NoHCMorphology_GroupMeanCentered <- AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm_NoHCMorphology

#Subtract ATx group mean from all ATx interlimb diff in tendon thickness values
AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm_NoHCMorphology_GroupMeanCentered[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$Group_ID ==  'ATx' ) ] <- AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm_NoHCMorphology[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$Group_ID ==  'ATx' ) ] - mean( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm_NoHCMorphology[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$Group_ID ==  'ATx' ) ], na.rm = T )

#Subtract Control group mean from all Control interlimb diff in tendon thickness values
AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm_NoHCMorphology_GroupMeanCentered[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$Group_ID ==  'Control' ) ] <- AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm_NoHCMorphology[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$Group_ID ==  'Control' ) ] - mean( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$BetweenLimbTendonThickness_mm_NoHCMorphology[ which( AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups$Group_ID ==  'Control' ) ], na.rm = T )




```



```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionContributionvsTendonMorphology_2.3Hz_1LimbPer3Groups <- rlmer( JointContribution_AveragePower_GenerationNeutralized~BetweenLimbTendonThickness_mm*Group_by_Morphology+(1|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups )


##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC <- rlmer(AnkleContribution_AveragePower_GenerationNeutralized~1|Participant_ID,data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance for random slope and residuals 
summary(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionContributionvsTendonMorphology_Braking_VarExplained = (250.74) / ( (250.74) + (22.62) ) )
#ICC = 0.92 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomInterceptOnly <- rlmer( AnkleContribution_AveragePower_GenerationNeutralized~Group_ID*BetweenLimbTendonThickness_mm_NoHCMorphology+VAS_Rating+(1|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)



#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomInterceptOnly )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( 8.7026^2 + 42.0762^2 + 4.3579^2 + 2.4810^2 + 75.1303^2 ) / ( 269.24 + 8.7026^2 + 42.0762^2 + 4.3579^2 + 2.4810^2 + 75.1303^2 + 24.36 )
#R2 = 0.96
#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 269.24 + 8.7026^2 + 42.0762^2 + 4.3579^2 + 2.4810^2 + 75.1303^2 ) / ( 269.24 + 8.7026^2 + 42.0762^2 + 4.3579^2 + 2.4810^2 + 75.1303^2 + 24.36 )
#R2 = 0.99



#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomInterceptOnly
( MSE_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 25.33


##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomSlopeOnly <- rlmer(AnkleContribution_AveragePower_GenerationNeutralized~Group_ID*BetweenLimbTendonThickness_mm_NoHCMorphology+VAS_Rating+(BetweenLimbTendonThickness_mm_NoHCMorphology-1|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomSlopeOnly )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects
( 5.1617^2 + 11.8879^2 + 4.7136^2 + 1.0517^2 + 22.9366^2 ) / ( 110.96 + 5.1617^2 + 11.8879^2 + 4.7136^2 + 1.0517^2 + 22.9366^2 + 24.37 )
#R2 = 0.84

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects
( 110.96 + 5.1617^2 + 11.8879^2 + 4.7136^2 + 1.0517^2 + 22.9366^2 ) / ( 110.96 + 5.1617^2 + 11.8879^2 + 4.7136^2 + 1.0517^2 + 22.9366^2 + 24.37 )
#R2 = 0.97

#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomSlopeOnly
( MSE_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 25.33




#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects <- rlmer(AnkleContribution_AveragePower_GenerationNeutralized~Group_ID*BetweenLimbTendonThickness_mm_NoHCMorphology+VAS_Rating+(BetweenLimbTendonThickness_mm_NoHCMorphology|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects
( 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 ) / ( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 + 24.36 )
#R2 = 0.96

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects
( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 ) / ( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 + 24.36 )
#R2 = 0.99

#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects
( MSE_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 23.29


##Both effects is best model.
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroup_Braking_BothEffects )

```



#### Tendon Morphology, Hop Height
```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionContributionvsTendonMorphology_2.3Hz_1LimbPer3Groups <- rlmer( JointContribution_AveragePower_GenerationNeutralized~BetweenLimbTendonThickness_mm*Group_by_Morphology+(1|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups )


##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC <- rlmer(AnkleContribution_AveragePower_GenerationNeutralized~1|Participant_ID,data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance for random slope and residuals 
summary(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionContributionvsTendonMorphology_Braking_VarExplained = (250.74) / ( (250.74) + (22.62) ) )
#ICC = 0.92 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_RandomInterceptOnly <- rlmer( AnkleContribution_AveragePower_GenerationNeutralized~(Group_ID*BetweenLimbTendonThickness_mm_NoHCMorphology) +HoppingHeight_cm+(1|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)



#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_RandomInterceptOnly )
#ATx Intercept is significant! 
#Effect of tendon thickness is significant!
#Effect of hopping height is significant
#No group effect on tendon thickness


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( 0.083302^2 + 0.415505^2 + 0.043099^2 + 0.005132^2 + 0.743027^2 ) / ( 0.026333 + 0.083302^2 + 0.415505^2 + 0.043099^2 + 0.005132^2 + 0.743027^2 + 0.002384 )
#R2 = 0.96

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.026333 + 0.083302^2 + 0.415505^2 + 0.043099^2 + 0.005132^2 + 0.743027^2 ) / ( 0.026333 + 0.083302^2 + 0.415505^2 + 0.043099^2 + 0.005132^2 + 0.743027^2 + 0.002384 )
#R2 = 0.996



#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_RandomInterceptOnly
( MSE_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.00249






##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_RandomSlopeOnly <- rlmer(AnkleContribution_AveragePower_GenerationNeutralized~Group_ID*BetweenLimbTendonThickness_mm_NoHCMorphology+HoppingHeight_cm+(BetweenLimbTendonThickness_mm_NoHCMorphology-1|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_RandomSlopeOnly )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects
( 0.0481010^2 + 0.1199437^2 + 0.0474708^2 + 0.0051317^2 + 0.2356191^2 ) / ( 0.011744 + 0.0481010^2 + 0.1199437^2 + 0.0474708^2 + 0.0051317^2 + 0.2356191^2 + 0.002385 )
#R2 = 0.84

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects
( 0.011744 + 0.0481010^2 + 0.1199437^2 + 0.0474708^2 + 0.0051317^2 + 0.2356191^2 ) / ( 0.011744 + 0.0481010^2 + 0.1199437^2 + 0.0474708^2 + 0.0051317^2 + 0.2356191^2 + 0.002385 )
#R2 = 0.97

#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_RandomSlopeOnly
( MSE_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.00249







#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_BothEffects <- rlmer(AnkleContribution_AveragePower_GenerationNeutralized~Group_ID*BetweenLimbTendonThickness_mm_NoHCMorphology+HoppingHeight_cm+(BetweenLimbTendonThickness_mm_NoHCMorphology|Participant_ID), data = AnkleContributionvsTendonMorphology_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_BothEffects )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects
( 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 ) / ( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 + 24.36 )
#R2 = 0.96

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects
( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 ) / ( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 + 24.36 )
#R2 = 0.99

#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_BothEffects
( MSE_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 23.29


##Both effects is best model.
summary( RMME_AnkleAbsorptionContributionvsTendonMorphologyAndGroupAndHeight_Braking_BothEffects )

```



#### Hop Height, Limb, Group
```{r Find Best Model Structure}







#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz <- rlmer( JointContribution_AveragePower_GenerationNeutralized/100~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz )

#Check results structure
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC <- rlmer(JointContribution_AveragePower_GenerationNeutralized/100~1|Participant_ID,data = Power_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
summary(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionContributionvsTendonMorphology_Braking_VarExplained = (0.014100) / ( (0.014100) + (0.004196) ) )
#ICC = 0.77 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( JointContribution_AveragePower_GenerationNeutralized/100~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz)



#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#



#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( 0.029803^2 + 0.003476^2 + 0.003740^2 + 0.048396^2 + 0.048405^2 ) / ( 0.015076 + 0.029803^2 + 0.003476^2 + 0.003740^2 + 0.048396^2 + 0.048405^2  + 0.004053 )
#R2 = 0.23

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.015076 + 0.029803^2 + 0.003476^2 + 0.003740^2 + 0.048396^2 + 0.048405^2  ) / ( 0.015076 + 0.029803^2 + 0.003476^2 + 0.003740^2 + 0.048396^2 + 0.048405^2  + 0.004053 )
#R2 = 0.84



#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.004155167






##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer(JointContribution_AveragePower_GenerationNeutralized/100~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( 0.0049980^2 + 0.0266715^2 + 0.0056755^2 + 0.0077629^2 + 0.0078476^2 ) / ( 0.018951 + 0.0049980^2 + 0.0266715^2 + 0.0056755^2 + 0.0077629^2 + 0.0078476^2  + 0.008783 )
#R2 = 0.031

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.018951 + 0.0049980^2 + 0.0266715^2 + 0.0056755^2 + 0.0077629^2 + 0.0078476^2  ) / ( 0.018951 + 0.0049980^2 + 0.0266715^2 + 0.0056755^2 + 0.0077629^2 + 0.0078476^2  + 0.008783 )
#R2 = 0.69


#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.0085







#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer(JointContribution_AveragePower_GenerationNeutralized/100~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( 0.028920^2 + 0.007175^2 + 0.003801^2 + 0.046917^2 + 0.046925^2 ) / ( 0.0143978 + 0.0009723 + 0.028920^2 + 0.007175^2 + 0.003801^2 + 0.046917^2 + 0.046925^2  + 0.0038809 )
#R2 = 0.22

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.0143978 + 0.0009723 + 0.028920^2 + 0.007175^2 + 0.003801^2 + 0.046917^2 + 0.046925^2  ) / ( 0.0143978 + 0.0009723 + 0.028920^2 + 0.007175^2 + 0.003801^2 + 0.046917^2 + 0.046925^2  + 0.0038809 )
#R2 = 0.84



#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.00398


##Both effects is best model.
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

```



#### Hop Height*Limb, Group
```{r Find Best Model Structure}


RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame <- data.frame( R2 = rep( 0, 3 ), R2WithRandomEffects = rep( 0, 3 ), MSE = rep( 0, 3 ), row.names = c( 'Random Intercept Only', 'Random Slope Only', 'Random Intercept, Random Slope' ) )



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz <- rlmer( (JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz )

#Check results structure
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~1|Participant_ID,data = Power_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionContributionvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.73 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( (JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ), comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 1 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.17


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 1 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.82


#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 1 ] <- ( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) ) )
#MSE = 0.0028








##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 2 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.16

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 2 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.72


#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 2 ] <- ( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) ) )
#MSE = 0.0061




#Print time before and after BothEffects runs to check run time
print( Sys.time() )


#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Ankle_2.3Hz)


print( Sys.time() )



#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 3 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.19

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 3 ] <- ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.85



#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 3 ] <- ( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) ) )
#MSE = 0.0025


view( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame )




##Both effects is best model.
( X <- summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )


#Round the data to only have 3 digits
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ) )


AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop




```




#### Hop Height*Limb, Group - Contribution = 100%
```{r Find Best Model Structure}


RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame <- data.frame( R2 = rep( 0, 3 ), R2WithRandomEffects = rep( 0, 3 ), MSE = rep( 0, 3 ), row.names = c( 'Random Intercept Only', 'Random Slope Only', 'Random Intercept, Random Slope' ) )



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz <- rlmer( JointContribution_AveragePower_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz )

#Check results structure
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC <- rlmer(JointContribution_AveragePower_AbsorptionNeutralized~1|Participant_ID,data = Power_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionContributionvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.74 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( JointContribution_AveragePower_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ), comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 1 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.22


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 1 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.799


#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 1 ] <- ( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.00032








##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer(JointContribution_AveragePower_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 2 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.21

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 2 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.74


#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 2 ] <- ( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.00057




#Print time before and after BothEffects runs to check run time
print( Sys.time() )


#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer(JointContribution_AveragePower_AbsorptionNeutralized~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Ankle_2.3Hz)


print( Sys.time() )



#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 3 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] )
#R2 = 0.290

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 3 ] <- ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] )
#R2 = 1.0



#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 3 ] <- ( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.00398


view( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame )




##Both effects is best model.
( X <- summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( Estimate = cbind( X$coefficients[,1] ), CI95Lowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), CI95UpperLimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ) ) )


View(AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI)

```




```{r Create Data Frames with Averages from RMME }


AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ) )


AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]




#Add Control Matched Dominance Limb data
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]

AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop




```



#### TorquexLimb, AngVelxLimb
```{r Find Best Model Structure}


RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame <- data.frame( R2 = rep( 0, 3 ), R2WithRandomEffects = rep( 0, 3 ), MSE = rep( 0, 3 ), row.names = c( 'Random Intercept Only', 'Random Slope Only', 'Random Intercept, Random Slope' ) )



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz <- rlmer( (JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz )

#Check results structure
summary( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~1|Participant_ID,data = Power_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionContributionvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.74 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( (JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomInterceptOnly ), comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame$R2[ 1 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.22


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame$R2WithRandomEffects[ 1 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.799


#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomInterceptOnly
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame$MSE[ 1 ] <- ( MSE_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.00032








##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomSlopeOnly ) )


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomSlopeOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame$R2[ 2 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.21

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame$R2WithRandomEffects[ 2 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.74


#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomSlopeOnly
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame$MSE[ 2 ] <- ( MSE_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.00057




#Print time before and after BothEffects runs to check run time
print( Sys.time() )


#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Ankle_2.3Hz)


print( Sys.time() )



#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame$R2[ 3 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] )
#R2 = 0.290

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame$R2WithRandomEffects[ 3 ] <- ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] )
#R2 = 1.0



#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects
RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame$MSE[ 3 ] <- ( MSE_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.00398


view( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_ResultsDataFrame )




##Both effects is best model.
( X <- summary( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( Estimate = cbind( X$coefficients[,1] ), CI95Lowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), CI95UpperLimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ) ) )


View(AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_CI)

```




```{r Create Data Frames with Averages from RMME }

AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ) )


AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 1 ]
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 3 ]
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 4 ]
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 5 ]
AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsTorqueandAngVelandLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop




```


### Ankle Gen Contribution vs...

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame <- data.frame( R2 = rep( 0, 3 ), R2WithRandomEffects = rep( 0, 3 ), MSE = rep( 0, 3 ), row.names = c( 'Random Intercept Only', 'Random Slope Only', 'Random Intercept, Random Slope' ) )



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz <- rlmer( (JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz )

#Check results structure
summary( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleGenerationContributionvsTendonMorphology_Braking_forICC <- rlmer((JointContribution_AveragePower_GenerationNeutralized/100)~1|Participant_ID,data = Power_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_AnkleGenerationContributionvsTendonMorphology_Braking_forICC) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_AnkleGenerationContributionvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(AnkleGenerationContributionvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.64 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( (JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ), comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 1 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.17


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 1 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.79


#Calculate Mean Squared Error for RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 1 ] <- ( MSE_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) ) )
#MSE = 0.0028








##Create mixed effects model for random slope only.
RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer((JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 2 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.15

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 2 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.66


#Calculate Mean Squared Error for RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 2 ] <- ( MSE_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) ) )
#MSE = 0.006




#Print time before and after BothEffects runs to check run time
print( Sys.time() )


#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer((JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Ankle_2.3Hz)


print( Sys.time() )



#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 3 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 3 ] <- ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.84



#Calculate Mean Squared Error for RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 3 ] <- ( MSE_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) ) )
#MSE = 0.0026


view( RMME_AnkleGenerationContributionvsHopHeightAndLimb_ResultsDataFrame )




##Both effects is best model.
( X <- summary( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )


#Round the data to only have 3 digits
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ) )


AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_AnkleGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop




```


### Knee Abs Contribution vs...

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame <- data.frame( R2 = rep( 0, 3 ), R2WithRandomEffects = rep( 0, 3 ), MSE = rep( 0, 3 ), row.names = c( 'Random Intercept Only', 'Random Slope Only', 'Random Intercept, Random Slope' ) )



#Perform normal robust mixed effects model, to check the results structure
RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz <- rlmer( (JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Knee_2.3Hz )

#Check results structure
summary( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_KneeAbsorptionContributionvsTendonMorphology_Braking_forICC <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~1|Participant_ID,data = Power_Knee_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_KneeAbsorptionContributionvsTendonMorphology_Braking_forICC) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_KneeAbsorptionContributionvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(KneeAbsorptionContributionvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.64 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( (JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Knee_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ), comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 1 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.17


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 1 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.79


#Calculate Mean Squared Error for RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 1 ] <- ( MSE_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) ) )
#MSE = 0.0028








##Create mixed effects model for random slope only.
RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Knee_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 2 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.15

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 2 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.66


#Calculate Mean Squared Error for RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 2 ] <- ( MSE_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) ) )
#MSE = 0.006




#Print time before and after BothEffects runs to check run time
print( Sys.time() )


#Create robust mixed effects model with both random slope and random intercept
RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Knee_2.3Hz)


print( Sys.time() )



#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 3 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 3 ] <- ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.84



#Calculate Mean Squared Error for RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 3 ] <- ( MSE_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) ) )
#MSE = 0.0026


view( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame )




##Both effects is best model.
( X <- summary( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )


#Round the data to only have 3 digits
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Knee_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Knee_2.3Hz$Participant_ID ) ) ) )


KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Knee_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Knee_2.3Hz
   Power_Knee_2.3Hz_ParticipantKOnly <- Power_Knee_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Knee_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Knee_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop




```



### Knee Gen Contribution vs...

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame <- data.frame( R2 = rep( 0, 3 ), R2WithRandomEffects = rep( 0, 3 ), MSE = rep( 0, 3 ), row.names = c( 'Random Intercept Only', 'Random Slope Only', 'Random Intercept, Random Slope' ) )



#Perform normal robust mixed effects model, to check the results structure
RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz <- rlmer( (JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Knee_2.3Hz )

#Check results structure
summary( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_KneeGenerationContributionvsTendonMorphology_Braking_forICC <- rlmer((JointContribution_AveragePower_GenerationNeutralized/100)~1|Participant_ID,data = Power_Knee_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_KneeGenerationContributionvsTendonMorphology_Braking_forICC) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_KneeGenerationContributionvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(KneeGenerationContributionvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.64 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( (JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Knee_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ), comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 1 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.17


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 1 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.79


#Calculate Mean Squared Error for RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 1 ] <- ( MSE_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) ) )
#MSE = 0.0028








##Create mixed effects model for random slope only.
RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer((JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Knee_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 2 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.15

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 2 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.66


#Calculate Mean Squared Error for RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 2 ] <- ( MSE_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) ) )
#MSE = 0.006




#Print time before and after BothEffects runs to check run time
print( Sys.time() )


#Create robust mixed effects model with both random slope and random intercept
RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer((JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Knee_2.3Hz)


print( Sys.time() )



#Use summary to find variance of fixed and random effects
( X <- summary( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 3 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.18

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 3 ] <- ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.84



#Calculate Mean Squared Error for RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 3 ] <- ( MSE_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) ) )
#MSE = 0.0026


view( RMME_KneeGenerationContributionvsHopHeightAndLimb_ResultsDataFrame )




##Both effects is best model.
( X <- summary( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )


#Round the data to only have 3 digits
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Knee_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Knee_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Knee_2.3Hz$Participant_ID ) ) ) )


KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Knee_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Knee_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Knee_2.3Hz
   Power_Knee_2.3Hz_ParticipantKOnly <- Power_Knee_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Knee_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Knee_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_KneeGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop




```


### Hip Abs Contribution vs...

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame <- data.frame( R2 = rep( 0, 3 ), R2WithRandomEffects = rep( 0, 3 ), MSE = rep( 0, 3 ), row.names = c( 'Random Intercept Only', 'Random Slope Only', 'Random Intercept, Random Slope' ) )



#Perform normal robust mixed effects model, to check the results structure
RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz <- rlmer( (JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Hip_2.3Hz )

#Check results structure
summary( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_HipAbsorptionContributionvsTendonMorphology_Braking_forICC <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~1|Participant_ID,data = Power_Hip_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_HipAbsorptionContributionvsTendonMorphology_Braking_forICC) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_HipAbsorptionContributionvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(HipAbsorptionContributionvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.7 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( (JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Hip_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ), comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 1 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.176


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 1 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.76


#Calculate Mean Squared Error for RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 1 ] <- ( MSE_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) ) )
#MSE = 0.001








##Create mixed effects model for random slope only.
RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Hip_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 2 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.16

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 2 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.75


#Calculate Mean Squared Error for RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 2 ] <- ( MSE_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) ) )
#MSE = 0.00189




#Print time before and after BothEffects runs to check run time
print( Sys.time() )


#Create robust mixed effects model with both random slope and random intercept
RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer((JointContribution_AveragePower_AbsorptionNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Hip_2.3Hz)


print( Sys.time() )



#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 3 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.17

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 3 ] <- ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.81



#Calculate Mean Squared Error for RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 3 ] <- ( MSE_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) ) )
#MSE = 0.00098


view( RMME_HipAbsorptionContributionvsHopHeightAndLimb_ResultsDataFrame )




##Both effects is best model.
( X <- summary( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )


#Round the data to only have 3 digits
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Hip_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Hip_2.3Hz$Participant_ID ) ) ) )


HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Hip_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Hip_2.3Hz
   Power_Hip_2.3Hz_ParticipantKOnly <- Power_Hip_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Hip_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Hip_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop




```



### Hip Gen Contribution vs...

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame <- data.frame( R2 = rep( 0, 3 ), R2WithRandomEffects = rep( 0, 3 ), MSE = rep( 0, 3 ), row.names = c( 'Random Intercept Only', 'Random Slope Only', 'Random Intercept, Random Slope' ) )



#Perform normal robust mixed effects model, to check the results structure
RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz <- rlmer( (JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Hip_2.3Hz )

#Check results structure
summary( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_HipGenerationContributionvsTendonMorphology_Braking_forICC <- rlmer((JointContribution_AveragePower_GenerationNeutralized/100)~1|Participant_ID,data = Power_Hip_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_HipGenerationContributionvsTendonMorphology_Braking_forICC) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_HipGenerationContributionvsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(HipGenerationContributionvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.7 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( (JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Hip_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ), comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 1 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.176


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 1 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.76


#Calculate Mean Squared Error for RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
( RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 1 ] <- ( MSE_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) ) )
#MSE = 0.001








##Create mixed effects model for random slope only.
RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer((JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Hip_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 2 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.16

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 2 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] ) )
#R2 = 0.75


#Calculate Mean Squared Error for RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
( RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 2 ] <- ( MSE_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) ) )
#MSE = 0.00189




#Print time before and after BothEffects runs to check run time
print( Sys.time() )


#Create robust mixed effects model with both random slope and random intercept
RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer((JointContribution_AveragePower_GenerationNeutralized/100)~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Hip_2.3Hz)


print( Sys.time() )



#Use summary to find variance of fixed and random effects
( X <- summary( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2[ 3 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.17

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 3 ] <- ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] ) )
#R2 = 0.81



#Calculate Mean Squared Error for RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
( RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame$MSE[ 3 ] <- ( MSE_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) ) )
#MSE = 0.00098


view( RMME_HipGenerationContributionvsHopHeightAndLimb_ResultsDataFrame )




##Both effects is best model.
( X <- summary( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( 
  #Add Estimate, meaning the intercept + effect of any IV. What is the actual hopping height?
  Estimate = cbind( c( X$coefficients[1:2,1], X$coefficients[3:5,1] + X$coefficients[1,1],
                       X$coefficients[6:8,1] + X$coefficients[2,1]) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                                     EstimateConfidenceIntervalLowerLimit = cbind( c( X$coefficients[1:2,1] - (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] - (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] - (2*X$coefficients[6:8,2]) ) ),
                        #Estimate CI = mean + effect + 2*effect standard error
                        EstimateConfidenceIntervalUpperLimit = cbind( c( X$coefficients[1:2,1] + (2*X$coefficients[1:2,2]), X$coefficients[1,1] + X$coefficients[3:5,1] + (2*X$coefficients[3:5,2]), X$coefficients[2,1] + X$coefficients[6:8,1] + (2*X$coefficients[6:8,2]) ) ), 
                      #Estimate CI arm = mean + effect + 2*effect standard error
                                                    EstimateConfidenceIntervalArm = cbind( EstimateConfidenceIntervalUpperLimit - Estimate[1] ),
                                                                        Effect = round( cbind( X$coefficients[,1] ), digits = 3),
                                                                       
                                                                                                                                                  #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), 
                                                     #95% confidence interval for mean or effect. To get 95% CI, do 2*standard error + Effect   
                                                     EffectConfidenceIntervalUpperlimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ), 
                                                     XMin = cbind(  rep('Involved',4) ) , XMax = cbind( c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ), YPosition = c( 4.75, 4.75, 5.25, 5.75 ) ) )


#Round the data to only have 3 digits
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3] <- round( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI[,1:3], digits = 3 )



#Create labels for adding text to plots
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( paste0( 'Mean = ', round( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ 1 ], digits = 3), ' cm ', '(95% CI:', round( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ 1 ], digits = 3), ',', round( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ 1 ], digits = 3 ), ')' ), 
                                                                       paste0( 'Diff = ', round( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Effect[ -1 ], digits = 3), ' cm ', '(95% CI:', round( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ], digits = 3),', ', round( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], digits = 3), ')' ) ) )

View( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )

write.csv( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI, 'HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI.csv' )

#Create labels for adding text to plots
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Label = cbind( c( NA, paste0( 'Diff = ', HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$Estimate[ -1 ], ' cm ', '(95% CI:', HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalLowerlimit[ -1 ],', ', HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI$EffectConfidenceIntervalUpperlimit[ -1 ], ')' ) ) )

```




```{r Create Data Frames with Averages from RMME }

HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Hip_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Hip_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Hip_2.3Hz$Participant_ID ) ) ) )


HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Hip_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Hip_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Hip_2.3Hz
   Power_Hip_2.3Hz_ParticipantKOnly <- Power_Hip_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Hip_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Hip_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_HipGenerationContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop




```


### Ankle Sagittal Torque Impulse vs...

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame <- data.frame( R2 = rep( 0, 3 ), R2WithRandomEffects = rep( 0, 3 ), MSE = rep( 0, 3 ), row.names = c( 'Random Intercept Only', 'Random Slope Only', 'Random Intercept, Random Slope' ) )



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz <- rlmer( JointTorqueImpulse_Braking_Sagittal_NoFlexTorq~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz )

#Check results structure
summary( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleSagittalTorqueImpulsevsTendonMorphology_Braking_forICC <- rlmer(JointTorqueImpulse_Braking_Sagittal_NoFlexTorq~1|Participant_ID,data = Power_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_AnkleSagittalTorqueImpulsevsTendonMorphology_Braking_forICC) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr(RMME_AnkleSagittalTorqueImpulsevsTendonMorphology_Braking_forICC),comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(AnkleSagittalTorqueImpulsevsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.74 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( JointTorqueImpulse_Braking_Sagittal_NoFlexTorq~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ), comp = "Variance")


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame$R2[ 1 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.22


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 1 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.799


#Calculate Mean Squared Error for RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame$MSE[ 1 ] <- ( MSE_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.00032








##Create mixed effects model for random slope only.
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer(JointTorqueImpulse_Braking_Sagittal_NoFlexTorq~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame$R2[ 2 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.21

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 2 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.74


#Calculate Mean Squared Error for RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame$MSE[ 2 ] <- ( MSE_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.00057




#Print time before and after BothEffects runs to check run time
print( Sys.time() )


#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer(JointTorqueImpulse_Braking_Sagittal_NoFlexTorq~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Ankle_2.3Hz)


print( Sys.time() )



#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame$R2[ 3 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] )
#R2 = 0.290

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 3 ] <- ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] )
#R2 = 1.0



#Calculate Mean Squared Error for RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects
RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame$MSE[ 3 ] <- ( MSE_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.00398


view( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_ResultsDataFrame )




##Both effects is best model.
( X <- summary( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( Estimate = cbind( X$coefficients[,1] ), CI95Lowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), CI95UpperLimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ) ) )


View(AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI)

```




```{r Create Data Frames with Averages from RMME }

AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ) )


AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop




```
















### Ankle Average Ang Vel vs...

#### Hop Height*Limb, Group
```{r Find Best Model Structure}


RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame <- data.frame( R2 = rep( 0, 3 ), R2WithRandomEffects = rep( 0, 3 ), MSE = rep( 0, 3 ), row.names = c( 'Random Intercept Only', 'Random Slope Only', 'Random Intercept, Random Slope' ) )



#Perform normal robust mixed effects model, to check the results structure
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz <- rlmer( AverageJointAngVel_BrakingPhase~HoppingHeight_cm_LimbMeanCentered+Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz )

#Check results structure
summary( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz )
#Involved limb is Limb 0




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AverageAnkleSagittalAngVelvsTendonMorphology_Braking_forICC <- rlmer(AverageJointAngVel_BrakingPhase~1|Participant_ID,data = Power_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
( X <- summary(RMME_AverageAnkleSagittalAngVelvsTendonMorphology_Braking_forICC) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AverageAnkleSagittalAngVelvsTendonMorphology_Braking_forICC ), comp = "Variance")

#ICC = within-subject / (within-subject+residual)
(AverageAnkleSagittalAngVelvsTendonMorphology_Braking_VarExplained = Y$vcov[ 1 ] / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] ) )
#ICC = 0.82 - significant clustering. Appropriate to use mixed effects








##Create mixed effects model for random intercept only.
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- rlmer( AverageJointAngVel_BrakingPhase~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ) )
#Intercept for both limbs is significant! 
#Effect of hop height is significant - slope of -0.014 (-0.021, -0.0071 ) = 1.4% decrease per cm hop height increase
#


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame$R2[ 1 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.23


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
   RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 1 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.83


#Calculate Mean Squared Error for RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame$MSE[ 1 ] <- ( MSE_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly <- mean( residuals(RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.004772









##Create mixed effects model for random slope only.
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- rlmer(AverageJointAngVel_BrakingPhase~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered-1|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ) )


#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame$R2[ 2 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.23


#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 2 ] <- ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 2 ] )
#R2 = 0.83


#Calculate Mean Squared Error for RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame$MSE[ 2 ] <- ( MSE_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly <- mean( residuals(RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.00095







#Create robust mixed effects model with both random slope and random intercept
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- rlmer(AverageJointAngVel_BrakingPhase~HoppingHeight_cm_LimbMeanCentered*Limb_ID_UnorderedFactor+(HoppingHeight_cm_LimbMeanCentered|Participant_ID), data = Power_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
( X <- summary( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )

#Use VarCorr along with comp = 'Variance' argument to extract random effect variances. Store as a data frame for easy accessing
Y <- as.data.frame( VarCorr( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ), comp = "Variance")

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame$R2[ 3 ] <- ( sum(X$coefficients[,2]^2) ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 3 ] )
#R2 = 0.2315

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame$R2WithRandomEffects[ 3 ] <- ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  ) / ( Y$vcov[ 1 ] + Y$vcov[ 2 ] + sum(X$coefficients[,2]^2)  + Y$vcov[ 4 ] )
#R2 = 0.842


View( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame )




#Calculate Mean Squared Error for RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects
RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_ResultsDataFrame$MSE[ 3 ] <- ( MSE_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects <- mean( residuals(RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 0.00398


##Both effects is best model.
( X <- summary( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects ) )
#Involved limb: participants with average hop height have 57.8% (52.0%, 63.4%) contribution
#1 cm increase in hop height decreases contribution by 1.49% (-2.9%, -0.05%)
#Non-Involved limb: participants with average hop height show greater contribution by 1.32% (0.56%, 2.08%)
#No diff of matched dominance and contralateral limb relative to involved limb

( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- cbind( X$coefficients[,1], X$coefficients[,1] - (2*X$coefficients[,2]), X$coefficients[,1] + (2*X$coefficients[,2]) ) )



( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI <- data.frame( Estimate = cbind( X$coefficients[,1] ), CI95MinLowerlimit = cbind( X$coefficients[,1] - (2*X$coefficients[,2]) ), CI95UpperLimit = cbind( X$coefficients[,1] + (2*X$coefficients[,2]) ) ) )


View( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_CI )


```




```{r Create Data Frames with Averages from RMME }

AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates <- data.frame(Group_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Intercept = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ), Slope = rep( 0, 2*length( unique( Power_Ankle_2.3Hz$Participant_ID ) ) ) )


AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Intercept = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ), Slope = rep( 0, length( unique( Power_Ankle_2.3Hz$Limb_ID ) ) ) )


#Add ATx Involved Limb data
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 1 ] <- 'ATx'
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 1 ] <- 'Involved'
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 1 ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ]
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 1 ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ]


#Add ATx Non-Involved Limb data
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 2 ] <- 'ATx'
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 2 ] <- 'Non-Involved'
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 2 ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ]
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 2 ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ]


#Add Control Matched Dominance Limb data
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 3 ] <- 'Control'
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 3 ] <- 'Matched Dominance'
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 3 ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ]
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 3 ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ]


#Add Control Contralateral Limb data
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Group_ID[ 4 ] <- 'Control'
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Limb_ID[ 4 ] <- 'Contralateral'
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Intercept[ 4 ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ]
AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates$Slope[ 4 ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ]






UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
   
      #Add Participant K's Group ID
      AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Group_ID[ RowtoFill ] <- UniqueGroup
      
      #Add Participant K's Participant ID
      AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      
      
      #If processing the Involved limb, add fixed effect 1 + random effect
      if ( UniqueLimb[ l ] ==  'Involved' ) {
           
           AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + ranef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + ranef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      
      #If processing the Non-Involved limb, add fixed effect 1 and 2 + random effect
      } else if ( UniqueLimb[ l ] ==  'Non-Involved' ) {
           
           AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 3 ] + ranef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 6 ] + ranef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Matched Dominance limb, add fixed effect 1 and 3 + random effect
      } else if ( UniqueLimb[ l ] ==  'Matched Dominance' ) {
           
          ( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 4 ] + ranef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ] )
           
           AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 7 ] + ranef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
      
      #If processing the Contralateral limb, add fixed effect 1 and 4 + random effect
      } else if ( UniqueLimb[ l ] ==  'Contralateral' ) {
           
           AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Intercept[ RowtoFill ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 1 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 5 ] + ranef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 1 ]
           
           AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates$Slope[ RowtoFill ] <- fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 2 ] + fixef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )[ 8 ] + ranef( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects )$Participant_ID[ k, 2 ]
         
         
      }#End If statement
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop




```






### ATx Only

#### Interlimb

##### Ankle Contribution vs...

###### Limb
```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx <- rlmer( JointContribution_AveragePower_GenerationNeutralized/100~HoppingHeight_cm_LimbMeanCentered+Limb_ID+(1|Participant_ID), data = Power_ATx_Ankle_2.3Hz )

#Check results structure
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx )
#Unsure what Limb_ID.L means




##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC <- rlmer(JointContribution_AveragePower_GenerationNeutralized/100~1|Participant_ID,data = Power_ATx_Ankle_2.3Hz)


#Use summary to find variance for random slope and residuals 
summary(RMME_AnkleAbsorptionContributionvsTendonMorphology_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleAbsorptionContributionvsTendonMorphology_Braking_VarExplained = (0.017714) / ( (0.017714) + (0.004659) ) )
#ICC = 0.79 - significant clustering. Appropriate to use mixed effects




##Create mixed effects model for random intercept only.
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_RandomInterceptOnly <- rlmer( JointContribution_AveragePower_GenerationNeutralized/100~HoppingHeight_cm_LimbMeanCentered+factor(Limb_ID_Unfactored) +(1|Participant_ID), data = Power_ATx_Ankle_2.3Hz)



#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_RandomInterceptOnly )
#Intercept for both limbs is significant! Non-involved limb has an average contribution of 0.596 (additional 0.014) for participants with average hop height for non-involved limb


#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects + residuals
( 0.032486^2 + 0.005121^2 + 0.002843^2  ) / ( 0.017982 + 0.032486^2 + 0.005121^2 + 0.002843^2  + 0.004685 )
#R2 = 0.046

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects + residuals
( 0.017982 + 0.032486^2 + 0.005121^2 + 0.002843^2  ) / ( 0.017982 + 0.032486^2 + 0.005121^2 + 0.002843^2  + 0.004685 )
#R2 = 0.80



#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_RandomInterceptOnly
( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_RandomInterceptOnly,type = 'response' )^2 ) )
#MSE = 0.00249






##Create mixed effects model for random slope only.
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_RandomSlopeOnly <- rlmer(JointContribution_AveragePower_GenerationNeutralized/100~HoppingHeight_cm_LimbMeanCentered+factor(Limb_ID_Unfactored) +(HoppingHeight_cm-1|Participant_ID), data = Power_ATx_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_RandomSlopeOnly )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects
( 0.0481010^2 + 0.1199437^2 + 0.0474708^2 + 0.0051317^2 + 0.2356191^2 ) / ( 0.011744 + 0.0481010^2 + 0.1199437^2 + 0.0474708^2 + 0.0051317^2 + 0.2356191^2 + 0.002385 )
#R2 = 0.84

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects
( 0.011744 + 0.0481010^2 + 0.1199437^2 + 0.0474708^2 + 0.0051317^2 + 0.2356191^2 ) / ( 0.011744 + 0.0481010^2 + 0.1199437^2 + 0.0474708^2 + 0.0051317^2 + 0.2356191^2 + 0.002385 )
#R2 = 0.97

#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_RandomSlopeOnly
( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_RandomSlopeOnly,type = 'response' )^2 ) )
#MSE = 0.00249







#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_BothEffects <- rlmer(JointContribution_AveragePower_GenerationNeutralized/100~HoppingHeight_cm_LimbMeanCentered+factor(Limb_ID_Unfactored) +(HoppingHeight_c|Participant_ID), data = Power_ATx_Ankle_2.3Hz)


#Use summary to find variance of fixed and random effects
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_BothEffects )

#Manually calculate R2: Variance of fixed effects / variance of fixed + random effects
( 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 ) / ( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 + 24.36 )
#R2 = 0.96

#Manually calculate R2: Variance of fixed effects + random effects / variance of fixed + random effects
( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 ) / ( 43.56 + 26.00 + 6.5896^2 + 22.3644^2 + 4.3393^2 + 1.6114^2 + 40.4738^2 + 24.36 )
#R2 = 0.99

#Calculate Mean Squared Error for RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_BothEffects
( MSE_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_BothEffects <- mean( residuals(RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_BothEffects,type = 'response' )^2 ) )
#MSE = 23.29


##Both effects is best model.
summary( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_ATx_Braking_BothEffects )

```


## SE Function

```{r}

standard_error <- function(x) {
   
   sd(x) /sqrt( length( x ) )
   
}

```

## Calculate SE

```{r}

#JointContributions_MEEAbsorption_ATx_2.3Hz_


```

## Between-Group Differences

### Ankle

```{r 2.3 Hz}


#Group difference in braking phase duration
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_BrakingPhaseLength_s[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_BrakingPhaseLength_s[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_BrakingPhaseLength_s[1]


#Group difference in propulsion phase duration
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_PropulsionPhaseLength_s[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_PropulsionPhaseLength_s[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_PropulsionPhaseLength_s[1]


#Group difference in ground contact phase duration
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_GroundContactPhaseLength_s[2] +  - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_GroundContactPhaseLength_s[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_GroundContactPhaseLength_s[1]
   


#Group difference in whole-limb MEE, braking phase
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Absorption_MEE[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Absorption_MEE[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Absorption_MEE[1]





#Group difference in whole-limb MEE, Propulsion phase
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Generation_MEE[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Generation_MEE[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Generation_MEE[1]



#Group difference in raw ankle MEE, BRAKING phase
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_MEE[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_MEE[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_MEE[1]




#Group difference in raw ankle MEE, PROPULSION phase
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_MEE[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_MEE[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_MEE[1]




#Group difference in ankle contribution to whole-limb MEE, BRAKING phase
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Percent_MEE_Absorption[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Percent_MEE_Absorption[1] )




#Group difference in ankle contribution to whole-limb MEE, PROPULSION phase
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Percent_MEE_Generation[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Percent_MEE_Generation[1] ) 




#Group difference in braking phase RoM
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_BrakingPhase[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_BrakingPhase[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_BrakingPhase[1]

#Group difference in propulsion phase RoM
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_PropulsionPhase[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_PropulsionPhase[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_PropulsionPhase[1]




#Group difference in braking phase angular velocity
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Absorption[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Absorption[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Absorption[1]

#Group difference in propulsion phase angular velocity
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Generation[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Generation[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Generation[1]




#Group difference in braking phase torque impulse
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_SagittalTorqueImpulse[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_SagittalTorqueImpulse[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_SagittalTorqueImpulse[1]

#Group difference in propulsion phase torque impulse
( Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_SagittalTorqueImpulse[2] - Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_SagittalTorqueImpulse[1] ) / Power_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_SagittalTorqueImpulse[1]

```



## PLOTS


```{r Tendon Morphology }



(Power1 <- ggplot(data = TendonMorphology, aes(y = DifferenceinTendonThickness_mm, x = DistancefromCalcanealInsertion_cm  ) ) +
      
      
      geom_hline( yintercept = 2, linewidth = 1.75, color = 'black' ) +
    
    
      geom_vline( xintercept = 2, linewidth = 1.75, color = 'darkgray', linetype = 'dashed' ) +
      
    
    
      geom_text( label = 'MDC = 0.08 mm', size = 10, x = 4.5, y = 3.55, color = 'black', fontface = 'bold' ) +
    
      
      #Arrow segment from 1 to max of y-axis.
   geom_segment( aes( x = 0.1, xend = 0.1, y = 2, yend = 4 ), linewidth = 2.5, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Literature-Informed \n Reduction in \n Tendon Stiffness', size = 10, x = 1.25, y = 3.55, color = 'black', fontface = 'bold' ) +
      
      
    
    
      #Arrow segment from 0 to 1 of x-axis.
   geom_segment( aes( x = 0.01, xend = 1.96, y = 0, yend = 0 ), linewidth = 2.5, arrow = arrow(length = unit(5,'mm'), ends = 'both', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Insertion', size = 10, x = 1, y = 0.06, color = 'black', fontface = 'bold' ) +
    
    
      
      #Arrow segment from 2 to 6.
   geom_segment( aes( x = 2.03, xend = 6, y = 0, yend = 0 ), linewidth = 2.5, arrow = arrow(length = unit(5,'mm'), ends = 'both', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Typical Achilles Midsubstance', size = 10, x = 4, y = 0.06, color = 'black', fontface = 'bold' ) +
      
      
      
    
    
      
      #Arrow segment from 6 to max of x-axis.
   geom_segment( aes( x = 6.06, xend = 8, y = 0, yend = 0 ), linewidth = 2.5, arrow = arrow(length = unit(5,'mm'), ends = 'both', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Atypical Achilles \n Midsubstance', size = 10, x = 7, y = 0.15, color = 'black', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.0Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.0Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      

   
   
   geom_dotplot( aes( fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, stroke = 2) +
   
   
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1],'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[1],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[1],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[1], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[7],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[8],
                                    'HC45' = met.brewer('OKeeffe1')[1],
                                    'HC42' = met.brewer('OKeeffe1')[10],
                                    'HC48' = met.brewer('OKeeffe1')[3],
                                    'HC44' = met.brewer('OKeeffe1')[6],
                                    'HC65' = met.brewer('OKeeffe1')[9],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1],
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[1],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[1],
                                'ATx39' = met.brewer('OKeeffe1')[7],
                                'ATx65' = met.brewer('OKeeffe1')[8],
                                'ATx66'  = met.brewer('OKeeffe1')[9],
                                'ATx74'  = met.brewer('OKeeffe1')[10],
                                'ATx75'  = met.brewer('OKeeffe1')[11],
                                'ATx100'  = met.brewer('OKeeffe1')[1],
                                'ATx102'  = met.brewer('OKeeffe1')[2],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[1], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[7],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[8],
                                    'HC45' = met.brewer('OKeeffe1')[1],
                                    'HC42' = met.brewer('OKeeffe1')[10],
                                    'HC48' = met.brewer('OKeeffe1')[3],
                                    'HC44' = met.brewer('OKeeffe1')[1],
                                    'HC65' = met.brewer('OKeeffe1')[9] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
   
   
   
   scale_y_continuous( breaks = seq( 0, 4, by = 0.25 ), limits = c( 0, 4 ) ) +
   
   
   scale_x_continuous( breaks = seq( 0, 8, by = 1 ), limits = c( 0, 8 ) ) +
   
   
   labs( title = ' Interlimb Difference in Achilles Tendon Thickness \n (Involved - Non-Involved)',x = 'Measurement Distance from Calcaneal Insertion (cm)', y = ' Difference in Thickness (mm) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) 

)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Morphology/', 'Dissertation_TendonMicroMorphology.png', width = 5000, height = 5000, units = 'px' )

```

### Participant Means

##### All 4 Limbs
```{r Joint Absorption Work }


range( Power_ParticipantMeans_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x ) /sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x ) /sqrt( length( x ) ) ), SE = sd( x ) /sqrt( length( x ) ), CI_Arm = 2*( sd( x ) /sqrt( length( x ) ) ) )
   
}



#Find SE and CI for Involved Limb
InvolvedLimbCI <- SE_function( Power_ParticipantMeans_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized[ which( Power_ParticipantMeans_2.3Hz$Limb_ID ==  'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Power_ParticipantMeans_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized[ which( Power_ParticipantMeans_2.3Hz$Limb_ID ==  'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Power_ParticipantMeans_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized[ which( Power_ParticipantMeans_2.3Hz$Limb_ID ==  'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Power_ParticipantMeans_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized[ which( Power_ParticipantMeans_2.3Hz$Limb_ID ==  'Contralateral' ) ] )




UniqueLimbID <- unique( Power_ParticipantMeans_2.3Hz$Limb_ID )
UniqueJointID <- unique( Power_ParticipantMeans_2.3Hz$Joint_ID )


Mean_JointWork_Braking_GenerationNeutralized_LimbMean <- data.frame( Group_ID = rep( 'ATx', 12 ), Limb_ID = rep(UniqueLimbID, 3), Joint_ID = rep( UniqueJointID, 4 ), Mean = rep( 0, 12 ), SE = rep( 0, 12 ), CI_Arm = rep( 0, 12 ), CI_LowerLimit = rep( 0, 12 ), CI_UpperLimit = rep( 0, 12 ) )

RowtoFill <- 1

#Fill in data frame with means for each limb
for ( l in 1 : length( UniqueLimbID ) ) {
   
   for ( k in 1 : length( UniqueJointID ) ) {
   
   Mean_JointWork_Braking_GenerationNeutralized_LimbMean$Group_ID[ RowtoFill ] <-  Power_ParticipantMeans_2.3Hz$Group_ID[ which( Power_ParticipantMeans_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ParticipantMeans_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
   
   Mean_JointWork_Braking_GenerationNeutralized_LimbMean$Limb_ID[ RowtoFill ] <-  Power_ParticipantMeans_2.3Hz$Limb_ID[ which( Power_ParticipantMeans_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ParticipantMeans_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
   
   Mean_JointWork_Braking_GenerationNeutralized_LimbMean$Joint_ID[ RowtoFill ] <-  Power_ParticipantMeans_2.3Hz$Joint_ID[ which( Power_ParticipantMeans_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ParticipantMeans_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
   
   
   
   SEOutput <- SE_function( Power_ParticipantMeans_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized[ which( Power_ParticipantMeans_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ParticipantMeans_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ] )
  
   
   
   Mean_JointWork_Braking_GenerationNeutralized_LimbMean$Mean[ RowtoFill ] <- SEOutput$y
   
   Mean_JointWork_Braking_GenerationNeutralized_LimbMean$CI_LowerLimit[ RowtoFill ] <- SEOutput$ymin
   
   Mean_JointWork_Braking_GenerationNeutralized_LimbMean$CI_UpperLimit[ RowtoFill ] <- SEOutput$ymax
   
   Mean_JointWork_Braking_GenerationNeutralized_LimbMean$SE[ RowtoFill ] <- SEOutput$SE
   
   Mean_JointWork_Braking_GenerationNeutralized_LimbMean$CI_Arm[ RowtoFill ] <- SEOutput$CI_Arm
   
   RowtoFill <- RowtoFill + 1
   
   }
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_ParticipantMeans_2.3Hz, aes(y = Mean_JointWork_Braking_GenerationNeutralized, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Power_ParticipantMeans_2.3Hz, Limb_ID ==  'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.8, na.rm = T ) +
      
      

 
 
   
    
   #Geom_point to show limb means per joint
      geom_point( data = Mean_JointWork_Braking_GenerationNeutralized_LimbMean, aes( y = Mean, x = Limb_ID, fill = Joint_ID, group = interaction( Limb_ID, Joint_ID ) ), shape = 22, size = 30, stroke = 3, color = 'black' ) +
      
      #Create error bars to show 95% CI
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = interaction( Limb_ID, Joint_ID ), color = Joint_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Power_ParticipantMeans_2.3Hz, Limb_ID ==  'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Power_ParticipantMeans_2.3Hz, Limb_ID ==  'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Power_ParticipantMeans_2.3Hz, Limb_ID ==  'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Power_ParticipantMeans_2.3Hz, Limb_ID ==  'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
 
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Joint_ID, group = interaction( Limb_ID, Joint_ID ) ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed = 1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ) +
      

    
    

geom_ysidedensity( aes( group = interaction( Limb_ID, Joint_ID ), color = Limb_ID, fill = Joint_ID ), linewidth = 6, alpha = 0.55 ) +
    
    #Need to allow independent x-axes so each subplot only shows the limbs for that group
    ggside( scales = 'free_x' ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -1, 0, by = 0.1 ), limits =  c( -1, 0.2 ) ) +
    
    
    scale_ysidex_discrete( breaks = NULL ) +
   
   
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Absorption Work vs Limb  \n 2.33 Hz Hopping ', x = 'Limb ID', y = ' Ankle Absorption Work (J/kg) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Ankle' = '#d7301f','Knee' = '#fc8d59','Hip' = '#fdcc8a',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#e66101',
                                 'Non-Involved' = '#b2abd2',
                                 'Matched Dominance' = '#fdb863',
                                 'Contralateral' = '#5e3c99', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[1], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[7],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[8],
                                    'HC45' = met.brewer('OKeeffe1')[6],
                                    'HC42' = met.brewer('OKeeffe1')[10],
                                    'HC48' = met.brewer('OKeeffe1')[3],
                                    'HC44' = met.brewer('OKeeffe1')[6],
                                    'HC65' = met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#d7301f','Knee' = '#fc8d59','Hip' = '#fdcc8a',
                                 'Involved' = '#e66101',
                                 'Non-Involved' = '#b2abd2',
                                 'Matched Dominance' = '#fdb863',
                                 'Contralateral' = '#5e3c99', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[1], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[7],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[8],
                                    'HC45' = met.brewer('OKeeffe1')[6],
                                    'HC42' = met.brewer('OKeeffe1')[10],
                                    'HC48' = met.brewer('OKeeffe1')[3],
                                    'HC44' = met.brewer('OKeeffe1')[6],
                                    'HC65' = met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC45' = 1,
                                    'HC20' =  1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11' =  1,
                                    'HC42' = 1,
                                    'HC21' =  1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 50, face = 'bold' ),
            ggside.panel.scale = .3,
        ggside.panel.border = element_rect(NA, "red", linewidth = 2),
        ggside.panel.grid = element_line("black", linewidth = .1, linetype = "dotted"),
        ggside.panel.background = element_blank() )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_AllTSContributiontoPFActivation_BrakingPhase_All4Limbs_ParticipantMeans2.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```

##### Between-Limb Diffs

###### Ankle Power Contribution vs Macromorphology, Group
```{r Braking Phase }




#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz, aes(y = Mean_JointContribution_AveragePower_GenerationNeutralized/100, x = Mean_BetweenLimbTendonThickness_mm) ) +
      
 
    
    #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.01, xend = 0.01, y = 0.01, yend = 0.2 ), linewidth = 3, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
      
#Text explaining purpose of above arrow   
   geom_text( label = 'Involved > Non-Involved', size = 13, x = 0.75, y = 0.195, fontface = 'bold' ) +
 
    
   
   
    #Arrow segment from 0 to min of y-axis.
   geom_segment(  aes( x = 0.01, xend = 0.01, y = -0.01, yend = -0.2 ), linewidth = 3, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
      
#Text explaining purpose of above arrow   
   geom_text( label = 'Involved < Non-Involved', size = 13, x = 0.75, y = -0.195, fontface = 'bold' ) +
    
    
    
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_ID, color = Group_ID ), se = F, linewidth = 5 ) +
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Group_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'ATx' = '#c51b7d',
                                 'Control' = '#4d9221',
                                    'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' =  0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits = c( 0, 4 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -0.2, 0.2, by = 0.05 ), limits =  c( -0.2, 0.2 ) ) +
      
      #Specify shapes
      scale_shape_manual( values = c( 'ATx' = 23,
                                 'Control' = 21 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Between-Limb Difference in Ankle Contribution to Whole-Limb \n Absorption Work vs Achilles Tendon Macromorphology \n  2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Interlimb Difference in Contribution (Max = 1) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','ATx' = '#c51b7d'  ) ), nrow = 1 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 30, lineheight = 100),
            legend.title = element_text(size = 30),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the legend background color - this is the behind the legend
            legend.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnklePowerAbsorptionContributionvsMacroMorphology_InterlimbDifference.png', width = 6250, height = 6250, units = 'px' )

```







###### Ankle Support Moment Contribution vs Macromorphology, Group
```{r Braking Phase }




#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, aes(y = Mean_JointSupportMomentContribution_Braking_NoFlexorTorque/100, x = Mean_BetweenLimbTendonThickness_mm) ) +
      
 
    
    #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.01, xend = 0.01, y = 0.01, yend = 0.1 ), linewidth = 3, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
      
#Text explaining purpose of above arrow   
   geom_text( label = 'Involved > Non-Involved', size = 13, x = 0.75, y = 0.081, fontface = 'bold' ) +
 
    
   
   
    #Arrow segment from 0 to min of y-axis.
   geom_segment(  aes( x = 0.01, xend = 0.01, y = -0.01, yend = -0.1 ), linewidth = 3, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
      
#Text explaining purpose of above arrow   
   geom_text( label = 'Involved < Non-Involved', size = 13, x = 0.75, y = -0.095, fontface = 'bold' ) +
    
    
    
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_ID, color = Group_ID ), se = F, linewidth = 5 ) +
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Group_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

   
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits = c( 0, 4 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -0.1, 0.1, by = 0.02 ), limits =  c( -0.1, 0.1 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Between-Limb Difference in Ankle Contribution to Whole-Limb \n Support Moment vs Achilles Tendon Macromorphology \n  2.33 Hz Hopping - Braking Phase ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Interlimb Difference in Moment Contribution (Max = 1) ' ) +
   
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'ATx' = '#c51b7d',
                                 'Control' = '#4d9221',
                                    'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' =  0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      #Specify shapes
      scale_shape_manual( values = c( 'ATx' = 23,
                                 'Control' = 21 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 30, lineheight = 100),
            legend.title = element_text(size = 30),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the legend background color - this is the behind the legend
            legend.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleSupportMomentContributionvsMacroMorphology_InterlimbDifference_BrakingPhase.png', width = 6250, height = 6250, units = 'px' )

```

###### Ankle Average Angular Velocity vs Macromorphology, Group
```{r Braking Phase }




#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_BetweenLimbDiff_ATxParticipantMeans_Ankle_2.3Hz, aes(y = Mean_AverageJointAngVel_BrakingPhase, x = Mean_BetweenLimbTendonThickness_mm) ) +
      
 
    
    #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.01, xend = 0.01, y = 1, yend = 50 ), linewidth = 3, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
      
#Text explaining purpose of above arrow   
   geom_text( label = 'Involved > Non-Involved', size = 13, x = 0.75, y = 44, fontface = 'bold' ) +
 
    
   
   
    #Arrow segment from 0 to min of y-axis.
   geom_segment(  aes( x = 0.01, xend = 0.01, y = -1, yend = -20 ), linewidth = 3, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
      
#Text explaining purpose of above arrow   
   geom_text( label = 'Involved < Non-Involved', size = 13, x = 0.75, y = -19.5, fontface = 'bold' ) +
    
    
    
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_ID, color = Group_ID ), se = F, linewidth = 5 ) +
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Group_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

   
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits = c( 0, 4 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -20, 50, by = 10 ), limits = c( -20, 50 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Between-Limb Difference in Average Ankle Angular Velocity \n vs Achilles Tendon Macromorphology \n  2.33 Hz Hopping - Braking Phase ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = expression( paste( ' Interlimb Difference in Average Angular Velocity (', degree, '/s)' ) ) ) +
   
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'ATx' = '#c51b7d',
                                 'Control' = '#4d9221',
                                    'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' =  0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      #Specify shapes
      scale_shape_manual( values = c( 'ATx' = 23,
                                 'Control' = 21 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 30, lineheight = 100),
            legend.title = element_text(size = 30),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the legend background color - this is the behind the legend
            legend.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AverageAnkleAngVelvsMacroMorphology_InterlimbDifference_BrakingPhase.png', width = 6250, height = 6250, units = 'px' )

```

##### 2 Groups, All Limbs - Regressions

###### Ankle Power Contribution vs Group, Age
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes(y = Mean_JointContribution_AveragePower_GenerationNeutralized, x = Age ) ) +
      
   #Scatter plot
   geom_point( aes( group = Group_ID, color = Participant_ID, shape = Group_ID ), size = 15 ) +
    
#Regression lines
         geom_smooth( formula = y ~ x, aes( group = Group_ID, color = Group_ID ), linewidth = 6, method = 'lm', se = F ) +
   
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( 20, 80, by = 5 ), limits =  c( 20, 80 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 30, 90, by = 10 ), limits =  c( 30, 90 ) ) +
   
   
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Power Absorption Contribution vs Group and Age  \n 2.33 Hz Hopping ', x = 'Age (years)', y = ' Ankle Power Absorption Contribution (max = 1) ' ) +


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41',
                                 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'ATx' = 18,
                                 'Control' = 19 ) ) +
      
      
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, color = c( 'ATx' = '#c51b7d','Control' = '#7fbc41'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnklePowerAbsorptionContributionvsGroupandAge_InvolvedvsMatchedDominance.png', width = 6000, height = 6000, units = 'px', limitsize = F )

```


####  MME with Individual Slopes

##### 2 Groups, All Limbs

###### Hop Height vs Limb

```{r Individual Hops }




#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Ankle_2.3Hz, aes(y = HoppingHeight_cm, x = Limb_ID ) ) +
    
 
    
    #     geom_text( label = 'ATx Involved Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    #     geom_text( label = expression(  'Absorption Work = -0.55* - 0.046' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # 
    # geom_text( label = 'ATx Non-Involved Limb Ankle', size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # geom_text( label = expression( ' Absorption Work = -0.55 - 0.014' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    #     geom_text( label = 'Control Matched Dominance Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    #     geom_text( label = expression( 'Absorption Work = -0.59 - 0.039' %*% 'Hop Height(cm)') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # geom_text( label = 'Control Contralateral Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # geom_text( label = expression( 'Absorption Work = -0.61 - 0.023' %*% 'Hop Height(cm)' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = 'ATx Involved Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.35 cm*', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # #Add Label for Non-Involved Limb Color
    # geom_text( label = 'ATx Non-Involved Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.39 cm*', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # #Add Label for Matched Dominance Limb Color
    # geom_text( label = 'Control Matched Dominance Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.66 cm', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # #Add Label for Contralateral Limb Color
    # geom_text( label = 'Control Contralateral Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.73 cm', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
 
 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = HopHeightAverages_FromRMME, aes( y  = Mean_HoppingHeight_cm, x = Limb_ID, fill = Limb_ID ), color = 'black' ) +
    
    #Use geom_signif to add significance bars 
    geom_signif( data = HopHeightvsLimb_2.3Hz_Braking_BothEffects_CI, aes( annotations = Label, y_position = YPosition, xmin = XMin, xmax = XMax, tip_length = c(0, rep(0.005, 3) ) ), manual = T, size = 4, textsize = 20, vjust = -0.1, fontface = 'bold', nudge_x = c(0.2, 0, 0, 0) ) +
 
    
      #Add label with Involved limb mean
   geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 1 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 1 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
    
 
      #Add label with Non-Involved limb mean
   geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 2 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 2 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
    
 
      #Add label with Matched Dominance limb mean
   geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 4 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 4 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
    
 
      #Add label with Contralateral limb mean
   geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 3 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 3 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID), size = 10*getME( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly, 'w_e'), stroke = 3*getME( RMME_HopHeightvsLimb_2.3Hz_Braking_RandomInterceptOnly, 'w_e') , color = 'black',  na.rm = T, position = position_jitter(seed = 1, height = 0, width = 0.25), shape = 21 )  +
       
   
    
#Add data points for participant means, based on RMME
         geom_point( data = HopHeightParticipantAverages_FromRMME, aes( x = Limb_ID, y  = Mean_HoppingHeight_cm, fill = Participant_ID), size = 40, colour = 'white', position = position_jitter(seed = 1, height = 0, width = 0.1), shape = 23 ) +

      
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ) +
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 5.5, by = 0.5 ), limits =  c( -0.2, 5.85 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Hop Height vs Limb  \n 2.33 Hz Hopping ', x = 'Limb ID', y = ' Hop Height (cm) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
    
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 50, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_HopHeight_All4Limbs_IndividualHops_NoGeomText.png', width = 15000, height = 10000, units = 'px', limitsize = F )

```





```{r Participant Means }




#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Ankle_2.3Hz, aes(y = HoppingHeight_cm, x = Limb_ID ) ) +
    
 
    
    #     geom_text( label = 'ATx Involved Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    #     geom_text( label = expression(  'Absorption Work = -0.55* - 0.046' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # 
    # geom_text( label = 'ATx Non-Involved Limb Ankle', size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # geom_text( label = expression( ' Absorption Work = -0.55 - 0.014' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    #     geom_text( label = 'Control Matched Dominance Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    #     geom_text( label = expression( 'Absorption Work = -0.59 - 0.039' %*% 'Hop Height(cm)') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # geom_text( label = 'Control Contralateral Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # geom_text( label = expression( 'Absorption Work = -0.61 - 0.023' %*% 'Hop Height(cm)' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = 'ATx Involved Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.35 cm*', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # #Add Label for Non-Involved Limb Color
    # geom_text( label = 'ATx Non-Involved Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.39 cm*', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # #Add Label for Matched Dominance Limb Color
    # geom_text( label = 'Control Matched Dominance Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.66 cm', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # #Add Label for Contralateral Limb Color
    # geom_text( label = 'Control Contralateral Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.73 cm', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
 
 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = HopHeightAverages_FromRMME, aes( y  = Mean_HoppingHeight_cm, x = Limb_ID, fill = Limb_ID ), color = 'black' ) +
    
    #Use geom_signif to add significance bars 
    geom_signif( data = HopHeightvsLimb_2.3Hz_Braking_BothEffects_CI, mapping = aes( annotations = Label, y_position = YPosition, xmin = XMin, xmax = XMax, tip_length = c(0, rep(0.005, 3) ) ), manual = T, size = 4, textsize = 20, vjust = -0.1, fontface = 'bold' ) +
 
   
    
      #Add label with Involved limb mean - Line 1
   geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 1 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 1 ], y = 4.35 ), size = 20, fontface = 'bold', data = HopHeightAverages_FromRMME[ 1, ] ) +
     
      #Add label with Involved limb CI - Line 2
   geom_text( label = paste0( '(95% CI:', round( HopHeightvsLimb_2.3Hz_Braking_BothEffects_CI$ConfidenceIntervalLowerlimit[ 1 ], digits = 2 ), ', ', round( HopHeightvsLimb_2.3Hz_Braking_BothEffects_CI$ConfidenceIntervalUpperlimits[ 1 ], digits = 2), ')' ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 1 ], y = 4.15 ), size = 20, fontface = 'bold', data = HopHeightAverages_FromRMME[ 1, ] ) +
    
 
   
     
      #Add label with Non-Involved limb mean
   geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 2 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 2 ], y = 4.25 ), size = 20, fontface = 'bold', data = HopHeightAverages_FromRMME[ 2, ] ) +
    
 
      #Add label with Matched Dominance limb mean
   geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 4 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 4 ], y = 4.25 ), size = 20, fontface = 'bold', data = HopHeightAverages_FromRMME[ 4, ] ) +
    
 
      #Add label with Contralateral limb mean
   geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 3 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 3 ], y = 4.25 ), size = 20, fontface = 'bold', data = HopHeightAverages_FromRMME[ 3, ] ) +
      
       
   
    
#Add data points for participant means, based on RMME
         geom_point( data = HopHeightParticipantAverages_FromRMME, aes( x = Limb_ID, y  = Mean_HoppingHeight_cm, fill = Participant_ID), size = 40, colour = 'white', position = position_jitter(seed = 1, height = 0, width = 0.1), shape = 23 ) +

      
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') ) +
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 5.5, by = 0.5 ), limits =  c( 0, 5.95 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Hop Height vs Limb  \n 2.33 Hz Hopping ', x = 'Limb ID', y = ' Hop Height (cm) ' ) +
   
   

       #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
   
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 50, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_HopHeight_All4Limbs_ParticipantMeans_NoGeomText.png', width = 15000, height = 10000, units = 'px', limitsize = F )

```



###### Ankle Work vs Hop Height, Limb
```{r Braking Phase }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_ParticipantMeans_Ankle_2.3Hz, aes(y = Mean_JointWork_Braking_GenerationNeutralized, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID,Limb_ID), nrow = 1 ) +
 
    #Add vertical line at x = 0
    geom_vline( xintercept = 0, size = 2.5, linetype = 'dashed' ) +
    
        geom_text( label = expression( 'ATx Involved Limb Ankle Contribution = 57.79* - 1.49' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0, y = 67, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold', na.rm = T ) +
    
    geom_text( label = expression( 'ATx Non-Involved Limb Ankle Contribution = 59.11* - 1.49' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0, y = 64, color = '#4d9221', nudge_y = -0.25, fontface = 'bold', na.rm = T ) +
    
        geom_text( label = expression( 'Control Matched Dominance Limb Ankle Contribution = 61.33 - 1.49' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0, y = 61, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold', alpha = 0.75, na.rm = T ) +
    
    geom_text( label = expression( 'Control Contralateral Limb Ankle Contribution = 64.64 - 1.49' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0, y = 57, color = '#4d9221', nudge_y = -0.25, fontface = 'bold', alpha = 0.75, na.rm = T ) +
   
    
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
   
   
   
    #Add Label for Involved Limb Color
    geom_text( label = 'ATx Involved Limb', size = 11, color = '#c51b7d', fontface = 'bold', x = -1, y = 70 ) +
   
    #Add Label for Non-Involved Limb Color
    geom_text( label = 'ATx Non-Involved Limb', size = 11, color = '#4d9221', fontface = 'bold', x = -1, y = 67 ) +
   
    #Add Label for Matched Dominance Limb Color
    geom_text( label = 'Control Matched Dominance Limb', size = 11, color = '#c51b7d', fontface = 'bold', x = -1, y = 64, alpha = 0.75 ) +
   
    #Add Label for Contralateral Limb Color
    geom_text( label = 'Control Contralateral Limb', size = 11, color = '#4d9221', fontface = 'bold', x = -1, y = 61, alpha = 0.75 ) +
    
   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      
   
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -1, 0, by = 0.1 ), limits =  c( -1, 0.2 ) ) +
   
   
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Absorption Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Ankle Absorption Work (J/kg) ' ) +


       #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
       
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
      
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Non-Involved' = '#4d9221','Control Contralateral' = '#4d9221','ATx Involved' = '#c51b7d','Control Matched Dominance' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionWorkvsHopHeightandLimb_All4Limbs.png', width = 15000, height = 10000, units = 'px', limitsize = F )

```


```{r Braking Phase - Individual Hops }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Ankle_2.3Hz, aes(y = JointWork_Braking_GenerationNeutralized, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID, factor(Limb_ID, levels = c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral' ) ) ), labeller = labeller( Group_ID = c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control'), Limb_ID = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ) ), nrow = 2 ) +
 
    #Add vertical line at x = 0
    geom_segment( x = 0, xend = 0, y = -1, yend = -0.09, size = 2.5, linetype = 'dashed' ) +
    
    # 
    #     geom_text( label = 'ATx Involved Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    #     geom_text( label = expression(  'Absorption Work = -0.55* - 0.046' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # 
    # 
    # 
    # geom_text( label = 'ATx Non-Involved Limb Ankle', size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # geom_text( label = expression( ' Absorption Work = -0.55 - 0.014' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # 
    #     geom_text( label = 'Control Matched Dominance Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    #     geom_text( label = expression( 'Absorption Work = -0.59 - 0.039' %*% 'Hop Height(cm)') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # 
    # geom_text( label = 'Control Contralateral Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # geom_text( label = expression( 'Absorption Work = -0.61 - 0.023' %*% 'Hop Height(cm)' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = 'ATx Involved Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.35 cm*', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # #Add Label for Non-Involved Limb Color
    # geom_text( label = 'ATx Non-Involved Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.39 cm*', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # #Add Label for Matched Dominance Limb Color
    # geom_text( label = 'Control Matched Dominance Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.66 cm', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # #Add Label for Contralateral Limb Color
    # geom_text( label = 'Control Contralateral Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.73 cm', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[1], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
 
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[2], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[3], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[4], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
    
    
    
    
    
 
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
   
   
   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), size = 10*getME( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e'), stroke = 3*getME( RMME_AnkleAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e') , color = 'black',  na.rm = T ) +
      

   
   
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -1, -0.1, by = 0.1 ), limits =  c( -1.2, -0.1 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Absorption Net Joint Moment Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Ankle Absorption Work (J/kg) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
        
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 40,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 40,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 40,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 50, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionWorkvsHopHeightandLimb_All4Limbs_IndividualHops_NoGeomText.png', width = 12000, height = 12000, units = 'px', limitsize = F )

```


###### Knee Work vs Hop Height, Limb
```{r Braking Phase - Individual Hops }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Knee_2.3Hz, aes(y = JointWork_Braking_GenerationNeutralized, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID, factor(Limb_ID, levels = c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral' ) ) ), labeller = labeller( Group_ID = c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control'), Limb_ID = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ) ), nrow = 2 ) +
 
    #Add vertical line at x = 0
    geom_segment( x = 0, xend = 0, y = -1, yend = -0.09, size = 2.5, linetype = 'dashed' ) +
    
    # 
    #     geom_text( label = 'ATx Involved Limb Knee' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    #     geom_text( label = expression(  'Absorption Work = -0.55* - 0.046' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # 
    # 
    # 
    # geom_text( label = 'ATx Non-Involved Limb Knee', size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # geom_text( label = expression( ' Absorption Work = -0.55 - 0.014' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # 
    #     geom_text( label = 'Control Matched Dominance Limb Knee' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    #     geom_text( label = expression( 'Absorption Work = -0.59 - 0.039' %*% 'Hop Height(cm)') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # 
    # geom_text( label = 'Control Contralateral Limb Knee' , size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # geom_text( label = expression( 'Absorption Work = -0.61 - 0.023' %*% 'Hop Height(cm)' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = 'ATx Involved Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.35 cm*', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # #Add Label for Non-Involved Limb Color
    # geom_text( label = 'ATx Non-Involved Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.39 cm*', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # #Add Label for Matched Dominance Limb Color
    # geom_text( label = 'Control Matched Dominance Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.66 cm', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # #Add Label for Contralateral Limb Color
    # geom_text( label = 'Control Contralateral Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.73 cm', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[1], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
 
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[2], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[3], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[4], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
    
    
    
    
    
 
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
   
   
   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), size = 10*getME( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e'), stroke = 3*getME( RMME_KneeAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e') , color = 'black',  na.rm = T ) +
      

   
   
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -1, -0.1, by = 0.1 ), limits =  c( -1.2, -0.1 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Knee Absorption Net Joint Moment Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Knee Absorption Work (J/kg) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
        
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 40,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 40,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 40,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 50, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_KneeAbsorptionWorkvsHopHeightandLimb_All4Limbs_IndividualHops_NoGeomText.png', width = 12000, height = 12000, units = 'px', limitsize = F )

```





###### Hip Work vs Hop Height, Limb
```{r Braking Phase - Individual Hops }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Hip_2.3Hz, aes(y = JointWork_Braking_GenerationNeutralized, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID, factor(Limb_ID, levels = c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral' ) ) ), labeller = labeller( Group_ID = c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control'), Limb_ID = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ) ), nrow = 2 ) +
 
    #Add vertical line at x = 0
    geom_segment( x = 0, xend = 0, y = -1, yend = -0.09, size = 2.5, linetype = 'dashed' ) +
    
    # 
    #     geom_text( label = 'ATx Involved Limb Hip' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    #     geom_text( label = expression(  'Absorption Work = -0.55* - 0.046' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # 
    # 
    # 
    # geom_text( label = 'ATx Non-Involved Limb Hip', size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # geom_text( label = expression( ' Absorption Work = -0.55 - 0.014' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # 
    #     geom_text( label = 'Control Matched Dominance Limb Hip' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    #     geom_text( label = expression( 'Absorption Work = -0.59 - 0.039' %*% 'Hop Height(cm)') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # 
    # geom_text( label = 'Control Contralateral Limb Hip' , size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # geom_text( label = expression( 'Absorption Work = -0.61 - 0.023' %*% 'Hop Height(cm)' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = 'ATx Involved Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.35 cm*', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # #Add Label for Non-Involved Limb Color
    # geom_text( label = 'ATx Non-Involved Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.39 cm*', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # #Add Label for Matched Dominance Limb Color
    # geom_text( label = 'Control Matched Dominance Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.66 cm', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # #Add Label for Contralateral Limb Color
    # geom_text( label = 'Control Contralateral Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.73 cm', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[1], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
 
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[2], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[3], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = 'Mean Hop Height = ', x = 1.4, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[4], digits = 2), ' cm' ), x = 1.4, y = -0.175, size = 16, fontface = 'bold' ) +
    
    
    
    
    
 
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
   
   
   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), size = 10*getME( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e'), stroke = 3*getME( RMME_HipAbsorptionWorkvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e') , color = 'black',  na.rm = T ) +
      

   
   
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -1, -0.1, by = 0.1 ), limits =  c( -1.2, -0.1 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Hip Absorption Net Joint Moment Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Hip Absorption Work (J/kg) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
        
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 40,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 40,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 40,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 50, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_HipAbsorptionWorkvsHopHeightandLimb_All4Limbs_IndividualHops_NoGeomText.png', width = 12000, height = 12000, units = 'px', limitsize = F )

```




###### Ankle Power Contribution vs Hop Height, Limb
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_ParticipantMeans_Ankle_2.3Hz, aes(y = Mean_JointContribution_AveragePower_GenerationNeutralized/100, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
      
    facet_wrap( vars(Group_ID, Limb_ID), labeller = labeller( Group_ID = c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control'), Limb_ID = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ) ), nrow = 2 ) +
 
    
    #Add vertical line at x = 0
    geom_segment( x = 0, xend = 0, y = 0.9, yend = 1, size = 2.5, linetype = 'dashed' ) +
    
   
   
   
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = 'Mean Hop Height = ', x = 1.8, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[1], digits = 2), ' cm' ), x = 1.8, y = -0.16, size = 16, fontface = 'bold' ) +
 
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = 'Mean Hop Height = ', x = 1.8, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[2], digits = 2), ' cm' ), x = 1.8, y = -0.16, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = 'Mean Hop Height = ', x = 1.8, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[3], digits = 2), ' cm' ), x = 1.8, y = -0.16, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
    #Arrow segment pointing at x = 0 
   geom_segment( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), aes( x = 0.5, xend = 0.1, y = -0.14, yend  = -0.14 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = 'Mean Hop Height = ', x = 1.8, y = -0.125, size = 16, fontface = 'bold' ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[4], digits = 2), ' cm' ), x = 1.8, y = -0.16, size = 16, fontface = 'bold' ) +
    
    
   
   
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 3 ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 3 ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 3 ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 3 ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID), linewidth = 12 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +
 
   
   

   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), size = 10, stroke = 3, color = 'black',  na.rm = T ) +
      
   
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0.1, 0.90, by = 0.10 ), limits =  c( -0.05, 0.90 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Contribution to Whole-Limb Absorption Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Ankle Contribution (%) ' ) +


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
      
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionContributionvsHopHeightandLimb_All4Limbs_ParticipantMeans_2Rows.png', width = 15000, height = 10000, units = 'px', limitsize = F )

```



```{r Braking Phase - Individual Hops }




#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Ankle_2.3Hz, aes(y = JointContribution_AveragePower_GenerationNeutralized/100, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID, Limb_ID), labeller = labeller( Group_ID = c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control'), Limb_ID = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ) ), nrow = 2 ) +
 
    
    #Add vertical line at x = 0
    geom_segment( x = 0, xend = 0, y = 0.9, yend = 0.1, size = 2.5, linetype = 'dashed' ) +
    
    # 
    #     geom_text( label = 'ATx Involved Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    #     geom_text( label = expression(  'Absorption Work = -0.55* - 0.046' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # 
    # 
    # 
    # geom_text( label = 'ATx Non-Involved Limb Ankle', size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # geom_text( label = expression( ' Absorption Work = -0.55 - 0.014' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # 
    #     geom_text( label = 'Control Matched Dominance Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    #     geom_text( label = expression( 'Absorption Work = -0.59 - 0.039' %*% 'Hop Height(cm)') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # 
    # geom_text( label = 'Control Contralateral Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # geom_text( label = expression( 'Absorption Work = -0.61 - 0.023' %*% 'Hop Height(cm)' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = 'ATx Involved Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.35 cm*', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # #Add Label for Non-Involved Limb Color
    # geom_text( label = 'ATx Non-Involved Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.39 cm*', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # #Add Label for Matched Dominance Limb Color
    # geom_text( label = 'Control Matched Dominance Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.66 cm', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # #Add Label for Contralateral Limb Color
    # geom_text( label = 'Control Contralateral Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.73 cm', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    
    #Arrow segment pointing at x = 0 
   geom_segment( aes( x = 0.5, xend = 0.1, y = 0.15, yend = 0.15 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[1], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
 
    
    
    
    
    
    
    
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[2], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[3], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[4], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
    
    
    
    
    
 
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
   
   
   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), size = 10*getME( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e'), stroke = 3*getME( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e') , color = 'black',  na.rm = T ) +
      

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0.1, 0.90, by = 0.10 ), limits =  c( -0.05, 0.90 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Contribution to Whole-Limb Absorption Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Ankle Contribution (%) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
  
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 70,hjust = 0.5,face = 'bold',family = 'Arial Bold'),
            axis.title.x = element_text(size = 65,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.title.y.left = element_text(size = 65,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.title.y.right = element_text(size = 65,face = 'bold.italic',family = 'Arial Bold Italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic',family = 'Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 55, face = 'bold',family = 'Arial Bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionContributionvsHopHeightandLimb_All4Limbs_IndividualHops_2Rows.png', width = 12000, height = 12000, units = 'px', limitsize = F )

```







```{r Braking Phase - Individual Hops - 4 Rows }



AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME <- data.frame( Group_ID = rep( 'Group', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Participant_ID = rep( 'Participant', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), Limb_ID = rep( 'Limb', length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ), JointContribution_AveragePower_GenerationNeutralized = rep( 0, length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ),  HoppingHeight_cm_LimbMeanCentered = rep( 0, length( unique( Power_Ankle_2.3Hz$Participant_ID ) )*2 ))



UniqueParticipant <- unique( Power_Ankle_2.3Hz$Participant_ID )

RowtoFill <- 1

for ( k in 1 : length( UniqueParticipant ) ) {
      
   #Filter out Participant K - only retain Participant K data from Power_Ankle_2.3Hz
   Power_Ankle_2.3Hz_ParticipantKOnly <- Power_Ankle_2.3Hz %>%
      filter( Participant_ID ==  UniqueParticipant[ k ] )
   
   #Create a vector containing the Limb IDs for Participant K
   UniqueLimb <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Limb_ID_Unfactored  )
   
   #Create a vector containing the Group for Participant K
   UniqueGroup <- unique( Power_Ankle_2.3Hz_ParticipantKOnly$Group_ID  )
   
   for ( l in 1 : length( UniqueLimb ) ) {
      
      
      #Filter out Limb K - only retain Participant K, Limb L data from Power_Ankle_2.3Hz
      Power_Ankle_2.3Hz_ParticipantKLimbLOnly <- Power_Ankle_2.3Hz_ParticipantKOnly %>%
         filter( Limb_ID ==  UniqueLimb[ l ] )
      
      #Add Participant K's Participant ID
      AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME$Group_ID[ RowtoFill ] <- UniqueGroup
   
      #Add Participant K's Participant ID
      AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME$Participant_ID[ RowtoFill ] <- UniqueParticipant[ k ]
      
      #Add Participant K's Lth Limb ID
      AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME$Limb_ID[ RowtoFill ] <- UniqueLimb[ l ]
      

      AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME$JointContribution_AveragePower_GenerationNeutralized[ RowtoFill ] <- mean( Power_Ankle_2.3Hz_ParticipantKLimbLOnly$JointContribution_AveragePower_GenerationNeutralized )
           
      AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME$HoppingHeight_cm_LimbMeanCentered[ RowtoFill ] <- mean( Power_Ankle_2.3Hz_ParticipantKLimbLOnly$HoppingHeight_cm_LimbMeanCentered )
   
      #Add 1 to fill next row on next loop iteration
      RowtoFill <- RowtoFill+1
      
   }#End L for loop
   
}#End K for loop





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Ankle_2.3Hz, aes(y = JointContribution_AveragePower_GenerationNeutralized, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID, Limb_ID), labeller = labeller( Group_ID = c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control'), Limb_ID = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ) ), nrow = 4 ) +
 
    
    #Add vertical line at x = 0
    geom_segment( x = 0, xend = 0, y = 90, yend = 10, size = 2.5, linetype = 'dashed' ) +
    

      
      
    
    #Arrow segment pointing at x = 0 
   geom_segment( aes( x = 0.3, xend = 0.05, y = 15, yend = 15 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = 'Mean Hop Height = ', x = 0.95, y = 21, size = 20, fontface = 'bold',family = 'Arial Bold' ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[1], digits = 2), ' cm' ), x = 0.95, y = 13, size = 20, fontface = 'bold',family = 'Arial Bold' ) +
 
    
    
    
    
    
    
    
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = 'Mean Hop Height = ', x = 0.95, y = 21, size = 20, fontface = 'bold',family = 'Arial Bold' ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[2], digits = 2), ' cm' ), x = 0.95, y = 13, size = 20, fontface = 'bold',family = 'Arial Bold' ) +
    
    
    
    
    
    
    
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = 'Mean Hop Height = ', x = 0.95, y = 21, size = 20, fontface = 'bold',family = 'Arial Bold' ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[3], digits = 2), ' cm' ), x = 0.95, y = 13, size = 20, fontface = 'bold',family = 'Arial Bold' ) +
    
    
    
    
    
    
    
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = 'Mean Hop Height = ', x = 0.95, y = 21, size = 20, fontface = 'bold',family = 'Arial Bold' ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[4], digits = 2), ' cm' ), x = 0.95, y = 13, size = 20, fontface = 'bold',family = 'Arial Bold' ) +
    
    
    
    
    
 
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID), linewidth = 12 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +
   
   
   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), size = 10*getME( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e'), stroke = 3*getME( RMME_AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e') , color = 'black',  na.rm = T ) +
      

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 10, 90, by = 10 ), limits =  c( -5, 90 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Contribution to Whole-Limb Absorption Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Ankle Contribution (%) ' ) +
   
   

       #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
       
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 70,hjust = 0.5,face = 'bold',family = 'Arial Bold'),
            axis.title.x = element_text(size = 75,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.title.y.left = element_text(size = 75,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.title.y.right = element_text(size = 75,face = 'bold.italic',family = 'Arial Bold Italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 50,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.text.y.right = element_text(size = 50,color = 'darkred',face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic',family = 'Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 65, face = 'bold',family = 'Arial Bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionContributionvsHopHeightandLimb_All4Limbs_IndividualHops_4Rowsv2.png', width = 10500, height = 15000, units = 'px', limitsize = F )

```




###### Knee Power Contribution vs Hop Height, Limb
```{r Braking Phase - Individual Hops }




#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Knee_2.3Hz, aes(y = JointContribution_AveragePower_GenerationNeutralized/100, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID, Limb_ID), labeller = labeller( Group_ID = c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control'), Limb_ID = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ) ), nrow = 2 ) +
 
    
    #Add vertical line at x = 0
    geom_segment( x = 0, xend = 0, y = 0.9, yend = 0.1, size = 2.5, linetype = 'dashed' ) +
    
    # 
    #     geom_text( label = 'ATx Involved Limb Knee' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    #     geom_text( label = expression(  'Absorption Work = -0.55* - 0.046' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # 
    # 
    # 
    # geom_text( label = 'ATx Non-Involved Limb Knee', size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # geom_text( label = expression( ' Absorption Work = -0.55 - 0.014' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # 
    #     geom_text( label = 'Control Matched Dominance Limb Knee' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    #     geom_text( label = expression( 'Absorption Work = -0.59 - 0.039' %*% 'Hop Height(cm)') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # 
    # geom_text( label = 'Control Contralateral Limb Knee' , size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # geom_text( label = expression( 'Absorption Work = -0.61 - 0.023' %*% 'Hop Height(cm)' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = 'ATx Involved Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.35 cm*', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # #Add Label for Non-Involved Limb Color
    # geom_text( label = 'ATx Non-Involved Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.39 cm*', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # #Add Label for Matched Dominance Limb Color
    # geom_text( label = 'Control Matched Dominance Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.66 cm', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # #Add Label for Contralateral Limb Color
    # geom_text( label = 'Control Contralateral Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.73 cm', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Knee_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    
    #Arrow segment pointing at x = 0 
   geom_segment( aes( x = 0.5, xend = 0.1, y = 0.15, yend = 0.15 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[1], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
 
    
    
    
    
    
    
    
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[2], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[3], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[4], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
    
    
    
    
    
 
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
   
   
   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), size = 10*getME( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e'), stroke = 3*getME( RMME_KneeAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e') , color = 'black',  na.rm = T ) +
      

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = KneeAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0.1, 0.90, by = 0.10 ), limits =  c( -0.05, 0.90 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Knee Contribution to Whole-Limb Absorption Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Knee Contribution (%) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
  
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 70,hjust = 0.5,face = 'bold',family = 'Arial Bold'),
            axis.title.x = element_text(size = 65,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.title.y.left = element_text(size = 65,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.title.y.right = element_text(size = 65,face = 'bold.italic',family = 'Arial Bold Italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic',family = 'Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 55, face = 'bold',family = 'Arial Bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_KneeAbsorptionContributionvsHopHeightandLimb_All4Limbs_IndividualHops_2Rows.png', width = 12000, height = 12000, units = 'px', limitsize = F )

```









###### Hip Power Contribution vs Hop Height, Limb
```{r Braking Phase - Individual Hops }




#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Hip_2.3Hz, aes(y = JointContribution_AveragePower_GenerationNeutralized/100, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID, Limb_ID), labeller = labeller( Group_ID = c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control'), Limb_ID = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ) ), nrow = 2 ) +
 
    
    #Add vertical line at x = 0
    geom_segment( x = 0, xend = 0, y = 0.9, yend = 0.1, size = 2.5, linetype = 'dashed' ) +
    
    # 
    #     geom_text( label = 'ATx Involved Limb Hip' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    #     geom_text( label = expression(  'Absorption Work = -0.55* - 0.046' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # 
    # 
    # 
    # geom_text( label = 'ATx Non-Involved Limb Hip', size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # geom_text( label = expression( ' Absorption Work = -0.55 - 0.014' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # 
    #     geom_text( label = 'Control Matched Dominance Limb Hip' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    #     geom_text( label = expression( 'Absorption Work = -0.59 - 0.039' %*% 'Hop Height(cm)') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # 
    # geom_text( label = 'Control Contralateral Limb Hip' , size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # geom_text( label = expression( 'Absorption Work = -0.61 - 0.023' %*% 'Hop Height(cm)' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = 'ATx Involved Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.35 cm*', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # #Add Label for Non-Involved Limb Color
    # geom_text( label = 'ATx Non-Involved Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.39 cm*', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # #Add Label for Matched Dominance Limb Color
    # geom_text( label = 'Control Matched Dominance Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.66 cm', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # #Add Label for Contralateral Limb Color
    # geom_text( label = 'Control Contralateral Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.73 cm', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Hip_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    
    #Arrow segment pointing at x = 0 
   geom_segment( aes( x = 0.5, xend = 0.1, y = 0.15, yend = 0.15 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[1], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
 
    
    
    
    
    
    
    
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[2], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[3], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
    
    
    
    
    
    
    
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = 'Mean Hop Height = ', x = 1.4, y = 0.175, size = 16, fontface = 'bold' ) +
 
 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[4], digits = 2), ' cm' ), x = 1.4, y = 0.125, size = 16, fontface = 'bold' ) +
    
    
    
    
    
 
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2 ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID), linewidth = 15 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 15 ) +
   
   
   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), size = 10*getME( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e'), stroke = 3*getME( RMME_HipAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e') , color = 'black',  na.rm = T ) +
      

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = HipAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0.1, 0.90, by = 0.10 ), limits =  c( -0.05, 0.90 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Hip Contribution to Whole-Limb Absorption Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Hip Contribution (%) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 
                                    'ATx07' = met.brewer('OKeeffe1')[1],
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'ATx74' = met.brewer('OKeeffe1')[7],
                                    'ATx65' = met.brewer('OKeeffe1')[8],
                                    'ATx14' = met.brewer('OKeeffe1')[9],
                                    'ATx39' = met.brewer('OKeeffe1')[10],
                                    'ATx66' = met.brewer('OKeeffe1')[11],
                                    'ATx75' = met.brewer('OKeeffe1')[1],
                                    'ATx100' = met.brewer('OKeeffe1')[2],
                                    'ATx108' = met.brewer('OKeeffe1')[3],
                                    'ATx28' = met.brewer('OKeeffe1')[4],
                                    'HC19' = met.brewer('OKeeffe1')[2],#match with ATx08
                                    'HC12' = met.brewer('OKeeffe1')[1],#match with ATx38 
                                    'HC05' = met.brewer('OKeeffe1')[4],#match with ATx12
                                    'HC06' = met.brewer('OKeeffe1')[5],#match with ATx17
                                    'HC20' = met.brewer('OKeeffe1')[7],#match with ATx19
                                    'HC11' = met.brewer('OKeeffe1')[7],#match with ATx34
                                    'HC17' = met.brewer('OKeeffe1')[9],#match with ATx24
                                    'HC21' = met.brewer('OKeeffe1')[11],#match with ATx27
                                    'HC25' = met.brewer('OKeeffe1')[10],#match with ATx39
                                    'HC18' = met.brewer('OKeeffe1')[8],#match with ATx21
                                    'HC45' = met.brewer('OKeeffe1')[6],#match with ATx18
                                    'HC42' = met.brewer('OKeeffe1')[9],#match with ATx14
                                    'HC48' = met.brewer('OKeeffe1')[3],#match with ATx44
                                    'HC44' = met.brewer('OKeeffe1')[6],#match with ATx49
                                    'HC65' = met.brewer('OKeeffe1')[2],#match with ATx100
                                    'HC67' = met.brewer('OKeeffe1')[2],#match with ATx41
                                    'HC68' = met.brewer('OKeeffe1')[4],#match with ATx50
                                    'HC30' = met.brewer('OKeeffe1')[3],#match with ATx10
                                    'HC31' = met.brewer('OKeeffe1')[5],#match with ATx36
                                    'HC32' = met.brewer('OKeeffe1')[4] ),#match with ATx28,
                        labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'ATx74' = 0.75,
                                    'ATx65' = 0.75,
                                    'ATx14' = 0.75,
                                    'ATx39' = 0.75,
                                    'ATx66' = 0.5,
                                    'ATx75' = 0.5,
                                    'ATx100' = 0.5,
                                    'ATx108' = 0.5,
                                    'ATx28' = 0.5,
                                    
                                    'HC19' = 1,#match with ATx08
                                    'HC12' = 0.75,#match with ATx38 
                                    'HC05' = 1,#match with ATx12
                                    'HC06' = 1,#match with ATx17
                                    'HC20' = 1,#match with ATx19
                                    'HC11' = 0.75,#match with ATx34
                                    'HC17' = 1,#match with ATx24
                                    'HC21' = 1,#match with ATx27
                                    'HC25' = 0.75,#match with ATx39
                                    'HC18' = 1,#match with ATx21
                                    'HC45' = 1,#match with ATx18
                                    'HC42' = 0.75,#match with ATx14
                                    'HC48' = 0.75,#match with ATx44
                                    'HC44' = 0.75,#match with ATx49
                                    'HC65' = 0.5,#match with ATx100
                                    'HC67' = 0.75,#match with ATx41
                                    'HC68' = 0.75,#match with ATx50
                                    'HC30' = 1,#match with ATx10
                                    'HC31' = 0.75,#match with ATx36
                                    'HC32' = 0.5 )#match with ATx28 
                          ) +
  
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 70,hjust = 0.5,face = 'bold',family = 'Arial Bold'),
            axis.title.x = element_text(size = 65,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.title.y.left = element_text(size = 65,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.title.y.right = element_text(size = 65,face = 'bold.italic',family = 'Arial Bold Italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic',family = 'Arial Bold Italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic',family = 'Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 55, face = 'bold',family = 'Arial Bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_HipAbsorptionContributionvsHopHeightandLimb_All4Limbs_IndividualHops_2Rows.png', width = 12000, height = 12000, units = 'px', limitsize = F )

```





###### Ankle Torque Impulse vs Hop Height, Limb
```{r Braking Phase }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_ParticipantMeans_Ankle_2.3Hz, aes(y = Mean_JointTorqueImpulse_Braking_Sagittal_NoFlexTorqn, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID,Limb_ID), nrow = 1 ) +
 
    #Add vertical line at x = 0
    geom_vline( xintercept = 0, size = 2.5, linetype = 'dashed' ) +
    
        geom_text( label = expression( 'ATx Involved Limb Ankle Contribution = 57.79* - 1.49' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0, y = 67, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold', na.rm = T ) +
    
    geom_text( label = expression( 'ATx Non-Involved Limb Ankle Contribution = 59.11* - 1.49' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0, y = 64, color = '#4d9221', nudge_y = -0.25, fontface = 'bold', na.rm = T ) +
    
        geom_text( label = expression( 'Control Matched Dominance Limb Ankle Contribution = 61.33 - 1.49' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0, y = 61, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold', alpha = 0.75, na.rm = T ) +
    
    geom_text( label = expression( 'Control Contralateral Limb Ankle Contribution = 64.64 - 1.49' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0, y = 57, color = '#4d9221', nudge_y = -0.25, fontface = 'bold', alpha = 0.75, na.rm = T ) +
   
    
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
   
   
   
    #Add Label for Involved Limb Color
    geom_text( label = 'ATx Involved Limb', size = 11, color = '#c51b7d', fontface = 'bold', x = -1, y = 70 ) +
   
    #Add Label for Non-Involved Limb Color
    geom_text( label = 'ATx Non-Involved Limb', size = 11, color = '#4d9221', fontface = 'bold', x = -1, y = 67 ) +
   
    #Add Label for Matched Dominance Limb Color
    geom_text( label = 'Control Matched Dominance Limb', size = 11, color = '#c51b7d', fontface = 'bold', x = -1, y = 64, alpha = 0.75 ) +
   
    #Add Label for Contralateral Limb Color
    geom_text( label = 'Control Contralateral Limb', size = 11, color = '#4d9221', fontface = 'bold', x = -1, y = 61, alpha = 0.75 ) +
    
   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      
   
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -1, 0, by = 0.1 ), limits =  c( -1, 0.2 ) ) +
   
   
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Absorption Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Ankle Absorption Work (J/kg) ' ) +


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
      
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Non-Involved' = '#4d9221','Control Contralateral' = '#4d9221','ATx Involved' = '#c51b7d','Control Matched Dominance' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionTorqueImpulsevsHopHeightandLimb_All4Limbs.png', width = 15000, height = 10000, units = 'px', limitsize = F )

```



```{r Braking Phase - Individual Hops }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Ankle_2.3Hz, aes(y = JointTorqueImpulse_Braking_Sagittal_NoFlexTorq, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID, factor(Limb_ID, levels = c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral' ) ) ), labeller = labeller( Group_ID = c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control'), Limb_ID = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ) ), nrow = 1 ) +
 
    #Add vertical line at x = 0
    geom_segment( x = 0, xend = 0, y = -0.325, yend = -0.075, size = 2.5, linetype = 'dashed' ) +
    
    # 
    #     geom_text( label = 'ATx Involved Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    #     geom_text( label = expression(  'Absorption Work = -0.55* - 0.046' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # 
    # 
    # 
    # geom_text( label = 'ATx Non-Involved Limb Ankle', size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # geom_text( label = expression( ' Absorption Work = -0.55 - 0.014' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # 
    #     geom_text( label = 'Control Matched Dominance Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    #     geom_text( label = expression( 'Absorption Work = -0.59 - 0.039' %*% 'Hop Height(cm)') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # 
    # geom_text( label = 'Control Contralateral Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # geom_text( label = expression( 'Absorption Work = -0.61 - 0.023' %*% 'Hop Height(cm)' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = 'ATx Involved Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.35 cm*', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # #Add Label for Non-Involved Limb Color
    # geom_text( label = 'ATx Non-Involved Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.39 cm*', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # #Add Label for Matched Dominance Limb Color
    # geom_text( label = 'Control Matched Dominance Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.66 cm', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # #Add Label for Contralateral Limb Color
    # geom_text( label = 'Control Contralateral Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.73 cm', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +

 
 
 
 
 
    #Arrow segment pointing at x = 0
   geom_segment( aes( x = 0.5, xend = 0.1, y = -0.085, yend  = -0.085 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +

 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = 'Mean Hop Height = ', x = 1.8, y = -0.080, size = 16, fontface = 'bold' ) +

 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[1], digits = 2), ' cm' ), x = 1.8, y = -0.090, size = 16, fontface = 'bold' ) +








 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = 'Mean Hop Height = ', x = 1.8, y = -0.080, size = 16, fontface = 'bold' ) +

 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[2], digits = 2), ' cm' ), x = 1.8, y = -0.090, size = 16, fontface = 'bold' ) +







 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = 'Mean Hop Height = ', x = 1.8, y = -0.080, size = 16, fontface = 'bold' ) +

 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[3], digits = 2), ' cm' ), x = 1.8, y = -0.090, size = 16, fontface = 'bold' ) +








 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = 'Mean Hop Height = ', x = 1.8, y = -0.080, size = 16, fontface = 'bold' ) +

 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[4], digits = 2), ' cm' ), x = 1.8, y = -0.090, size = 16, fontface = 'bold' ) +







#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +



#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +



#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +



#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +



   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +



   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +



   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID), linewidth = 12 ) +



   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +


   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID), size = 10*getME( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e'), stroke = 3*getME( RMME_AnkleSagittalTorqueImpulsevsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e') , color = 'black',  na.rm = T ) +
      

   
   
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -0.325, -0.075, by = 0.025 ), limits =  c( -0.375, -0.075 ) ) +
   
 
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Sagittal Torque Impulse vs Hop Height  \n 2.33 Hz Hopping - Braking Phase ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Ankle Sagittal Torque Impulse (N*s/kg) [ - = Plantar Flexor Torque ] ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[7],
                                    'HC18' = met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 40,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 40,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 40,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 50, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleSagittalTorqueImpulsevsHopHeightandLimb_All4Limbs_IndividualHops.png', width = 15000, height = 10000, units = 'px', limitsize = F )

```



###### Ankle Average Sagittal Ang Vel vs Hop Height, Limb
```{r Braking Phase }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_ParticipantMeans_Ankle_2.3Hz, aes(y = Mean_AverageJointAngVel_BrakingPhase, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID,Limb_ID), nrow = 1 ) +
 
    #Add vertical line at x = 0
    geom_vline( xintercept = 0, size = 2.5, linetype = 'dashed' ) +
    
        geom_text( label = expression( 'ATx Involved Limb Ankle Contribution = 57.79* - 1.49' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0, y = 67, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold', na.rm = T ) +
    
    geom_text( label = expression( 'ATx Non-Involved Limb Ankle Contribution = 59.11* - 1.49' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0, y = 64, color = '#4d9221', nudge_y = -0.25, fontface = 'bold', na.rm = T ) +
    
        geom_text( label = expression( 'Control Matched Dominance Limb Ankle Contribution = 61.33 - 1.49' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0, y = 61, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold', alpha = 0.75, na.rm = T ) +
    
    geom_text( label = expression( 'Control Contralateral Limb Ankle Contribution = 64.64 - 1.49' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0, y = 57, color = '#4d9221', nudge_y = -0.25, fontface = 'bold', alpha = 0.75, na.rm = T ) +
   
    
    
#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
   
    
    
#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
   
    
    
#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
   
    
    
#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 0.75 ) +
    
    
    
   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
    
    
    
   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
    
    
    
   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
    
    
    
   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( AnkleAbsorptionContributionvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = 'Limb_ID' ), linewidth = 10 ) +
   
   
   
    #Add Label for Involved Limb Color
    geom_text( label = 'ATx Involved Limb', size = 11, color = '#c51b7d', fontface = 'bold', x = -1, y = 70 ) +
   
    #Add Label for Non-Involved Limb Color
    geom_text( label = 'ATx Non-Involved Limb', size = 11, color = '#4d9221', fontface = 'bold', x = -1, y = 67 ) +
   
    #Add Label for Matched Dominance Limb Color
    geom_text( label = 'Control Matched Dominance Limb', size = 11, color = '#c51b7d', fontface = 'bold', x = -1, y = 64, alpha = 0.75 ) +
   
    #Add Label for Contralateral Limb Color
    geom_text( label = 'Control Contralateral Limb', size = 11, color = '#4d9221', fontface = 'bold', x = -1, y = 61, alpha = 0.75 ) +
    
   
   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      
   
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -1, 0, by = 0.1 ), limits =  c( -1, 0.2 ) ) +
   
   
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Absorption Work vs Hop Height  \n 2.33 Hz Hopping ', x = 'Limb-Mean Centered Hop Height (cm)', y = ' Ankle Absorption Work (J/kg) ' ) +


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
      
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Non-Involved' = '#4d9221','Control Contralateral' = '#4d9221','ATx Involved' = '#c51b7d','Control Matched Dominance' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionTorqueImpulsevsHopHeightandLimb_All4Limbs.png', width = 15000, height = 10000, units = 'px', limitsize = F )

```



```{r Braking Phase - Individual Hops }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Power_Ankle_2.3Hz, aes(y = AverageJointAngVel_BrakingPhase, x = HoppingHeight_cm_LimbMeanCentered ) ) +
      
    facet_wrap( vars(Group_ID, factor(Limb_ID, levels = c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral' ) ) ), labeller = labeller( Group_ID = c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control'), Limb_ID = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ) ), nrow = 1 ) +
 
    #Add vertical line at x = 0
    geom_segment( x = 0, xend = 0, y = 60, yend = 250, size = 2.5, linetype = 'dashed' ) +
    
    # 
    #     geom_text( label = 'ATx Involved Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    #     geom_text( label = expression(  'Absorption Work = -0.55* - 0.046' %*% 'Hop Height(cm)*') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # 
    # 
    # 
    # geom_text( label = 'ATx Non-Involved Limb Ankle', size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # geom_text( label = expression( ' Absorption Work = -0.55 - 0.014' %*% 'Hop Height(cm)*' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # 
    #     geom_text( label = 'Control Matched Dominance Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    #     geom_text( label = expression( 'Absorption Work = -0.59 - 0.039' %*% 'Hop Height(cm)') , parse = T, size = 13, x = 0.5, y = -0.035, color = '#c51b7d', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # 
    # geom_text( label = 'Control Contralateral Limb Ankle' , size = 13, x = 0.5, y = -0.015, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # geom_text( label = expression( 'Absorption Work = -0.61 - 0.023' %*% 'Hop Height(cm)' ), parse = T, size = 13, x = 0.5, y = -0.035, color = '#4d9221', nudge_y = -0.25, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # 
    # 
    # 
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = 'ATx Involved Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.35 cm*', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Involved' ) ) +
    # 
    # 
    # #Add Label for Non-Involved Limb Color
    # geom_text( label = 'ATx Non-Involved Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.39 cm*', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Non-Involved' ) ) +
    # 
    # 
    # 
    # #Add Label for Matched Dominance Limb Color
    # geom_text( label = 'Control Matched Dominance Limb Mean Hop Height', size = 13, color = '#c51b7d', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' =  1.66 cm', size = 13, color = '#c51b7d', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Matched Dominance' ) ) +
    # 
    # 
    # 
    # #Add Label for Contralateral Limb Color
    # geom_text( label = 'Control Contralateral Limb Mean Hop Height', size = 13, color = '#4d9221', x = 0.5, y = -0.06, alpha = 0.75, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +
    # 
    # #Add Label for Involved Limb Color
    # geom_text( label = ' = 1.73 cm', size = 13, color = '#4d9221', x = 0.5, y = -0.08, na.rm = T,  data = subset( Power_Ankle_2.3Hz, Limb_ID ==  'Contralateral' ) ) +

 
 

    #Arrow segment pointing at x = 0
   geom_segment( aes( x = 0.5, xend = 0.1, y = 75, yend = 75 ), linewidth = 6, arrow = arrow(length = unit(13,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +

 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = 'Mean Hop Height = ', x = 1.8, y = 80, size = 16, fontface = 'bold' ) +

 #Label for ATx Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[1], digits = 2), ' cm' ), x = 1.8, y = 75, size = 16, fontface = 'bold' ) +







 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = 'Mean Hop Height = ', x = 1.8, y = 80, size = 16, fontface = 'bold' ) +

 #Label for ATx Non-Involved Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Non-Involved'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[2], digits = 2), ' cm' ), x = 1.8, y = 75, size = 16, fontface = 'bold' ) +







 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = 'Mean Hop Height = ', x = 1.8, y = 80, size = 16, fontface = 'bold' ) +

 #Label for Control Matched Dominance Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Matched Dominance'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[3], digits = 2), ' cm' ), x = 1.8, y = 75, size = 16, fontface = 'bold' ) +







 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = 'Mean Hop Height = ', x = 1.8, y = 80, size = 16, fontface = 'bold' ) +

 #Label for Control Contralateral Limb Hopping Height mean
 geom_text( data = subset( HopHeightAverages_FromRMME, Limb_ID ==  'Contralateral'), label = paste0( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[4], digits = 2), ' cm' ), x = 1.8, y = 75, size = 16, fontface = 'bold' ) +







#Regression line for ATx, Involved Limb - Individual Participants
         geom_abline( data = subset( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +



#Regression line for ATx, Non-Involved Limb - Individual Participants
         geom_abline( data = subset( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Non-Involved'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +



#Regression line for Control, Matched Dominance Limb - Individual Participants
         geom_abline( data = subset( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Matched Dominance'), aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +



#Regression line for Control, Contralateral Limb - Individual Participants
         geom_abline( data = subset( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_ParticipantEstimates, Limb_ID ==  'Contralateral'),  aes( intercept = Intercept, slope = Slope, color = Participant_ID ), linewidth = 2, linetype = 'dashed' ) +



   #Regression line for Control Group, Matched Dominance Limb
      geom_abline( data = subset( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Matched Dominance' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +



   #Regression line for Control Group, Contralateral Limb
      geom_abline( data = subset( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Contralateral' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +



   #Regression line for ATx Group, Involved Limb
      geom_abline( data = subset( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID), linewidth = 12 ) +



   #Regression line for ATx Group, Non-Involved Limb
      geom_abline( data = subset( AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects_GroupEstimates, Limb_ID ==  'Non-Involved' ), aes( intercept = Intercept, slope = Slope,  color = Limb_ID ), linewidth = 12 ) +



   
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Limb_ID), size = 10*getME( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e'), stroke = 3*getME( RMME_AverageAnkleSagittalAngVelvsHopHeightAndLimb_2.3Hz_Braking_BothEffects, 'w_e') , color = 'black',  na.rm = T ) +
      

   
   
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq( -2, 3, by = 0.5 ), limits =  c( -2, 3 ) ) +
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 50, 250, by = 25 ), limits =  c( 20, 250 ) ) +
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Average Sagittal Plane Angular Velocity vs Hop Height  \n 2.33 Hz Hopping - Braking Phase ', x = 'Limb-Mean Centered Hop Height (cm)', y = expression( paste( ' Ankle Average Angular Velocity (', degree, '/s) [ + = Dorsiflexion ] ' ), parse  = T ) ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'ATx36' = 0.75,
                                    'ATx49' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 40,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 40,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 40,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 50, face = 'bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAverageSagittalAngVelvsHopHeightandLimb_All4Limbs_IndividualHops.png', width = 15000, height = 10000, units = 'px', limitsize = F )

```




##### 2 ATx Groups - Laterality


###### 2.3 Hz

```{r Hop Rate }


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_HopFrequency, x = Limb_ID  ) ) +
      
    geom_hline( yintercept = 2.33, linewidth = 2, linetype = 'dashed', color = 'black' ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_HopFrequency, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_HopFrequency, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(2,3,by = 0.1),limits = c(2,3) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Hop Height \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Height (cm) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```

```{r Hop Height }


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_HoppingHeight_m*100, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#4d9221'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_HoppingHeight_m*100, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_HoppingHeight_m*100, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,4,by = 0.5),limits = c(0,4) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Hop Height \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Height (cm) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```

```{r Flight Duration }


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_LengthofFlightPhase_sec, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#4d9221'   ) +
    
      
    

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_LengthofFlightPhase_sec, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_LengthofFlightPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Flight Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```




```{r Braking Phase Duration }


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_LengthofBrakingPhase_sec, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#4d9221'   ) +
    
      
    

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_LengthofBrakingPhase_sec, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_LengthofBrakingPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0.1,0.2,by = 0.01),limits = c(0.1,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Braking Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```



```{r Propulsion Phase Duration }


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_LengthofPropulsionPhase_sec, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#4d9221'   ) +
    
      
    

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_LengthofPropulsionPhase_sec, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_LengthofPropulsionPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0.1,0.2,by = 0.01),limits = c(0.1,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Propulsion Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```



```{r Limb MEE Absorption }






(ATxLimbMEEAbsorb1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_Limb_Absorption_MEE, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#4d9221'   ) +
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
      
      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Limb_Absorption_MEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +

    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_Limb_Absorption_MEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1.75, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1.4,by = 0.2),limits = c(0,1.4) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Total Limb MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```

```{r Limb MEE Generation }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_Limb_Generation_MEE, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#4d9221'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Limb_Generation_MEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_Limb_Generation_MEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1.75, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1.4,by = 0.2),limits = c(0,1.4) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Total Limb MEE - Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```




```{r Raw Absorption MEE }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Absorption_MEE, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz, aes(x = Limb_ID, y = Mean_Joint_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Raw Joint MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```





```{r Raw Generation MEE - ATx }



(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Generation_MEE, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Generation_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint MEE During Propulsion Phase \n 2.3 Hz Hopping - ATx vs Control',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```





```{r % Absorption MEE }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Percent_MEE_Absorption, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Percent_MEE_Absorption, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
   
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Whole-Limb MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```





```{r % Generation MEE }



(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Percent_MEE_Generation, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Percent_MEE_Generation, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, yend = Mean_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, yend = Mean_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ) , color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.815 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
   
   
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Propulsion Phase Whole-Limb MEE \n 2.3 Hz Hopping - ATx vs Control',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```





```{r Absorption Torque Impulse }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Absorption_SagittalTorqueImpulse, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Absorption_SagittalTorqueImpulse, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_SagittalTorqueImpulse, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.5, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.07 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.05 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.03 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-0.4,0.1,by = 0.1),limits = c(-0.4,0.1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Sagittal Plane Joint Torque Impulse - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```





```{r Generation Torque Impulse }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Generation_SagittalTorqueImpulse, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Generation_SagittalTorqueImpulse, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Generation_SagittalTorqueImpulse, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.07 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.05 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.03 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-0.4,0.1,by = 0.1),limits = c(-0.4,0.1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Torque Impulse During Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```





```{r Absorption Angular Velocity }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_AverageJointAngVel_BrakingPhase, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_AverageJointAngVel_BrakingPhase, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_AverageJointAngVel_BrakingPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      


   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 40 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 25 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 10 ) +
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-25,225,by = 25),limits = c(-25,225) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Peak Sagittal Plane Joint Angular Velocity - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)



```





```{r Generation Angular Velocity }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_AverageJointAngVel_PropulsionPhase, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_AverageJointAngVel_PropulsionPhase, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_AverageJointAngVel_PropulsionPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 3 ) +
      
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = -10 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = -25 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = -40 ) +
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-275,0,by = 25),limits = c(-275,0) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Peak Joint Angular Velocity During Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```





```{r % Knee and Ankle Absorption MEE }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Braking, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Limb_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Braking, x = Limb_ID, fill = 'Ankle', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
   stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( x = Limb_ID, y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Braking, group = interaction( Limb_ID ), color = 'Knee' ), linewidth = 1, show.legend = F, na.rm = T  ) + 
    
   
   
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Braking, x = Limb_ID, fill = 'Knee', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Braking Phase Whole-Limb MEE  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```





```{r % Knee and Ankle Propulsion MEE }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Propulsion, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
   
      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Limb_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Propulsion, x = Limb_ID, fill = 'Ankle', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
   stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( x = Limb_ID, y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Propulsion, group = interaction( Limb_ID ), color = 'Knee' ), linewidth = 1, show.legend = F, na.rm = T  ) + 
    
   
   
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Propulsion, x = Limb_ID, fill = 'Knee', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Propulsion Phase Whole-Limb MEE  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```



##### 2 ATx Groups - Morphology
```{r % Braking Ankle MEE vs Morphology } 

(Power1 <- ggplot(data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18, aes(x = Mean_BetweenLimbTendonThickness_mm, y = Mean_Joint_Percent_MEE_Absorption  ) ) +
      
      
   
   
   geom_point( aes( fill = Participant_ID ), shape = 21, color = 'white',size = 5, stroke = 2) +
   
    
    geom_abline( aes( intercept = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$coefficients[1], slope = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$coefficients[2] ), linewidth = 2, color = 'black' ) +
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC21' = met.brewer('OKeeffe1')[11] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
   
   
   
   scale_x_continuous( breaks = seq( 0, 4, by = 0.25 ), limits = c( 0, 4 ) ) +
   
   
   scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits = c( 0, 1 ) ) +
   
   
   labs( title = ' Ankle Contribution to Whole-Limb MEE Absorption vs \n Between-Limb Difference in Tendon Thickness',x = 'Difference in Thickness (mm)', y = ' Contribution to MEE Absorption (%) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) 

)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Power/', 'Dissertation_AnklePercentMEEvsTendonThickness.png', width = 5000, height = 5000, units = 'px' )
```



```{r Ankle Absorption Work  vs Morphology } 

(Power1 <- ggplot(data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz, aes(x = Mean_BetweenLimbTendonThickness_mm, y = Mean_JointWork_Braking_GenerationNeutralized  ) ) +
      
      
   
   
   geom_point( aes( fill = Participant_ID, group = Group_by_Morphology ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
   
    geom_smooth( aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 4, method = 'lm' ) +
    
    #geom_abline( aes( intercept = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$coefficients[1], slope = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$coefficients[2] ), linewidth = 2, color = 'black' ) +
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC21' = met.brewer('OKeeffe1')[11] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
   
   
   
   scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits = c( 0, 4 ) ) +
   
   
   scale_y_continuous( breaks = seq( -1, 0, by = 0.1 ), limits = c( -1, 0) ) +
   
   
   labs( title = ' Ankle Absorption Work vs \n Between-Limb Difference in Tendon Thickness',x = 'Difference in Thickness (mm)', y = ' Ankle Absorption Work (J/kg) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) 

)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/ATxGroupComparison', 'Dissertation_AnkleAbsorptionWorkvsTendonThickness.png', width = 5500, height = 5500, units = 'px' )
```



```{r Ankle Absorption Work Rate vs Morphology } 

(Power1 <- ggplot(data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz, aes(x = Mean_BetweenLimbTendonThickness_mm, y = Mean_JointAveragePower_Braking_GenerationNeutralized  ) ) +
      
      
   
   
   geom_point( aes( fill = Participant_ID, group = Group_by_Morphology ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
   
    geom_smooth( aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 4, method = 'lm' ) +
    
    #geom_abline( aes( intercept = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$coefficients[1], slope = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$coefficients[2] ), linewidth = 2, color = 'black' ) +
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC21' = met.brewer('OKeeffe1')[11] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
   
   
   
   scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits = c( 0, 4 ) ) +
   
   
   scale_y_continuous( breaks = seq( -7, 0, by = 1 ), limits = c( -7, 0) ) +
   
   
   labs( title = ' Ankle Absorption Work Rate vs \n Between-Limb Difference in Tendon Thickness',x = 'Difference in Thickness (mm)', y = ' Ankle Absorption Work Rate (W/kg) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) 

)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/ATxGroupComparison', 'Dissertation_AnkleWorkRatevsTendonThickness.png', width = 5500, height = 5500, units = 'px' )
```



```{r Ankle Generation Work  vs Morphology } 

(Power1 <- ggplot(data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz, aes(x = Mean_BetweenLimbTendonThickness_mm, y = Mean_JointWork_Propulsion_AbsorptionNeutralized  ) ) +
      
      
   
   
   geom_point( aes( fill = Participant_ID, group = Group_by_Morphology ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
   
    geom_smooth( aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 4, method = 'lm' ) +
    
    #geom_abline( aes( intercept = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$coefficients[1], slope = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$coefficients[2] ), linewidth = 2, color = 'black' ) +
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC21' = met.brewer('OKeeffe1')[11] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
   
   
   
   scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits = c( 0, 4 ) ) +
   
   
   scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits = c( 0, 1) ) +
   
   
   labs( title = ' Ankle Generation Work vs \n Between-Limb Difference in Tendon Thickness',x = 'Difference in Thickness (mm)', y = ' Ankle Generation Work (J/kg) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) 

)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/ATxGroupComparison', 'Dissertation_AnkleGenerationWorkvsTendonThickness.png', width = 5500, height = 5500, units = 'px' )
```





```{r Ankle Generation Work Rate vs Morphology } 

(Power1 <- ggplot(data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz, aes(x = Mean_BetweenLimbTendonThickness_mm, y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized  ) ) +
      
      
   
   
   geom_point( aes( fill = Participant_ID, group = Group_by_Morphology ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
   
    geom_smooth( aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 4, method = 'lm' ) +
    
    #geom_abline( aes( intercept = LM_Joint_Percent_MEE_GenerationvsATxMorphology$coefficients[1], slope = LM_Joint_Percent_MEE_GenerationvsATxMorphology$coefficients[2] ), linewidth = 2, color = 'black' ) +
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC21' = met.brewer('OKeeffe1')[11] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
   
   
   
   scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits = c( 0, 4 ) ) +
   
   
   scale_y_continuous( breaks = seq( 0, 7, by = 1 ), limits = c( 0, 7 ) ) +
   
   
   labs( title = ' Ankle Generation Work Rate vs \n Between-Limb Difference in Tendon Thickness',x = 'Difference in Thickness (mm)', y = ' Ankle Generation Work Rate (W/kg) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) 

)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/ATxGroupComparison', 'Dissertation_AnkleGenerationWorkRatevsTendonThickness.png', width = 5500, height = 5500, units = 'px' )
```



```{r Repeat w/ No ATx08 } 





(Power1 <- ggplot(data = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx08, aes(x = Mean_BetweenLimbTendonThickness_mm, y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized  ) ) +
      
      
   
   
   geom_point( aes( fill = Participant_ID, group = Group_by_Morphology ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
   
    geom_smooth( aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 4, method = 'lm' ) +
    
    #geom_abline( aes( intercept = LM_Joint_Percent_MEE_GenerationvsATxMorphology$coefficients[1], slope = LM_Joint_Percent_MEE_GenerationvsATxMorphology$coefficients[2] ), linewidth = 2, color = 'black' ) +
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC21' = met.brewer('OKeeffe1')[11] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
   
   
   
   scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits = c( 0, 4 ) ) +
   
   
   scale_y_continuous( breaks = seq( 0, 7, by = 1 ), limits = c( 0, 7 ) ) +
   
   
   labs( title = ' Ankle Generation Work Rate vs \n Between-Limb Difference in Tendon Thickness',x = 'Difference in Thickness (mm)', y = ' Ankle Generation Work Rate (W/kg) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) 

)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/ATxGroupComparison', 'Dissertation_AnkleGenerationWorkRatevsTendonThickness_NoATx08.png', width = 5500, height = 5500, units = 'px' )

```


##### Involved vs Non-Involved

###### 2.3 Hz

```{r Hop Rate }


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_HopFrequency, x = Limb_ID  ) ) +
      
    geom_hline( yintercept = 2.33, linewidth = 2, linetype = 'dashed', color = 'black' ) +

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_HopFrequency, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_HopFrequency, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(2,3,by = 0.1),limits = c(2,3) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Hop Height \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Height (cm) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r Hop Height }


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_HoppingHeight_m*100, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_HoppingHeight_m*100, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_HoppingHeight_m*100, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,4,by = 0.5),limits = c(0,4) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Hop Height \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Height (cm) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r Flight Duration }


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_LengthofFlightPhase_sec, x = Limb_ID  ) ) +
      
    

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_LengthofFlightPhase_sec, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_LengthofFlightPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Flight Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r Braking Phase Duration }


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_LengthofBrakingPhase_sec, x = Limb_ID  ) ) +
      
    

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_LengthofBrakingPhase_sec, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_LengthofBrakingPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0.1,0.2,by = 0.01),limits = c(0.1,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Braking Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```


```{r Propulsion Phase Duration }


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_LengthofPropulsionPhase_sec, x = Limb_ID  ) ) +
      
    

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_LengthofPropulsionPhase_sec, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_LengthofPropulsionPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0.1,0.2,by = 0.01),limits = c(0.1,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Propulsion Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```



```{r Limb MEE Absorption }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_Limb_Absorption_MEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Limb_Absorption_MEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_Limb_Absorption_MEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1.75, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1.4,by = 0.2),limits = c(0,1.4) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Total Limb MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```


```{r Limb MEE Generation }

(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_Limb_Generation_MEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Limb_Generation_MEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      

    
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_Limb_Generation_MEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center', binaxis = 'y', dotsize = 1.75, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1],
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1.4,by = 0.2),limits = c(0,1.4) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Total Limb MEE - Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key = element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = "black",linewidth = 1),
            panel.background = element_rect(color = "black",fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 22.5) ) 

)

```



```{r Raw Work Rate Generation }


CI <- mean_cl_boot( Power_ParticipantMeans_ATx_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized[ which( Power_ParticipantMeans_ATx_2.3Hz$Limb_ID ==  'Non-Involved' & Power_ParticipantMeans_ATx_2.3Hz$Joint_ID ==  'Ankle' ) ] )


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_ATx_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, yend = Mean_JointAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, yend = Mean_JointAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized, na.rm = T ) ) /9, dotsize = 0.5, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_ATx_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_ATx_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_ATx_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
      scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-7,0,by = 1),limits = c(-7,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Non-Involved' = 'Non-Involved' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Raw Net Joint Moment Work Rate \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Absorption Work Rate (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Limb_ID ), nrow = 1, scales = 'free_x' )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/InvolvedVsNonInvolved', filename = 'Dissertation_JointAbsorptionWorkRate_2.33Hz_InvolvedvsNonInvolved.png', width = 5500, height = 5500, units = 'px' )


```



```{r Raw Absorption MEE }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Absorption_MEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz, aes(x = Limb_ID, y = Mean_Joint_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Raw Joint MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```



```{r Raw Work Rate Generation }


CI <- mean_cl_boot( Power_ParticipantMeans_ATx_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized[ which( Power_ParticipantMeans_ATx_2.3Hz$Limb_ID ==  'Non-Involved' & Power_ParticipantMeans_ATx_2.3Hz$Joint_ID ==  'Ankle' ) ] )


(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_ATx_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, yend = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, yend = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, na.rm = T ) ) /9, dotsize = 0.5, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_ATx_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_ATx_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_ATx_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
      scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,7,by = 1),limits = c(0,7) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Non-Involved' = 'Non-Involved' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Raw Net Joint Moment Work Rate \n Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Generation Work Rate (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Limb_ID ), scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/InvolvedVsNonInvolved', filename = 'Dissertation_JointGenerationWorkRate_2.33Hz_InvolvedvsNonInvolved.png', width = 5500, height = 5500, units = 'px' )


```



```{r Raw Generation MEE - ATx }



(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Generation_MEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Generation_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint MEE During Propulsion Phase \n 2.3 Hz Hopping - ATx vs Control',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r % Absorption MEE }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Percent_MEE_Absorption, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Percent_MEE_Absorption, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
   
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Whole-Limb MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r % Generation MEE }



(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Percent_MEE_Generation, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Percent_MEE_Generation, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, yend = Mean_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, yend = Mean_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ) , color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.815 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
   
   
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Propulsion Phase Whole-Limb MEE \n 2.3 Hz Hopping - ATx vs Control',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r Absorption Torque Impulse }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Absorption_SagittalTorqueImpulse, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Absorption_SagittalTorqueImpulse, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_SagittalTorqueImpulse, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.5, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.07 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.05 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.03 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-0.4,0.1,by = 0.1),limits = c(-0.4,0.1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Sagittal Plane Joint Torque Impulse - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r Generation Torque Impulse }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Generation_SagittalTorqueImpulse, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Generation_SagittalTorqueImpulse, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Generation_SagittalTorqueImpulse, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.07 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.05 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.03 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-0.4,0.1,by = 0.1),limits = c(-0.4,0.1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Torque Impulse During Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r Absorption Angular Velocity }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_AverageJointAngVel_BrakingPhase, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_AverageJointAngVel_BrakingPhase, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_AverageJointAngVel_BrakingPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      


   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 40 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 25 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 10 ) +
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-25,225,by = 25),limits = c(-25,225) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Peak Sagittal Plane Joint Angular Velocity - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  )

 
)



```

```{r Generation Angular Velocity }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_AverageJointAngVel_PropulsionPhase, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_AverageJointAngVel_PropulsionPhase, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_AverageJointAngVel_PropulsionPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 3 ) +
      
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = -10 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = -25 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = -40 ) +
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-275,0,by = 25),limits = c(-275,0) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Peak Joint Angular Velocity During Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r % Knee and Ankle Absorption MEE }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Braking, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Limb_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Limb_ID ), color = 'Ankle' ), linewidth = 1, show.legend = F, na.rm = T  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Braking, x = Limb_ID, fill = 'Ankle', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
   stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( x = Limb_ID, y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Braking, group = interaction( Limb_ID ), color = 'Knee' ), linewidth = 1, show.legend = F, na.rm = T  ) + 
    
   
   
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Braking, x = Limb_ID, fill = 'Knee', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Braking Phase Whole-Limb MEE  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r % Knee and Ankle Propulsion MEE }






(Power1 <- ggplot(data = Power_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Propulsion, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Limb_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Limb_ID ), color = 'Ankle' ), linewidth = 1, show.legend = F, na.rm = T  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Propulsion, x = Limb_ID, fill = 'Ankle', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
   stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( x = Limb_ID, y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Propulsion, group = interaction( Limb_ID ), color = 'Knee' ), linewidth = 1, show.legend = F, na.rm = T  ) + 
    
   
   
   
    geom_dotplot( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Propulsion, x = Limb_ID, fill = 'Knee', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Propulsion Phase Whole-Limb MEE  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

###### SD

```{r % Absorption MEE }






(Power1 <- ggplot(data = Power_ParticipantMeans_InvolvedVsControl_2.3Hz, aes(y = SD_Joint_Percent_MEE_Absorption, x = Limb_ID  ) ) +
      

      #geom_line( data = Power_ParticipantMeans, aes(x = Limb_ID, y = SD_PercentNegativePower_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape = Participant_ID ), size = 5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = SD_Joint_Percent_MEE_Absorption, yend = SD_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = SD_Joint_Percent_MEE_Absorption, yend = SD_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_InvolvedVsControl_2.3Hz, aes( y = SD_Joint_Percent_MEE_Absorption, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.375, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.815 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02','ATx07' = met.brewer('Archambault')[4], 'HC01' = 'black', 'ATx10' = 'darkgray', 'HP08' = 'darkgray', 'ATx18' = 'white', 'HP09' = 'white') ,
                         name = 'Joint ID',aesthetics = c('color'),labels = c('Ankle','Knee','Hip','ATx07','HC01','ATx10','HP08','ATx18','HP09') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,0.2,by = 0.02),limits = c(0,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Matched Control Limb ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' SD of Joint Contribution to Braking Phase Whole-Limb MEE \n 2.3 Hz - ATx vs Control',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r % Generation MEE }



(Power1 <- ggplot(data = Power_ParticipantMeans_InvolvedVsControl_2.3Hz, aes(y = SD_Joint_Percent_MEE_Generation, x = Limb_ID  ) ) +
      

      #geom_line( data = Power_ParticipantMeans, aes(x = Limb_ID, y = SD_PercentNegativePower_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape = Participant_ID ), size = 5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = SD_Joint_Percent_MEE_Generation, yend = SD_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = SD_Joint_Percent_MEE_Generation, yend = SD_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_InvolvedVsControl_2.3Hz, aes( y = SD_Joint_Percent_MEE_Generation, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ) , color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.375, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.815 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02','ATx07' = met.brewer('Archambault')[4], 'HC01' = 'black', 'ATx10' = 'darkgray', 'HP08' = 'darkgray', 'ATx18' = 'white', 'HP09' = 'white') ,
                         name = 'Joint ID',aesthetics = c('color'),labels = c('Ankle','Knee','Hip','ATx07','HC01','ATx10','HP08','ATx18','HP09') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,0.2,by = 0.02),limits = c(0,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Matched Control Limb ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' SD of Joint Contribution to Propulsion Phase Whole-Limb MEE \n 2.3 Hz Hopping - ATx vs Control',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r Raw Absorption MEE }






(Power1 <- ggplot(data = Power_ParticipantMeans_InvolvedVsControl_2.3Hz, aes(y = SD_Joint_Absorption_MEE, x = Limb_ID  ) ) +
      

      #geom_line( data = Power_ParticipantMeans, aes(x = Limb_ID, y = SD_PercentNegativePower_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape = Participant_ID ), size = 5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = SD_Joint_Absorption_MEE, yend = SD_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = SD_Joint_Absorption_MEE, yend = SD_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_InvolvedVsControl_2.3Hz, aes( y = SD_Joint_Absorption_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = .5, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.815 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02','ATx07' = met.brewer('Archambault')[4], 'HC01' = 'black', 'ATx10' = 'darkgray', 'HP08' = 'darkgray', 'ATx18' = 'white', 'HP09' = 'white') ,
                         name = 'Joint ID',aesthetics = c('color'),labels = c('Ankle','Knee','Hip','ATx07','HC01','ATx10','HP08','ATx18','HP09') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,0.2,by = 0.02),limits = c(0,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Matched Control Limb ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' SD of Joint MEE During Braking Phase \n 2.3 Hz - ATx vs Control',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```

```{r Raw Generation MEE - ATx }



(Power1 <- ggplot(data = Power_ParticipantMeans_InvolvedVsControl_2.3Hz, aes(y = SD_Joint_Generation_MEE, x = Limb_ID  ) ) +
      

      #geom_line( data = Power_ParticipantMeans, aes(x = Limb_ID, y = SD_PercentNegativePower_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape = Participant_ID ), size = 5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = SD_Joint_Generation_MEE, yend = SD_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = SD_Joint_Generation_MEE, yend = SD_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ParticipantMeans_InvolvedVsControl_2.3Hz, aes( y = SD_Joint_Generation_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.5, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.815 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02','ATx07' = met.brewer('Archambault')[4], 'HC01' = 'black', 'ATx10' = 'darkgray', 'HP08' = 'darkgray', 'ATx18' = 'white', 'HP09' = 'white') ,
                         name = 'Joint ID',aesthetics = c('color'),labels = c('Ankle','Knee','Hip','ATx07','HC01','ATx10','HP08','ATx18','HP09') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,0.2,by = 0.02),limits = c(0,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Matched Control Limb ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' SD of Joint MEE During Propulsion Phase \n 2.3 Hz Hopping - ATx vs Control',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) 

 
)




```







##### 2 Groups - Involved vs Matched Dominance


```{r Flight Phase Duration }


CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LengthofFlightPhase_sec )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes(y = Mean_LengthofFlightPhase_sec, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 10, x = 0.575, y = CI$ymax + 0.0025, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Group_ID ), linewidth = 2, show.legend = F  ) + 
   
   
   geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes( y = Mean_LengthofFlightPhase_sec, x = Limb_ID, fill = Participant_ID, group = interaction( Group_ID, Participant_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
   
   
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'ATx' = '#c51b7d' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
    scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'ATx' = '#c51b7d' ),
                      name = '',
                      aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
   
   
   
   scale_y_continuous(breaks = seq(0,0.17,by = 0.01),limits = c(0,0.17) ) +
   
   
   scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
   
   
   labs(title = ' Flight Phase Duration - 2.33 Hz Hopping',x = 'Limb ID', y = ' Duration (sec) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         plot.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
         legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),
         panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )


)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_FlightPhaseDuration_2.33Hz_1LimbPer2Groups.png', width = 5000, height = 5000, units = 'px' )

```




```{r Braking Phase Duration }


CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LengthofBrakingPhase_sec )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes(y = Mean_LengthofBrakingPhase_sec, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 10, x = 0.575, y = CI$ymax + 0.0025, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Group_ID ), linewidth = 2, show.legend = F  ) + 
   
   
   geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes( y = Mean_LengthofBrakingPhase_sec, x = Limb_ID, fill = Participant_ID, group = interaction( Group_ID, Participant_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
   
   
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'ATx' = '#c51b7d' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
    scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'ATx' = '#c51b7d' ),
                      name = '',
                      aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
   
   
   
   scale_y_continuous(breaks = seq(0.1,0.24,by = 0.01),limits = c(0.1,0.24) ) +
   
   
   scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
   
   
   labs(title = ' Braking Phase Duration - 2.33 Hz Hopping',x = 'Limb ID', y = ' Duration (sec) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         plot.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
         legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),
         panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )


)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_BrakingPhaseDuration_2.33Hz_1LimbPer2Groups.png', width = 5000, height = 5000, units = 'px' )

```





```{r Propulsion Phase Duration }


CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LengthofPropulsionPhase_sec )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes(y = Mean_LengthofPropulsionPhase_sec, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 10, x =  0.575, y = CI$ymax + 0.0025, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Group_ID ), linewidth = 2, show.legend = F  ) + 
   
   
   geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes( y = Mean_LengthofPropulsionPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
   
   
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'ATx' = '#c51b7d' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
    scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'ATx' = '#c51b7d' ),
                      name = '',
                      aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
   
   
   
   scale_y_continuous(breaks = seq(0.1,0.24,by = 0.01),limits = c(0.1,0.24) ) +
   
   
   scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
   
   
   labs(title = ' Propulsion Phase Duration - 2.33 Hz Hopping',x = 'Limb ID', y = ' Duration (sec) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),plot.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )


)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_PropulsionPhaseDuration_2.33Hz_1LimbPer2Groups.png', width = 5000, height = 5000, units = 'px' )

```



```{r Limb Power Absorption }



CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_TotalLimbSupportPower_BrakingPhase )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes(y = Mean_TotalLimbSupportPower_BrakingPhase, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 10, x = 0.575, y = CI$ymax + 6, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ), color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes( y = Mean_TotalLimbSupportPower_BrakingPhase, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      
      scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'Involved' = '#c51b7d', 
                                    'Non-Involved' = '#7fbc41',
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         name = '',
                         aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      
      
      scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                   'ATx08' = met.brewer('OKeeffe1')[2],
                                   'ATx10' = met.brewer('OKeeffe1')[3], 
                                   'ATx12' = met.brewer('OKeeffe1')[4],
                                   'ATx17' = met.brewer('OKeeffe1')[5],
                                   'ATx18' = met.brewer('OKeeffe1')[6],
                                   'ATx19' = met.brewer('OKeeffe1')[7],
                                   'ATx21' = met.brewer('OKeeffe1')[8],
                                   'ATx24' = met.brewer('OKeeffe1')[9],
                                   'ATx25' = met.brewer('OKeeffe1')[10],
                                   'ATx27' = met.brewer('OKeeffe1')[11],
                                   'ATx34' = met.brewer('OKeeffe1')[ 7],
                                   'HC01' = met.brewer('OKeeffe1')[1], 
                                   'HC19' = met.brewer('OKeeffe1')[2],
                                   'HC12' = met.brewer('OKeeffe1')[3], 
                                   'HC05' = met.brewer('OKeeffe1')[4],
                                   'HC06' = met.brewer('OKeeffe1')[5],
                                   'HC08' = met.brewer('OKeeffe1')[6],
                                   'HC20' = met.brewer('OKeeffe1')[7],
                                   'HC11' = met.brewer('OKeeffe1')[8],
                                   'HC17' = met.brewer('OKeeffe1')[9],
                                   'HC21' = met.brewer('OKeeffe1')[11] ),
                        name = '',
                        aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
      
      
      
      scale_y_continuous(breaks = seq(-350,0,by = 50),limits = c(-350,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Limb Contribution to Sum of Joint Work Rate - Braking Phase - 2.0 Hz Hopping',x = 'Limb ID', y = ' Contribution to Sum of Joint Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30)  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.0 Hz', filename = 'Dissertation_LimbSumofPowerAbsorption_2.0Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Limb Absorption Work Rate }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LimbAveragePower_Braking_GenerationNeutralized )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes(y = Mean_LimbAveragePower_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.2, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_LimbAveragePower_Braking_GenerationNeutralized, yend = Mean_LimbAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_LimbAveragePower_Braking_GenerationNeutralized, yend = Mean_LimbAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID ), color = Group_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes( y = Mean_LimbAveragePower_Braking_GenerationNeutralized, x = Limb_ID, fill = Participant_ID, group = interaction( Participant_ID, Group_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_LimbAveragePower_Braking_GenerationNeutralized, na.rm = T ) ) /10, dotsize = 0.55, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      

      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'ATx' = '#c51b7d' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
    scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'ATx' = '#c51b7d' ),
                      name = '',
                      aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      
      scale_y_continuous(breaks = seq(-10, 0, by = 1 ),limits = c( -10, 0 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Whole-Limb Absorption Work Rate \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Limb Absorption Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbAbsorptionWorkRate_GenerationNeutralized_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Limb Generation Work Rate }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes(y = Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.2, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized, yend = Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized, yend = Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID ), color = Group_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz, aes( y = Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID, fill = Participant_ID, group = interaction( Participant_ID, Group_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized, na.rm = T ) ) /10, dotsize = 0.55, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      

      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'ATx' = '#c51b7d' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
    scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'ATx' = '#c51b7d' ),
                      name = '',
                      aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      
      scale_y_continuous( breaks = seq( 0, 10, by = 1 ), limits = c( 0, 10 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Whole-Limb Generation Work Rate \n Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Limb Generation Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbGenerationWorkRate_AbsorptionNeutralized_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```










```{r Raw Absorption Work }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes(y = Mean_JointWork_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointWork_Braking_GenerationNeutralized, yend = Mean_JointWork_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointWork_Braking_GenerationNeutralized, yend = Mean_JointWork_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes( y = Mean_JointWork_Braking_GenerationNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized, na.rm = T ) ) /10, dotsize = 0.35, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.4, y = -0.0225, fontface = 'bold' ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.4, y = -0.05, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 12, color = '#d95f02', x = 1.4, y = -0.08, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-1,0,by = 0.1),limits = c(-1,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Net Joint Moment Work \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Absorption Work (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointAbsorptionWork_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r % Absorption Work Rate }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized/100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes(y = Mean_JointContribution_AveragePower_GenerationNeutralized/100, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      geom_text( label = 'Ankle Mean Diff (95% CI) = -0.24 (-1.2, 0.73), \n p = 0.62', y = 0.915, x = 1, size = 10, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'ATx' ) ) +
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointContribution_AveragePower_GenerationNeutralized, yend = Mean_JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointContribution_AveragePower_GenerationNeutralized, yend = Mean_JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes( y = Mean_JointContribution_AveragePower_GenerationNeutralized/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized/100, na.rm = T ) ) /10, dotsize = 0.45, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 0.6, y = 0.95, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 0.6, y = 0.915, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      #Hip
      geom_text(  label = 'Hip', size = 12, color = '#d95f02', x = 0.6, y = 0.88, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0, 1, by = 0.1 ),limits = c( 0, 1 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Whole-Limb Absorption Work Rate \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Contribution (Max = 1) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAbsorptionWorkRateContribution_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```


```{r Raw Average Absorption Work Rate }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes(y = Mean_JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.1, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, yend = Mean_JointAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, yend = Mean_JointAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized, na.rm = T ) ) /10, dotsize = 0.35, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.4, y = -0.225, fontface = 'bold' ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.4, y = -0.5, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 12, color = '#d95f02', x = 1.4, y = -0.8, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-7, 0, by = 1 ),limits = c( -7, 0 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Net Joint Moment Work Rate \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Absorption Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointAbsorptionWorkRate_GenerationNeutralized_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Raw Average Absorption Work Rate - GeomPoint }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes(y = Mean_JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.1, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, yend = Mean_JointAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, yend = Mean_JointAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      geom_point( data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), shape = 21, color = 'black', size = 10, position = position_jitter( height = 0, width = 0.05, seed = 3 ) ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.4, y = -0.225, fontface = 'bold' ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.4, y = -0.5, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 12, color = '#d95f02', x = 1.4, y = -0.8, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-7, 0, by = 1 ),limits = c( -7, 0 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Net Joint Moment Work Rate \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Absorption Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointAbsorptionWorkRate_GenerationNeutralized_2.3Hz_1LimbPer2Groups_GeomPoint.png', width = 5500, height = 5500, units = 'px' )

```



```{r % Absorption Work Rate }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointWork_Braking_NoGeneration )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes(y = Mean_JointWork_Braking_NoGeneration, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      # geom_text( label = 'Ankle Mean Diff (95% CI) = -0.24 (-1.2, 0.73), \n p = 0.62', y = 0.915, x = 1, size = 10, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'ATx' ) ) +
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointContribution_AveragePower_GenerationNeutralized, yend = Mean_JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointContribution_AveragePower_GenerationNeutralized, yend = Mean_JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_point( data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes( y = Mean_JointWork_Braking_NoGeneration, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_ID ) ), color = 'black', shape = 21, size = 10, position = position_jitter( seed = 3, width = 0.05, height = 0 ) ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 0.6, y = 0.95, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 0.6, y = 0.915, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      #Hip
      geom_text(  label = 'Hip', size = 12, color = '#d95f02', x = 0.6, y = 0.88, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-1.1, 0, by = 0.1 ),limits = c( -1.1, 0 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Whole-Limb Absorption Work Rate \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Contribution (Max = 1) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAbsorptionWorkRateContribution_2.3Hz_1LimbPer2Groups_GeomPoint.png', width = 5500, height = 5500, units = 'px' )

```



```{r % Absorption Work Rate }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized/100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes(y = Mean_JointContribution_AveragePower_GenerationNeutralized/100, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      geom_text( label = 'Ankle Mean Diff (95% CI) = -0.24 (-1.2, 0.73), \n p = 0.62', y = 0.915, x = 1, size = 10, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'ATx' ) ) +
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointContribution_AveragePower_GenerationNeutralized, yend = Mean_JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointContribution_AveragePower_GenerationNeutralized, yend = Mean_JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes( y = Mean_JointContribution_AveragePower_GenerationNeutralized/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized/100, na.rm = T ) ) /10, dotsize = 0.45, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 0.6, y = 0.95, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 0.6, y = 0.915, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      #Hip
      geom_text(  label = 'Hip', size = 12, color = '#d95f02', x = 0.6, y = 0.88, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0, 1, by = 0.1 ),limits = c( 0, 1 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Whole-Limb Absorption Work Rate \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Contribution (Max = 1) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAbsorptionWorkRateContribution_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Raw Generation Work }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes(y = Mean_JointWork_Propulsion_AbsorptionNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointWork_Propulsion_AbsorptionNeutralized, yend = Mean_JointWork_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointWork_Propulsion_AbsorptionNeutralized, yend = Mean_JointWork_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes( y = Mean_JointWork_Propulsion_AbsorptionNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized, na.rm = T ) ) /10, dotsize = 0.5, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Net Joint Moment Work \n Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Generation Work (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointGenerationWork_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Raw Generation Work Rate }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes(y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.1, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, yend = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, yend = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes( y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, na.rm = T ) ) /10, dotsize = 0.35, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 6.75, fontface = 'bold' ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 6.5, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 6.2, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,7,by = 1),limits = c(0,7) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Net Joint Moment Work Rate \n Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Generation Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointGenerationWorkRate_AbsorptionNeutralized_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```


```{r % Generation Work Rate }




CI <- mean_cl_normal( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized/100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      geom_text( label = 'Ankle Mean Diff (95% CI) = 0.23 (-0.38, 0.84), \n p = 0.45', y = 0.915, x = 1, size = 10, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'ATx' ) ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointContribution_AveragePower_AbsorptionNeutralized, yend = Mean_JointContribution_AveragePower_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointContribution_AveragePower_AbsorptionNeutralized, yend = Mean_JointContribution_AveragePower_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_normal'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, aes( y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, na.rm = T ) ) /10, dotsize = 0.45, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 0.6, y = 0.95, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 0.6, y = 0.915, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      #Hip
      geom_text(  label = 'Hip', size = 12, color = '#d95f02', x = 0.6, y = 0.88, fontface = 'bold', data = subset( Power_ParticipantMeans_1LimbPer2Groups_2.3Hz, Group_ID ==  'Control' ) ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      labs(title = ' Joint Contribution to Whole-Limb Generation Work Rate \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Contribution (Max = 1) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointGenerationWorkRateContribution_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```


##### 3 Groups - Involved vs Matched Dominance



###### 2.3 Hz

```{r Hop Rate }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_HopFrequency )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_HopFrequency, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = 2.33, linewidth = 1.75, color = 'black' ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 2, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 2, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.015, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ), color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
   
   
   geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_HopFrequency, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', inherit.aes = F, dotsize = 0.75, stroke = 2, binwidth = 1/60, binpositions = 'all', stackgroups = T, stackratio = 0.8) +
   
   
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                'ATx38' = met.brewer('OKeeffe1')[1],
                                'ATx41' = met.brewer('OKeeffe1')[2],
                                'ATx44' = met.brewer('OKeeffe1')[3],
                                'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
   
   
   scale_y_continuous(breaks = seq(1.8,2.4,by = 0.1),limits = c(1.8,2.4) ) +
   
   
   scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
   
   
   labs(title = ' Hop Rate - 2.33 Hz Hopping',x = 'Limb ID', y = ' Rate (Hz) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
   
   facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )


)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', 'Dissertation_HopRate_2.3Hz_1LimbPer3Groups.png', width = 5600, height = 5600, units = 'px' )

```




```{r Hop Height }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_HoppingHeight_m*100 )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_HoppingHeight_m*100, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.06, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      # 
      # stat_summary( fun.data = 'mean_cl_boot'  ,
      #               geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  ) + 
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
   
   
   geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_HoppingHeight_m*100, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
   
   
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
   
   
   
   scale_y_continuous(breaks = seq(0,4,by = 0.5),limits = c(0,4) ) +
   
   
   scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
   
   
   
   labs(title = ' Hop Height - 2.3 Hz Hopping',x = 'Limb ID', y = ' Height (cm) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
   
   facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )


)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', 'Dissertation_HopHeight_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Flight Duration }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LengthofFlightPhase_sec )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_LengthofFlightPhase_sec, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.0025, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
   
   
   geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_LengthofFlightPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2 ) +
   
   
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
   
   
   
   scale_y_continuous(breaks = seq(0.02,0.2,by = 0.02),limits = c(0.02,0.2) ) +
   
   
   scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
   
   
   labs(title = ' Flight Phase Duration - 2.3 Hz Hopping',x = 'Limb ID', y = ' Duration (sec) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', 
         legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),
         plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
         legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),
         legend.key.height = unit(0,'lines'),
         legend.key.width = unit(0.5,'lines'),
         legend.box.background = element_rect(color = 'black',linewidth = 1),
         panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),
         panel.grid.major.y = element_line(color = 'darkgrey'),
         panel.grid.minor.y = element_line(color = 'darkgrey'),
         strip.text = element_text(size = 30,face = 'bold')  ) +
   
   facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )


)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_FlightDuration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Contact Phase Duration }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LengthofContactPhase_sec )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_LengthofContactPhase_sec, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.0025, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
   
   
   geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_LengthofContactPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2 ) +
   
   
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
   
   
   
   scale_y_continuous(breaks = seq(0.2,0.425,by = 0.025),limits = c(0.2,0.425) ) +
   
   
   scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
   
   
   labs(title = ' Ground Contact Phase Duration - 2.3 Hz Hopping',x = 'Limb ID', y = ' Duration (sec) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', 
         legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),
         plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
         legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),
         legend.key.height = unit(0,'lines'),
         legend.key.width = unit(0.5,'lines'),
         legend.box.background = element_rect(color = 'black',linewidth = 1),
         panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),
         panel.grid.major.y = element_line(color = 'darkgrey'),
         panel.grid.minor.y = element_line(color = 'darkgrey'),
         strip.text = element_text(size = 30,face = 'bold')  ) +
   
   facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )


)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_ContactPhaseDuration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Braking Phase Duration }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LengthofBrakingPhase_sec )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_LengthofBrakingPhase_sec, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology !=  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.0025, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
   
   
   geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_LengthofBrakingPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
   
   
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
   
   
   
   scale_y_continuous(breaks = seq(0.1,0.23,by = 0.01),limits = c(0.1,0.23) ) +
   
   
   scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
   
   
   labs(title = ' Braking Phase Duration - 2.3 Hz Hopping',x = 'Limb ID', y = ' Duration (sec) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
   
   facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )


)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_BrakingPhaseDuration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```





```{r Propulsion Phase Duration }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LengthofPropulsionPhase_sec )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_LengthofPropulsionPhase_sec, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x =  0.575, y = CI$ymax + 0.0025, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
   
   
   geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_LengthofPropulsionPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
   
   
   
   
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
   
   
   
   scale_y_continuous(breaks = seq(0.1,0.23,by = 0.01),limits = c(0.1,0.23) ) +
   
   
   scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
   
   
   labs(title = ' Propulsion Phase Duration - 2.3 Hz Hopping',x = 'Limb ID', y = ' Duration (sec) ' ) +
   
   
   guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
   
   facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )


)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_PropulsionPhaseDuration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Limb Power Absorption }



CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_WholeLimbWork_Braking_GenerationNeutralized )



(Power1 <- ggplot(data = Power_ParticipantMeans_Ankle_2.3Hz, aes(y = Mean_WholeLimbWork_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 6, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Group_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_Ankle_2.3Hz, aes( y = Mean_WholeLimbWork_Braking_GenerationNeutralized, x = Limb_ID, fill = Participant_ID, group = interaction(Group_ID,Limb_ID) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous(breaks = seq(-2,0,by = 0.2),limits = c(-2,0) ) +
      
      
      #scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Limb Energy Absorption - Braking Phase - 2.3 Hz Hopping',x = 'Limb ID', y = ' Limb Energy Absorption (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_ID ), scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbSumofPowerAbsorption_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```







```{r Limb Power Generation }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_TotalLimbSupportPower_PropulsionPhase )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_TotalLimbSupportPower_PropulsionPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 6, color = '#4d9221', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_TotalLimbSupportPower_PropulsionPhase, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous(breaks = seq( 0, 400, by = 50), limits = c( 0, 400 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Limb Contribution to Sum of Joint Work Rate - Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Contribution to Sum of Joint Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbSumofPowerGeneration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )


```




```{r Limb Work Rate Absorption }



CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LimbAveragePower_Braking_GenerationNeutralized )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_LimbAveragePower_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.25, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ), color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_LimbAveragePower_Braking_GenerationNeutralized, x = Limb_ID, fill = Participant_ID ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_LimbAveragePower_Braking_GenerationNeutralized, na.rm = T ) ) /10, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      
      
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous(breaks = seq(-9,0,by = 1),limits = c(-9,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Limb Work Rate - Braking Phase - 2.3 Hz Hopping',x = 'Limb ID', y = ' Contribution to Sum of Joint Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbAbsorptionWorkRate_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Limb Work Rate Generation }



CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.2, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ), color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID, fill = Participant_ID ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_LimbAveragePower_Propulsion_AbsorptionNeutralized, na.rm = T ) ) /10, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous(breaks = seq(0,9,by = 1),limits = c(0,9) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Limb Work Rate - Propulsion Phase - 2.3 Hz Hopping',x = 'Limb ID', y = ' Contribution to Sum of Joint Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbGeneratioWorkRate_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Limb MEE Absorption }



CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_Limb_Absorption_MEE, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.025, color = '#4d9221', fontface = 'bold' ) +
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ), color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_Limb_Absorption_MEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous(breaks = seq(0,1.6,by = 0.1),limits = c(0,1.6) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Total Limb MEE - Braking Phase - 2.3 Hz Hopping',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbMEEAbsorption_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```







```{r Limb MEE Generation }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Generation_MEE )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_Limb_Generation_MEE, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.025, color = '#4d9221', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_Limb_Generation_MEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous(breaks = seq(0,1.6,by = 0.1),limits = c(0,1.6) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Total Limb MEE - Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbMEEGeneration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )


```


```{r Limb Average MEE Absorption }



CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_WholeLimbAverageAbsorptionMEE )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_WholeLimbAverageAbsorptionMEE, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.2, color = '#4d9221', fontface = 'bold' ) +
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ), color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_WholeLimbAverageAbsorptionMEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous(breaks = seq(0,10,by = 1),limits = c(0,10) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Limb Average MEE - Braking Phase - 2.3 Hz Hopping',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbAverageMEEAbsorption_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```







```{r Limb Average MEE Generation }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_WholeLimbAverageGenerationMEE )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_WholeLimbAverageGenerationMEE, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.2, color = '#4d9221', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_WholeLimbAverageGenerationMEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous(breaks = seq(0,10,by = 1),limits = c(0,10) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Limb Average MEE - Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbAverageMEEGeneration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )


```


```{r Limb Peak Support Moment - Braking Phase }



CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_PeakSupportMoment_BrakingPhase)



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_PeakSupportMoment_BrakingPhase, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.125, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ), color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_PeakSupportMoment_BrakingPhase, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous(breaks = seq( -8, 0, by = 1 ),limits = c( -8, 0 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Limb Peak Support Moment \n Braking Phase - 2.3 Hz Hopping',x = 'Limb ID', y = ' Peak Support Moment (N-m/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbPeakSupportMoment_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```







```{r Limb Peak Support Moment - Propulsion Phase }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_PeakSupportMoment_PropulsionPhase )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_PeakSupportMoment_PropulsionPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.125, color = '#4d9221', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_PeakSupportMoment_PropulsionPhase, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous(breaks = seq( -8, 0, by = 1 ),limits = c( -8, 0 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Limb Peak Support Moment \n  Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Peak Support Moment (N-m/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbPeakSupportMoment_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )


```



```{r Limb Total Support Moment - Braking Phase }



CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_TotalLimbSupportMoment_BrakingPhase )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_TotalLimbSupportMoment_BrakingPhase, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 4, color = '#4d9221', fontface = 'bold' ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ), color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_TotalLimbSupportMoment_BrakingPhase, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      
   scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous( breaks = seq( -175, 0, by = 25 ), limits = c( -175, 0 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Total Limb Support Moment \n Braking Phase - 2.3 Hz Hopping',x = 'Limb ID', y = ' Support Moment (N-m/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbTotalSupportMoment_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```







```{r Limb Total Support Moment - Propulsion Phase }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_TotalLimbSupportMoment_PropulsionPhase )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes(y = Mean_TotalLimbSupportMoment_PropulsionPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 4, color = '#4d9221', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz, aes( y = Mean_TotalLimbSupportMoment_PropulsionPhase, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3, ) +
      
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                'ATx08' = met.brewer('OKeeffe1')[2],
                                'ATx10' = met.brewer('OKeeffe1')[3], 
                                'ATx12' = met.brewer('OKeeffe1')[4],
                                'ATx17' = met.brewer('OKeeffe1')[5],
                                'ATx18' = met.brewer('OKeeffe1')[6],
                                'ATx19' = met.brewer('OKeeffe1')[7],
                                'ATx21' = met.brewer('OKeeffe1')[8],
                                'ATx24' = met.brewer('OKeeffe1')[9],
                                'ATx25' = met.brewer('OKeeffe1')[10],
                                'ATx27' = met.brewer('OKeeffe1')[11],
                                'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                 'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                'HC01' = met.brewer('OKeeffe1')[1], 
                                'HC19' = met.brewer('OKeeffe1')[2],
                                'HC12' = met.brewer('OKeeffe1')[3], 
                                'HC05' = met.brewer('OKeeffe1')[4],
                                'HC06' = met.brewer('OKeeffe1')[5],
                                'HC08' = met.brewer('OKeeffe1')[6],
                                'HC20' = met.brewer('OKeeffe1')[7],
                                'HC11' = met.brewer('OKeeffe1')[8],
                                'HC17' = met.brewer('OKeeffe1')[9],
                                'HC18' = met.brewer('OKeeffe1')[2],
                                'HC21' = met.brewer('OKeeffe1')[11],
                                'HC25' = met.brewer('OKeeffe1')[ 7] ),
                     name = '',
                     aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18', 'HC19', 'HC20', 'HC21', 'HC25' ) ) +
   
      
      
      
      scale_y_continuous( breaks = seq( -175, 0, by = 25 ), limits = c( -175, 0 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      labs(title = ' Total Limb Support Moment \n Propulsion Phase - 2.3 Hz Hopping',x = 'Limb ID', y = ' Support Moment (N-m/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbTotalSupportMoment_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )


```




```{r Raw Absorption Work }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointWork_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointWork_Braking_GenerationNeutralized, yend = Mean_JointWork_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointWork_Braking_GenerationNeutralized, yend = Mean_JointWork_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_by_Morphology ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointWork_Braking_GenerationNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_by_Morphology ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized, na.rm = T ) ) /10, dotsize = 0.5, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-1,0,by = 0.1),limits = c(-1,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Net Joint Moment Work \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Absorption Work (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointAbsorptionWork_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```


```{r Raw Work Rate Absorption }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, yend = Mean_JointAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, yend = Mean_JointAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_by_Morphology ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_by_Morphology ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized, na.rm = T ) ) /10, dotsize = 0.5, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-7,0,by = 1),limits = c(-7,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Raw Net Joint Moment Work Rate \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Work Rate (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointAbsorptionWorkRate_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Raw Absorption MEE }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Absorption_MEE )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_Joint_Absorption_MEE, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_by_Morphology ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_by_Morphology ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
     scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Raw Joint MEE - Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointMEEAbsorption_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Raw Work Rate Generation }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, yend = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, yend = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, na.rm = T ) ) /9, dotsize = 0.5, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
      scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,7,by = 1),limits = c(0,7) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Raw Net Joint Moment Work Rate \n Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Work Rate (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointGenerationWorkRate_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```






```{r Raw Generation MEEx }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Generation_MEE )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_Joint_Generation_MEE, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Generation_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
      scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Raw Joint MEE - Propulsion Phase - 2.3 Hz Hopping',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointMEEGeneration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Joint Work Ratio }




CI <- mean_cl_boot( abs( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointWorkRatio_PropulsionvsBrakingPhase ) )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = abs( Mean_JointWorkRatio_PropulsionvsBrakingPhase ), x = Limb_ID  ) ) +
      
      
      
      #Arrow segment from 1 to max of y-axis.
   geom_segment( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'LessThan_2mm_Diff' ), aes( x = 0.5, xend = 0.5, y = 1.02, yend = 14 ), linewidth = 2.5, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
      
#Text explaining purpose of above arrow   
   geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'LessThan_2mm_Diff' ), label = 'Greater Positive Work', size = 9, x = 0.93, y = 13.18, fontface = 'bold' ) +
      
      
      
      #Arrow segment from 1 to max of y-axis.
   geom_segment( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'LessThan_2mm_Diff' ), aes( x = 0.5, xend = 0.5, y = 0.98, yend = 0 ), linewidth = 2.5, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
      
#Text explaining purpose of above arrow   
   geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'LessThan_2mm_Diff' ), label = 'Greater Negative Work', size = 9, x = 0.95, y = 0.02, fontface = 'bold' ) +
      
      
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.3, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
   

      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = abs( Mean_JointWorkRatio_PropulsionvsBrakingPhase ), x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.3, y = 13.6, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.3, y = 13.2, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.3, y = 12.75, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous( breaks = seq( 0, 14, by = 1 ), limits = c( 0, 14 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Work Ratio \n 2.3 Hz Hopping - Propulsion vs Braking Phase ',x = 'Limb ID', y = ' Work Ratio ( Generation/Absorption, unitless ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointWorkRatio_2.3Hz_1LimbPer3Groups_WithOutlier.png', width = 5500, height = 5500, units = 'px' )

```





###### Without Outlier

```{r Joint Work Ratio }




CI <- mean_cl_boot( abs( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointWorkRatio_PropulsionvsBrakingPhase ) )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = abs( Mean_JointWorkRatio_PropulsionvsBrakingPhase ), x = Limb_ID  ) ) +
      
      
      
      #Arrow segment from 1 to max of y-axis.
   geom_segment( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'LessThan_2mm_Diff' ), aes( x = 0.5, xend = 0.5, y = 1.02, yend = 2.2 ), linewidth = 2.5, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
      
#Text explaining purpose of above arrow   
   geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'LessThan_2mm_Diff' ), label = 'Greater Positive Work', size = 9, x = 0.93, y = 2.18, fontface = 'bold' ) +
      
      
      
      #Arrow segment from 1 to max of y-axis.
   geom_segment( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'LessThan_2mm_Diff' ), aes( x = 0.5, xend = 0.5, y = 0.98, yend = 0 ), linewidth = 2.5, arrow = arrow(length = unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
      
#Text explaining purpose of above arrow   
   geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'LessThan_2mm_Diff' ), label = 'Greater Negative Work', size = 9, x = 0.95, y = 0.02, fontface = 'bold' ) +
      
      
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.03, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
   

      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = abs( Mean_JointWorkRatio_PropulsionvsBrakingPhase ), x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.3, y = 2.125, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.3, y = 2.065, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.3, y = 2.005, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous( breaks = seq( 0, 2.2, by = 0.2 ), limits = c( 0, 2.2 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Work Ratio \n 2.3 Hz Hopping - Propulsion vs Braking Phase ',x = 'Limb ID', y = ' Work Ratio ( Generation/Absorption, unitless ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointWorkRatio_2.3Hz_1LimbPer3Groups_WithoutOutliers.png', width = 5500, height = 5500, units = 'px' )

```





```{r % Power Absorption }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_SupportPower_BrakingPhase/100 )

CI_Lessthan2mm <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_SupportPower_BrakingPhase/100 )

CI_Minof2mm <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_SupportPower_BrakingPhase/100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointContribution_SupportPower_BrakingPhase/100, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
   
   
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportPower_BrakingPhase/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Whole-Limb Power Absorption  \n 2.3 Hz Hopping - Braking Phase ',x = 'Limb ID', y = ' Contribution to Sum of Joint Work Rate Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2PowerAbsorption_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r % Power Generation }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_SupportPower_PropulsionPhase/100 )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointContribution_SupportPower_PropulsionPhase/100, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, yend = Mean_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, yend = Mean_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportPower_PropulsionPhase/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ) , color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Whole-Limb Power Generation \n 2.3 Hz Hopping - Propulsion Phase ',x = 'Limb ID', y = ' Contribution to Sum of Joint Work Rate ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2PowerGeneration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```


```{r Raw Absorption MEE }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_TotalJointSupportPower_BrakingPhase  )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_TotalJointSupportPower_BrakingPhase, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Group_by_Morphology ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_TotalJointSupportPower_BrakingPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_by_Morphology ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Raw Joint MEE - Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointMEEAbsorption_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Raw Generation MEE - ATx }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Generation_MEE )


(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_Joint_Generation_MEE, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Generation_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
  scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Raw Joint MEE - Propulsion Phase - 2.3 Hz Hopping',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointMEEGeneration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r % Absorption MEE }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Percent_MEE_Absorption )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_Joint_Percent_MEE_Absorption, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 12, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
   
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      

      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
     scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Whole-Limb MEE  \n 2.3 Hz Hopping - Braking Phase ',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2MEEAbsorption_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r % Generation MEE }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Percent_MEE_Generation )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_Joint_Percent_MEE_Generation, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, yend = Mean_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, yend = Mean_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ) , color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Whole-Limb MEE \n 2.3 Hz Hopping - Propulsion Phase ',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2MEEGeneration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```


```{r % Average Absorption MEE }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_AverageAbsorptionMEE )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointContribution_AverageAbsorptionMEE, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 12, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_AverageAbsorptionMEE, yend = Mean_JointContribution_AverageAbsorptionMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_AverageAbsorptionMEE, yend = Mean_JointContribution_AverageAbsorptionMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
   
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      

      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_AverageAbsorptionMEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Average Limb MEE Absorption  \n 2.3 Hz Hopping - Braking Phase ',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2AverageMEEAbsorption_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r % Average Generation MEE }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_AverageGenerationMEE )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointContribution_AverageGenerationMEE, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_AverageGenerationMEE, yend = Mean_JointContribution_AverageGenerationMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_AverageGenerationMEE, yend = Mean_JointContribution_AverageGenerationMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_AverageGenerationMEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ) , color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
     scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Average Limb MEE Generation \n 2.3 Hz Hopping - Propulsion Phase ',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2AverageMEEGeneration_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



###### % Average Support Power - Opposite Neutralized


```{r % Braking Support Power - Generation Neutralized }




CI <- mean_cl_boot( abs(Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized) /100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = abs(Mean_JointContribution_AveragePower_GenerationNeutralized) /100, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 12.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportPower_BrakingPhase, yend = Mean_JointContribution_SupportPower_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportPower_BrakingPhase, yend = Mean_JointContribution_SupportPower_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ) , linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = abs(Mean_JointContribution_AveragePower_GenerationNeutralized) /100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized/100, na.rm = T ) ) /10, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 14, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 14, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 14, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title =  ' Joint Contribution to Limb Absorption Work Rate \n  Generation Neutralized  \n 2.3 Hz Hopping - Braking Phase ',x = 'Limb ID', y = ' Contribution to Sum of Joint Work Rate ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 35,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 35,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 30,face = 'bold')  ) +
      
      
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2AverageSupportPower_GenerationNeutralized_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r % Propulsion Support Power - Absorption Neutralized }




CI <- mean_cl_boot( abs(Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized) /100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = abs(Mean_JointContribution_AveragePower_AbsorptionNeutralized) /100, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportPower_PropulsionPhase, yend = Mean_JointContribution_SupportPower_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportPower_PropulsionPhase, yend = Mean_JointContribution_SupportPower_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = abs(Mean_JointContribution_AveragePower_AbsorptionNeutralized) /100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, na.rm = T ) ) /9, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Limb Generation Work Rate \n Absorption Neutralized \n 2.3 Hz Hopping - Propulsion Phase ',x = 'Limb ID', y = ' Contribution to Sum of Joint Work Rate ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2AverageSupportPower_AbsorptionNeutralized_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```


###### % Support Moment


```{r % Peak Braking Support Moment }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_PeakSupportMoment_BrakingPhase/100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointContribution_PeakSupportMoment_BrakingPhase/100, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_PeakSupportMoment_BrakingPhase, yend = Mean_JointContribution_PeakSupportMoment_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_PeakSupportMoment_BrakingPhase, yend = Mean_JointContribution_PeakSupportMoment_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
   
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_PeakSupportMoment_BrakingPhase/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
     scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Peak Support Moment \n 2.3 Hz Hopping - Braking Phase ',x = 'Limb ID', y = ' Support Moment Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2PeakSupportMoment_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```


```{r % Peak Propulsion Support Moment }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_PeakSupportMoment_PropulsionPhase/100 )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointContribution_PeakSupportMoment_PropulsionPhase/100, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_PeakSupportMoment_PropulsionPhase, yend = Mean_JointContribution_PeakSupportMoment_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_PeakSupportMoment_PropulsionPhase, yend = Mean_JointContribution_PeakSupportMoment_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  ) + 
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_PeakSupportMoment_PropulsionPhase/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ) , color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Peak Support Moment \n 2.3 Hz Hopping - Propulsion Phase ',x = 'Limb ID', y = ' Support Moment Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2PeakSupportMoment_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```


###### % Total Support Moment

```{r % Total Braking Support Moment }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_SupportMoment_BrakingPhase/100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointContribution_SupportMoment_BrakingPhase/100, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportMoment_BrakingPhase, yend = Mean_JointContribution_SupportMoment_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportMoment_BrakingPhase, yend = Mean_JointContribution_SupportMoment_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportMoment_BrakingPhase/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Total Support Moment \n 2.3 Hz Hopping - Braking Phase ',x = 'Limb ID', y = ' Support Moment Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2SupportMoment_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r % Total Propulsion Support Moment }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_SupportMoment_PropulsionPhase/100 )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointContribution_SupportMoment_PropulsionPhase/100, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportMoment_PropulsionPhase, yend = Mean_JointContribution_SupportMoment_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportMoment_PropulsionPhase, yend = Mean_JointContribution_SupportMoment_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  ) + 
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportMoment_PropulsionPhase/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ) , color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Total Support Moment \n 2.3 Hz Hopping - Propulsion Phase ',x = 'Limb ID', y = ' Support Moment Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2SupportMoment_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```





###### % Total Support Moment - No Flexor Torque

```{r % Total Braking Support Moment }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointSupportMomentContribution_Braking_NoFlexorTorque/100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointSupportMomentContribution_Braking_NoFlexorTorque/100, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointSupportMomentContribution_Braking_NoFlexorTorque, yend = Mean_JointSupportMomentContribution_Braking_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointSupportMomentContribution_Braking_NoFlexorTorque, yend = Mean_JointSupportMomentContribution_Braking_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointSupportMomentContribution_Braking_NoFlexorTorque/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
  scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Total Support Moment - No Flexor Torque \n 2.3 Hz Hopping - Braking Phase ',x = 'Limb ID', y = ' Support Moment Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2SupportMoment_NoFlexorTorque_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 6500, height = 6500, units = 'px' )

```




```{r % Total Propulsion Support Moment }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointSupportMomentContribution_Propulsion_NoFlexorTorque/100 )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointSupportMomentContribution_Propulsion_NoFlexorTorque/100, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointSupportMomentContribution_Propulsion_NoFlexorTorque, yend = Mean_JointSupportMomentContribution_Propulsion_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointSupportMomentContribution_Propulsion_NoFlexorTorque, yend = Mean_JointSupportMomentContribution_Propulsion_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  ) + 
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointSupportMomentContribution_Propulsion_NoFlexorTorque/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ) , color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Total Support Moment - No Flexor Torque \n 2.3 Hz Hopping - Propulsion Phase ',x = 'Limb ID', y = ' Support Moment Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2SupportMoment_NoFlexorTorque_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 6500, height = 6500, units = 'px' )

```



###### % Support Moment = Extensor


```{r % Total Braking Support Moment }




CI <- mean_cl_boot( abs(Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_Braking_AllNegativeSupportMoment) /100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = abs(Mean_JointContribution_Braking_AllNegativeSupportMoment) /100, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportMoment_BrakingPhase, yend = Mean_JointContribution_SupportMoment_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportMoment_BrakingPhase, yend = Mean_JointContribution_SupportMoment_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = abs(Mean_JointContribution_Braking_AllNegativeSupportMoment) /100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Support Moment \n  Limb Support Moment = Extensor \n 2.3 Hz Hopping - Braking Phase ',x = 'Limb ID', y = ' Support Moment Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2SupportMoment_SupportMomentEqualsExtensor_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r % Total Propulsion Support Moment }




CI <- mean_cl_boot( abs(Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointContribution_Propulsion_AllNegativeSupportMoment) /100 )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = abs(Mean_JointContribution_Propulsion_AllNegativeSupportMoment) /100, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportMoment_PropulsionPhase, yend = Mean_JointContribution_SupportMoment_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointContribution_SupportMoment_PropulsionPhase, yend = Mean_JointContribution_SupportMoment_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = abs(Mean_JointContribution_Propulsion_AllNegativeSupportMoment) /100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
    scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +    
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Joint Contribution to Support Moment \n  Limb Support Moment = Extensor \n 2.3 Hz Hopping - Propulsion Phase ',x = 'Limb ID', y = ' Support Moment Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointContribution2SupportMoment_SupportMomentEqualsExtensor_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```







```{r Absorption Torque Impulse }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Absorption_SagittalTorqueImpulse )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_Joint_Absorption_SagittalTorqueImpulse, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymin - 0.0095, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_SagittalTorqueImpulse, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.078, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.058, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.038, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-0.4,0.1,by = 0.05),limits = c(-0.4,0.1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = '  Sagittal Plane Joint Torque Impulse  \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointSagittalTorqueImpulse_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Generation Torque Impulse }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Generation_SagittalTorqueImpulse )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_Joint_Generation_SagittalTorqueImpulse, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymin - 0.0095, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Generation_SagittalTorqueImpulse, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.078, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.058, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.038, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-0.4,0.1,by = 0.1),limits = c(-0.4,0.1) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Sagittal Plane Joint Torque Impulse  \n Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointSagittalTorqueImpulse_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```


```{r Avg Absorption Torque Impulse }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointAverageBrakingTorque )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAverageBrakingTorque, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymin - 0.05, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot',
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAverageBrakingTorque, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.42, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.33, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.24, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-2,0.5,by = 0.25),limits = c(-2,0.5) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Sagittal Plane Average Joint Torque Impulse  \n Braking Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison/Group Comparison', filename = 'Dissertation_AverageJointSagittalTorqueImpulse_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Avg Generation Torque Impulse }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointAveragePropulsionTorque )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAveragePropulsionTorque, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymin - 0.05, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAveragePropulsionTorque, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.4, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.33, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.24, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-2,0.5,by = 0.25),limits = c(-2,0.5) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Sagittal Plane Average Joint Torque Impulse  \n Propulsion Phase - 2.3 Hz Hopping ',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AverageJointSagittalTorqueImpulse_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```


```{r Average Absorption Angular Velocity }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_AverageJointAngVel_BrakingPhase )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_AverageJointAngVel_BrakingPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 5, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_AverageJointAngVel_BrakingPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.4, y = 220, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.4, y = 212, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.4, y = 204.5, fontface = 'bold' ) +
      
      
      
  scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-25,225,by = 25),limits = c(-25,225) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Average Sagittal Plane Joint Angular Velocity \n  Braking Phase - 2.3 Hz Hopping',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AverageJointSagittalAngularVelocity_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5600, height = 5600, units = 'px' )

```



```{r Average Generation Angular Velocity }





CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_AverageJointAngVel_PropulsionPhase )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_AverageJointAngVel_PropulsionPhase, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 5, color = '#1b9e77', fontface = 'bold' ) +
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_AverageJointAngVel_PropulsionPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = -20, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = -28, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = -36, fontface = 'bold' ) +
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-275,0,by = 25),limits = c(-275,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Average Sagittal Plane Joint Angular Velocity \n  Propulsion Phase - 2.3 Hz Hopping',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AverageJointSagittalAngularVelocity_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5600, height = 5600, units = 'px' )

```



```{r Peak Absorption Angular Velocity }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Absorption )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_Peak_Joint_AngularVelocity_Absorption, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 5, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Peak_Joint_AngularVelocity_Absorption, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 106, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 95, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 83.5, fontface = 'bold' ) +
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,400,by = 25),limits = c(0,400) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Peak Sagittal Plane Joint Angular Velocity \n  Braking Phase - 2.3 Hz Hopping',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_PeakJointSagittalAngularVelocity_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5600, height = 5600, units = 'px' )

```



```{r Peak Generation Angular Velocity }





CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Generation )



(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_Peak_Joint_AngularVelocity_Generation, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 5, color = '#1b9e77', fontface = 'bold' ) +
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Peak_Joint_AngularVelocity_Generation, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = -20, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = -28, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = -36, fontface = 'bold' ) +
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-400,0,by = 50),limits = c(-400,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Peak Sagittal Plane Joint Angular Velocity \n  Propulsion Phase - 2.3 Hz Hopping',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_PeakJointSagittalAngularVelocity_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5600, height = 5600, units = 'px' )

```




```{r RoM Braking Phase }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_SagittalRoM_BrakingPhase )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_SagittalRoM_BrakingPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.75, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_SagittalRoM_BrakingPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1, y = 34, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1, y = 33, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1, y = 32, fontface = 'bold' ) +
      
      
      
  scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,35,by = 5),limits = c(0,35) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Sagittal Plane Range of Motion \n  Braking Phase - 2.3 Hz Hopping',x = 'Limb ID', y = expression( paste( ' Range of Motion (', degree, ') [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_PeakJointSagittalRoM_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5600, height = 5600, units = 'px' )

```


```{r RoM Propulsion Phase }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_SagittalRoM_PropulsionPhase )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_SagittalRoM_PropulsionPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.75, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_SagittalRoM_PropulsionPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1, y = -4.5, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1, y = -6, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1, y = -7.5, fontface = 'bold' ) +
      
      
      
  scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-40,0,by = 5),limits = c(-40,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Sagittal Plane Range of Motion \n  Propulsion Phase - 2.3 Hz Hopping',x = 'Limb ID', y = expression( paste( ' Range of Motion (', degree, ') [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_PeakJointSagittalRoM_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5600, height = 5600, units = 'px' )

```


```{r Initial Contact Angle }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointInitialContactAngle )




(Power1 <- ggplot(data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointInitialContactAngle, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 1.5, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointInitialContactAngle, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1, y = 48.5, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1, y = 46, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( Power_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_by_Morphology ==  'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1, y = 43.5, fontface = 'bold' ) +
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq( -30, 60,by = 10),limits = c( -30, 60 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Joint Angular Position at Initial Ground \n Contact - 2.3 Hz Hopping',x = 'Limb ID', y = expression( paste( ' Angular Position (', degree, ') [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 30,face = 'bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_JointInitialContactAngle_2.3Hz_1LimbPer3Groups.png', width = 5600, height = 5600, units = 'px' )

```

##### Regressions

###### Ankle Work vs Morphology

```{r Braking Phase }



AnkleBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_Joint_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized, digits = 2),
                                                                  Mean_Joint_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_Joint_Work_GenerationNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      #Use geom point to create scatter plot 
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = round( seq( -0.3, 0.3, by = 0.1 ), digits = 2), limits =  round( c( -0.3, 0.3 ), digits = 2 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Ankle Work Absorption vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Ankle Work Absorption ( J/kg ) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInAnkleWorkAbsorptionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```






```{r Propulsion Phase }



AnkleBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_Joint_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized, digits = 2),
                                                                  Mean_Joint_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_Joint_Work_AbsorptionNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = round( seq( -0.3, 0.3, by = 0.1 ), digits = 2), limits =  round( c( -0.3, 0.3 ), digits = 2 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Ankle Work Generation vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Ankle Work Generation ( J/kg ) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInAnkleWorkGenerationvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```





###### Knee Work vs Morphology

```{r Braking Phase }



KneeBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_Joint_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized, digits = 2),
                                                                  Mean_Joint_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = KneeBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_Joint_Work_GenerationNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = round( seq( -0.3, 0.3, by = 0.1 ), digits = 2), limits =  round( c( -0.3, 0.3 ), digits = 2 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Knee Work Absorption vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Knee Work Absorption ( J/kg ) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInKneeWorkAbsorptionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```






```{r Propulsion Phase }



KneeBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_Joint_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized, digits = 2),
                                                                  Mean_Joint_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = KneeBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_Joint_Work_AbsorptionNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = round( seq( -0.3, 0.3, by = 0.1 ), digits = 2), limits =  round( c( -0.3, 0.3 ), digits = 2 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Knee Work Generation vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Knee Work Generation ( J/kg ) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInKneeWorkGenerationvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```







###### Hip Work vs Morphology

```{r Braking Phase }



HipBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_Joint_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized, digits = 2),
                                                                  Mean_Joint_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = HipBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_Joint_Work_GenerationNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = round( seq( -0.3, 0.3, by = 0.1 ), digits = 2), limits =  round( c( -0.3, 0.3 ), digits = 2 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Hip Work Absorption vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Hip Work Absorption ( J/kg ) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInHipWorkAbsorptionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```






```{r Propulsion Phase }



HipBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_Joint_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_JointWork_Braking_GenerationNeutralized, digits = 2),
                                                                  Mean_Joint_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_JointWork_Propulsion_AbsorptionNeutralized, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = HipBetweenLimbDiffWorkvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_Joint_Work_AbsorptionNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = round( seq( -0.3, 0.3, by = 0.1 ), digits = 2), limits =  round( c( -0.3, 0.3 ), digits = 2 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Hip Work Generation vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Hip Work Generation ( J/kg ) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInHipWorkGenerationvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```




###### Ankle Work Rate vs Morphology

```{r Braking Phase }


AnkleAveragePowervsMorphology_2.3Hz_ATxInvolvedLimb <- data.frame( Group_ID = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  Participant_ID = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Participant_ID, 
                                                                  DifferenceinTendonThickness_mm = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointAveragePower_Braking_GenerationNeutralized = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized,
                                                                  Mean_JointAveragePower_Propulsion_AbsorptionNeutralized = Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized )




#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleAveragePowervsMorphology_2.3Hz_ATxInvolvedLimb, aes(y = Mean_JointAveragePower_Braking_GenerationNeutralized, x = DifferenceinTendonThickness_mm ) ) +
      
      #Add in Spearman rho values
      geom_text( label = expression( paste( 'Spearman ', rho, ' = 0.18, p = 0.47' ) ), x = 3, y = -2.9, size = 12 ) +
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, se = F, linewidth = 5 ) +
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -7, -1, by = 1 ), limits =  c( -7, -1 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Work Rate Absorption vs \n Interlimb Diff in Tendon Thickness  \n 2.3 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Work Rate (W/kg) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAveragePowerAbsorptionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```




```{r Propulsion Phase }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleAveragePowervsMorphology_2.3Hz_ATxInvolvedLimb, aes(y = Mean_JointAveragePower_Propulsion_AbsorptionNeutralized, x = DifferenceinTendonThickness_mm ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, se = F, linewidth = 5 ) +
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 1, 7, by = 1 ), limits =  c( 1, 7 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Generation Work Rate vs \n Interlimb Diff in Tendon Thickness  \n 2.3 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Work Rate (W/kg) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAveragePowerGenerationvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```



###### Ankle Work Contribution vs Morphology

```{r Braking Phase }



AnkleBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointContribution_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_JointWorkContribution_Braking_GenerationNeutralized*100, digits = 2),
                                                                  Mean_JointContribution_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized*100, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_JointContribution_Work_GenerationNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -30, 30, by = 10 ), limits =  c( -30, 30 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Ankle Contribution to Energy Absorption vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Energy Absorption Contribution (%) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInAnkleEnergyAbsorptionContributionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```




```{r Propulsion Phase }



AnkleBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointContribution_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_JointWorkContribution_Braking_GenerationNeutralized*100, digits = 2),
                                                                  Mean_JointContribution_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Ankle_2.3Hz$Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized*100, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_JointContribution_Work_AbsorptionNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -30, 30, by = 10 ), limits =  c( -30, 30 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Ankle Contribution to Energy Generation vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Energy Generation Contribution (%) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInAnkleEnergyGenerationContributionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```



###### Knee Work Contribution vs Morphology

```{r Braking Phase }



KneeBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointContribution_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_JointWorkContribution_Braking_GenerationNeutralized*100, digits = 2),
                                                                  Mean_JointContribution_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized*100, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = KneeBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_JointContribution_Work_GenerationNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -30, 30, by = 10 ), limits =  c( -30, 30 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Knee Contribution to Energy Absorption vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Energy Absorption Contribution (%) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInKneeEnergyAbsorptionContributionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```




```{r Propulsion Phase }



KneeBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointContribution_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_JointWorkContribution_Braking_GenerationNeutralized*100, digits = 2),
                                                                  Mean_JointContribution_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Knee_2.3Hz$Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized*100, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = KneeBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_JointContribution_Work_AbsorptionNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -30, 30, by = 10 ), limits =  c( -30, 30 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Knee Contribution to Energy Generation vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Energy Generation Contribution (%) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInKneeEnergyGenerationContributionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```






###### Hip Work Contribution vs Morphology

```{r Braking Phase }



HipBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointContribution_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_JointWorkContribution_Braking_GenerationNeutralized*100, digits = 2),
                                                                  Mean_JointContribution_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized*100, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = HipBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_JointContribution_Work_GenerationNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -30, 30, by = 10 ), limits =  c( -30, 30 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Hip Contribution to Energy Absorption vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Energy Absorption Contribution (%) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInHipEnergyAbsorptionContributionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```




```{r Propulsion Phase }



HipBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz <- data.frame( Group_ID = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Group_ID,
                                                                  
                                                                  Participant_ID = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Participant_ID, 
                                                                                                   
                                                                  BetweenLimbTendonThickness_mm = Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointContribution_Work_GenerationNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_JointWorkContribution_Braking_GenerationNeutralized*100, digits = 2),
                                                                  Mean_JointContribution_Work_AbsorptionNeutralized = round( Power_BetweenLimbDiff_ParticipantMeans_Hip_2.3Hz$Mean_JointWorkContribution_Propulsion_AbsorptionNeutralized*100, digits = 2 ) )








#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = HipBetweenLimbDiffWorkContributionvsMorphology_ParticipantMeans_2.3Hz, aes(y = Mean_JointContribution_Work_AbsorptionNeutralized, x = BetweenLimbTendonThickness_mm  ) ) +
      
    
      #Use geom_smooth to fit a regression line. In this plot, this is just to show the trend and not an actual stat result
    geom_smooth( formula = y~x, aes( group = Group_ID, color = Group_ID  ), linewidth = 2, alpha = 0.85, na.rm = T, method = 'lm', se = F  ) +
      
      
    
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Group_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41', 'ATx' = '#c51b7d',
                                 'Control' = '#7fbc41' ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -30, 30, by = 10 ), limits =  c( -30, 30 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Limb Diff in Hip Contribution to Energy Generation vs \n Interlimb Diff in Tendon Thickness  \n 2.33 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Limb Difference in Energy Generation Contribution (%) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbDiffInHipEnergyGenerationContributionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```


###### Ankle Power Contribution vs Morphology

```{r Braking Phase }



AnklePowerContributionvsMorphology_ParticipantMeans_2.3Hz_InvolvedvsMatchedDominance <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  
                                                                  Participant_ID = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Participant_ID, 
                                                                  
Limb_ID = Power_ParticipantMeans_Ankle_2.3Hz$Limb_ID,                                                 
                                                                  BetweenLimbTendonThickness_mm = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm, 
                                                                  Mean_JointContribution_AveragePower_GenerationNeutralized = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized,
                                                                  Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized  )

AnklePowerContributionvsMorphology_ParticipantMeans_2.3Hz_InvolvedvsMatchedDominance$BetweenLimbTendonThickness_mm_No0Point55mm <- as.numeric( Power_ParticipantMeans_1LimbPer2Groups_Ankle_2.3Hz$Mean_BetweenLimbTendonThickness_mm )

AnklePowerContributionvsMorphology_ParticipantMeans_2.3Hz_InvolvedvsMatchedDominance$BetweenLimbTendonThickness_mm_No0Point55mm[ which( AnklePowerContributionvsMorphology_ParticipantMeans_2.3Hz_InvolvedvsMatchedDominance$BetweenLimbTendonThickness_mm ==  0.55 ) ] <- NA







#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnklePowerContributionvsMorphology_2.3Hz_InvolvedvsMatchedDominance, aes(y = Mean_JointContribution_AveragePower_GenerationNeutralized/100, x = DifferenceinTendonThickness_mm ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, se = F, linewidth = 5 ) +
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Contribution to Power Absorption vs \n Interlimb Diff in Tendon Thickness  \n 2.3 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Contribution (Max = 1) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnklePowerAbsorptionContributionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```




```{r Propulsion Phase }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnklePowerContributionvsMorphology_2.3Hz_ATxInvolvedLimb, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = DifferenceinTendonThickness_mm ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, se = F, linewidth = 5 ) +
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID ), shape = 23, color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 4, by = 0.5), limits = c(0, 4) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Ankle Contribution to Power Generation vs \n Interlimb Diff in Tendon Thickness  \n 2.3 Hz Hopping ', x = 'Interlimb Difference in Tendon Thickness (mm)', y = ' Contribution (Max = 1) ' ) +
      
    
      #Remove all legends
      guides( color = 'none', size = 'none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) ) + 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color = 'black', linewidth = 1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text = element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_AnklePowerGenerationContributionvsInterlimbDiffinTendonThickness.png', width = 5750, height = 5750, units = 'px' )

```














### Individual Hops

###### Average Support Power - Opposite Neutralized
```{r % Braking Support Power - Generation Neutralized }




(Power1 <- ggplot(data = Power_1LimbPer3Groups_Ankle_2.3Hz, aes(y = JointContribution_AveragePower_GenerationNeutralized/100, x = Group_by_Morphology  ) ) +
      

      
      geom_point( data = Power_1LimbPer3Groups_Ankle_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized/100, x = Group_by_Morphology, fill = Participant_ID, group = interaction( Participant_ID, Group_by_Morphology), shape = Group_by_Morphology ), color = 'black', size = 6, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( label = 'Healthy Control Hop # = ', size = 12, color = '#4d9221', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( label = 'Less Than 2 mm Diff ATx', size = 12, color = '#7fbc41', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( label = 'Minimum 2 mm Diff ATx', size = 12, color = '#c51b7d', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
      
      scale_fill_manual( values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                 'ATx08' = met.brewer('OKeeffe1')[2],
                                 'ATx10' = met.brewer('OKeeffe1')[3], 
                                 'ATx12' = met.brewer('OKeeffe1')[4],
                                 'ATx17' = met.brewer('OKeeffe1')[5],
                                 'ATx18' = met.brewer('OKeeffe1')[6],
                                 'ATx19' = met.brewer('OKeeffe1')[7],
                                 'ATx21' = met.brewer('OKeeffe1')[8],
                                 'ATx24' = met.brewer('OKeeffe1')[9],
                                 'ATx25' = met.brewer('OKeeffe1')[10],
                                 'ATx27' = met.brewer('OKeeffe1')[11],
                                 'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                  'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                 'HC01' = met.brewer('OKeeffe1')[1], 
                                 'HC19' = met.brewer('OKeeffe1')[2],
                                 'HC12' = met.brewer('OKeeffe1')[3], 
                                 'HC05' = met.brewer('OKeeffe1')[4],
                                 'HC06' = met.brewer('OKeeffe1')[5],
                                 'HC08' = met.brewer('OKeeffe1')[6],
                                 'HC20' = met.brewer('OKeeffe1')[7],
                                 'HC11' = met.brewer('OKeeffe1')[8],
                                 'HC17' = met.brewer('OKeeffe1')[9],
                                 'HC18' = met.brewer('OKeeffe1')[2],
                                 'HC21' = met.brewer('OKeeffe1')[11],
                                 'HC25' = met.brewer('OKeeffe1')[ 7],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221','Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02' ),
                      name = '',
                      aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19','HC18', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance', 'Ankle', 'Knee', 'Hip' ) ) +
      
    
      scale_shape_manual( values = c( 'Minimum_2mm_Diff' = 23, 
                                 'LessThan_2mm_Diff' = 24,
                                 'Control' = 21 ) ) +
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
      
      
      scale_x_discrete(labels = c( 'Minimum_2mm_Diff' = 'Min 2 mm Diff \n ATx', 
                                 'LessThan_2mm_Diff' = '< 2 mm Diff \n ATx',
                                 'Control' = 'Control' ) ) +
      
      
      
      labs(title =  ' Ankle Contribution to Limb Work Rate Absorption \n  Generation Neutralized  \n 2.3 Hz Hopping - Braking Phase ',x = 'Group ID', y = ' Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 30,face = 'bold')  ) 
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_Scatterplot_JointContribution2AverageSupportPower_GenerationNeutralized_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```


### Individual Participants

##### Involved vs Non-Involved



###### 2.3 Hz

```{r Hop Rate }


(Power1 <- ggplot(data = Power_ATx_Ankle_2.3Hz, aes(y = Mean_HopFrequency, x = Limb_ID  ) ) +
      
    geom_hline( yintercept = 2.33, linewidth = 2, linetype = 'dashed', color = 'black' ) +

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_HopFrequency, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_Ankle_2.3Hz, aes( y = Mean_HopFrequency, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(2,3,by = 0.1),limits = c(2,3) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Hop Height \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Height (cm) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```



```{r Hop Height }


(Power1 <- ggplot(data = Power_ATx_Ankle_2.3Hz, aes(y = Mean_HoppingHeight_m*100, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_HoppingHeight_m*100, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_Ankle_2.3Hz, aes( y = Mean_HoppingHeight_m*100, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,4,by = 0.5),limits = c(0,4) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Hop Height \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Height (cm) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r Flight Duration }


(Power1 <- ggplot(data = Power_ATx_Ankle_2.3Hz, aes(y = Mean_LengthofFlightPhase_sec, x = Limb_ID  ) ) +
      
    

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_LengthofFlightPhase_sec, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_Ankle_2.3Hz, aes( y = Mean_LengthofFlightPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Flight Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r Braking Phase Duration }


(Power1 <- ggplot(data = Power_ATx_Ankle_2.3Hz, aes(y = Mean_LengthofBrakingPhase_sec, x = Limb_ID  ) ) +
      
    

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_LengthofBrakingPhase_sec, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_Ankle_2.3Hz, aes( y = Mean_LengthofBrakingPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0.1,0.2,by = 0.01),limits = c(0.1,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Braking Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r Propulsion Phase Duration }


(Power1 <- ggplot(data = Power_ATx_Ankle_2.3Hz, aes(y = Mean_LengthofPropulsionPhase_sec, x = Limb_ID  ) ) +
      
    

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_LengthofPropulsionPhase_sec, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_Ankle_2.3Hz, aes( y = Mean_LengthofPropulsionPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 2) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0.1,0.2,by = 0.01),limits = c(0.1,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Propulsion Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r Limb MEE Absorption }






(Power1 <- ggplot(data = Power_ATx_Ankle_2.3Hz, aes(y = Mean_Limb_Absorption_MEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_Limb_Absorption_MEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_Ankle_2.3Hz, aes( y = Mean_Limb_Absorption_MEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1.75, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1.4,by = 0.2),limits = c(0,1.4) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Total Limb MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r Limb MEE Generation }






(Power1 <- ggplot(data = Power_ATx_Ankle_2.3Hz, aes(y = Mean_Limb_Generation_MEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_Limb_Generation_MEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_Ankle_2.3Hz, aes( y = Mean_Limb_Generation_MEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1.75, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1.4,by = 0.2),limits = c(0,1.4) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
   
      labs(title = ' Total Limb MEE - Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```



```{r Raw Absorption MEE }






(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_Joint_Absorption_MEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_2.3Hz, aes(x = Limb_ID, y = Mean_Joint_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Raw Joint MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r Raw Generation MEE - ATx }



(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_Joint_Generation_MEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_Joint_Generation_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint MEE During Propulsion Phase \n 2.3 Hz Hopping - ATx vs Control',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r % Absorption MEE }






(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_Joint_Percent_MEE_Absorption, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_Joint_Percent_MEE_Absorption, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
   
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Whole-Limb MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r % Generation MEE }



(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_Joint_Percent_MEE_Generation, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_Joint_Percent_MEE_Generation, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, yend = Mean_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, yend = Mean_Joint_Percent_MEE_Generation, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Generation, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ) , color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.815 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
   
   
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Propulsion Phase Whole-Limb MEE \n 2.3 Hz Hopping - ATx vs Control',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```


```{r Absorption Torque Impulse }






(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_Joint_Absorption_SagittalTorqueImpulse, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_Joint_Absorption_SagittalTorqueImpulse, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_SagittalTorqueImpulse, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.5, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.07 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.05 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.03 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-0.4,0.1,by = 0.1),limits = c(-0.4,0.1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Sagittal Plane Joint Torque Impulse - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r Generation Torque Impulse }






(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_Joint_Generation_SagittalTorqueImpulse, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_Joint_Generation_SagittalTorqueImpulse, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Generation_SagittalTorqueImpulse, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.07 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.05 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.03 ) +
      

   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-0.4,0.1,by = 0.1),limits = c(-0.4,0.1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Torque Impulse During Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```



```{r Absorption Angular Velocity }






(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_AverageJointAngVel_BrakingPhase, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_AverageJointAngVel_BrakingPhase, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_AverageJointAngVel_BrakingPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      


   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 40 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 25 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 10 ) +
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-25,225,by = 25),limits = c(-25,225) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Peak Sagittal Plane Joint Angular Velocity - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)



```

```{r Generation Angular Velocity }






(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_AverageJointAngVel_PropulsionPhase, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_AverageJointAngVel_PropulsionPhase, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_AverageJointAngVel_PropulsionPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 3 ) +
      
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = -10 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = -25 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = -40 ) +
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-275,0,by = 25),limits = c(-275,0) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Peak Joint Angular Velocity During Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```



```{r Generation Angular Velocity }






(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_AverageJointAngVel_PropulsionPhase, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_AverageJointAngVel_PropulsionPhase, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 1, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_AverageJointAngVel_PropulsionPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 3 ) +
      
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = -10 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = -25 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = -40 ) +
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-275,0,by = 25),limits = c(-275,0) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Peak Joint Angular Velocity During Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r % Knee and Ankle Absorption MEE }






(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Braking, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_Limb_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Limb_ID ), color = 'Ankle' ), linewidth = 1, show.legend = F, na.rm = T  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Braking, x = Limb_ID, fill = 'Ankle', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
   stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( x = Limb_ID, y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Braking, group = interaction( Limb_ID ), color = 'Knee' ), linewidth = 1, show.legend = F, na.rm = T  ) + 
    
   
   
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Braking, x = Limb_ID, fill = 'Knee', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Braking Phase Whole-Limb MEE  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

```{r % Knee and Ankle Propulsion MEE }






(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Propulsion, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_Limb_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, yend = Mean_Joint_Percent_MEE_Absorption, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Limb_ID ), color = 'Ankle' ), linewidth = 1, show.legend = F, na.rm = T  ) + 
    
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_AnklePercentMEE_ofAnkleandKneeMEE_Propulsion, x = Limb_ID, fill = 'Ankle', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
   stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( x = Limb_ID, y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Propulsion, group = interaction( Limb_ID ), color = 'Knee' ), linewidth = 1, show.legend = F, na.rm = T  ) + 
    
   
   
   
    geom_dotplot( data = Power_ATx_2.3Hz, aes( y = Mean_KneePercentMEE_ofAnkleandKneeMEE_Propulsion, x = Limb_ID, fill = 'Knee', group = interaction( Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.5, inherit.aes = F, stroke = 3, binwidth = 1/50, na.rm = T ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.885 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.85 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) ) +
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title = ' Joint Contribution to Propulsion Phase Whole-Limb MEE  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255,alpha = 55)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 2, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.3 Hz'  ) ) )

 
)




```

###### ATx Involved

####### 2.3 Hz


```{r Flight Duration }


(Power1 <- ggplot(data = Power_ATx_InvolvedAnkle_2.3Hz, aes(y = LengthofFlightPhase_sec, x = Limb_ID  ) ) +
      
    

      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_InvolvedAnkle_2.3Hz, aes( y = LengthofFlightPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 2.5, inherit.aes = F, stroke = 2, stackratio = 0.8) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44', 'Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0.02,0.2,by = 0.02),limits = c(0.02,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
   
      labs(title = ' Flight Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255,alpha = 55)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_FlightDuration_2.3Hz_ATxInvolvedLimb.png', width = 5500, height = 5500, units = 'px' )

```



```{r Contact Phase Duration }


(Power1 <- ggplot(data = Power_ATx_InvolvedAnkle_2.3Hz, aes(y = LengthofContactPhase_sec, x = Limb_ID  ) ) +
      
    

      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_InvolvedAnkle_2.3Hz, aes( y = LengthofContactPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 2.5, inherit.aes = F, stroke = 2, stackratio = 0.8) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44', 'Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0.2,0.425,by = 0.025),limits = c(0.2,0.425) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
   
      labs(title = ' Contact Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_ContactPhaseDuration_2.3Hz_ATxInvolvedLimb.png', width = 5500, height = 5500, units = 'px' )

```




```{r Braking Phase Duration }


(Power1 <- ggplot(data = Power_ATx_InvolvedAnkle_2.3Hz, aes(y = LengthofBrakingPhase_sec, x = Limb_ID  ) ) +
      
    

      geom_path( data = Power_ATx_InvolvedAnkle_2.3Hz, aes(x = Limb_ID, y = LengthofBrakingPhase_sec, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_InvolvedAnkle_2.3Hz, aes( y = LengthofBrakingPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 2.5, inherit.aes = F, stroke = 2, stackratio = 0.8 ) +
      

   

               scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44', 'Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ) ) +
    
    
      
      
      scale_y_continuous(breaks = seq(0.1,0.24,by = 0.02),limits = c(0.1,0.24) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
   
      labs(title = ' Braking Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)

ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_BrakingPhaseDuration_2.3Hz_ATxInvolvedLimb.png', width = 5500, height = 5500, units = 'px' )


```




```{r Propulsion Phase Duration }


(Power1 <- ggplot(data = Power_ATx_InvolvedAnkle_2.3Hz, aes(y = LengthofPropulsionPhase_sec, x = Limb_ID  ) ) +
      
    

      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_InvolvedAnkle_2.3Hz, aes( y = LengthofPropulsionPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 2.5, inherit.aes = F, stroke = 2, stackratio = 0.8 ) +
      

   

               scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44', 'Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ) ) +
    
    
      
      
      scale_y_continuous(breaks = seq(0.1,0.24,by = 0.02),limits = c(0.1,0.24) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
   
      labs(title = ' Propulsion Phase Duration \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  )  +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_PropulsionPhaseDuration_2.3Hz_ATxInvolvedLimb.png', width = 5500, height = 5500, units = 'px' )


```



```{r Limb Average MEE Absorption }






(Power1 <- ggplot(data = Power_ATx_InvolvedAnkle_2.3Hz, aes(y = WholeLimbAverageAbsorptionMEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_InvolvedAnkle_2.3Hz, aes(x = Limb_ID, y = WholeLimbAverageAbsorptionMEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_InvolvedAnkle_2.3Hz, aes( y = WholeLimbAverageAbsorptionMEE, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      

   
   
                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'Involved','Non-Involved') ) +
   
   
   
                             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'Involved','Non-Involved') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,11,by = 1),limits = c(0,11) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Limb Average MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)




```





```{r Limb Work Rate Absorption - Generation Neutralized }






(Power1 <- ggplot(data = Power_ATx_InvolvedAnkle_2.3Hz, aes(y = LimbAveragePower_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_InvolvedAnkle_2.3Hz, aes(x = Limb_ID, y = LimbAveragePower_Braking_GenerationNeutralized, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_InvolvedAnkle_2.3Hz, aes( y = LimbAveragePower_Braking_GenerationNeutralized, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      

   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'Involved','Non-Involved') ) +
   
   
   
                             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'Involved','Non-Involved') ) +
    
      
      
      scale_y_continuous(breaks = seq(-10,0,by = 1),limits = c(-10,0) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Limb Work Rate - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Power (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_LimbAveragePowerAbsorption_GenerationNeutralized_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```




```{r Limb Average MEE Generation }






(Power1 <- ggplot(data = Power_ATx_InvolvedAnkle_2.3Hz, aes(y = WholeLimbAverageGenerationMEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_InvolvedAnkle_2.3Hz, aes(x = Limb_ID, y = WholeLimbAverageGenerationMEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_InvolvedAnkle_2.3Hz, aes( y = WholeLimbAverageGenerationMEE, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      

   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'Involved','Non-Involved') ) +
   
   
   
                             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'Involved','Non-Involved') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,11,by = 1),limits = c(0,11) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Limb Average MEE - Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)




```



```{r Limb Work Rate Generation - Absorption Neutralized}






(Power1 <- ggplot(data = Power_ATx_InvolvedAnkle_2.3Hz, aes(y = LimbAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATx_InvolvedAnkle_2.3Hz, aes(x = Limb_ID, y = LimbAveragePower_Propulsion_AbsorptionNeutralized, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATx_InvolvedAnkle_2.3Hz, aes( y = LimbAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      

   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'Involved','Non-Involved') ) +
   
   
   
                             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'Involved','Non-Involved') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,11,by = 1),limits = c(0,11) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Limb Work Rate - Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Power (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_LimbAveragePowerGeneration_AbsorptionNeutralized_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )


```

###### Hop Height

```{r Hop Height }


range( Power_ATx_Ankle_2.3Hz$HoppingHeight_cm )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x ) /sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x ) /sqrt( length( x ) ) ), SE = sd( x ) /sqrt( length( x ) ), CI_Arm = 2*( sd( x ) /sqrt( length( x ) ) ) )
   
}



#Find SE and CI for Involved Limb
InvolvedLimbCI <- SE_function( Power_ATx_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ATx_Ankle_2.3Hz$Limb_ID ==  'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Power_ATx_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ATx_Ankle_2.3Hz$Limb_ID ==  'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Power_ATx_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ATx_Ankle_2.3Hz$Limb_ID ==  'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Power_ATx_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ATx_Ankle_2.3Hz$Limb_ID ==  'Contralateral' ) ] )



UniqueParticipantID <- unique( Power_ATx_Ankle_2.3Hz$Participant_ID )
UniqueLimbID <- unique( Power_ATx_Ankle_2.3Hz$Limb_ID )
UniqueJointID <- unique( Power_ATx_Ankle_2.3Hz$Joint_ID )


HoppingHeight_cm_LimbMean <- data.frame( Group_ID = rep( 'ATx', length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ),
                                                                Participant_ID = rep( 'ATx07',  length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ), 
                                                                Limb_ID = rep( UniqueLimbID, length( UniqueParticipantID ) * length( UniqueJointID  ) ), 
                                                                Joint_ID = rep( UniqueJointID, length( UniqueParticipantID ) * length( UniqueLimbID ) ), 
                                                                Mean = rep( 0, length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ), 
                                                                SE = rep( 0, length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ), 
                                                                CI_Arm = rep( 0,length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ), 
                                                                CI_LowerLimit = rep( 0, length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ), 
                                                                CI_UpperLimit = rep( 0, length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ) )

RowtoFill <- 1


#Fill in data frame with means for each limb

for (h in 1:length(UniqueParticipantID) ) {
   for (l in 1:length(UniqueLimbID) ) {
      for (k in 1:length(UniqueJointID) ) {
      
      HoppingHeight_cm_LimbMean$Group_ID[ RowtoFill ] <-  Power_ATx_Ankle_2.3Hz$Group_ID[ which( Power_ATx_Ankle_2.3Hz$Participant_ID ==  UniqueParticipantID[ h ] & Power_ATx_Ankle_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ATx_Ankle_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
      
      HoppingHeight_cm_LimbMean$Participant_ID[ RowtoFill ] <-  Power_ATx_Ankle_2.3Hz$Participant_ID[ which( Power_ATx_Ankle_2.3Hz$Participant_ID ==  UniqueParticipantID[ h ] & Power_ATx_Ankle_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ATx_Ankle_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
      
      HoppingHeight_cm_LimbMean$Limb_ID[ RowtoFill ] <-  Power_ATx_Ankle_2.3Hz$Limb_ID[ which( Power_ATx_Ankle_2.3Hz$Participant_ID ==  UniqueParticipantID[ h ] & Power_ATx_Ankle_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ATx_Ankle_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
      
      HoppingHeight_cm_LimbMean$Joint_ID[ RowtoFill ] <-  Power_ATx_Ankle_2.3Hz$Joint_ID[ which( Power_ATx_Ankle_2.3Hz$Participant_ID ==  UniqueParticipantID[ h ] & Power_ATx_Ankle_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ATx_Ankle_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
      
      
      
      SEOutput <- SE_function( Power_ATx_Ankle_2.3Hz$HoppingHeight_cm[ which( Power_ATx_Ankle_2.3Hz$Participant_ID ==  UniqueParticipantID[ h ] & Power_ATx_Ankle_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ATx_Ankle_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ] )
     
      
      
      HoppingHeight_cm_LimbMean$Mean[ RowtoFill ] <- SEOutput$y
      
      HoppingHeight_cm_LimbMean$CI_LowerLimit[ RowtoFill ] <- SEOutput$ymin
      
      HoppingHeight_cm_LimbMean$CI_UpperLimit[ RowtoFill ] <- SEOutput$ymax
      
      HoppingHeight_cm_LimbMean$SE[ RowtoFill ] <- SEOutput$SE
      
      HoppingHeight_cm_LimbMean$CI_Arm[ RowtoFill ] <- SEOutput$CI_Arm
      
      RowtoFill <- RowtoFill + 1
      
      }
      
   }

}



(Power1 <- ggplot(data = Power_ATx_Ankle_2.3Hz, aes(y = HoppingHeight_cm, x = Limb_ID  ) ) +
      
      
      facet_wrap( vars( Participant_ID ), nrow = 5 ) +
    
        #Geom_point to show limb means per joint
      geom_point( data = HoppingHeight_cm_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), shape = 22, size = 30, stroke = 3, color = 'black' ) +
      
      #Create error bars to show 95% CI
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID, color = Limb_ID ), linewidth = 5, size = 3 ) +
    



    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Limb_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed = 1, height = 0, width = 0.35), shape = 23 ) +



         #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Hop Height vs Limb  \n 2.33 Hz Hopping - ATx Group ', x = 'Limb ID', y = ' Hop Height (cm) ' ) +



       #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[1], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[7],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[8],
                                    'HC45' = met.brewer('OKeeffe1')[6],
                                    'HC42' = met.brewer('OKeeffe1')[10],
                                    'HC48' = met.brewer('OKeeffe1')[3],
                                    'HC44' = met.brewer('OKeeffe1')[6],
                                    'HC65' = met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[1], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[7],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[8],
                                    'HC45' = met.brewer('OKeeffe1')[6],
                                    'HC42' = met.brewer('OKeeffe1')[10],
                                    'HC48' = met.brewer('OKeeffe1')[3],
                                    'HC44' = met.brewer('OKeeffe1')[6],
                                    'HC65' = met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +

    
      
      
      scale_y_continuous(breaks = seq( 0, 5.5, by = 0.5 ), limits = c( 0, 5.5 ) ) +
    
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            plot.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) 

 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Both Limbs', filename = 'Dissertation_HopHeight_2.3Hz_ATx_IndividualHops.png', width = 14000, height = 14000, units = 'px' )


```

###### Raw Joint Work

```{r Joint Work Absorption - Generation Neutralized }


range( Power_ATx_2.3Hz$JointWork_Braking_GenerationNeutralized )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x ) /sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x ) /sqrt( length( x ) ) ), SE = sd( x ) /sqrt( length( x ) ), CI_Arm = 2*( sd( x ) /sqrt( length( x ) ) ) )
   
}



#Find SE and CI for Involved Limb
InvolvedLimbCI <- SE_function( Power_ATx_2.3Hz$JointWork_Braking_GenerationNeutralized[ which( Power_ATx_2.3Hz$Limb_ID ==  'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Power_ATx_2.3Hz$JointWork_Braking_GenerationNeutralized[ which( Power_ATx_2.3Hz$Limb_ID ==  'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Power_ATx_2.3Hz$JointWork_Braking_GenerationNeutralized[ which( Power_ATx_2.3Hz$Limb_ID ==  'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Power_ATx_2.3Hz$JointWork_Braking_GenerationNeutralized[ which( Power_ATx_2.3Hz$Limb_ID ==  'Contralateral' ) ] )



UniqueParticipantID <- unique( Power_ATx_2.3Hz$Participant_ID )
UniqueLimbID <- unique( Power_ATx_2.3Hz$Limb_ID )
UniqueJointID <- unique( Power_ATx_2.3Hz$Joint_ID )


JointWork_Braking_GenerationNeutralized_LimbMean <- data.frame( Group_ID = rep( 'ATx', length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ),
                                                                Participant_ID = rep( 'ATx07',  length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ), 
                                                                Limb_ID = rep( UniqueLimbID, length( UniqueParticipantID ) * length( UniqueJointID  ) ), 
                                                                Joint_ID = rep( UniqueJointID, length( UniqueParticipantID ) * length( UniqueLimbID ) ), 
                                                                Mean = rep( 0, length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ), 
                                                                SE = rep( 0, length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ), 
                                                                CI_Arm = rep( 0,length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ), 
                                                                CI_LowerLimit = rep( 0, length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ), 
                                                                CI_UpperLimit = rep( 0, length( UniqueParticipantID ) * length( UniqueLimbID ) * length( UniqueJointID  ) ) )

RowtoFill <- 1


#Fill in data frame with means for each limb

for (h in 1:length(UniqueParticipantID) ) {
   for (l in 1:length(UniqueLimbID) ) {
      for (k in 1:length(UniqueJointID) ) {
      
      JointWork_Braking_GenerationNeutralized_LimbMean$Group_ID[ RowtoFill ] <-  Power_ATx_2.3Hz$Group_ID[ which( Power_ATx_2.3Hz$Participant_ID ==  UniqueParticipantID[ h ] & Power_ATx_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ATx_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
      
      JointWork_Braking_GenerationNeutralized_LimbMean$Participant_ID[ RowtoFill ] <-  Power_ATx_2.3Hz$Participant_ID[ which( Power_ATx_2.3Hz$Participant_ID ==  UniqueParticipantID[ h ] & Power_ATx_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ATx_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
      
      JointWork_Braking_GenerationNeutralized_LimbMean$Limb_ID[ RowtoFill ] <-  Power_ATx_2.3Hz$Limb_ID[ which( Power_ATx_2.3Hz$Participant_ID ==  UniqueParticipantID[ h ] & Power_ATx_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ATx_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
      
      JointWork_Braking_GenerationNeutralized_LimbMean$Joint_ID[ RowtoFill ] <-  Power_ATx_2.3Hz$Joint_ID[ which( Power_ATx_2.3Hz$Participant_ID ==  UniqueParticipantID[ h ] & Power_ATx_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ATx_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ]
      
      
      
      SEOutput <- SE_function( Power_ATx_2.3Hz$JointWork_Braking_GenerationNeutralized[ which( Power_ATx_2.3Hz$Participant_ID ==  UniqueParticipantID[ h ] & Power_ATx_2.3Hz$Limb_ID ==  UniqueLimbID[ l ] & Power_ATx_2.3Hz$Joint_ID ==  UniqueJointID[ k ] ) ] )
     
      
      
      JointWork_Braking_GenerationNeutralized_LimbMean$Mean[ RowtoFill ] <- SEOutput$y
      
      JointWork_Braking_GenerationNeutralized_LimbMean$CI_LowerLimit[ RowtoFill ] <- SEOutput$ymin
      
      JointWork_Braking_GenerationNeutralized_LimbMean$CI_UpperLimit[ RowtoFill ] <- SEOutput$ymax
      
      JointWork_Braking_GenerationNeutralized_LimbMean$SE[ RowtoFill ] <- SEOutput$SE
      
      JointWork_Braking_GenerationNeutralized_LimbMean$CI_Arm[ RowtoFill ] <- SEOutput$CI_Arm
      
      RowtoFill <- RowtoFill + 1
      
      }
      
   }

}



(Power1 <- ggplot(data = Power_ATx_2.3Hz, aes(y = JointWork_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
      
      facet_wrap( vars( Participant_ID ), nrow = 5 ) +
    
        #Geom_point to show limb means per joint
      geom_point( data = JointWork_Braking_GenerationNeutralized_LimbMean, aes( y = Mean, x = Limb_ID, fill = Joint_ID, group = interaction( Limb_ID, Joint_ID ) ), shape = 22, size = 30, stroke = 3, color = 'black' ) +
      
      #Create error bars to show 95% CI
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = interaction( Limb_ID, Joint_ID ), color = Joint_ID ), linewidth = 5, size = 3 ) +
    



    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Joint_ID, group = interaction( Limb_ID, Joint_ID ) ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed = 1, height = 0, width = 0.35), shape = 23 ) +


   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1, y = 1.16 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1, y = 1.115 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1, y = 1.07 ) +
      

         #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title = '  Joint Absorption Work vs Limb  \n 2.33 Hz Hopping - ATx Group ', x = 'Limb ID', y = ' Absorption Work (J/kg) ' ) +



       #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[1], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[7],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[8],
                                    'HC45' = met.brewer('OKeeffe1')[6],
                                    'HC42' = met.brewer('OKeeffe1')[10],
                                    'HC48' = met.brewer('OKeeffe1')[3],
                                    'HC44' = met.brewer('OKeeffe1')[6],
                                    'HC65' = met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics = c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'ATx36' = met.brewer('OKeeffe1')[5],
                                    'ATx49' = met.brewer('OKeeffe1')[6],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[1], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[7],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[8],
                                    'HC45' = met.brewer('OKeeffe1')[6],
                                    'HC42' = met.brewer('OKeeffe1')[10],
                                    'HC48' = met.brewer('OKeeffe1')[3],
                                    'HC44' = met.brewer('OKeeffe1')[6],
                                    'HC65' = met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics = c('fill') ) +

    
      
      
      scale_y_continuous(breaks = seq( -1.1, 0, by = 0.1 ), limits = c( -1.1, 0.2 ) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Absorption Work - Generation Neutralized \n Braking Phase - 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Absorption Work (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            plot.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) 

 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Both Limbs', filename = 'Dissertation_JointAbsorptionWork_GenerationNeutralized_2.3Hz_ATx_IndividualHops.png', width = 14000, height = 14000, units = 'px' )


```


###### Raw Joint Work Rate

```{r Joint Work Rate Absorption - Generation Neutralized }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      
    
      
        #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized, yend = JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized, yend = JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ATxInvolvedLimb_2.3Hz$JointAveragePower_Braking_GenerationNeutralized, na.rm = T ) ) /15, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      

    
    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
   
   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-8,0,by = 1),limits = c(-8,0) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Absorption Work Rate - Generation Neutralized \n Braking Phase - 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            plot.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 5 )

 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_JointAbsorptionWorkRate_GenerationNeutralized_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )


```





```{r Joint Work Rate Generation - Absorption Neutralized }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATxInvolvedLimb_2.3Hz, aes(x = Limb_ID, y = JointAveragePower_Propulsion_AbsorptionNeutralized, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized, yend = JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized, yend = JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    
    
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ATxInvolvedLimb_2.3Hz$JointAveragePower_Propulsion_AbsorptionNeutralized, na.rm = T ) ) /14, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      

    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
    
   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,8,by = 1),limits = c(0,8) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Generation Work Rate - Absorption Neutralized \n Propulsion Phase - 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Work Rate (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            plot.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 5 )

 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_JointGenerationWorkRate_AbsorptionNeutralized_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )


```





###### Joint Contribution

```{r Joint Average MEE Absorption }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointContribution_AverageAbsorptionMEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATxInvolvedLimb_2.3Hz, aes(x = Limb_ID, y = JointContribution_AverageAbsorptionMEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointContribution_AverageAbsorptionMEE, yend = JointContribution_AverageAbsorptionMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointContribution_AverageAbsorptionMEE, yend = JointContribution_AverageAbsorptionMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AverageAbsorptionMEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Average MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)




```



```{r Joint Work Rate Absorption - Generation Neutralized }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointContribution_AveragePower_GenerationNeutralized/100, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATxInvolvedLimb_2.3Hz, aes(x = Limb_ID, y = JointContribution_AveragePower_GenerationNeutralized/100, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized, yend = JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized, yend = JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ATxInvolvedLimb_2.3Hz$JointContribution_AveragePower_GenerationNeutralized/100, na.rm = T ) ) /18, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Work Rate - Generation Neutralized \n Braking Phase - 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            plot.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 5 )

 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_JointContribution2AveragePowerAbsorption_GenerationNeutralized_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )


```





```{r Joint Average MEE Generation }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointContribution_AverageGenerationMEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATxInvolvedLimb_2.3Hz, aes(x = Limb_ID, y = JointContribution_AverageGenerationMEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AverageGenerationMEE, yend = JointContribution_AverageGenerationMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AverageGenerationMEE, yend = JointContribution_AverageGenerationMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AverageGenerationMEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


                 scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Average MEE - Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)




```



```{r Joint Work Rate Generation - Absorption Neutralized }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointContribution_AveragePower_AbsorptionNeutralized/100, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATxInvolvedLimb_2.3Hz, aes(x = Limb_ID, y = JointContribution_AveragePower_AbsorptionNeutralized/100, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AveragePower_AbsorptionNeutralized, yend = JointContribution_AveragePower_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AveragePower_AbsorptionNeutralized, yend = JointContribution_AveragePower_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_AveragePower_AbsorptionNeutralized/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( Power_ATxInvolvedLimb_2.3Hz$JointContribution_AveragePower_AbsorptionNeutralized/100, na.rm = T ) ) /18, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Work Rate - Absorption Neutralized \n Propulsion Phase - 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            plot.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 5 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_JointContribution2AveragePowerGeneration_AbsorptionNeutralized_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```



###### Joint Contribution - Support Moment

```{r Braking Phase }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointContribution_SupportMoment_BrakingPhase/100, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATxInvolvedLimb_2.3Hz, aes(x = Limb_ID, y = JointContribution_SupportMoment_BrakingPhase/100, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointContribution_SupportMoment_BrakingPhase, yend = JointContribution_SupportMoment_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointContribution_SupportMoment_BrakingPhase, yend = JointContribution_SupportMoment_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_SupportMoment_BrakingPhase/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Support Moment - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb',filename = 'Dissertation_JointContribution2SupportMoment_BrakingPhase_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```


```{r Propulsion Phase }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointContribution_SupportMoment_PropulsionPhase/100, x = Limb_ID  ) ) +
      

      geom_path( data = Power_ATxInvolvedLimb_2.3Hz, aes(x = Limb_ID, y = JointContribution_SupportMoment_PropulsionPhase/100, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointContribution_SupportMoment_PropulsionPhase, yend = JointContribution_SupportMoment_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointContribution_SupportMoment_PropulsionPhase, yend = JointContribution_SupportMoment_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointContribution_SupportMoment_PropulsionPhase/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Support Moment - Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb',filename = 'Dissertation_JointContribution2SupportMoment_PropulsionPhase_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```




###### Joint Contribution - Support Moment - No Flexor Torque

```{r Braking Phase }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointSupportMomentContribution_Braking_NoFlexorTorque/100, x = Limb_ID  ) ) +
      

      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointSupportMomentContribution_Braking_NoFlexorTorque, yend = JointSupportMomentContribution_Braking_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointSupportMomentContribution_Braking_NoFlexorTorque, yend = JointSupportMomentContribution_Braking_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointSupportMomentContribution_Braking_NoFlexorTorque/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Support Moment - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb',filename = 'Dissertation_JointContribution2SupportMoment_NoFlexorTorque_BrakingPhase_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```


```{r Propulsion Phase }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointSupportMomentContribution_Propulsion_NoFlexorTorque/100, x = Limb_ID  ) ) +
      

      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointSupportMomentContribution_Propulsion_NoFlexorTorque, yend = JointSupportMomentContribution_Propulsion_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointSupportMomentContribution_Propulsion_NoFlexorTorque, yend = JointSupportMomentContribution_Propulsion_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointSupportMomentContribution_Propulsion_NoFlexorTorque/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Support Moment - Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb',filename = 'Dissertation_JointContribution2SupportMoment_NoFlexorTorque_PropulsionPhase_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```


###### Torque Impulse
```{r Avg Absorption Torque Impulse }


CI <- mean_cl_boot( Power_Control_MatchedDominanceAnkle_2.3Hz$JointAverageBrakingTorque )


(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointAverageBrakingTorque, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text(  label = '95% CI', size = 14, x = 0.575, y = CI$ymin - 0.1, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointAverageBrakingTorque, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text(  label = 'Ankle', size = 14, color = '#1b9e77', x = 1.35, y = 0.42, fontface = 'bold' ) +
      #Knee
      geom_text(  label = 'Knee', size = 14, color = '#7570b3', x = 1.35, y = 0.25, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 14, color = '#d95f02', x = 1.35, y = 0.1, fontface = 'bold' ) +
      
      
      
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                     'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-2.25,0.75,by = 0.25),limits = c(-2.25,0.75) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved') ) +
      
      
      
      labs(title = '  Sagittal Plane Joint Torque Impulse - Braking Phase  \n 2.3 Hz Hopping - ATx Group ',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40,face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_AverageJointSagittalTorqueImpulse_BrakingPhase_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```




```{r Avg Generation Torque Impulse }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointAveragePropulsionTorque )




(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointAveragePropulsionTorque, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 14, x = 0.575, y = CI$ymin - 0.1, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointAveragePropulsionTorque, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text(  label = 'Ankle', size = 14, color = '#1b9e77', x = 1.35, y = 0.4, fontface = 'bold' ) +
      #Knee
      geom_text(  label = 'Knee', size = 14, color = '#7570b3', x = 1.35, y = 0.25, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 14, color = '#d95f02', x = 1.35, y = 0.1, fontface = 'bold' ) +
      
      
      
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                     'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-2.25,0.75,by = 0.25),limits = c(-2.25,0.75) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Sagittal Plane Joint Torque Impulse - Propulsion Phase \n 2.3 Hz Hopping - ATx Group ',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40,face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_AverageJointSagittalTorqueImpulse_PropulsionPhase_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```


###### Angular Velocity
```{r Average Absorption Angular Velocity }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = AverageJointAngVel_BrakingPhase, x = Limb_ID  ) ) +
      

      
        #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      
    stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
   
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = AverageJointAngVel_BrakingPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
   

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 14, color = '#1b9e77', x = 1.1, y = 290, fontface = 'bold' ) +
      #Knee
   geom_text( label = 'Knee', size = 14, color = '#7570b3', x = 1.1, y = 267, fontface = 'bold' ) +
      #Hip
   geom_text( label = 'Hip', size = 14, color = '#d95f02', x = 1.1, y = 245, fontface = 'bold' ) +
   
      
                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-50,300,by = 50),limits = c(-50,300) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Average Sagittal Plane Joint Angular Velocity - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40, face = 'bold' )  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_AverageAngularVelocity_BrakingPhase_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```



```{r Average Generation Angular Velocity }






(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = AverageJointAngVel_PropulsionPhase, x = Limb_ID  ) ) +
      
      
        #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
    geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = AverageJointAngVel_PropulsionPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +

    
      
    
   
      
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 14, color = '#1b9e77', x = 1.25, y = 40, fontface = 'bold' ) +
      #Knee
   geom_text( label = 'Knee', size = 14, color = '#7570b3', x = 1.25, y = 17, fontface = 'bold' ) +
      #Hip
   geom_text( label = 'Hip', size = 14, color = '#d95f02', x = 1.25, y = -3, fontface = 'bold' ) +
   
      
   
                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-300,50,by = 50),limits = c(-300,50) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Average Joint Angular Velocity During Propulsion Phase  \n 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text( size = 40, face = 'bold' )  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_AverageAngularVelocity_PropulsionPhase_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )


```


###### RoM

```{r RoM Braking Phase }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_SagittalRoM_BrakingPhase )




(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = SagittalRoM_BrakingPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 14, x = 0.575, y = CI$ymax + 1.75, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = SagittalRoM_BrakingPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text(  label = 'Ankle', size = 14, color = '#1b9e77', x = 1.35, y = 34, fontface = 'bold' ) +
      #Knee
      geom_text(  label = 'Knee', size = 14, color = '#7570b3', x = 1.35, y = 31.5, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 14, color = '#d95f02', x = 1.475, y = 32.75, fontface = 'bold' ) +
      
      
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                    'ATx38' = met.brewer('OKeeffe1')[1],
                                    'ATx41' = met.brewer('OKeeffe1')[2],
                                    'ATx44' = met.brewer('OKeeffe1')[3],
                                    'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      scale_alpha_manual( values = c( 'ATx07' =  1, 
                                    'ATx08' = 1,
                                    'ATx10' = 1, 
                                    'ATx12' = 1,
                                    'ATx17' = 1,
                                    'ATx18' = 1,
                                    'ATx19' = 1,
                                    'ATx21' = 1,
                                    'ATx24' = 1,
                                    'ATx25' = 1,
                                    'ATx27' = 1,
                                    'ATx34' = 0.75,
                                    'ATx38' = 0.75,
                                    'ATx41' = 0.75,
                                    'ATx44' = 0.75,
                                    'ATx50' = 0.75,
                                    'HC01' =  1, 
                                    'HC19' = 1,
                                    'HC12' =  1, 
                                    'HC05' =  1,
                                    'HC06' =  1,
                                    'HC08' =  1,
                                    'HC20' =  1,
                                    'HC11' =  1,
                                    'HC17' =  1,
                                    'HC21' =  1,
                                    'HC25' =  0.75,
                                    'HC18' = 0.75 ) ) +
      
      scale_y_continuous(breaks = seq(0,40,by = 5),limits = c(0,40) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Sagittal Plane Range of Motion - Braking Phase \n  2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Range of Motion (', degree, ') [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40,face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_PeakJointSagittalRoM_BrakingPhase_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```


```{r RoM Propulsion Phase }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_SagittalRoM_PropulsionPhase )




(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = SagittalRoM_PropulsionPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 14, x = 0.575, y = CI$ymax + 1.75, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = SagittalRoM_PropulsionPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text(  label = 'Ankle', size = 14, color = '#1b9e77', x = 1.35, y = -4.5, fontface = 'bold' ) +
      #Knee
      geom_text(  label = 'Knee', size = 14, color = '#7570b3', x = 1.35, y = -7, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 14, color = '#d95f02', x = 1.475, y = -5.75, fontface = 'bold' ) +
      
      
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                     'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-45,0,by = 5),limits = c(-45,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Sagittal Plane Range of Motion - Propulsion Phase \n  2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Range of Motion (', degree, ') [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40,face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_PeakJointSagittalRoM_PropulsionPhase_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )

```


```{r Initial Contact Angle }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointInitialContactAngle )




(Power1 <- ggplot(data = Power_ATxInvolvedLimb_2.3Hz, aes(y = JointInitialContactAngle, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 14, x = 0.575, y = CI$ymax + 3.5, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_ATxInvolvedLimb_2.3Hz, aes( y = JointInitialContactAngle, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text(  label = 'Ankle', size = 14, color = '#1b9e77', x = 1.35, y = 48.5, fontface = 'bold' ) +
      #Knee
      geom_text(  label = 'Knee', size = 14, color = '#7570b3', x = 1.35, y = 43, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 14, color = '#d95f02', x = 1.475, y = 46.75, fontface = 'bold' ) +
      
      
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                     'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq( -30, 60,by = 10),limits = c( -30, 60 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Joint Angular Position at Initial Ground \n Contact - 2.3 Hz Hopping - ATx Group',x = 'Limb ID', y = expression( paste( ' Angular Position (', degree, ') [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40,face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/ATx Involved Limb', filename = 'Dissertation_JointInitialContactAngle_2.3Hz_ATxInvolvedLimb.png', width = 12000, height = 12000, units = 'px' )


```


###### Control Matched Dominance


```{r Flight Duration }


(Power1 <- ggplot(data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(y = LengthofFlightPhase_sec, x = Limb_ID  ) ) +
      
    

      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes( y = LengthofFlightPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 2.5, inherit.aes = F, stroke = 2, stackratio = 0.8) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44', 'Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0.02,0.2,by = 0.02),limits = c(0.02,0.2) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
   
      labs(title = ' Flight Phase Duration \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 4, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.33 Hz'  ) ) )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_FlightDuration_2.3Hz_ControlMatchedDominanceLimb.png', width = 5500, height = 5500, units = 'px' )

```



```{r Contact Phase Duration }


(Power1 <- ggplot(data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(y = LengthofContactPhase_sec, x = Limb_ID  ) ) +
      
    

      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes( y = LengthofContactPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 2.5, inherit.aes = F, stroke = 2, stackratio = 0.8) +
      

   

                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44', 'Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0.2,0.425,by = 0.025),limits = c(0.2,0.425) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
   
      labs(title = ' Contact Phase Duration \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 4, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.33 Hz'  ) ) )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_ContactPhaseDuration_2.3Hz_ControlMatchedDominanceLimb.png', width = 5500, height = 5500, units = 'px' )

```




```{r Braking Phase Duration }


(Power1 <- ggplot(data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(y = LengthofBrakingPhase_sec, x = Limb_ID  ) ) +
      
    

    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes( y = LengthofBrakingPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 2.5, inherit.aes = F, stroke = 2, stackratio = 0.8) +
      

   

               scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44', 'Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ) ) +
    
    
      
      
      scale_y_continuous(breaks = seq(0.1,0.24,by = 0.02),limits = c(0.1,0.24) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
   
      labs(title = ' Braking Phase Duration \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 4, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.33 Hz'  ) ) )

 
)

ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_BrakingPhaseDuration_2.3Hz_ControlMatchedDominanceLimb.png', width = 5500, height = 5500, units = 'px' )


```

```{r Propulsion Phase Duration }


(Power1 <- ggplot(data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(y = LengthofPropulsionPhase_sec, x = Limb_ID  ) ) +
      
    

      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes( y = LengthofPropulsionPhase_sec, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 2.5, inherit.aes = F, stroke = 2, stackratio = 0.8) +
      

   

               scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44', 'Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ) ) +
    
    
      
      
      scale_y_continuous(breaks = seq(0.1,0.23,by = 0.01),limits = c(0.1,0.23) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
   
      labs(title = ' Propulsion Phase Duration \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Duration (sec) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'), axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 30,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 22.5)  ) +
      
      facet_wrap( vars(Participant_ID,HoppingRate_ID), nrow = 4, labeller = labeller( HoppingRate_ID  = c( '2.3' = '2.33 Hz'  ) ) )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_PropulsionPhaseDuration_2.3Hz_ControlMatchedDominanceLimb.png', width = 5500, height = 5500, units = 'px' )


```




####### 2.3 Hz

```{r Limb Average MEE Absorption }






(Power1 <- ggplot(data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(y = WholeLimbAverageAbsorptionMEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(x = Limb_ID, y = WholeLimbAverageAbsorptionMEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes( y = WholeLimbAverageAbsorptionMEE, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      

   
                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                          'HC12' = met.brewer('OKeeffe1')[3], 
                                          'HC05' = met.brewer('OKeeffe1')[4],
                                          'HC06' = met.brewer('OKeeffe1')[5],
                                          'HC08' = met.brewer('OKeeffe1')[6],
                                          'HC20' = met.brewer('OKeeffe1')[7],
                                          'HC11' = met.brewer('OKeeffe1')[8],
                                          'HC17' = met.brewer('OKeeffe1')[9],
                                          'HC18' = met.brewer('OKeeffe1')[2],
                                          'HC21' = met.brewer('OKeeffe1')[11],
                                          'HC25' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +

   
   
                scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                          'HC12' = met.brewer('OKeeffe1')[3], 
                                          'HC05' = met.brewer('OKeeffe1')[4],
                                          'HC06' = met.brewer('OKeeffe1')[5],
                                          'HC08' = met.brewer('OKeeffe1')[6],
                                          'HC20' = met.brewer('OKeeffe1')[7],
                                          'HC11' = met.brewer('OKeeffe1')[8],
                                          'HC17' = met.brewer('OKeeffe1')[9],
                                          'HC18' = met.brewer('OKeeffe1')[2],
                                          'HC21' = met.brewer('OKeeffe1')[11],
                                          'HC25' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,11,by = 1),limits = c(0,11) ) +
    
    
      scale_x_discrete(labels = c( 'Matched to ATx Dominance' ) ) +
      
   
      labs(title = ' Limb Average MEE - Braking Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_LimbAverageMEEAbsorption_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```



```{r Limb Work Rate Absorption - Generation Neutralized }






(Power1 <- ggplot(data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(y = LimbAveragePower_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      

      geom_path( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(x = Limb_ID, y = LimbAveragePower_Braking_GenerationNeutralized, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_Control_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_Control_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes( y = LimbAveragePower_Braking_GenerationNeutralized, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      

   


                 scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                          'HC12' = met.brewer('OKeeffe1')[3], 
                                          'HC05' = met.brewer('OKeeffe1')[4],
                                          'HC06' = met.brewer('OKeeffe1')[5],
                                          'HC08' = met.brewer('OKeeffe1')[6],
                                          'HC20' = met.brewer('OKeeffe1')[7],
                                          'HC11' = met.brewer('OKeeffe1')[8],
                                          'HC17' = met.brewer('OKeeffe1')[9],
                                          'HC18' = met.brewer('OKeeffe1')[2],
                                          'HC21' = met.brewer('OKeeffe1')[11],
                                          'HC25' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +

   
   
                scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                          'HC12' = met.brewer('OKeeffe1')[3], 
                                          'HC05' = met.brewer('OKeeffe1')[4],
                                          'HC06' = met.brewer('OKeeffe1')[5],
                                          'HC08' = met.brewer('OKeeffe1')[6],
                                          'HC20' = met.brewer('OKeeffe1')[7],
                                          'HC11' = met.brewer('OKeeffe1')[8],
                                          'HC17' = met.brewer('OKeeffe1')[9],
                                          'HC18' = met.brewer('OKeeffe1')[2],
                                          'HC21' = met.brewer('OKeeffe1')[11],
                                          'HC25' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(-10,0,by = 1),limits = c(-10,0) ) +
    
    
      scale_x_discrete(labels = c( 'Matched to ATx Dominance' ) ) +
      
   
      labs(title = ' Limb Work Rate - Braking Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Power (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_LimbAveragePowerAbsorption_GenerationNeutralized_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```




```{r Limb Average MEE Generation }






(Power1 <- ggplot(data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(y = WholeLimbAverageGenerationMEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(x = Limb_ID, y = WholeLimbAverageGenerationMEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_Control_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_Control_2.3Hz, aes( y = Mean_Joint_Generation_MEE, yend = Mean_Joint_Generation_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes( y = WholeLimbAverageGenerationMEE, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      

   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                          'HC12' = met.brewer('OKeeffe1')[3], 
                                          'HC05' = met.brewer('OKeeffe1')[4],
                                          'HC06' = met.brewer('OKeeffe1')[5],
                                          'HC08' = met.brewer('OKeeffe1')[6],
                                          'HC20' = met.brewer('OKeeffe1')[7],
                                          'HC11' = met.brewer('OKeeffe1')[8],
                                          'HC17' = met.brewer('OKeeffe1')[9],
                                          'HC18' = met.brewer('OKeeffe1')[2],
                                          'HC21' = met.brewer('OKeeffe1')[11],
                                          'HC25' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +

   
   
                scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                          'HC12' = met.brewer('OKeeffe1')[3], 
                                          'HC05' = met.brewer('OKeeffe1')[4],
                                          'HC06' = met.brewer('OKeeffe1')[5],
                                          'HC08' = met.brewer('OKeeffe1')[6],
                                          'HC20' = met.brewer('OKeeffe1')[7],
                                          'HC11' = met.brewer('OKeeffe1')[8],
                                          'HC17' = met.brewer('OKeeffe1')[9],
                                          'HC18' = met.brewer('OKeeffe1')[2],
                                          'HC21' = met.brewer('OKeeffe1')[11],
                                          'HC25' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,11,by = 1),limits = c(0,11) ) +
    
    
      scale_x_discrete(labels = c( 'Matched to ATx Dominance' ) ) +
      
   
      labs(title = ' Limb Average MEE - Propulsion Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_LimbAverageMEEGeneration_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```



```{r Limb Work Rate Generation - Absorption Neutralized }






(Power1 <- ggplot(data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(y = LimbAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID  ) ) +
      

      geom_path( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes(x = Limb_ID, y = LimbAveragePower_Propulsion_AbsorptionNeutralized, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
    
        #geom_segment( data = Power_ParticipantMeans_Control_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ParticipantMeans_Control_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominanceAnkle_2.3Hz, aes( y = LimbAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      

   


                scale_color_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                          'HC12' = met.brewer('OKeeffe1')[3], 
                                          'HC05' = met.brewer('OKeeffe1')[4],
                                          'HC06' = met.brewer('OKeeffe1')[5],
                                          'HC08' = met.brewer('OKeeffe1')[6],
                                          'HC20' = met.brewer('OKeeffe1')[7],
                                          'HC11' = met.brewer('OKeeffe1')[8],
                                          'HC17' = met.brewer('OKeeffe1')[9],
                                          'HC18' = met.brewer('OKeeffe1')[2],
                                          'HC21' = met.brewer('OKeeffe1')[11],
                                          'HC25' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics = c('color'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +

   
   
                scale_fill_manual(values = c('ATx07' = met.brewer('OKeeffe1')[1], 
                                          'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                          'HC12' = met.brewer('OKeeffe1')[3], 
                                          'HC05' = met.brewer('OKeeffe1')[4],
                                          'HC06' = met.brewer('OKeeffe1')[5],
                                          'HC08' = met.brewer('OKeeffe1')[6],
                                          'HC20' = met.brewer('OKeeffe1')[7],
                                          'HC11' = met.brewer('OKeeffe1')[8],
                                          'HC17' = met.brewer('OKeeffe1')[9],
                                          'HC18' = met.brewer('OKeeffe1')[2],
                                          'HC21' = met.brewer('OKeeffe1')[11],
                                          'HC25' = met.brewer('OKeeffe1')[ 7],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics = c('fill'), labels = c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21','HC25','Involved','Non-Involved', 'Matched Dominance' ) ) +
    
      
      
      scale_y_continuous(breaks = seq(0,11,by = 1),limits = c(0,11) ) +
    
    
      scale_x_discrete(labels = c( 'Matched to ATx Dominance' ) ) +
      
   
      labs(title = ' Limb Work Rate - Propulsion Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Power (J/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)

ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_LimbAveragePowerGeneration_AbsorptionNeutralized_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )


```


###### Raw Joint Power/MEE
```{r Joint Work Rate Absorption - Generation Neutralized }



(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID  ) ) +
      

      geom_path( data = Power_Control_MatchedDominance_2.3Hz, aes(x = Limb_ID, y = JointAveragePower_Braking_GenerationNeutralized, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointAveragePower_Braking_GenerationNeutralized, yend = JointAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointAveragePower_Braking_GenerationNeutralized, yend = JointAveragePower_Braking_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointAveragePower_Braking_GenerationNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 1 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = -0.25 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = -0.5 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = -0.75 ) +
      

   


               scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC18' = met.brewer('OKeeffe1')[1],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-7,0,by = 1),limits = c(-7,0) ) +
    
    
      scale_x_discrete(labels = c( 'Matched to ATx Dominance' ) ) +
      
   
      labs(title = ' Raw Joint Work Rate - Braking Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Power (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)

ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_RawJointPowerAbsorption_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )


```



```{r Joint Work Rate Generation - Absorption Neutralized }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID  ) ) +
      

      geom_path( data = Power_Control_MatchedDominance_2.3Hz, aes(x = Limb_ID, y = JointAveragePower_Propulsion_AbsorptionNeutralized, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointAveragePower_Propulsion_AbsorptionNeutralized, yend = JointAveragePower_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointAveragePower_Propulsion_AbsorptionNeutralized, yend = JointAveragePower_Propulsion_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointAveragePower_Propulsion_AbsorptionNeutralized, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 1 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 6.75 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 6.5 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 6.25 ) +
      

   


               scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC18' = met.brewer('OKeeffe1')[1],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   
   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,7,by = 1),limits = c(0,7) ) +
    
    
      scale_x_discrete(labels = c( 'Matched to ATx Dominance' ) ) +
      
   
      labs(title = ' Raw Joint Work Rate - Braking Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Power (W/kg) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)

ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_RawJointPowerGeneration_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )


```



###### Joint Contribution

```{r Joint Average MEE Absorption }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointContribution_AverageAbsorptionMEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_Control_MatchedDominance_2.3Hz, aes(x = Limb_ID, y = JointContribution_AverageAbsorptionMEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_Control_2.3Hz, aes( y = JointContribution_AverageAbsorptionMEE, yend = JointContribution_AverageAbsorptionMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_Control_2.3Hz, aes( y = JointContribution_AverageAbsorptionMEE, yend = JointContribution_AverageAbsorptionMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_AverageAbsorptionMEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


               scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC18' = met.brewer('OKeeffe1')[1],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Matched to ATx Dominance' ) ) +
      
   
      labs(title = ' Joint Contribution to Average MEE - Braking Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_JointContribution2AverageMEEAbsorption_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```



```{r Joint Work Rate Absorption - Generation Neutralized }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointContribution_AveragePower_GenerationNeutralized/100, x = Limb_ID  ) ) +
      

      geom_path( data = Power_Control_MatchedDominance_2.3Hz, aes(x = Limb_ID, y = JointContribution_AveragePower_GenerationNeutralized/100, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized, yend = JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized, yend = JointContribution_AveragePower_GenerationNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_AveragePower_GenerationNeutralized/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      

   


               scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC18' = met.brewer('OKeeffe1')[1],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Matched to ATx Dominance' ) ) +
      
   
      labs(title = ' Joint Contribution to Work Rate - Generation Neutralized \n Braking Phase - 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)

ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_JointContribution2AveragePowerAbsorption_GenerationNeutralized_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )


```





```{r Joint Average MEE Generation }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointContribution_AverageGenerationMEE, x = Limb_ID  ) ) +
      

      geom_path( data = Power_Control_MatchedDominance_2.3Hz, aes(x = Limb_ID, y = JointContribution_AverageGenerationMEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_AverageGenerationMEE, yend = JointContribution_AverageGenerationMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_AverageGenerationMEE, yend = JointContribution_AverageGenerationMEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_AverageGenerationMEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


               scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC18' = met.brewer('OKeeffe1')[1],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Matched to ATx Dominance' ) ) +
      
   
      labs(title = ' Joint Contribution to Average MEE - Propulsion Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_JointContribution2AverageMEEGeneration_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```



```{r Joint Work Rate Generation - Absorption Neutralized }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointContribution_AveragePower_AbsorptionNeutralized/100, x = Limb_ID  ) ) +
      

      geom_path( data = Power_Control_MatchedDominance_2.3Hz, aes(x = Limb_ID, y = JointContribution_AveragePower_AbsorptionNeutralized/100, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend = FALSE ) +
      
        #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_AveragePower_AbsorptionNeutralized, yend = JointContribution_AveragePower_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_AveragePower_AbsorptionNeutralized, yend = JointContribution_AveragePower_AbsorptionNeutralized, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_AveragePower_AbsorptionNeutralized/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      

   


               scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC18' = met.brewer('OKeeffe1')[1],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Matched to ATx Dominance' ) ) +
      
   
      labs(title = ' Joint Contribution to Work Rate - AbsorptionNeutralized \n Propulsion Phase - 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_JointContribution2AveragePowerGeneration_AbsorptionNeutralized_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )


```

###### Joint Contribution - Support Moment

```{r Braking Phase }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointContribution_SupportMoment_BrakingPhase/100, x = Limb_ID  ) ) +
      

      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointContribution_SupportMoment_BrakingPhase, yend = JointContribution_SupportMoment_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointContribution_SupportMoment_BrakingPhase, yend = JointContribution_SupportMoment_BrakingPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_SupportMoment_BrakingPhase/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Support Moment - Braking Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb',filename = 'Dissertation_JointContribution2SupportMoment_BrakingPhase_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```


```{r Propulsion Phase }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointContribution_SupportMoment_PropulsionPhase/100, x = Limb_ID  ) ) +
      

      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointContribution_SupportMoment_PropulsionPhase, yend = JointContribution_SupportMoment_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointContribution_SupportMoment_PropulsionPhase, yend = JointContribution_SupportMoment_PropulsionPhase, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointContribution_SupportMoment_PropulsionPhase/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Support Moment - Propulsion Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb',filename = 'Dissertation_JointContribution2SupportMoment_PropulsionPhase_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```




###### Joint Contribution - Support Moment - No Flexor Torque

```{r Braking Phase }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointSupportMomentContribution_Braking_NoFlexorTorque/100 , x = Limb_ID  ) ) +
      

      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointSupportMomentContribution_Braking_NoFlexorTorque, yend = JointSupportMomentContribution_Braking_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointSupportMomentContribution_Braking_NoFlexorTorque, yend = JointSupportMomentContribution_Braking_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointSupportMomentContribution_Braking_NoFlexorTorque/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Support Moment - Braking Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb',filename = 'Dissertation_JointContribution2SupportMoment_NoFlexorTorque_BrakingPhase_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```



```{r Propulsion Phase }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointSupportMomentContribution_Propulsion_NoFlexorTorque/100 , x = Limb_ID  ) ) +
      

      
        #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointSupportMomentContribution_Propulsion_NoFlexorTorque, yend = JointSupportMomentContribution_Propulsion_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_ATx_2.3Hz, aes( y = JointSupportMomentContribution_Propulsion_NoFlexorTorque, yend = JointSupportMomentContribution_Propulsion_NoFlexorTorque, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointSupportMomentContribution_Propulsion_NoFlexorTorque/100, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.1, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.1, y = 0.875 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.1, y = 0.82 ) +
      
      

   


                scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                          'ATx44' = met.brewer('OKeeffe1')[1] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx44' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(0,1,by = 0.1),limits = c(0,1) ) +
    
    
      scale_x_discrete(labels = c( 'Involved Limb' ) ) +
      
   
      labs(title = ' Joint Contribution to Support Moment - Propulsion Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = ' Contribution ( Max = 1 ) ' ) +
      
      
      guides(color = 'none',size = 'none',fill =  'none', alpha = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),
            plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),
            legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),
            legend.key.height = unit(0,'lines'),
            legend.key.width = unit(0.5,'lines'),
            legend.box.background = element_rect(color = 'black',linewidth = 1),
            panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),
            panel.grid.major.y = element_line(color = 'darkgrey'),
            panel.grid.minor.y = element_line(color = 'darkgrey'),
            strip.text = element_text(size = 40)  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb',filename = 'Dissertation_JointContribution2SupportMoment_NoFlexorTorque_PropulsionPhase_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```



###### Torque Impulse
```{r Avg Absorption Torque Impulse }


CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointAverageBrakingTorque )


(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointAverageBrakingTorque, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text(  label = '95% CI', size = 14, x = 0.575, y = CI$ymin - 0.1, color = '#1b9e77', fontface = 'bold' ) +
      
      
      
      #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointAverageBrakingTorque, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text(  label = 'Ankle', size = 14, color = '#1b9e77', x = 1.35, y = 0.42, fontface = 'bold' ) +
      #Knee
      geom_text(  label = 'Knee', size = 14, color = '#7570b3', x = 1.35, y = 0.25, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 14, color = '#d95f02', x = 1.35, y = 0.1, fontface = 'bold' ) +
      
      
      
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                     'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-2.25,0.75,by = 0.25),limits = c(-2.25,0.75) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved') ) +
      
      
      
      labs(title = '  Sagittal Plane Joint Torque Impulse - Braking Phase  \n 2.3 Hz Hopping - Control Group ',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40,face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_AverageJointSagittalTorqueImpulse_BrakingPhase_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```




```{r Avg Generation Torque Impulse }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointAveragePropulsionTorque )




(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointAveragePropulsionTorque, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 14, x = 0.575, y = CI$ymin - 0.1, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointAveragePropulsionTorque, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text(  label = 'Ankle', size = 14, color = '#1b9e77', x = 1.35, y = 0.4, fontface = 'bold' ) +
      #Knee
      geom_text(  label = 'Knee', size = 14, color = '#7570b3', x = 1.35, y = 0.25, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 14, color = '#d95f02', x = 1.35, y = 0.1, fontface = 'bold' ) +
      
      
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                     'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-2.25,0.75,by = 0.25),limits = c(-2.25,0.75) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) ) +
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title = ' Sagittal Plane Joint Torque Impulse - Propulsion Phase \n 2.3 Hz Hopping - Control Group ',x = 'Limb ID', y = ' Torque Impulse (N-m-s) /kg [ - = Ext, + = Flex ] ' ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none' ) +
      
      
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40,face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_AverageJointSagittalTorqueImpulse_PropulsionPhase_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```


###### Angular Velocity
```{r Average Absorption Angular Velocity }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = AverageJointAngVel_BrakingPhase, x = Limb_ID  ) ) +
      

      
        #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
    stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) +   
    
   
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = AverageJointAngVel_BrakingPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +
      
   

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 14, color = '#1b9e77', x = 1.2, y = 290, fontface = 'bold' ) +
      #Knee
   geom_text( label = 'Knee', size = 14, color = '#7570b3', x = 1.2, y = 267, fontface = 'bold' ) +
      #Hip
   geom_text( label = 'Hip', size = 14, color = '#d95f02', x = 1.2, y = 245, fontface = 'bold' ) +
   
      
               scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC18' = met.brewer('OKeeffe1')[1],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-50,300,by = 50),limits = c(-50,300) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Average Sagittal Plane Joint Angular Velocity - Braking Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40, face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_AverageAngularVelocity_BrakingPhase_2.3Hz_Control_MatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```



```{r Average Generation Angular Velocity }






(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = AverageJointAngVel_PropulsionPhase, x = Limb_ID  ) ) +
      
      
        #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    stat_summary( fun.data = 'mean_cl_boot',
geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
    
    geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = AverageJointAngVel_PropulsionPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3 ) +

    
      
    
   
      
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.25, y = 40, fontface = 'bold' ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.25, y = 17, fontface = 'bold' ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.25, y = -3, fontface = 'bold' ) +
   
      
   
               scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                              
'ATx08' = met.brewer('OKeeffe1')[2],
                                          'ATx10' = met.brewer('OKeeffe1')[3], 
                                          'ATx12' = met.brewer('OKeeffe1')[4],
                                          'ATx17' = met.brewer('OKeeffe1')[5],
                                          'ATx18' = met.brewer('OKeeffe1')[6],
                                          'ATx19' = met.brewer('OKeeffe1')[7],
                                          'ATx21' = met.brewer('OKeeffe1')[8],
                                          'ATx24' = met.brewer('OKeeffe1')[9],
                                          'ATx25' = met.brewer('OKeeffe1')[10],
                                          'ATx27' = met.brewer('OKeeffe1')[11],
                                          'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                           'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC18' = met.brewer('OKeeffe1')[1],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7] ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      

   scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                         name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks = seq(-300,50,by = 50),limits = c(-300,50) ) +
    
    
      scale_x_discrete(labels = c( 'Involved' ) ) +
      
    scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
    
      
      labs(title = ' Average Joint Angular Velocity During Propulsion Phase  \n 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = expression( paste( ' Angular Velocity (', degree, '/s) [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
   
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'), axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text( size = 40, face = 'bold' )  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )

 
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_AverageAngularVelocity_PropulsionPhase_2.3Hz_Control_MatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )


```


###### RoM

```{r RoM Braking Phase }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_SagittalRoM_BrakingPhase )




(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = SagittalRoM_BrakingPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 14, x = 0.575, y = CI$ymax + 1.75, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = SagittalRoM_BrakingPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text(  label = 'Ankle', size = 14, color = '#1b9e77', x = 1.35, y = 34, fontface = 'bold' ) +
      #Knee
      geom_text(  label = 'Knee', size = 14, color = '#7570b3', x = 1.35, y = 31.5, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 14, color = '#d95f02', x = 1.475, y = 32.75, fontface = 'bold' ) +
      
      
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                     'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(0,40,by = 5),limits = c(0,40) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Sagittal Plane Range of Motion - Braking Phase \n  2.3 Hz Hopping - Control Group',x = 'Limb ID', y = expression( paste( ' Range of Motion (', degree, ') [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40,face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_PeakJointSagittalRoM_BrakingPhase_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```


```{r RoM Propulsion Phase }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_SagittalRoM_PropulsionPhase )




(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = SagittalRoM_PropulsionPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 14, x = 0.575, y = CI$ymax + 1.75, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = SagittalRoM_PropulsionPhase, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text(  label = 'Ankle', size = 14, color = '#1b9e77', x = 1.35, y = -4.5, fontface = 'bold' ) +
      #Knee
      geom_text(  label = 'Knee', size = 14, color = '#7570b3', x = 1.35, y = -7, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 14, color = '#d95f02', x = 1.475, y = -5.75, fontface = 'bold' ) +
      
      
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                     'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq(-45,0,by = 5),limits = c(-45,0) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Sagittal Plane Range of Motion - Propulsion Phase \n  2.3 Hz Hopping - Control Group',x = 'Limb ID', y = expression( paste( ' Range of Motion (', degree, ') [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40,face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_PeakJointSagittalRoM_PropulsionPhase_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )

```


```{r Initial Contact Angle }




CI <- mean_cl_boot( Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_JointInitialContactAngle )




(Power1 <- ggplot(data = Power_Control_MatchedDominance_2.3Hz, aes(y = JointInitialContactAngle, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( label = '95% CI', size = 14, x = 0.575, y = CI$ymax + 3.5, color = '#1b9e77', fontface = 'bold' ) +
      
      
      #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = Power_Control_MatchedDominance_2.3Hz, aes( y = Joint_Absorption_MEE, yend = Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom = "crossbar", width = 0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  ) + 
      
      
      
      
      geom_dotplot( data = Power_Control_MatchedDominance_2.3Hz, aes( y = JointInitialContactAngle, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3 ) +
      
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text(  label = 'Ankle', size = 14, color = '#1b9e77', x = 1.35, y = 48.5, fontface = 'bold' ) +
      #Knee
      geom_text(  label = 'Knee', size = 14, color = '#7570b3', x = 1.35, y = 43, fontface = 'bold' ) +
      #Hip
      geom_text(  label = 'Hip', size = 14, color = '#d95f02', x = 1.475, y = 46.75, fontface = 'bold' ) +
      
      
      
      scale_color_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02', 'ATx07' = met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10' = met.brewer('OKeeffe1')[3], 
                                    'ATx12' = met.brewer('OKeeffe1')[4],
                                    'ATx17' = met.brewer('OKeeffe1')[5],
                                    'ATx18' = met.brewer('OKeeffe1')[6],
                                    'ATx19' = met.brewer('OKeeffe1')[7],
                                    'ATx21' = met.brewer('OKeeffe1')[8],
                                    'ATx24' = met.brewer('OKeeffe1')[9],
                                    'ATx25' = met.brewer('OKeeffe1')[10],
                                    'ATx27' = met.brewer('OKeeffe1')[11],
                                    'ATx34' = met.brewer('OKeeffe1')[ 7],
                                                                     'ATx38' = met.brewer('OKeeffe1')[1],                                 'ATx41' = met.brewer('OKeeffe1')[2],                                 'ATx44' = met.brewer('OKeeffe1')[3],                                 'ATx50' = met.brewer('OKeeffe1')[4],
                                    'HC01' = met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12' = met.brewer('OKeeffe1')[3], 
                                    'HC05' = met.brewer('OKeeffe1')[4],
                                    'HC06' = met.brewer('OKeeffe1')[5],
                                    'HC08' = met.brewer('OKeeffe1')[6],
                                    'HC20' = met.brewer('OKeeffe1')[7],
                                    'HC11' = met.brewer('OKeeffe1')[8],
                                    'HC17' = met.brewer('OKeeffe1')[9],
                                    'HC21' = met.brewer('OKeeffe1')[11],
                                    'HC25' = met.brewer('OKeeffe1')[ 7],
                                    'HC18' = met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels = c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','ATx44', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics = c('color') ) +
      
      
      scale_fill_manual(values = c('Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02') ,
                        name = 'Joint ID',aesthetics = c('fill'),labels = c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks = seq( -30, 60,by = 10),limits = c( -30, 60 ) ) +
      
      
      scale_x_discrete(labels = c( 'Involved' = 'Involved' ) ) +
      
      scale_shape_manual( values = c('Ankle' = 21,'Knee' = 21,'Hip' = 21  ) ) +
      
      
      labs(title = ' Joint Angular Position at Initial Ground \n Contact - 2.3 Hz Hopping - Control Group',x = 'Limb ID', y = expression( paste( ' Angular Position (', degree, ') [ - = Ext, + = Flex] ' ) ) ) +
      
      
      guides(color = 'none',size = 'none',fill = 'none', alpha = 'none', shape = 'none' ) +
      
      
      theme(plot.title = element_text(size = 50,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 50,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 50,face = 'bold.italic',vjust = 0.9,color = 'darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right = element_text(size = 45,color = 'darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 45,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight = 100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            plot.background = element_rect(color = rgb(245,245,220,maxColorValue = 255),fill = rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color = rgb(245,245,220,maxColorValue = 255)),legend.key.height = unit(0,'lines'),legend.key.width = unit(0.5,'lines'),legend.box.background = element_rect(color = 'black',linewidth = 1),panel.background = element_rect(color = 'black',fill = rgb(245,245,220,maxColorValue = 255)),panel.grid.major.y = element_line(color = 'darkgrey'),panel.grid.minor.y = element_line(color = 'darkgrey'),strip.text = element_text(size = 40,face = 'bold')  ) +
      
      facet_wrap( vars(Group_by_Morphology,Participant_ID), nrow = 4 )
   
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Individual Hops/Control Matched Dominance Limb', filename = 'Dissertation_JointInitialContactAngle_2.3Hz_ControlMatchedDominanceLimb.png', width = 12000, height = 12000, units = 'px' )


```