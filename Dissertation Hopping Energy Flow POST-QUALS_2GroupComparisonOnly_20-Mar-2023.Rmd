---
title: "DTOW Dissertation - Energy Flow Analysis"
output: html_document
author: "David Ortiz"
date: "2023-12-19"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Load - Libraries

```{r Load Libraries, message=FALSE , include=FALSE,results='hide'}
library(R.matlab)
library(ggplot2)
library(pander)
library(stargazer)
library(gridExtra)
library(ggpubr)
library(RColorBrewer)
library(reshape2)
library(effsize)
library(ggsignif)
library(lme4)
library(ggeffects)
library(effects)
library(clubSandwich)
library(DescTools)
library(readxl)
library(xlsx)
library(dplyr)
library(shadowtext)
library(MetBrewer)
library(sjstats)
library(coin)
library(rstatix)
library(tidyverse)
library(datarium)
library(svglite)
library(MASS)
library(car)
library(robustlmm)
library(nlme)

setTimeLimit(cpu= Inf, elapsed = Inf, transient = FALSE)
```

## Load Data

```{r Tendon Morphology}

TendonMorphology <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Morphology/ATx Tendon Morphology.xlsx' ) )

```



### Individual Hops

#### Energy Flow

```{r}

#Load Energy Flow table, with data points for individual hops
EnergyFlow_IndividualHops <- as.data.frame(read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Energy Flow/PostQuals_EnergyFlow_Table.xlsx' ))

#EnergyFlow_IndividualHops$Participant_ID <- factor(EnergyFlow_IndividualHops$Participant_ID)

#Next lines will convert Participant ID numbers into labels
EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID==1) ] <- 'ATx07'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 2) ] <- 'ATx08'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 3) ] <- 'ATx10'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 4) ] <- 'ATx12'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 5) ] <- 'ATx17'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 6) ] <- 'ATx18'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 7) ] <- 'ATx19'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 8) ] <- 'ATx21'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 9) ] <- 'ATx24'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 10) ] <- 'ATx25'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 11) ] <- 'ATx27'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 12) ] <- 'ATx34'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 13) ] <- 'ATx38'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 14) ] <- 'ATx41'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 15) ] <- 'ATx44'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 16) ] <- 'ATx50'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 17) ] <- 'ATx36'

EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Participant_ID == 18) ] <- 'ATx49'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx39'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx74'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx65'








TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 1) ] <- 'HC05'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 2) ] <- 'HC06'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 3) ] <- 'HC11'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 4) ] <- 'HC12'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 5) ] <- 'HC17'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 6) ] <- 'HC18'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 7) ] <- 'HC19'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 8) ] <- 'HC20'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 9) ] <- 'HC21'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 10) ] <- 'HC25'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 11) ] <- 'HC42'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 12) ] <- 'HC45'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 13) ] <- 'HC44'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 14) ] <- 'HC48'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 15) ] <- 'HC65'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 16) ] <- 'HC67'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 17) ] <- 'HC68'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 18) ] <- 'HC30'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 19) ] <- 'HC31'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 20) ] <- 'HC32'




#Convert MTU ID into a label
EnergyFlow_IndividualHops$MTU_ID[which( EnergyFlow_IndividualHops$MTU_ID == 1 ) ] <- 'GasMed'



#Convert Limb_ID numbers into labels. The numbers are the same between groups, so need to tell the code to find the limbs for the ATx group separately from the Control group
EnergyFlow_IndividualHops$Limb_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Limb_ID==1) ] <- 'Involved'

EnergyFlow_IndividualHops$Limb_ID[which(EnergyFlow_IndividualHops$Group_ID == 1 & EnergyFlow_IndividualHops$Limb_ID==2) ] <- 'Non-Involved'


EnergyFlow_IndividualHops$Limb_ID[which(EnergyFlow_IndividualHops$Group_ID == 2 & EnergyFlow_IndividualHops$Limb_ID==1) ] <- 'Matched Dominance'

EnergyFlow_IndividualHops$Limb_ID[which(EnergyFlow_IndividualHops$Group_ID == 2 & EnergyFlow_IndividualHops$Limb_ID==2) ] <- 'Contralateral'


#Convert Limb ID into a categorical variable. Order the levels based on their position in the levels vector
EnergyFlow_IndividualHops$Limb_ID <- factor( EnergyFlow_IndividualHops$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )

                                                        
#Change Group ID numbers into labels     
EnergyFlow_IndividualHops$Group_ID[which(EnergyFlow_IndividualHops$Group_ID==1) ] <- 'ATx'
EnergyFlow_IndividualHops$Group_ID[which(EnergyFlow_IndividualHops$Group_ID==2) ] <- 'Control'



#Change Joint ID numbers into labels
EnergyFlow_IndividualHops$Joint_ID[which(EnergyFlow_IndividualHops$Joint_ID==1) ] <- 'Ankle'
EnergyFlow_IndividualHops$Joint_ID[which(EnergyFlow_IndividualHops$Joint_ID==2) ] <- 'Knee'
EnergyFlow_IndividualHops$Joint_ID[which(EnergyFlow_IndividualHops$Joint_ID==3) ] <- 'Hip'



#Change Segment ID numbers into labels
EnergyFlow_IndividualHops$Segment_ID_Name[which(EnergyFlow_IndividualHops$Segment_ID_Name == 1) ] <- 'Foot'
EnergyFlow_IndividualHops$Segment_ID_Name[which(EnergyFlow_IndividualHops$Segment_ID_Name == 2) ] <- 'Shank'
EnergyFlow_IndividualHops$Segment_ID_Name[which(EnergyFlow_IndividualHops$Segment_ID_Name == 3) ] <- 'Thigh'
EnergyFlow_IndividualHops$Segment_ID_Name[which(EnergyFlow_IndividualHops$Segment_ID_Name == 4) ] <- 'Pelvis'


#Convert Segment_ID_Name into a categorical variable. Order the labels based on their position in the levels vector.
EnergyFlow_IndividualHops$Segment_ID_Name <- factor( EnergyFlow_IndividualHops$Segment_ID_Name, levels = c( 'Foot', 'Shank', 'Thigh', 'Pelvis' ), ordered = T )



#Change Segment_ID_ProxvsDist numbers into labels
EnergyFlow_IndividualHops$Segment_ID_ProxvsDist[which(EnergyFlow_IndividualHops$Segment_ID_ProxvsDist == 1) ] <- 'Distal'
EnergyFlow_IndividualHops$Segment_ID_ProxvsDist[which(EnergyFlow_IndividualHops$Segment_ID_ProxvsDist == 2) ] <- 'Proximal'


#EnergyFlow_IndividualHops <- EnergyFlow_IndividualHops %>% filter( Participant_ID != 'HC08' )

#Create a new column, Group_by_Tendinopathy_Type. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type <- 'Control'

#Change the labels of Group_by_Tendinopathy_Type depending on the participant
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx07' ) ] <- 'Unilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx08' ) ] <- 'Bilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx10' ) ] <- 'Bilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx12' ) ] <- 'Unilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx17' ) ] <- 'Unilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx18' ) ] <- 'Bilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx19' ) ] <- 'Bilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx21' ) ] <- 'Unilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx24' ) ] <- 'Bilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx25' ) ] <- 'Unilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx27' ) ] <- 'Bilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx34' ) ] <- 'Bilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx36' ) ] <- 'Bilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx38' ) ] <- 'Unilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx41' ) ] <- 'Unilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx44' ) ] <- 'Unilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx49' ) ] <- 'Bilateral'
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx50' ) ] <- 'Unilateral'

#Convert Group_by_Tendinopathy_Type into a categorical variable
EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type <- factor( EnergyFlow_IndividualHops$Group_by_Tendinopathy_Type, levels = c( 'Unilateral', 'Bilateral', 'Control'), ordered = T )


#Create a new column, Group_by_Morphology. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
EnergyFlow_IndividualHops$Group_by_Morphology <- 'Control'

#Change the labels of Group_by_Morphology depending on the participant
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx07' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx08' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx10' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx12' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx17' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx18' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx19' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx21' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx24' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx25' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx27' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx34' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx38' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx41' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx44' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx50' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx36' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_IndividualHops$Group_by_Morphology[ which( EnergyFlow_IndividualHops$Participant_ID == 'ATx49' ) ] <- 'LessThan_2mm_Diff'


#Convert Group_by_Morphology into a categorical variable. Order the labels based on their position in the levels vector.
EnergyFlow_IndividualHops$Group_by_Morphology_NotFactored <- EnergyFlow_IndividualHops$Group_by_Morphology


#Convert Group_by_Morphology into a categorical variable
EnergyFlow_IndividualHops$Group_by_Morphology <- factor( EnergyFlow_IndividualHops$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control'), ordered = T )



```


#### Joint Reaction Force/Linear Vel

```{r}

#Load Energy Flow table, with data points for individual hops
JointReactionForceandLinearVel_IndividualHops <- as.data.frame(read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Energy Flow/PostQuals_JointReactionForceandLinearVel_Table.xlsx' ))


#Next lines will convert Participant ID numbers into labels
JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID==1) ] <- 'ATx07'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 2) ] <- 'ATx08'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 3) ] <- 'ATx10'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 4) ] <- 'ATx12'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 5) ] <- 'ATx17'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 6) ] <- 'ATx18'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 7) ] <- 'ATx19'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 8) ] <- 'ATx21'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 9) ] <- 'ATx24'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 10) ] <- 'ATx25'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 11) ] <- 'ATx27'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 12) ] <- 'ATx34'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 13) ] <- 'ATx38'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 14) ] <- 'ATx41'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 15) ] <- 'ATx44'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 16) ] <- 'ATx50'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 17) ] <- 'ATx36'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 18) ] <- 'ATx49'




JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID==1) ] <- 'HC01'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 2) ] <- 'HC05'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 3) ] <- 'HC06'

# EnergyFlow_IndividualHops$Participant_ID[which(EnergyFlow_IndividualHops$Group_ID == 2 & EnergyFlow_IndividualHops$Participant_ID == 4) ] <- 'HC08'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 4) ] <- 'HC11'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 5) ] <- 'HC12'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 6) ] <- 'HC17'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 7) ] <- 'HC18'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 8) ] <- 'HC19'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 9) ] <- 'HC20'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 10) ] <- 'HC21'

JointReactionForceandLinearVel_IndividualHops$Participant_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Participant_ID == 11) ] <- 'HC25'




#Convert MTU ID into a label
JointReactionForceandLinearVel_IndividualHops$MTU_ID[which( JointReactionForceandLinearVel_IndividualHops$MTU_ID == 1 ) ] <- 'GasMed'



#Convert Limb_ID numbers into labels. The numbers are the same between groups, so need to tell the code to find the limbs for the ATx group separately from the Control group
JointReactionForceandLinearVel_IndividualHops$Limb_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Limb_ID==1) ] <- 'Involved'

JointReactionForceandLinearVel_IndividualHops$Limb_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 1 & JointReactionForceandLinearVel_IndividualHops$Limb_ID==2) ] <- 'Non-Involved'


JointReactionForceandLinearVel_IndividualHops$Limb_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Limb_ID==1) ] <- 'Matched Dominance'

JointReactionForceandLinearVel_IndividualHops$Limb_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID == 2 & JointReactionForceandLinearVel_IndividualHops$Limb_ID==2) ] <- 'Contralateral'


#Convert Limb ID into a categorical variable. Order the levels based on their position in the levels vector
JointReactionForceandLinearVel_IndividualHops$Limb_ID <- factor( JointReactionForceandLinearVel_IndividualHops$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )


#Change Group ID numbers into labels     
JointReactionForceandLinearVel_IndividualHops$Group_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID==1) ] <- 'ATx'
JointReactionForceandLinearVel_IndividualHops$Group_ID[which(JointReactionForceandLinearVel_IndividualHops$Group_ID==2) ] <- 'Control'



#Change Joint ID numbers into labels
JointReactionForceandLinearVel_IndividualHops$Joint_ID[which(JointReactionForceandLinearVel_IndividualHops$Joint_ID == 1) ] <- 'Ankle'
JointReactionForceandLinearVel_IndividualHops$Joint_ID[which(JointReactionForceandLinearVel_IndividualHops$Joint_ID == 2) ] <- 'Knee'
JointReactionForceandLinearVel_IndividualHops$Joint_ID[which(JointReactionForceandLinearVel_IndividualHops$Joint_ID == 3) ] <- 'Hip'


#Convert Joint ID into a categorical variable. Order the levels based on their position in the levels vector
JointReactionForceandLinearVel_IndividualHops$Joint_ID <- factor( JointReactionForceandLinearVel_IndividualHops$Joint_ID, levels = c('Ankle', 'Knee', 'Hip'), ordered = T )



#Change Axis numbers into labels
JointReactionForceandLinearVel_IndividualHops$Axis_ID[which(JointReactionForceandLinearVel_IndividualHops$Axis_ID == 1) ] <- 'X'
JointReactionForceandLinearVel_IndividualHops$Axis_ID[which(JointReactionForceandLinearVel_IndividualHops$Axis_ID == 2) ] <- 'Y'
JointReactionForceandLinearVel_IndividualHops$Axis_ID[which(JointReactionForceandLinearVel_IndividualHops$Axis_ID == 3) ] <- 'Z'




#JointReactionForceandLinearVel_IndividualHops <- JointReactionForceandLinearVel_IndividualHops %>% filter( Participant_ID != 'HC08' )

#Create a new column, Group_by_Tendinopathy_Type. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type <- 'Control'

#Change the labels of Group_by_Tendinopathy_Type depending on the participant
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx07' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx08' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx10' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx12' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx17' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx18' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx19' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx21' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx24' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx25' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx27' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx34' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx36' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx38' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx41' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx44' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx49' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx50' ) ] <- 'Unilateral'

#Convert Group_by_Tendinopathy_Type into a categorical variable
JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type <- factor( JointReactionForceandLinearVel_IndividualHops$Group_by_Tendinopathy_Type, levels = c( 'Unilateral', 'Bilateral', 'Control'), ordered = T )


#Create a new column, Group_by_Morphology. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology <- 'Control'

#Change the labels of Group_by_Morphology depending on the participant
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx07' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx08' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx10' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx12' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx17' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx18' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx19' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx21' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx24' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx25' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx27' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx34' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx38' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx41' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx44' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx36' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology[ which( JointReactionForceandLinearVel_IndividualHops$Participant_ID == 'ATx49' ) ] <- 'LessThan_2mm_Diff'

#Convert Group_by_Morphology into a categorical variable
JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology <- factor( JointReactionForceandLinearVel_IndividualHops$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control'), ordered = T )



```


### Participant Means

```{r Energy Flow}

#Load Energy Flow table, with data points for participant means
EnergyFlow_ParticipantMeans <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Energy Flow/PostQuals_EnergyFlow_ParticipantMeansPerHoppingRate.xlsx' ) )


#Next lines will convert Participant ID numbers into labels
EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID==1) ] <- 'ATx07'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 2) ] <- 'ATx08'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 3) ] <- 'ATx10'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 4) ] <- 'ATx12'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 5) ] <- 'ATx17'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 6) ] <- 'ATx18'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 7) ] <- 'ATx19'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 8) ] <- 'ATx21'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 9) ] <- 'ATx24'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 10) ] <- 'ATx25'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 11) ] <- 'ATx27'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 12) ] <- 'ATx34'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 13) ] <- 'ATx38'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 14) ] <- 'ATx41'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 15) ] <- 'ATx44'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 16) ] <- 'ATx50'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 17) ] <- 'ATx36'

EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Participant_ID == 18) ] <- 'ATx49'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx39'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx74'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx65'




TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 1) ] <- 'HC05'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 2) ] <- 'HC06'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 3) ] <- 'HC11'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 4) ] <- 'HC12'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 5) ] <- 'HC17'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 6) ] <- 'HC18'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 7) ] <- 'HC19'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 8) ] <- 'HC20'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 9) ] <- 'HC21'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 10) ] <- 'HC25'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 11) ] <- 'HC42'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 12) ] <- 'HC45'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 13) ] <- 'HC44'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 14) ] <- 'HC48'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 15) ] <- 'HC65'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 16) ] <- 'HC67'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 17) ] <- 'HC68'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 18) ] <- 'HC30'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 19) ] <- 'HC31'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 20) ] <- 'HC32'

#Convert MTU ID into a label
EnergyFlow_ParticipantMeans$MTU_ID[which( EnergyFlow_ParticipantMeans$MTU_ID == 1 ) ] <- 'GasMed'


#Convert Limb_ID numbers into labels. The numbers are the same between groups, so need to tell the code to find the limbs for the ATx group separately from the Control group
EnergyFlow_ParticipantMeans$Limb_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Limb_ID==1) ] <- 'Involved'

EnergyFlow_ParticipantMeans$Limb_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 1 & EnergyFlow_ParticipantMeans$Limb_ID==2) ] <- 'Non-Involved'


EnergyFlow_ParticipantMeans$Limb_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 2 & EnergyFlow_ParticipantMeans$Limb_ID==1) ] <- 'Matched Dominance'

EnergyFlow_ParticipantMeans$Limb_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 2 & EnergyFlow_ParticipantMeans$Limb_ID==2) ] <- 'Contralateral'


#Convert Limb ID into a categorical variable. Order the levels based on their position in the levels vector
EnergyFlow_ParticipantMeans$Limb_ID <- factor( EnergyFlow_ParticipantMeans$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )
                                                                         

#Convert Group ID into labels.
EnergyFlow_ParticipantMeans$Group_ID[which(EnergyFlow_ParticipantMeans$Group_ID==1) ] <- 'ATx'
EnergyFlow_ParticipantMeans$Group_ID[which(EnergyFlow_ParticipantMeans$Group_ID==2) ] <- 'Control'


#Change Joint ID numbers into labels
EnergyFlow_ParticipantMeans$Joint_ID[which(EnergyFlow_ParticipantMeans$Joint_ID==1) ] <- 'Ankle'
EnergyFlow_ParticipantMeans$Joint_ID[which(EnergyFlow_ParticipantMeans$Joint_ID==2) ] <- 'Knee'
EnergyFlow_ParticipantMeans$Joint_ID[which(EnergyFlow_ParticipantMeans$Joint_ID==3) ] <- 'Hip'



#Change Segment ID numbers into labels
EnergyFlow_ParticipantMeans$Segment_ID_Name[which(EnergyFlow_ParticipantMeans$Segment_ID_Name == 1) ] <- 'Foot'
EnergyFlow_ParticipantMeans$Segment_ID_Name[which(EnergyFlow_ParticipantMeans$Segment_ID_Name == 2) ] <- 'Shank'
EnergyFlow_ParticipantMeans$Segment_ID_Name[which(EnergyFlow_ParticipantMeans$Segment_ID_Name == 3) ] <- 'Thigh'
EnergyFlow_ParticipantMeans$Segment_ID_Name[which(EnergyFlow_ParticipantMeans$Segment_ID_Name == 4) ] <- 'Pelvis'

#Convert Segment_ID_Name into a categorical variable. Order the labels based on their position in the levels vector.
EnergyFlow_ParticipantMeans$Segment_ID_Name <- factor( EnergyFlow_ParticipantMeans$Segment_ID_Name, levels = c( 'Foot', 'Shank', 'Thigh', 'Pelvis' ), ordered = T )


#Change Segment_ID_ProxvsDist numbers into labels
EnergyFlow_ParticipantMeans$Segment_ID_ProxvsDist[which(EnergyFlow_ParticipantMeans$Segment_ID_ProxvsDist == 1) ] <- 'Distal'
EnergyFlow_ParticipantMeans$Segment_ID_ProxvsDist[which(EnergyFlow_ParticipantMeans$Segment_ID_ProxvsDist == 2) ] <- 'Proximal'




#Remove HC08 from the analysis
EnergyFlow_ParticipantMeans <- EnergyFlow_ParticipantMeans %>% filter( Participant_ID != 'HC08' )

#Create a new column, Group_by_Tendinopathy_Type. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type <- 'Control'


#Change the labels of Group_by_Tendinopathy_Type depending on the participant
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx07' ) ] <- 'Unilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx08' ) ] <- 'Bilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx10' ) ] <- 'Bilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx12' ) ] <- 'Unilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx17' ) ] <- 'Unilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx18' ) ] <- 'Bilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx19' ) ] <- 'Bilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx21' ) ] <- 'Unilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx24' ) ] <- 'Bilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx25' ) ] <- 'Unilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx27' ) ] <- 'Bilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx34' ) ] <- 'Bilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx38' ) ] <- 'Unilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx50' ) ] <- 'Unilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx41' ) ] <- 'Unilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx44' ) ] <- 'Unilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx36' ) ] <- 'Bilateral'
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx49' ) ] <- 'Bilateral'

#Convert Group_by_Tendinopathy_Type into a categorical variable. Order the labels based on their position in the levels vector.
EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type <- factor( EnergyFlow_ParticipantMeans$Group_by_Tendinopathy_Type, levels = c( 'Unilateral', 'Bilateral', 'Control'), ordered = T )



#Create a new column, Group_by_Morphology. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
EnergyFlow_ParticipantMeans$Group_by_Morphology <- 'Control'

#Change the labels of Group_by_Morphology depending on the participant
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx07' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx08' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx10' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx12' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx17' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx18' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx19' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx21' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx24' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx25' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx27' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx34' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx38' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx41' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx44' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx50' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx36' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_ParticipantMeans$Participant_ID == 'ATx49' ) ] <- 'LessThan_2mm_Diff'




#Convert Group_by_Morphology into a categorical variable. Order the labels based on their position in the levels vector.
EnergyFlow_ParticipantMeans$Group_by_Morphology_NotFactored <- EnergyFlow_ParticipantMeans$Group_by_Morphology

#Convert Group_by_Morphology into a categorical variable. Do not give the levels a specific order
EnergyFlow_ParticipantMeans$Group_by_Morphology_NotOrdered <- factor( EnergyFlow_ParticipantMeans$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control') )

#Convert Group_by_Morphology into a categorical variable. Order the labels based on their position in the levels vector.
EnergyFlow_ParticipantMeans$Group_by_Morphology <- factor( EnergyFlow_ParticipantMeans$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control'), ordered = T )






```


#### Joint Reaction Force/Linear Vel
```{r}

#Load Energy Flow table, with data points for individual hops
JointReactionForceandLinearVel_ParticipantMeans <- as.data.frame(read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Energy Flow/PostQuals_JointReactionForceandLinearVel_ParticipantMeansPerHoppingRate.xlsx' ))


#Next lines will convert Participant ID numbers into labels
JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID==1) ] <- 'ATx07'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 2) ] <- 'ATx08'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 3) ] <- 'ATx10'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 4) ] <- 'ATx12'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 5) ] <- 'ATx17'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 6) ] <- 'ATx18'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 7) ] <- 'ATx19'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 8) ] <- 'ATx21'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 9) ] <- 'ATx24'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 10) ] <- 'ATx25'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 11) ] <- 'ATx27'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 12) ] <- 'ATx34'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 13) ] <- 'ATx38'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 14) ] <- 'ATx41'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 15) ] <- 'ATx44'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 16) ] <- 'ATx50'




JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID==1) ] <- 'HC01'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 2) ] <- 'HC05'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 3) ] <- 'HC06'

# EnergyFlow_ParticipantMeans$Participant_ID[which(EnergyFlow_ParticipantMeans$Group_ID == 2 & EnergyFlow_ParticipantMeans$Participant_ID == 4) ] <- 'HC08'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 4) ] <- 'HC11'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 5) ] <- 'HC12'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 6) ] <- 'HC17'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 7) ] <- 'HC18'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 8) ] <- 'HC19'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 9) ] <- 'HC20'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 10) ] <- 'HC21'

JointReactionForceandLinearVel_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 11) ] <- 'HC25'





#Convert MTU ID into a label
JointReactionForceandLinearVel_ParticipantMeans$MTU_ID[which( JointReactionForceandLinearVel_ParticipantMeans$MTU_ID == 1 ) ] <- 'GasMed'



#Convert Limb_ID numbers into labels. The numbers are the same between groups, so need to tell the code to find the limbs for the ATx group separately from the Control group
JointReactionForceandLinearVel_ParticipantMeans$Limb_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Limb_ID==1) ] <- 'Involved'

JointReactionForceandLinearVel_ParticipantMeans$Limb_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_ParticipantMeans$Limb_ID==2) ] <- 'Non-Involved'


JointReactionForceandLinearVel_ParticipantMeans$Limb_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Limb_ID==1) ] <- 'Matched Dominance'

JointReactionForceandLinearVel_ParticipantMeans$Limb_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_ParticipantMeans$Limb_ID==2) ] <- 'Contralateral'


#Convert Limb ID into a categorical variable. Order the levels based on their position in the levels vector
JointReactionForceandLinearVel_ParticipantMeans$Limb_ID <- factor( JointReactionForceandLinearVel_ParticipantMeans$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )


#Change Group ID numbers into labels     
JointReactionForceandLinearVel_ParticipantMeans$Group_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID==1) ] <- 'ATx'
JointReactionForceandLinearVel_ParticipantMeans$Group_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Group_ID==2) ] <- 'Control'



#Change Joint ID numbers into labels
JointReactionForceandLinearVel_ParticipantMeans$Joint_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Joint_ID == 1) ] <- 'Ankle'
JointReactionForceandLinearVel_ParticipantMeans$Joint_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Joint_ID == 2) ] <- 'Knee'
JointReactionForceandLinearVel_ParticipantMeans$Joint_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Joint_ID == 3) ] <- 'Hip'



#Convert Joint ID into a categorical variable. Order the levels based on their position in the levels vector
JointReactionForceandLinearVel_ParticipantMeans$Joint_ID <- factor( JointReactionForceandLinearVel_ParticipantMeans$Joint_ID, levels = c('Ankle', 'Knee', 'Hip'), ordered = T )



#Change Axis numbers into labels
JointReactionForceandLinearVel_ParticipantMeans$Axis_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Axis_ID == 1) ] <- 'X'
JointReactionForceandLinearVel_ParticipantMeans$Axis_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Axis_ID == 2) ] <- 'Y'
JointReactionForceandLinearVel_ParticipantMeans$Axis_ID[which(JointReactionForceandLinearVel_ParticipantMeans$Axis_ID == 3) ] <- 'Z'




#JointReactionForceandLinearVel_ParticipantMeans <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( Participant_ID != 'HC08' )

#Create a new column, Group_by_Tendinopathy_Type. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type <- 'Control'

#Change the labels of Group_by_Tendinopathy_Type depending on the participant
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx07' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx08' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx10' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx12' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx17' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx18' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx19' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx21' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx24' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx25' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx27' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx34' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx36' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx38' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx41' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx44' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx49' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx50' ) ] <- 'Unilateral'

#Convert Group_by_Tendinopathy_Type into a categorical variable
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type <- factor( JointReactionForceandLinearVel_ParticipantMeans$Group_by_Tendinopathy_Type, levels = c( 'Unilateral', 'Bilateral', 'Control'), ordered = T )


#Create a new column, Group_by_Morphology. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology <- 'Control'

#Change the labels of Group_by_Morphology depending on the participant
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx07' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx08' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx10' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx12' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx17' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx18' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx19' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx21' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx24' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx25' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx27' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx34' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx38' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx41' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx44' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx50' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx36' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_ParticipantMeans$Participant_ID == 'ATx49' ) ] <- 'LessThan_2mm_Diff'

#Convert Group_by_Morphology into a categorical variable
JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology <- factor( JointReactionForceandLinearVel_ParticipantMeans$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control'), ordered = T )



```



### Group Means

```{r Energy Flow, Group Means}

#Load Energy Flow table, with data points for group means
EnergyFlow_GroupMeans <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Energy Flow/PostQuals_EnergyFlow_GroupMeansPerHoppingRate.xlsx' ) )



#MTU ID is Medial Gastroc or
EnergyFlow_GroupMeans$MTU_ID[which( EnergyFlow_GroupMeans$MTU_ID == 1 ) ] <- 'MedGas'



#Limb 1 of Group 1 is the Involved Limb
EnergyFlow_GroupMeans$Limb_ID[which(EnergyFlow_GroupMeans$Group_ID == 1 & EnergyFlow_GroupMeans$Limb_ID==1) ] <- 'Involved'

#Limb 1 of Group 1 is the Non-Involved Limb
EnergyFlow_GroupMeans$Limb_ID[which(EnergyFlow_GroupMeans$Group_ID == 1 & EnergyFlow_GroupMeans$Limb_ID==2) ] <- 'Non-Involved'


#Limb 1 of Group 2 is the Matched Dominance Limb of the healthy control group
EnergyFlow_GroupMeans$Limb_ID[which(EnergyFlow_GroupMeans$Group_ID == 2 & EnergyFlow_GroupMeans$Limb_ID==1) ] <- 'Matched Dominance'

#Limb 2 of Group 2 is the Contralateral Limb of the healthy control group
EnergyFlow_GroupMeans$Limb_ID[which(EnergyFlow_GroupMeans$Group_ID == 2 & EnergyFlow_GroupMeans$Limb_ID==2) ] <- 'Contralateral'


#Convert Limb ID into a categorical variable. Order the levels based on their position in the levels vector
EnergyFlow_GroupMeans$Limb_ID <- factor( EnergyFlow_GroupMeans$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )





#Group 1 is the ATx group
EnergyFlow_GroupMeans$Group_ID[which(EnergyFlow_GroupMeans$Group_ID==1) ] <- 'ATx'

#Group 2 is the Control group
EnergyFlow_GroupMeans$Group_ID[which(EnergyFlow_GroupMeans$Group_ID==2) ] <- 'Control'





#Round the hopping rates to 1 decimal point to avoid weird errors
EnergyFlow_GroupMeans$HoppingRate_ID <- round( EnergyFlow_GroupMeans$HoppingRate_ID, digits = 1 )



#Joint 1 is the ankle
EnergyFlow_GroupMeans$Joint_ID[which(EnergyFlow_GroupMeans$Joint_ID==1) ] <- 'Ankle'

#Joint 2 is the knee
EnergyFlow_GroupMeans$Joint_ID[which(EnergyFlow_GroupMeans$Joint_ID==2) ] <- 'Knee'

#Joint 3 is the hip
EnergyFlow_GroupMeans$Joint_ID[which(EnergyFlow_GroupMeans$Joint_ID==3) ] <- 'Hip'




#Change Segment ID numbers into labels
EnergyFlow_GroupMeans$Segment_ID_Name[which(EnergyFlow_GroupMeans$Segment_ID_Name == 1) ] <- 'Foot'
EnergyFlow_GroupMeans$Segment_ID_Name[which(EnergyFlow_GroupMeans$Segment_ID_Name == 2) ] <- 'Shank'
EnergyFlow_GroupMeans$Segment_ID_Name[which(EnergyFlow_GroupMeans$Segment_ID_Name == 3) ] <- 'Thigh'
EnergyFlow_GroupMeans$Segment_ID_Name[which(EnergyFlow_GroupMeans$Segment_ID_Name == 4) ] <- 'Pelvis'

#Convert Segment_ID_Name into a categorical variable. Order the labels based on their position in the levels vector.
EnergyFlow_GroupMeans$Segment_ID_Name <- factor( EnergyFlow_GroupMeans$Segment_ID_Name, levels = c( 'Foot', 'Shank', 'Thigh', 'Pelvis' ), ordered = T )


#Change Segment_ID_ProxvsDist numbers into labels
EnergyFlow_GroupMeans$Segment_ID_ProxvsDist[which(EnergyFlow_GroupMeans$Segment_ID_ProxvsDist == 1) ] <- 'Distal'
EnergyFlow_GroupMeans$Segment_ID_ProxvsDist[which(EnergyFlow_GroupMeans$Segment_ID_ProxvsDist == 2) ] <- 'Proximal'

```



#### Joint Reaction Force/Linear Vel
```{r}

#Load Energy Flow table, with data points for individual hops
JointReactionForceandLinearVel_GroupMeans <- as.data.frame(read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Energy Flow/PostQuals_JointReactionForceandLinearVel_GroupMeansPerHoppingRate.xlsx' ))


#Convert MTU ID into a label
JointReactionForceandLinearVel_GroupMeans$MTU_ID[which( JointReactionForceandLinearVel_GroupMeans$MTU_ID == 1 ) ] <- 'GasMed'



#Convert Limb_ID numbers into labels. The numbers are the same between groups, so need to tell the code to find the limbs for the ATx group separately from the Control group
JointReactionForceandLinearVel_GroupMeans$Limb_ID[which(JointReactionForceandLinearVel_GroupMeans$Group_ID == 1 & JointReactionForceandLinearVel_GroupMeans$Limb_ID==1) ] <- 'Involved'

JointReactionForceandLinearVel_GroupMeans$Limb_ID[which(JointReactionForceandLinearVel_GroupMeans$Group_ID == 1 & JointReactionForceandLinearVel_GroupMeans$Limb_ID==2) ] <- 'Non-Involved'


JointReactionForceandLinearVel_GroupMeans$Limb_ID[which(JointReactionForceandLinearVel_GroupMeans$Group_ID == 2 & JointReactionForceandLinearVel_GroupMeans$Limb_ID==1) ] <- 'Matched Dominance'

JointReactionForceandLinearVel_GroupMeans$Limb_ID[which(JointReactionForceandLinearVel_GroupMeans$Group_ID == 2 & JointReactionForceandLinearVel_GroupMeans$Limb_ID==2) ] <- 'Contralateral'


#Convert Limb ID into a categorical variable. Order the levels based on their position in the levels vector
JointReactionForceandLinearVel_GroupMeans$Limb_ID <- factor( JointReactionForceandLinearVel_GroupMeans$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )


#Change Group ID numbers into labels     
JointReactionForceandLinearVel_GroupMeans$Group_ID[which(JointReactionForceandLinearVel_GroupMeans$Group_ID==1) ] <- 'ATx'
JointReactionForceandLinearVel_GroupMeans$Group_ID[which(JointReactionForceandLinearVel_GroupMeans$Group_ID==2) ] <- 'Control'



#Change Joint ID numbers into labels
JointReactionForceandLinearVel_GroupMeans$Joint_ID[which(JointReactionForceandLinearVel_GroupMeans$Joint_ID == 1) ] <- 'Ankle'
JointReactionForceandLinearVel_GroupMeans$Joint_ID[which(JointReactionForceandLinearVel_GroupMeans$Joint_ID == 2) ] <- 'Knee'
JointReactionForceandLinearVel_GroupMeans$Joint_ID[which(JointReactionForceandLinearVel_GroupMeans$Joint_ID == 3) ] <- 'Hip'

#Convert Joint ID into a categorical variable. Order the levels based on their position in the levels vector
JointReactionForceandLinearVel_GroupMeans$Joint_ID <- factor( JointReactionForceandLinearVel_GroupMeans$Joint_ID, levels = c('Ankle', 'Knee', 'Hip'), ordered = T )


#Change Axis numbers into labels
JointReactionForceandLinearVel_GroupMeans$Axis_ID[which(JointReactionForceandLinearVel_GroupMeans$Axis_ID == 1) ] <- 'X'
JointReactionForceandLinearVel_GroupMeans$Axis_ID[which(JointReactionForceandLinearVel_GroupMeans$Axis_ID == 2) ] <- 'Y'
JointReactionForceandLinearVel_GroupMeans$Axis_ID[which(JointReactionForceandLinearVel_GroupMeans$Axis_ID == 3) ] <- 'Z'




#JointReactionForceandLinearVel_GroupMeans <- JointReactionForceandLinearVel_GroupMeans %>% filter( Participant_ID != 'HC08' )

#Create a new column, Group_by_Tendinopathy_Type. Will first assign the Control label

```


### Between-Limb Differences

```{r Energy Flow, Between-Limb Differences}


#Load Energy Flow table, with data points for between-limb differences
EnergyFlow_BetweenLimbDiff_ParticipantMeans <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Energy Flow/PostQuals_EnergyFlow_BetweenLimbDiff_ParticipantMeans.xlsx' ) )


#Next lines will convert Participant ID numbers into labels
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID==1) ] <- 'ATx07'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 2) ] <- 'ATx08'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 3) ] <- 'ATx10'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 4) ] <- 'ATx12'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 5) ] <- 'ATx17'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 6) ] <- 'ATx18'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 7) ] <- 'ATx19'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 8) ] <- 'ATx21'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 9) ] <- 'ATx24'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 10) ] <- 'ATx25'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 11) ] <- 'ATx27'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 12) ] <- 'ATx34'




EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID==1) ] <- 'HC01'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 2) ] <- 'HC05'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 3) ] <- 'HC06'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 4) ] <- 'HC08'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 5) ] <- 'HC11'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 6) ] <- 'HC12'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 7) ] <- 'HC17'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 8) ] <- 'HC19'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 9) ] <- 'HC20'

EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 10) ] <- 'HC21'



                                                                         
#Convert Group ID into labels.
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID==1) ] <- 'ATx'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_ID==2) ] <- 'Control'



#Change Joint ID numbers into labels
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Joint_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Joint_ID==1) ] <- 'Ankle'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Joint_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Joint_ID==2) ] <- 'Knee'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Joint_ID[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Joint_ID==3) ] <- 'Hip'



#Change Segment ID numbers into labels
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_Name[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_Name == 1) ] <- 'Foot'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_Name[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_Name == 2) ] <- 'Shank'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_Name[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_Name == 3) ] <- 'Thigh'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_Name[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_Name == 4) ] <- 'Pelvis'

#Convert Segment_ID_Name into a categorical variable. Order the labels based on their position in the levels vector.
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_Name <- factor( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_Name, levels = c( 'Foot', 'Shank', 'Thigh', 'Pelvis' ), ordered = T )



#Change Segment_ID_ProxvsDist numbers into labels
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_ProxvsDist[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_ProxvsDist == 1) ] <- 'Distal'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_ProxvsDist[which(EnergyFlow_BetweenLimbDiff_ParticipantMeans$Segment_ID_ProxvsDist == 2) ] <- 'Proximal'

#Remove HC08 from analysis
EnergyFlow_BetweenLimbDiff_ParticipantMeans <- EnergyFlow_BetweenLimbDiff_ParticipantMeans %>% filter( Participant_ID != 'HC08' )

#Create a new column, Group_by_Tendinopathy_Type. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type <- 'Control'

#Change the labels of Group_by_Tendinopathy_Type depending on the participant
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx07' ) ] <- 'Unilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx08' ) ] <- 'Bilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx10' ) ] <- 'Bilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx12' ) ] <- 'Unilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx17' ) ] <- 'Unilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx18' ) ] <- 'Bilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx19' ) ] <- 'Bilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx21' ) ] <- 'Unilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx24' ) ] <- 'Bilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx25' ) ] <- 'Unilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx27' ) ] <- 'Bilateral'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx34' ) ] <- 'Bilateral'


#Convert Group_by_Tendinopathy_Type into a categorical variable.
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type <- factor( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type, levels = c( 'Unilateral', 'Bilateral', 'Control'), ordered = T )



#Create a new column, Group_by_Morphology. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology <- 'Control'

#Change the labels of Group_by_Morphology depending on the participant
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx07' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx08' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx10' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx12' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx17' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx18' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx19' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx21' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx24' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx25' ) ] <- 'LessThan_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx27' ) ] <- 'Minimum_2mm_Diff'
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx34' ) ] <- 'LessThan_2mm_Diff'


#Convert Group_by_Morphology into a categorical variable
EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology <- factor( EnergyFlow_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control'), ordered = T )

```




#### Joint Reaction Force/Linear Vel
```{r}

#Load Energy Flow table, with data points for individual hops
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans <- as.data.frame(read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Energy Flow/PostQuals_JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans.xlsx' ))


#Next lines will convert Participant ID numbers into labels
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID==1) ] <- 'ATx07'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 2) ] <- 'ATx08'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 3) ] <- 'ATx10'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 4) ] <- 'ATx12'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 5) ] <- 'ATx17'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 6) ] <- 'ATx18'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 7) ] <- 'ATx19'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 8) ] <- 'ATx21'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 9) ] <- 'ATx24'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 10) ] <- 'ATx25'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 11) ] <- 'ATx27'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 1 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 12) ] <- 'ATx34'




JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID==1) ] <- 'HC01'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 2) ] <- 'HC05'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 3) ] <- 'HC06'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 4) ] <- 'HC08'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 5) ] <- 'HC11'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 6) ] <- 'HC12'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 7) ] <- 'HC17'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 8) ] <- 'HC19'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 9) ] <- 'HC20'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 10) ] <- 'HC21'

JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID == 2 & JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 11) ] <- 'HC25'




#Convert MTU ID into a label
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$MTU_ID[which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$MTU_ID == 1 ) ] <- 'GasMed'




#Change Group ID numbers into labels     
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID==1) ] <- 'ATx'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_ID==2) ] <- 'Control'



#Change Joint ID numbers into labels
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Joint_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Joint_ID == 1) ] <- 'Ankle'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Joint_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Joint_ID == 2) ] <- 'Knee'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Joint_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Joint_ID == 3) ] <- 'Hip'


#Convert Joint ID into a categorical variable. Order the levels based on their position in the levels vector
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Joint_ID <- factor( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Joint_ID, levels = c('Ankle', 'Knee', 'Hip'), ordered = T )







#Change Axis numbers into labels
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Axis_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Axis_ID == 1) ] <- 'X'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Axis_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Axis_ID == 2) ] <- 'Y'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Axis_ID[which(JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Axis_ID == 3) ] <- 'Z'




#JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans <- JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans %>% filter( Participant_ID != 'HC08' )

#Create a new column, Group_by_Tendinopathy_Type. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type <- 'Control'

#Change the labels of Group_by_Tendinopathy_Type depending on the participant
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx07' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx08' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx10' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx12' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx17' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx18' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx19' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx21' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx24' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx25' ) ] <- 'Unilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx27' ) ] <- 'Bilateral'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx34' ) ] <- 'Bilateral'

#Convert Group_by_Tendinopathy_Type into a categorical variable
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type <- factor( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Tendinopathy_Type, levels = c( 'Unilateral', 'Bilateral', 'Control'), ordered = T )


#Create a new column, Group_by_Morphology. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology <- 'Control'

#Change the labels of Group_by_Morphology depending on the participant
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx07' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx08' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx10' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx12' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx17' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx18' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx19' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx21' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx24' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx25' ) ] <- 'LessThan_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx27' ) ] <- 'Minimum_2mm_Diff'
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology[ which( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Participant_ID == 'ATx34' ) ] <- 'LessThan_2mm_Diff'

#Convert Group_by_Morphology into a categorical variable
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology <- factor( JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control'), ordered = T )



```



## Calculations

## DPLYR


### Both Rates

##### Both Groups
```{r Energy Flow}

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
EnergyFlow_ParticipantMeans_2.0vs2.3Hz <- EnergyFlow_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Non-Involved' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
EnergyFlow_ParticipantMeans_2.0vs2.3Hz_OneJoint <- EnergyFlow_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Non-Involved', Joint_ID == 'Ankle' )


```



```{r JRF and Joint Linear Vel}

#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
JointReactionForceandLinearVel_ParticipantMeans_2.0vs2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Non-Involved' )


#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
JointReactionForceandLinearVel_ParticipantMeans_2.0vs2.3Hz_OneJoint <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Non-Involved', Joint_ID == 'Ankle' )


```

#### ATx Only

```{r Energy Flow}

#Next block of code is for BOTH limbs

#Create new data frame that contains only the data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates
EnergyFlow_ATxBothLimbs_2vs2.3Hz <- EnergyFlow_IndividualHops %>% filter(Group_ID == 'ATx', HoppingRate_ID != 0.0 )


#Create new data frame that contains only the data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates
EnergyFlow_ATxBothLimbs_2vs2.3Hz_AnkleOnly <- EnergyFlow_IndividualHops %>% filter(Group_ID == 'ATx', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )


#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
EnergyFlow_GroupMeans_ATxBothLimbs_2.0vs2.3Hz <- EnergyFlow_GroupMeans %>% filter( HoppingRate_ID != 0.0, Group_ID == 'ATx' )


#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
EnergyFlow_GroupMeans_ATxBothLimbs_2.0vs2.3Hz_AnkleOnly <- EnergyFlow_GroupMeans %>% filter( HoppingRate_ID != 0.0, Group_ID == 'ATx', Joint_ID == 'Ankle' )


#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
EnergyFlow_ParticipantMeans_ATxBothLimbs_2.0vs2.3Hz <- EnergyFlow_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Group_ID == 'ATx' )


#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
EnergyFlow_ParticipantMeans_ATxBothLimbs_2.0vs2.3Hz_AnkleOnly <- EnergyFlow_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Group_ID == 'ATx', Joint_ID == 'Ankle' )








#Next block of code is ONLY Involved Limb


#Create new data frame that contains only the data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates
EnergyFlow_ATxInvolvedLimb_2.0vs2.3Hz <- EnergyFlow_IndividualHops %>% filter( Limb_ID == 'Involved', HoppingRate_ID != 0.0 )


#Create new data frame that contains only the data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle onnly
EnergyFlow_ATxInvolvedLimb_2.0vs2.3Hz_OneJoint <- EnergyFlow_IndividualHops %>% filter( Limb_ID == 'Involved', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )


#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly <- EnergyFlow_GroupMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID == 'Involved', Joint_ID == 'Ankle' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the data for the Involved limb of the ATx group.  Contains both 2.0 and 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.0vs2.3Hz <- EnergyFlow_ParticipantMeans %>% filter( Limb_ID == 'Involved', HoppingRate_ID != '0.0' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group.  Contains both 2.0 and 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.0vs2.3Hz_OneJoint <- EnergyFlow_ParticipantMeans %>% filter( Limb_ID == 'Involved', HoppingRate_ID != '0.0', Joint_ID == 'Ankle' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
EnergyFlow_ParticipantMeans_ATxInvolvedAnkle <- EnergyFlow_ParticipantMeans %>% filter( Limb_ID == 'Involved', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )




#Create new data frame from EnergyFlow_BetweenLimbDiff_ParticipantMeans, containing only ATx group ankle and 2.0 vs 2.3 Hz
EnergyFlow_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2vs2.3Hz <- EnergyFlow_BetweenLimbDiff_ParticipantMeans %>% filter( Group_ID == 'ATx', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )

```



```{r JRF and Joint Linear Vel}

#Next block of code is for BOTH limbs

#Create new data frame that contains only the data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates
JointReactionForceandLinearVel_ATxBothLimbs_2vs2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(Group_ID == 'ATx', HoppingRate_ID != 0.0 )


#Create new data frame that contains only the data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates
JointReactionForceandLinearVel_ATxBothLimbs_2vs2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_IndividualHops %>% filter(Group_ID == 'ATx', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )


#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
JointReactionForceandLinearVel_GroupMeans_ATxBothLimbs_2.0vs2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter( HoppingRate_ID != 0.0, Group_ID == 'ATx' )


#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
JointReactionForceandLinearVel_GroupMeans_ATxBothLimbs_2.0vs2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_GroupMeans %>% filter( HoppingRate_ID != 0.0, Group_ID == 'ATx', Joint_ID == 'Ankle' )


#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
JointReactionForceandLinearVel_ParticipantMeans_ATxBothLimbs_2.0vs2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Group_ID == 'ATx' )


#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
JointReactionForceandLinearVel_ParticipantMeans_ATxBothLimbs_2.0vs2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Group_ID == 'ATx', Joint_ID == 'Ankle' )








#Next block of code is ONLY Involved Limb


#Create new data frame that contains only the data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates
JointReactionForceandLinearVel_ATxInvolvedLimb_2.0vs2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter( Limb_ID == 'Involved', HoppingRate_ID != 0.0 )


#Create new data frame that contains only the data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle onnly
JointReactionForceandLinearVel_ATxInvolvedLimb_2.0vs2.3Hz_OneJoint <- JointReactionForceandLinearVel_IndividualHops %>% filter( Limb_ID == 'Involved', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )


#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
JointReactionForceandLinearVel_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_GroupMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID == 'Involved', Joint_ID == 'Ankle' )


#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the data for the Involved limb of the ATx group.  Contains both 2.0 and 2.3 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_ATxInvolvedLimb_2.0vs2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( Limb_ID == 'Involved', HoppingRate_ID != '0.0' )



#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group.  Contains both 2.0 and 2.3 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_ATxInvolvedLimb_2.0vs2.3Hz_OneJoint <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( Limb_ID == 'Involved', HoppingRate_ID != '0.0', Joint_ID == 'Ankle' )



#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
JointReactionForceandLinearVel_ParticipantMeans_ATxInvolvedAnkle <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( Limb_ID == 'Involved', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )




#Create new data frame from JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans, containing only ATx group ankle and 2.0 vs 2.3 Hz
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2vs2.3Hz <- JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans %>% filter( Group_ID == 'ATx', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )

```

#### Control Only

```{r Energy Flow}

#Create new data frame that contains only the data for the Control group. Contains both 2.0 and 2.3 Hz hopping rates
EnergyFlow_ControlGroup_BothLimbs_2.0vs2.3Hz <- EnergyFlow_IndividualHops %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0 )

#Create new data frame that contains only the data for the Control group. Contains both 2.0 and 2.3 Hz hopping rates
EnergyFlow_ControlGroup_DominanceMatchedLimb_2.0vs2.3Hz <- EnergyFlow_IndividualHops %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Limb_ID == 'Matched Dominance' )

#Create new data frame that contains only the data for the Control group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
EnergyFlow_ControlGroup_BothLimbs_2.0vs2.3Hz_AnkleOnly <- EnergyFlow_IndividualHops %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )

#Create new data frame that contains only the data for the Control group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
EnergyFlow_ControlGroup_DominanceMatchedLimb_2.0vs2.3Hz_AnkleOnly <- EnergyFlow_IndividualHops %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )






#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group. Contains both 2.0 and 2.3 Hz hopping rates
EnergyFlow_ParticipantMeans_ControlGroup_BothLimbs_2.0vs2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0 )


#Create a new data frame from the EnergyFlow_ParticipantMeans data but containing only the data for the Control group ankle joint.  Contains both 2.0 and 2.3 Hz hopping rates
EnergyFlow_ParticipantMeans_ControlGroup_BothLimbs_2.0vs2.3Hz_AnkleOnly <- EnergyFlow_ParticipantMeans %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group. Contains both 2.0 and 2.3 Hz hopping rates
EnergyFlow_ParticipantMeans_DominanceMatchedLimb_2.0vs2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Limb_ID == 'Matched Dominance' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data but containing only the data for the Control group ankle joint.  Contains both 2.0 and 2.3 Hz hopping rates
EnergyFlow_ParticipantMeans_DominanceMatchedLimb_2.0vs2.3Hz_AnkleOnly <- EnergyFlow_ParticipantMeans %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )




#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
EnergyFlow_GroupMeans_ControlGroup_BothLimbs_2.0and2.3Hz_AnkleOnly <- EnergyFlow_GroupMeans %>% filter( HoppingRate_ID != 0.0,Group_ID == 'Control', Joint_ID == 'Ankle' )

#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
EnergyFlow_GroupMeans_ControlGroup_DominanceMatchedLimb_2.0and2.3Hz_AnkleOnly <- EnergyFlow_GroupMeans %>% filter( HoppingRate_ID != 0.0,Group_ID == 'Control', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )

```



```{r JRF and Joint Linear Vel}

#Create new data frame that contains only the data for the Control group. Contains both 2.0 and 2.3 Hz hopping rates
JointReactionForceandLinearVel_ControlGroup_BothLimbs_2.0vs2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0 )

#Create new data frame that contains only the data for the Control group. Contains both 2.0 and 2.3 Hz hopping rates
JointReactionForceandLinearVel_ControlGroup_DominanceMatchedLimb_2.0vs2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Limb_ID == 'Matched Dominance' )

#Create new data frame that contains only the data for the Control group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
JointReactionForceandLinearVel_ControlGroup_BothLimbs_2.0vs2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_IndividualHops %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )

#Create new data frame that contains only the data for the Control group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
JointReactionForceandLinearVel_ControlGroup_DominanceMatchedLimb_2.0vs2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_IndividualHops %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )






#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group. Contains both 2.0 and 2.3 Hz hopping rates
JointReactionForceandLinearVel_ParticipantMeans_ControlGroup_BothLimbs_2.0vs2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0 )


#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data but containing only the data for the Control group ankle joint.  Contains both 2.0 and 2.3 Hz hopping rates
JointReactionForceandLinearVel_ParticipantMeans_ControlGroup_BothLimbs_2.0vs2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Joint_ID == 'Ankle' )


#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group. Contains both 2.0 and 2.3 Hz hopping rates
JointReactionForceandLinearVel_ParticipantMeans_DominanceMatchedLimb_2.0vs2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Limb_ID == 'Matched Dominance' )


#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data but containing only the data for the Control group ankle joint.  Contains both 2.0 and 2.3 Hz hopping rates
JointReactionForceandLinearVel_ParticipantMeans_DominanceMatchedLimb_2.0vs2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(Group_ID == 'Control', HoppingRate_ID != 0.0, Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )




#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
JointReactionForceandLinearVel_GroupMeans_ControlGroup_BothLimbs_2.0and2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_GroupMeans %>% filter( HoppingRate_ID != 0.0,Group_ID == 'Control', Joint_ID == 'Ankle' )

#Create new data frame that contains only the group means data for the involved limb of the ATx group. Contains both 2.0 and 2.3 Hz hopping rates. Ankle only
JointReactionForceandLinearVel_GroupMeans_ControlGroup_DominanceMatchedLimb_2.0and2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_GroupMeans %>% filter( HoppingRate_ID != 0.0,Group_ID == 'Control', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )

```


### 2.0 Hz Only

####Power Data

##### Both Groups
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2')


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2')



```


```{r JRF and Joint Linear Vel}


#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2')


#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2')



```

##### ATx
```{r Energy Flow}


#Next block of code is for BOTH limbs

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the ATx group and the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_ATx_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == 2.0, Group_ID == 'ATx')





#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
EnergyFlow_ATx_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == 2.0, Group_ID == 'ATx')

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
EnergyFlow_ATxAnkle_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == 2.0, Group_ID == 'ATx', Joint_ID == 'Ankle' )



#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
EnergyFlow_ATx_InvolvedAnkle_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == 2.0, Group_ID == 'ATx', Joint_ID == 'Ankle', Limb_ID == 'Involved' )

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
EnergyFlow_ATx_NonInvolvedAnkle_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == 2.0, Group_ID == 'ATx', Joint_ID == 'Ankle', Limb_ID == 'Non-Involved' )





#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the ATx group and the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_ATx_2.0Hz_AnkleOnly <- EnergyFlow_ParticipantMeans_ATx_2.0Hz %>% filter(HoppingRate_ID == '2', Group_ID == 'ATx', Joint_ID == 'Ankle')






## INVOLVED Limb Only
EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.0Hz <- EnergyFlow_ParticipantMeans_ATx_2.0Hz %>%
   filter( Limb_ID == 'Involved' )

EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.0Hz <- EnergyFlow_ParticipantMeans_ATx_2.0Hz %>%
   filter( Limb_ID == 'Involved', Joint_ID=='Ankle' )


EnergyFlow_GroupMeans_ATxInvolvedLimb_2.0Hz <- EnergyFlow_GroupMeans %>%
   filter( Limb_ID == 'Involved' )




## NON-INVOLVED Limb Only
EnergyFlow_ParticipantMeans_ATxNonInvolvedLimb_2.0Hz <- EnergyFlow_ParticipantMeans_ATx_2.0Hz %>%
   filter( Limb_ID == 'Non-Involved' )

EnergyFlow_ParticipantMeans_ATxNonInvolvedAnkle_2.0Hz <- EnergyFlow_ParticipantMeans_ATx_2.0Hz %>%
   filter( Limb_ID == 'Non-Involved', Joint_ID=='Ankle' )

EnergyFlow_GroupMeans_ATxNonInvolvedLimb_2.0Hz <- EnergyFlow_GroupMeans %>%
   filter( Limb_ID == 'Non-Involved' )


```


```{r JRF and Joint Linear Vel}


#Next block of code is for BOTH limbs

#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the ATx group and the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_ATx_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == 2.0, Group_ID == 'ATx')





#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
JointReactionForceandLinearVel_ATx_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == 2.0, Group_ID == 'ATx')

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
JointReactionForceandLinearVel_ATxAnkle_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == 2.0, Group_ID == 'ATx', Joint_ID == 'Ankle' )



#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
JointReactionForceandLinearVel_ATx_InvolvedAnkle_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == 2.0, Group_ID == 'ATx', Joint_ID == 'Ankle', Limb_ID == 'Involved' )

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
JointReactionForceandLinearVel_ATx_NonInvolvedAnkle_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == 2.0, Group_ID == 'ATx', Joint_ID == 'Ankle', Limb_ID == 'Non-Involved' )





#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the ATx group and the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_ATx_2.0Hz_AnkleOnly <- JointReactionForceandLinearVel_ParticipantMeans_ATx_2.0Hz %>% filter(HoppingRate_ID == '2', Group_ID == 'ATx', Joint_ID == 'Ankle')






## INVOLVED Limb Only
JointReactionForceandLinearVel_ParticipantMeans_ATxInvolvedLimb_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans_ATx_2.0Hz %>%
   filter( Limb_ID == 'Involved' )

JointReactionForceandLinearVel_ParticipantMeans_ATxInvolvedAnkle_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans_ATx_2.0Hz %>%
   filter( Limb_ID == 'Involved', Joint_ID=='Ankle' )


JointReactionForceandLinearVel_GroupMeans_ATxInvolvedLimb_2.0Hz <- JointReactionForceandLinearVel_GroupMeans %>%
   filter( Limb_ID == 'Involved' )




## NON-INVOLVED Limb Only
JointReactionForceandLinearVel_ParticipantMeans_ATxNonInvolvedLimb_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans_ATx_2.0Hz %>%
   filter( Limb_ID == 'Non-Involved' )

JointReactionForceandLinearVel_ParticipantMeans_ATxNonInvolvedAnkle_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans_ATx_2.0Hz %>%
   filter( Limb_ID == 'Non-Involved', Joint_ID=='Ankle' )

JointReactionForceandLinearVel_GroupMeans_ATxNonInvolvedLimb_2.0Hz <- JointReactionForceandLinearVel_GroupMeans %>%
   filter( Limb_ID == 'Non-Involved' )


```

##### Control
```{r Energy Flow}

#Create new data frame EnergyFlow_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
EnergyFlow_Control_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2', Group_ID == 'Control')

#Create new data frame EnergyFlow_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
EnergyFlow_Control_DominanceMatchedLimb_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Limb_ID == 'Matched Dominance' )

#Create new data frame EnergyFlow_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
EnergyFlow_ControlAnkle_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle')


#Create new data frame EnergyFlow_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
EnergyFlow_Control_ContralateralAnkle_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle',Limb_ID=='Contralateral')


#Create new data frame EnergyFlow_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
EnergyFlow_Control_MatchedDominanceAnkle_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle',Limb_ID=='Matched Dominance')







#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group and the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_Control_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2', Group_ID == 'Control')

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group and the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_MatchedDominanceLimb_Control_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Limb_ID == 'Matched Dominance' )

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group and the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_ControlAnkle_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle' )

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group and the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter( HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )
                                                                                                          
#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group and the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_Control_ContralateralAnkle_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle', Limb_ID == 'Contralateral' )




```


```{r JRF and Joint Linear Vel}

#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
JointReactionForceandLinearVel_Control_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2', Group_ID == 'Control')

#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
JointReactionForceandLinearVel_Control_DominanceMatchedLimb_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Limb_ID == 'Matched Dominance' )

#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
JointReactionForceandLinearVel_ControlAnkle_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle')


#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
JointReactionForceandLinearVel_Control_ContralateralAnkle_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle',Limb_ID=='Contralateral')


#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
JointReactionForceandLinearVel_Control_MatchedDominanceAnkle_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle',Limb_ID=='Matched Dominance')







#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group and the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_Control_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2', Group_ID == 'Control')

#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group and the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_MatchedDominanceLimb_Control_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Limb_ID == 'Matched Dominance' )

#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group and the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_ControlAnkle_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle' )

#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group and the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_Control_MatchedDominanceAnkle_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )
                                                                                                          
#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group and the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_Control_ContralateralAnkle_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2', Group_ID == 'Control', Joint_ID == 'Ankle', Limb_ID == 'Contralateral' )




```


##### Separate The Joints
```{r Energy Flow}

#Make a new data frame containing only the ankle joint data - this is for the Involved limb of the ATx group versus the Control group, at 2.0 Hz
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.0Hz <- EnergyFlow_ParticipantMeans_InvolvedVsControl_2.0Hz %>% filter( Joint_ID == 'Ankle' )

#Make a new data frame containing only the knee joint data - this is for the Involved limb of the ATx group versus the Control group, at 2.0 Hz
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.0Hz <- EnergyFlow_ParticipantMeans_InvolvedVsControl_2.0Hz %>% filter( Joint_ID == 'Knee' )

#Make a new data frame containing only the hip joint data - this is for the Involved limb of the ATx group versus the Control group, at 2.0 Hz
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.0Hz <- EnergyFlow_ParticipantMeans_InvolvedVsControl_2.0Hz %>% filter( Joint_ID == 'Hip' )

```



### 2.3 Hz Only

#### Power Data

##### Both Groups
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3')

EnergyFlow_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3')

EnergyFlow_ParticipantMeans_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3')

EnergyFlow_GroupMeans_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle' )




```



```{r JRF and Joint Linear Vel}


#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3')

JointReactionForceandLinearVel_Ankle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle' )



#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3')

JointReactionForceandLinearVel_ParticipantMeans_Ankle_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle' )



#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_GroupMeans_2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter(HoppingRate_ID == '2.3')

JointReactionForceandLinearVel_GroupMeans_Ankle_2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle' )




```


##### ATx
```{r Energy Flow}

#Next block of code is for BOTH limbs

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
EnergyFlow_ATx_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx')

EnergyFlow_ATx_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Joint_ID == 'Ankle' )


#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
EnergyFlow_ATx_InvolvedAnkle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Joint_ID == 'Ankle', Limb_ID == 'Involved' )

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
EnergyFlow_ATx_NonInvolvedAnkle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Joint_ID == 'Ankle', Limb_ID == 'Non-Involved' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the ATx group and the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_ATx_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx')




### Participant Means, Ankle Only
EnergyFlow_ParticipantMeans_ATx_2.3Hz_AnkleOnly <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Joint_ID == 'Ankle')




#Next block of code is for INVOLVED limb only

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
EnergyFlow_ATxInvolvedLimb_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved')

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate and only the Ankle joint
EnergyFlow_InvolvedAnkle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved',Joint_ID=='Ankle')


EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.3Hz <- EnergyFlow_ParticipantMeans_ATx_2.3Hz %>% filter( Limb_ID == 'Involved' )



EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz <- EnergyFlow_ParticipantMeans_ATx_2.3Hz %>%
   filter( Limb_ID == 'Involved', Joint_ID=='Ankle' )



#Create a new data frame from the EnergyFlow_GroupMeans data, but containing only the ATx group Involved limb, only the 2.3 Hz hopping rate and only the Ankle joint
EnergyFlow_GroupMeans_InvolvedLimb_2.3Hz <- EnergyFlow_GroupMeans %>% filter( HoppingRate_ID == '2.3', Limb_ID == 'Involved' )


#Create a new data frame from the EnergyFlow_GroupMeans data, but containing only the ATx group Involved limb, only the 2.3 Hz hopping rate and only the Ankle joint
EnergyFlow_GroupMeans_InvolvedAnkle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved',Joint_ID=='Ankle' )









#Next block of code is for NON-INVOLVED limb only

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate and only the Ankle joint
EnergyFlow_NonInvolvedAnkle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Non-Involved',Joint_ID=='Ankle')



EnergyFlow_ParticipantMeans_ATxNonInvolved_2.3Hz <- EnergyFlow_ParticipantMeans_ATx_2.3Hz %>% filter( Limb_ID == 'Non-Involved' )



EnergyFlow_ParticipantMeans_ATxNonInvolvedAnkle_2.Hz <- EnergyFlow_ParticipantMeans_ATx_2.3Hz %>%
   filter( Limb_ID == 'Non-Involved', Joint_ID=='Ankle' )


#Create a new data frame from the EnergyFlow_GroupMeans data, but containing only the ATx group Involved limb, only the 2.3 Hz hopping rate and only the Ankle joint
EnergyFlow_GroupMeans_NonInvolvedAnkle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Non-Involved',Joint_ID=='Ankle' )








#Create new data frame from EnergyFlow_BetweenLimbDiff_ParticipantMeans, containing only ATx group ankle and 2.0 vs 2.3 Hz
EnergyFlow_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2.3Hz <- EnergyFlow_BetweenLimbDiff_ParticipantMeans %>% filter( Group_ID == 'ATx', HoppingRate_ID == 2.3, Joint_ID == 'Ankle' )


```



```{r JRF and Joint Linear Vel}

#Next block of code is for BOTH limbs

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
JointReactionForceandLinearVel_ATx_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx')

JointReactionForceandLinearVel_ATx_Ankle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Joint_ID == 'Ankle' )


#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
JointReactionForceandLinearVel_ATx_InvolvedAnkle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Joint_ID == 'Ankle', Limb_ID == 'Involved' )

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
JointReactionForceandLinearVel_ATx_NonInvolvedAnkle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Joint_ID == 'Ankle', Limb_ID == 'Non-Involved' )


#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the ATx group and the 2.3 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_ATx_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx')




### Participant Means, Ankle Only
JointReactionForceandLinearVel_ParticipantMeans_ATx_2.3Hz_AnkleOnly <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Joint_ID == 'Ankle')




#Next block of code is for INVOLVED limb only

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate
JointReactionForceandLinearVel_ATxInvolvedLimb_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved')

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate and only the Ankle joint
JointReactionForceandLinearVel_InvolvedAnkle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved',Joint_ID=='Ankle')


JointReactionForceandLinearVel_ParticipantMeans_ATxInvolvedLimb_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans_ATx_2.3Hz %>% filter( Limb_ID == 'Involved' )



JointReactionForceandLinearVel_ParticipantMeans_ATxInvolvedAnkle_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans_ATx_2.3Hz %>%
   filter( Limb_ID == 'Involved', Joint_ID=='Ankle' )


#Create a new data frame from the JointReactionForceandLinearVel_GroupMeans data, but containing only the ATx group Involved limb, only the 2.3 Hz hopping rate and only the Ankle joint
JointReactionForceandLinearVel_GroupMeans_InvolvedAnkle_2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved',Joint_ID=='Ankle' )









#Next block of code is for NON-INVOLVED limb only

#Create new data frame Power but containing only the ATx group and 2.3 Hz hopping rate and only the Ankle joint
JointReactionForceandLinearVel_NonInvolvedAnkle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Non-Involved',Joint_ID=='Ankle')



JointReactionForceandLinearVel_ParticipantMeans_ATxNonInvolved_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans_ATx_2.3Hz %>% filter( Limb_ID == 'Non-Involved' )



JointReactionForceandLinearVel_ParticipantMeans_ATxNonInvolvedAnkle_2.Hz <- JointReactionForceandLinearVel_ParticipantMeans_ATx_2.3Hz %>%
   filter( Limb_ID == 'Non-Involved', Joint_ID=='Ankle' )


#Create a new data frame from the JointReactionForceandLinearVel_GroupMeans data, but containing only the ATx group Involved limb, only the 2.3 Hz hopping rate and only the Ankle joint
JointReactionForceandLinearVel_GroupMeans_NonInvolvedAnkle_2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Non-Involved',Joint_ID=='Ankle' )








#Create new data frame from JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans, containing only ATx group ankle and 2.0 vs 2.3 Hz
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2.3Hz <- JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans %>% filter( Group_ID == 'ATx', HoppingRate_ID == 2.3, Joint_ID == 'Ankle' )


```



###### Foot Only
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_ATxInvolvedLimb_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved')

EnergyFlow_ATxInvolvedLimb_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved' )

EnergyFlow_DistalFootOnly_ATxInvolvedLimb_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved', Segment_ID_Name == 'Foot', Segment_ID_ProxvsDist == 'Distal' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_DistalFootOnly_ATxInvolvedLimb_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved', Segment_ID_Name == 'Foot', Segment_ID_ProxvsDist == 'Distal' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_ATxInvolvedLimb_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved')

EnergyFlow_GroupMeans_ATxInvolvedLimb_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved'  )


```




###### Shank Only
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_ATxInvolvedLimb_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved')

EnergyFlow_ATxInvolvedLimb_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved' )

EnergyFlow_DistalShankOnly_ATxInvolvedLimb_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Distal' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_DistalShankOnly_ATx_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Distal' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate for the ATx group Involved limb, for the Shank only - need to specify Proximal segment to get the shank net work rate
EnergyFlow_ParticipantMeans_ProximalShankOnly_ATxInvolvedLimb_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Proximal' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate for the ATx group Involved limb, for the Shank only - need to specify Distal segment to get the knee transfer work rate
EnergyFlow_ParticipantMeans_DistalShankOnly_ATxInvolvedLimb_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Distal' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_ATxInvolvedLimb_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved')

EnergyFlow_GroupMeans_ATxInvolvedLimb_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved'  )


```



###### Thigh Only
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_ATxInvolvedLimb_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved')

EnergyFlow_ATxInvolvedLimb_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved' )

EnergyFlow_ProximalThighOnly_ATxInvolvedLimb_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved', Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal' )



EnergyFlow_ParticipantMeans_ProximalThighOnly_ATx_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal' )

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved')

EnergyFlow_ParticipantMeans_ATxInvolvedLimb_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved' )

EnergyFlow_ParticipantMeans_ProximalThighOnly_ATxInvolvedLimb_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved', Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_ATxInvolvedLimb_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved')

EnergyFlow_GroupMeans_ATxInvolvedLimb_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Involved' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Involved'  )


```



###### Remove ATx Participants
```{r Energy Flow}
 
EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18 <- EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID != 'ATx18' )

EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18 <- EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID != 'ATx18' & Participant_ID != 'ATx12' )

EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12 <- EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID != 'ATx12'  & Participant_ID != 'ATx07' )

EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18 <- EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>% filter( Participant_ID != 'ATx18' & Participant_ID != 'ATx12'  & Participant_ID != 'ATx07' )

```



##### Control


```{r Energy Flow}


#Create new data frame Power but containing only the Control group and 2.3 Hz hopping rate
EnergyFlow_Control_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control')


#Create new data frame Power but containing only the Control group and 2.3 Hz hopping rate
EnergyFlow_Control_MatchedDominance_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control', Limb_ID == 'Matched Dominance' )

#Create new data frame Power but containing only the Control group and 2.3 Hz hopping rate and only the Ankle
EnergyFlow_ControlAnkle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control',Joint_ID=='Ankle')


#Create new data frame EnergyFlow_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
EnergyFlow_Control_ContralateralAnkle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control', Joint_ID == 'Ankle',Limb_ID=='Contralateral')


#Create new data frame EnergyFlow_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
EnergyFlow_Control_MatchedDominanceAnkle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control', Joint_ID == 'Ankle',Limb_ID=='Matched Dominance')





#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group and the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_Control_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control')

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group's Matched Dominance Limb and only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_MatchedDominanceLimb_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control',Limb_ID=='Matched Dominance')

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group and the 2.3 Hz hopping rate and only the Ankle joint
EnergyFlow_ParticipantMeans_ControlAnkle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control',Joint_ID == 'Ankle')

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the Control group and the 2.3 Hz hopping rate and only the Ankle joint
EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control',Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )





#Create a new data frame from the EnergyFlow_GroupMeans data, but containing only the Control group, only the 2.3 Hz hopping rate and only the Ankle joint
EnergyFlow_GroupMeans_ControlAnkle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control',Joint_ID=='Ankle' )

#Create a new data frame from the EnergyFlow_GroupMeans data, but containing only the Control group, only the 2.3 Hz hopping rate and only the Ankle joint
EnergyFlow_GroupMeans_Control_MatchedDominanceLimb_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control', Limb_ID == 'Matched Dominance' )

#Create a new data frame from the EnergyFlow_GroupMeans data, but containing only the Control group, only the 2.3 Hz hopping rate and only the Ankle joint
EnergyFlow_GroupMeans_Control_MatchedDominanceAnkle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control', Joint_ID=='Ankle', Limb_ID == 'Matched Dominance' )



#Create new data frame from EnergyFlow_BetweenLimbDiff_ParticipantMeans, containing only Control group Matched Dominance ankle and only 2.3 Hz
EnergyFlow_BetweenLimbDiff_ParticipantMeans_ControlAnkle_2.3Hz <- EnergyFlow_BetweenLimbDiff_ParticipantMeans %>% filter( Group_ID == 'Control', HoppingRate_ID == 2.3, Joint_ID == 'Ankle' )

```


```{r JRF and Joint Linear Vel}


#Create new data frame Power but containing only the Control group and 2.3 Hz hopping rate
JointReactionForceandLinearVel_Control_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control')


#Create new data frame Power but containing only the Control group and 2.3 Hz hopping rate
JointReactionForceandLinearVel_Control_MatchedDominance_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control', Limb_ID == 'Matched Dominance' )

#Create new data frame Power but containing only the Control group and 2.3 Hz hopping rate and only the Ankle
JointReactionForceandLinearVel_ControlAnkle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control',Joint_ID=='Ankle')


#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
JointReactionForceandLinearVel_Control_ContralateralAnkle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control', Joint_ID == 'Ankle',Limb_ID=='Contralateral')


#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the Control group and 2.0 Hz hopping rate
JointReactionForceandLinearVel_Control_MatchedDominanceAnkle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control', Joint_ID == 'Ankle',Limb_ID=='Matched Dominance')







#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group and the 2.3 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_Control_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control')

#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group's Matched Dominance Limb and only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_MatchedDominanceLimb_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control',Limb_ID=='Matched Dominance')

#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group and the 2.3 Hz hopping rate and only the Ankle joint
JointReactionForceandLinearVel_ParticipantMeans_ControlAnkle_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control',Joint_ID == 'Ankle')

#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the Control group and the 2.3 Hz hopping rate and only the Ankle joint
JointReactionForceandLinearVel_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control',Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )





#Create a new data frame from the JointReactionForceandLinearVel_GroupMeans data, but containing only the Control group, only the 2.3 Hz hopping rate and only the Ankle joint
JointReactionForceandLinearVel_GroupMeans_ControlAnkle_2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control',Joint_ID=='Ankle' )

#Create a new data frame from the JointReactionForceandLinearVel_GroupMeans data, but containing only the Control group, only the 2.3 Hz hopping rate and only the Ankle joint
JointReactionForceandLinearVel_GroupMeans_Control_MatchedDominanceAnkle_2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'Control', Joint_ID=='Ankle', Limb_ID == 'Matched Dominance' )



#Create new data frame from JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans, containing only Control group Matched Dominance ankle and only 2.3 Hz
JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans_ControlAnkle_2.3Hz <- JointReactionForceandLinearVel_BetweenLimbDiff_ParticipantMeans %>% filter( Group_ID == 'Control', HoppingRate_ID == 2.3, Joint_ID == 'Ankle' )

```




##### Separate The Joints
```{r Energy Flow}

#Make a new data frame containing only the ankle joint data - this is for the Involved limb of the ATx group versus the Control group, at 2.3 Hz
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz <- EnergyFlow_ParticipantMeans_InvolvedVsControl_2.3Hz %>% filter( Joint_ID == 'Ankle' )



#Make a new data frame containing only the knee joint data - this is for the Involved limb of the ATx group versus the Control group, at 2.3 Hz
EnergyFlow_ParticipantMeans_InvolvedVsControlKnee_2.3Hz <- EnergyFlow_ParticipantMeans_InvolvedVsControl_2.3Hz %>% filter( Joint_ID == 'Knee' )



#Make a new data frame containing only the hip joint data - this is for the Involved limb of the ATx group versus the Control group, at 2.3 Hz
EnergyFlow_ParticipantMeans_InvolvedVsControlHip_2.3Hz <- EnergyFlow_ParticipantMeans_InvolvedVsControl_2.3Hz %>% filter( Joint_ID == 'Hip' )

```






### Dominance Matched Limb Only

#### Both Rates

##### Both Groups
```{r Energy Flow}

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
EnergyFlow_ParticipantMeans_3Limbs_2.0vs2.3Hz <- EnergyFlow_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Contralateral' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
EnergyFlow_ParticipantMeans_3Limbs_2.0vs2.3Hz_OneJoint <- EnergyFlow_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Contralateral', Joint_ID == 'Ankle' )






#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.0vs2.3Hz <- EnergyFlow_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.0vs2.3Hz_OneJoint <- EnergyFlow_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' , Joint_ID == 'Ankle' )


```



```{r JRF and Joint Linear Vel}

#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
JointReactionForceandLinearVel_ParticipantMeans_3Limbs_2.0vs2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Contralateral' )


#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
JointReactionForceandLinearVel_ParticipantMeans_3Limbs_2.0vs2.3Hz_OneJoint <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Contralateral', Joint_ID == 'Ankle' )






#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
JointReactionForceandLinearVel_ParticipantMeans_1LimbPerGroup_2.0vs2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )


#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the data for the Involved limb ankle of the ATx group
JointReactionForceandLinearVel_ParticipantMeans_1LimbPerGroup_2.0vs2.3Hz_OneJoint <- JointReactionForceandLinearVel_ParticipantMeans %>% filter( HoppingRate_ID != 0.0, Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' , Joint_ID == 'Ankle' )


```


#### 2.0 Hz Only

##### Both Groups
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_3Limbs_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral')








#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_3Limbs_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral')


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral', Joint_ID == 'Ankle')













#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.0Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )






#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.0 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.0Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved', Joint_ID == 'Ankle')

```




```{r JRF and Joint Linear Vel}


#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_3Limbs_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral')








#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_3Limbs_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral')


#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_3Limbs_Ankle_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral', Joint_ID == 'Ankle')













#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_1LimbPerGroup_2.0Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )






#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_1LimbPerGroup_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )



#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.0 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_1LimbPerGroup_Ankle_2.0Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved', Joint_ID == 'Ankle')

```



#### 2.3 Hz Only

##### Both Groups
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_3Limbs_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_3Limbs_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_3Limbs_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )

EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral' )

EnergyFlow_ParticipantMeans_AnkleOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Joint_ID == 'Ankle' )

EnergyFlow_ParticipantMeans_AnkleandFootOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Joint_ID == 'Ankle', Segment_ID_Name == 'Foot' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_3Limbs_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_GroupMeans_3Limbs_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )


```



```{r JRF and Joint Linear Vel}


#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_3Limbs_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

JointReactionForceandLinearVel_3Limbs_Ankle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )



#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_3Limbs_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

JointReactionForceandLinearVel_ParticipantMeans_3Limbs_Ankle_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )

JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral' )



#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_GroupMeans_3Limbs_2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

JointReactionForceandLinearVel_GroupMeans_3Limbs_Ankle_2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )








#Create new data frame JointReactionForceandLinearVel_ParticipantMeans but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_1LimbPerGroup_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

JointReactionForceandLinearVel_1LimbPerGroup_Ankle_2.3Hz <- JointReactionForceandLinearVel_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_ParticipantMeans_1LimbPerGroup_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

JointReactionForceandLinearVel_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- JointReactionForceandLinearVel_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the JointReactionForceandLinearVel_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
JointReactionForceandLinearVel_GroupMeans_1LimbPerGroup_2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

JointReactionForceandLinearVel_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- JointReactionForceandLinearVel_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )


```


###### Foot Only
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_3Limbs_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_3Limbs_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )

EnergyFlow_ProximalFootOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Foot' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_3Limbs_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )

EnergyFlow_ParticipantMeans_ProximalFootOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Foot' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_3Limbs_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_GroupMeans_3Limbs_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )


```




###### Shank Only
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_3Limbs_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_3Limbs_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )

EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Distal' )

EnergyFlow_ProximalShankOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Proximal' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_3Limbs_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )

EnergyFlow_ParticipantMeans_ProximalShankOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Proximal' )

EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Distal' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_3Limbs_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_GroupMeans_3Limbs_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )


```



###### Thigh Only
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_3Limbs_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_3Limbs_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )

EnergyFlow_ProximalThighOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_3Limbs_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )

EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_3Limbs_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_GroupMeans_3Limbs_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )


#Create a new data from EnergyFlow_ParticipantMeans data - will contain only the 2.33 Hz hopping rate, only the Involved and Matched Dominance limbs, and only the energy flow data for the proximal thigh
EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal' )

#Create a new data from EnergyFlow_ParticipantMeans data - will contain only the 2.33 Hz hopping rate, only the Involved and Matched Dominance limbs, and only the energy flow data for the distal thigh
EnergyFlow_ParticipantMeans_DistalThighOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Distal' )

#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )


```




###### Pelvis Only
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_3Limbs_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_3Limbs_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_3Limbs_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )

EnergyFlow_ParticipantMeans_ProximalPelvisOnly_1LimbPer3Groups_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Non-Involved' & Limb_ID != 'Contralateral', Segment_ID_Name == 'Pelvis', Segment_ID_ProxvsDist == 'Proximal' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_3Limbs_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral')

EnergyFlow_GroupMeans_3Limbs_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID != 'Contralateral' & Limb_ID != 'Non-Involved'  )


```



##### Control Only

###### Foot Only
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_ControlMatchedDominance_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance')

EnergyFlow_ControlMatchedDominance_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )

EnergyFlow_DistalFootOnly_ControlMatchedDominance_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance', Segment_ID_Name == 'Foot', Segment_ID_ProxvsDist == 'Distal' )





#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_DistalFootOnly_ControlMatchedDominance_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance', Segment_ID_Name == 'Foot', Segment_ID_ProxvsDist == 'Distal' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_ControlMatchedDominance_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance')

EnergyFlow_GroupMeans_ControlMatchedDominance_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance'  )


```




###### Shank Only
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_ControlMatchedDominance_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance')

EnergyFlow_ControlMatchedDominance_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )

EnergyFlow_DistalShankOnly_ControlMatchedDominance_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Distal' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate and the data for when the shank is the distal segment (knee joint)
EnergyFlow_ParticipantMeans_DistalShankOnly_ATx_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Group_ID == 'ATx', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Distal' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate for the Control group Matched Dominance limb, for the Shank only - need to specify Distal segment to get the knee transfer work rate
EnergyFlow_ParticipantMeans_DistalShankOnly_ControlMatchedDominance_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Distal' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate for the Control group Matched Dominance limb, for the Shank only - need to specify Proximal segment to get the shank net work rate
EnergyFlow_ParticipantMeans_ProximalShankOnly_ControlMatchedDominance_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance', Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Proximal' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_ControlMatchedDominance_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance')

EnergyFlow_GroupMeans_ControlMatchedDominance_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance'  )


```



###### Thigh Only
```{r Energy Flow}


#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_ControlMatchedDominance_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance')

EnergyFlow_ControlMatchedDominance_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )

EnergyFlow_ProximalThighOnly_ControlMatchedDominance_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance', Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_ControlMatchedDominance_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance')

EnergyFlow_ParticipantMeans_ControlMatchedDominance_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )

EnergyFlow_ParticipantMeans_ProximalThighOnly_ControlMatchedDominance_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance', Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_ControlMatchedDominance_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance')

EnergyFlow_GroupMeans_ControlMatchedDominance_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )








#Create new data frame EnergyFlow_ParticipantMeans but containing only the 2.3 Hz hopping rate
EnergyFlow_1LimbPerGroup_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance' )

EnergyFlow_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance' )

EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance'  )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_1LimbPerGroup_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance' )

EnergyFlow_GroupMeans_1LimbPerGroup_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance'  )


```


###### Pelvis Only
```{r Energy Flow}

##Create new data frame from EnergyFlow_IndividualHops, containing only the 2.3 Hz hopping rate, only the the matched dominance limb, and only the pelvis. 
EnergyFlow_ProximalPelvisOnly_ControlMatchedDominance_2.3Hz <- EnergyFlow_IndividualHops %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance', Segment_ID_Name == 'Pelvis' )



#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_ParticipantMeans_ControlMatchedDominance_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance')

EnergyFlow_ParticipantMeans_ControlMatchedDominance_Ankle_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )

EnergyFlow_ParticipantMeans_ProximalPelvisOnly_ControlMatchedDominance_2.3Hz <- EnergyFlow_ParticipantMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance', Segment_ID_Name == 'Pelvis' )


#Create a new data frame from the EnergyFlow_ParticipantMeans data, but containing only the 2.3 Hz hopping rate
EnergyFlow_GroupMeans_ControlMatchedDominance_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Limb_ID == 'Matched Dominance')

EnergyFlow_GroupMeans_ControlMatchedDominance_Ankle_2.3Hz <- EnergyFlow_GroupMeans %>% filter(HoppingRate_ID == '2.3', Joint_ID == 'Ankle', Limb_ID == 'Matched Dominance' )

```





## Combine Joint Power and Segmental Energy
```{r Ankle Work Rate vs Foot/Thigh}



#Create a new data frame to contain Group_ID, Participant_ID, Group_by_Morphology, Mean_JointContribution_AveragePower_AbsorptionNeutralized, Mean_SegmentAverageEnergy_Braking. This will contain participant means
AnkleWorkRatevsFootShankThighWorkRate_ParticipantMeans_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID,
                                                                                                   Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalFootOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,
                                                                                                   Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,
                                                                                                   Mean_AnkleWorkRate_GenerationNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized,
                                                                                                   Mean_AnkleWorkRate_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized,
                                                                                                   Mean_FootAverageEnergy_Braking = EnergyFlow_ParticipantMeans_ProximalFootOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking,
                                                                                            Mean_ShankAverageEnergy_Braking = EnergyFlow_ParticipantMeans_ProximalShankOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking,
                                                                                                   Mean_ThighAverageEnergy_Braking = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking,
                                                                                        ThighAverageEnergyTransfer_Braking = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking*(-1),
                                                                                        ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking,
                                                                                        
                                                                                        ShankProxTransfer_Propulsion = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Propulsion, 
                                                                                           
                                                                                           FootProxTransfer_Propulsion = EnergyFlow_ParticipantMeans_ProximalFootOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Propulsion )





#Create a new data frame to contain Group_ID, Participant_ID, Group_by_Morphology, Mean_JointContribution_AveragePower_AbsorptionNeutralized, Mean_SegmentAverageEnergy_Braking. This will contain one data point for each hop, rather than participant means
AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_1LimbPer3Groups_Ankle_2.3Hz$Group_ID, 
                                                                                        Group_by_Morphology = EnergyFlow_ProximalFootOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                                        Participant_ID = Power_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,
                                                                                        AnkleWorkRate_GenerationNeutralized = Power_1LimbPer3Groups_Ankle_2.3Hz$JointAveragePower_Braking_GenerationNeutralized,
                                                                                        AnkleWorkRate_AbsorptionNeutralized = Power_1LimbPer3Groups_Ankle_2.3Hz$JointAveragePower_Propulsion_AbsorptionNeutralized,
                                                                                        FootAverageEnergy_Braking = EnergyFlow_ProximalFootOnly_1LimbPer3Groups_2.3Hz$SegmentAverageEnergy_Braking,
                                                                                        ShankAverageEnergy_Braking = EnergyFlow_ProximalShankOnly_1LimbPer3Groups_2.3Hz$SegmentAverageEnergy_Braking,
                                                                                        ThighAverageEnergy_Braking = EnergyFlow_ProximalThighOnly_1LimbPer3Groups_2.3Hz$SegmentAverageEnergy_Braking,
                                                                                        ThighAverageEnergyTransfer_Braking = EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Braking*(-1),
                                                                                        ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer = EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Braking,
                                                                                        
                                                                                        ShankProxTransfer_Propulsion = EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Propulsion, 
                                                                                           
                                                                                           FootProxTransfer_Propulsion = EnergyFlow_ProximalFootOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Propulsion)
#Multiply shank power transfer by -1 to equal to the power transfer for the thigh.


```






```{r Ankle Contribution vs Foot/Thigh}



#Create a new data frame to contain Group_ID, Participant_ID, Group_by_Morphology, Mean_JointContribution_AveragePower_AbsorptionNeutralized, Mean_SegmentAverageEnergy_Braking. This will contain participant means
AnkleContributionvsAverageFootShankThighPower_ParticipantMeans_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID,
                                                                                                   Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalFootOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,
                                                                                                   Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,
                                                                                                   Mean_AnkleContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized,
                                                                                                   Mean_FootAverageEnergy_Braking = EnergyFlow_ParticipantMeans_ProximalFootOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking,
                                                                                                   Mean_ThighAverageEnergy_Braking = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking,
                                                                                        ThighAverageEnergyTransfer_Braking = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageEnergyFlow_IndividualHopsTransfer_Braking*(-1),
                                                                                        ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageEnergyFlow_IndividualHopsTransfer_Braking )





#Create a new data frame to contain Group_ID, Participant_ID, Group_by_Morphology, Mean_JointContribution_AveragePower_AbsorptionNeutralized, Mean_SegmentAverageEnergy_Braking. This will contain one data point for each hop, rather than participant means
AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_1LimbPer3Groups_Ankle_2.3Hz$Group_ID, 
                                                                                        Group_by_Morphology = EnergyFlow_ProximalFootOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                                        Participant_ID = Power_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,
                                                                                        AnkleContribution_AveragePower_GenerationNeutralized = Power_1LimbPer3Groups_Ankle_2.3Hz$JointContribution_AveragePower_GenerationNeutralized,
                                                                                        AnkleContribution_AveragePower_AbsorptionNeutralized = Power_1LimbPer3Groups_Ankle_2.3Hz$JointContribution_AveragePower_AbsorptionNeutralized,
                                                                                        FootAverageEnergy_Braking = EnergyFlow_ProximalFootOnly_1LimbPer3Groups_2.3Hz$SegmentAverageEnergy_Braking,
                                                                                        ThighAverageEnergy_Braking = EnergyFlow_ProximalThighOnly_1LimbPer3Groups_2.3Hz$SegmentAverageEnergy_Braking,
                                                                                        ThighAverageEnergyTransfer_Braking = EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Braking*(-1),
                                                                                        ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer = EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Braking,
                                                                                        FootAverageEnergyTransfer_Propulsion = EnergyFlow_ProximalFootOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Propulsion,
                                                                                        ShankAverageEnergyTransfer_Propulsion = EnergyFlow_DistalShankOnly_1LimbPer3Groups_2.3Hz$JointAverageTotalPowerTransfer_Braking )
#Multiply shank power transfer by -1 to equal to the power transfer for the thigh.


```


##Pandoc Tables

### Support Moment

#### Braking Phase

```{r % Contribution, echo=FALSE}



pandoc.table( t = cbind( EnergyFlow_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2vs2.3Hz$Participant_ID, EnergyFlow_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2vs2.3Hz$HoppingRate_ID, EnergyFlow_BetweenLimbDiff_ParticipantMeans_ATxAnkle_2vs2.3Hz$Mean_JointContribution_PeakSupportMoment_BrakingPhase ), 'Ankle Contribution to Peak Braking Phase Support Moment', col.names = c( 'Participant ID', 'Hopping Rate', '% Peak Support Moment'), style='multiline',split.tables=200,emphasize.rownames=T )


```




## STATS

### Normality Testing

#### ATx - Involved Limb

```{r 2.0 Hz}

## Whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.0Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Limb_Absorption_MEE )
# Normally distributed!

## Whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.0Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>%
   shapiro_test( Mean_Limb_Generation_MEE )
   # Normally distributed!



## Ankle contribution to whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.0Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Ankle contribution to whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.0Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!



```

```{r 2.3 Hz}

## Whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Limb_Absorption_MEE )
# Normally distributed!

## Whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>%
   shapiro_test( Mean_Limb_Generation_MEE )
# Normally distributed!



## Ankle contribution to whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Ankle contribution to whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!






## Knee contribution to whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID == 'Knee' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Knee contribution to whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID == 'Knee' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!








## Hip contribution to whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID == 'Hip' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Hip contribution to whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolved_2.3Hz %>% 
   filter( Joint_ID == 'Hip' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!

```

#### Control Group

```{r 2.0 Hz}

## Whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_Control_2.0Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Limb_Absorption_MEE )
# Normally distributed!

## Whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_Control_2.0Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>%
   shapiro_test( Mean_Limb_Generation_MEE )
# NOT Normally distributed! - Need Wilcoxon rank sum test for whole-limb generation MEE



## Ankle contribution to whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_Control_2.0Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Ankle contribution to whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_Control_2.0Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!



```

```{r 2.3 Hz}

## Whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Limb_Absorption_MEE )
# Normally distributed!

## Whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>%
   shapiro_test( Mean_Limb_Generation_MEE )
# NOT Normally distributed! - Need Wilcoxon rank sum test for whole-limb generation MEE





## Ankle contribution to whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Ankle contribution to whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID == 'Ankle' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!






## Knee contribution to whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID == 'Knee' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Knee contribution to whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID == 'Knee' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!







## Hip contribution to whole-limb MEE, Braking Phase
EnergyFlow_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID == 'Hip' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Absorption )
# Normally distributed!



## Hip contribution to whole-limb MEE, Propulsion Phase
EnergyFlow_ParticipantMeans_Control_2.3Hz %>% 
   filter( Joint_ID == 'Hip' ) %>% 
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
# Normally distributed!


```

###ANOVAs

```{r % MEE Absorption vs Group}



bxp <- ggboxplot(EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz, x = "Group_by_Morphology_NotOrdered", y = 'Mean_Joint_Percent_MEE_Absorption', add = "point")
bxp


EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz %>%
  group_by(Group_by_Morphology_NotOrdered) %>%
  identify_outliers(Mean_Joint_Percent_MEE_Absorption)


EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz %>%
  group_by(Group_by_Morphology_NotOrdered) %>%
  shapiro_test(Mean_Joint_Percent_MEE_Absorption)
#All are normally distributed



#Are variances equal?
DancerKinematics %>% levene_test(GContactDuration_sec~factor( Series_ID) )


#wid = participant ID, within = repeated measures variable
ANOVA_PercentMEEAbsorptionvsGroup <- EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz %>% anova_test(Mean_Joint_Percent_MEE_Absorption~Group_by_Morphology_NotOrdered, wid=Participant_ID,within=Group_by_Morphology_NotOrdered, effect.size='pes' )


get_anova_table(mANOVA)





#wid = participant ID, within = repeated measures variable
mANOVA <- EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz %>% anova_test(PercentPositivePower_JointContribution_EntireContactPhase~Group_by_Morphology_NotOrdered, wid=Participant_ID,within=Group_by_Morphology_NotOrdered, effect.size='pes' )


get_anova_table(mANOVA)



PercentNegativeEnergyFlow_Ankle_2.3Hz_ATx <- data.frame( x = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz$Mean_Joint_Percent_MEE_Absorption[ which( EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz$Group_by_Morphology_NotOrdered=='Involved' ) ] )


PercentNegativeEnergyFlow_Ankle_2.3Hz_ATx$Non_Involved <- EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz$Mean_Joint_Percent_MEE_Absorption[ which( EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz$Group_by_Morphology_NotOrdered=='Non-Involved' ) ]

colnames( PercentNegativeEnergyFlow_Ankle_2.3Hz_ATx ) <- c( 'Involved', ' Non-Involved' )

cor( PercentNegativeEnergyFlow_Ankle_2.3Hz_ATx, method='pearson' )




PercentPositiveEnergyFlow_Ankle_2.3Hz_ATx <- data.frame( x = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz$PercentPositivePower_JointContribution_EntireContactPhase[ which( EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz$Group_by_Morphology_NotOrdered=='Involved' ) ] )


PercentPositiveEnergyFlow_Ankle_2.3Hz_ATx$Non_Involved <- EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz$PercentPositivePower_JointContribution_EntireContactPhase[ which( EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz$Group_by_Morphology_NotOrdered=='Non-Involved' ) ]

colnames( PercentPositiveEnergyFlow_Ankle_2.3Hz_ATx ) <- c( 'Involved', ' Non-Involved' )

cor( PercentPositiveEnergyFlow_Ankle_2.3Hz_ATx, method='pearson' )

```



### T-Test

#### 2.33 Hz
```{r Pelvis Braking Work Rate}

#Test normality
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Pelvis', Segment_ID_ProxvsDist == 'Proximal') %>%
  group_by( Group_ID ) %>%
  shapiro_test(Mean_SegmentAverageEnergy_Braking )
#ATx group is not normally distributed!


#Identify outliers in Mean_JointContribution_AveragePower_GenerationNeutralized
   #ATx Group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers( Mean_JointContribution_AveragePower_GenerationNeutralized )
#No outliers

   #Control Group
Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz %>%
  identify_outliers( Mean_JointContribution_AveragePower_GenerationNeutralized )
#No outliers


#Test equality of variances for Mean_JointContribution_AveragePower_GenerationNeutralized
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Pelvis', Segment_ID_ProxvsDist == 'Proximal') %>%
  levene_test(Mean_SegmentAverageEnergy_Braking ~ Group_ID)
#Variances are equal!

## Ankle contribution to whole-limb power absorption - Braking Phase
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Pelvis', Segment_ID_ProxvsDist == 'Proximal') %>%
   wilcox_test( Mean_SegmentAverageEnergy_Braking ~ Group_ID, conf.level = 0.95, detailed = T )

```


```{r Thigh Braking Work Rate}

#Test normality
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal') %>%
  group_by( Group_ID ) %>%
  shapiro_test(Mean_SegmentAverageEnergy_Braking )
#ATx group is not normally distributed!


#Identify outliers in Mean_JointContribution_AveragePower_GenerationNeutralized
   #ATx Group
Power_ParticipantMeans_ATxInvolvedAnkle_2.3Hz %>%
  identify_outliers( Mean_JointContribution_AveragePower_GenerationNeutralized )
#No outliers

   #Control Group
Power_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz %>%
  identify_outliers( Mean_JointContribution_AveragePower_GenerationNeutralized )
#No outliers


#Test equality of variances for Mean_JointContribution_AveragePower_GenerationNeutralized
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal') %>%
  levene_test(Mean_SegmentAverageEnergy_Braking ~ Group_ID)
#Variances are equal!

## Ankle contribution to whole-limb power absorption - Braking Phase
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Thigh', Segment_ID_ProxvsDist == 'Proximal') %>%
   wilcox_test( Mean_SegmentAverageEnergy_Braking ~ Group_ID, conf.level = 0.95, detailed = T )

```



```{r Shank Braking Work Rate}

#Test normality
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Proximal') %>%
  group_by( Group_ID ) %>%
  shapiro_test(Mean_SegmentAverageEnergy_Braking )
#Normally distributed!



#Identify outliers in Mean_JointContribution_AveragePower_GenerationNeutralized
   #ATx Group
EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.3Hz %>%
   filter(Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Proximal') %>%
  identify_outliers( Mean_SegmentAverageEnergy_Braking )
#No outliers

   #Control Group
EnergyFlow_ParticipantMeans_MatchedDominanceLimb_2.3Hz %>%
   filter(Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Proximal') %>%
  identify_outliers( Mean_SegmentAverageEnergy_Braking )
#No outliers


#Test equality of variances for Mean_JointContribution_AveragePower_GenerationNeutralized
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Proximal') %>%
  levene_test(Mean_SegmentAverageEnergy_Braking ~ Group_ID)
#Variances are equal!

## Ankle contribution to whole-limb power absorption - Braking Phase
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Shank', Segment_ID_ProxvsDist == 'Proximal') %>%
   t_test( Mean_SegmentAverageEnergy_Braking ~ Group_ID, conf.level = 0.95, detailed = T )

```



```{r Foot Braking Work Rate}

#Test normality
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Foot', Segment_ID_ProxvsDist == 'Distal') %>%
  group_by( Group_ID ) %>%
  shapiro_test(Mean_SegmentAverageEnergy_Braking )
#Both groups are normally distributed!


#Identify outliers in Mean_JointContribution_AveragePower_GenerationNeutralized
   #ATx Group
EnergyFlow_ParticipantMeans_ATxInvolvedLimb_2.3Hz %>%
   filter(Segment_ID_Name == 'Foot', Segment_ID_ProxvsDist == 'Distal') %>%
  identify_outliers( Mean_SegmentAverageEnergy_Braking )
#No outliers

   #Control Group
EnergyFlow_ParticipantMeans_MatchedDominanceLimb_2.3Hz %>%
   filter(Segment_ID_Name == 'Foot', Segment_ID_ProxvsDist == 'Distal') %>%
  identify_outliers( Mean_SegmentAverageEnergy_Braking )
#No outliers


#Test equality of variances for Mean_JointContribution_AveragePower_GenerationNeutralized
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Foot', Segment_ID_ProxvsDist == 'Distal') %>%
  levene_test(Mean_SegmentAverageEnergy_Braking ~ Group_ID)
#Variances are equal!

## Ankle contribution to whole-limb power absorption - Braking Phase
EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz %>%
   filter(Segment_ID_Name == 'Foot', Segment_ID_ProxvsDist == 'Distal') %>%
   t_test( Mean_SegmentAverageEnergy_Braking ~ Group_ID, conf.level = 0.95, detailed = T )

```




```{r 2.3 Hz}


## Whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   t_test( Mean_Limb_Absorption_MEE ~ Group_ID, conf.level = 0.95, detailed = T )





## Ankle contribution to whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   t_test( Mean_Joint_Percent_MEE_Absorption ~ Group_ID, conf.level = 0.95, detailed = T )


## Ankle contribution to whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   t_test( Mean_Joint_Percent_MEE_Generation ~ Group_ID, conf.level = 0.95, detailed = T )








## Knee contribution to whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlKnee_2.3Hz %>%
   t_test( Mean_Joint_Percent_MEE_Absorption ~ Group_ID, conf.level = 0.95, detailed = T )





## Hip contribution to whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlHip_2.3Hz %>%
   t_test( Mean_Joint_Percent_MEE_Generation ~ Group_ID, conf.level = 0.95, detailed = T )

```

```{r 2.0 Hz vs 2.3 Hz}

## Whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolvedAnkle %>%
   t_test( Mean_Limb_Absorption_MEE ~ HoppingRate_ID, conf.level = 0.95, detailed = T )


## Whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolvedAnkle %>%
   t_test( Mean_Limb_Generation_MEE ~ HoppingRate_ID, conf.level = 0.95, detailed = T )







## Ankle contribution to whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolvedAnkle %>%
   t_test( Mean_Joint_Percent_MEE_Absorption ~ HoppingRate_ID, conf.level = 0.95, detailed = T )


## Ankle contribution to whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolvedAnkle %>%
   t_test( Mean_Joint_Percent_MEE_Generation ~ HoppingRate_ID, conf.level = 0.95, detailed = T )




```

### Wilcoxon Rank Sum Test

```{r 2.3 Hz}

## Whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   wilcox_test( Mean_Limb_Generation_MEE ~ Group_ID, conf.level = 0.95, detailed = T )


## Knee contribution to whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlKnee_2.3Hz %>%
   wilcox_test( Mean_Joint_Percent_MEE_Generation ~ Group_ID, conf.level = 0.95, detailed = T )


## Hip contribution to whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlHip_2.3Hz %>% 
   wilcox_test( Mean_Joint_Percent_MEE_Absorption ~ Group_ID, conf.level = 0.95, detailed = T )




```

### Hedges G

```{r 2.3 Hz}

## Whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   cohens_d( Mean_Limb_Absorption_MEE ~ Group_ID, conf.level = 0.95, ci = T )


## Ankle contribution to whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   cohens_d( Mean_Joint_Percent_MEE_Absorption ~ Group_ID, conf.level = 0.95, ci = T )


## Ankle contribution to whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   cohens_d( Mean_Joint_Percent_MEE_Generation ~ Group_ID, conf.level = 0.95, ci = T )




## Knee contribution to whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlKnee_2.3Hz %>%
   cohens_d( Mean_Joint_Percent_MEE_Absorption ~ Group_ID, conf.level = 0.95, ci = T )


## Hip contribution to whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlHip_2.3Hz %>%
   cohens_d( Mean_Joint_Percent_MEE_Generation ~ Group_ID, conf.level = 0.95, ci = T )




```

```{r 2.0 Hz vs 2.3 Hz}

## Whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolvedAnkle %>%
   cohens_d( Mean_Limb_Absorption_MEE ~ HoppingRate_ID, conf.level = 0.95, ci = T )


## Whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolvedAnkle %>%
   cohens_d( Mean_Limb_Generation_MEE ~ HoppingRate_ID, conf.level = 0.95, ci = T )




## Ankle contribution to whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolvedAnkle %>%
   cohens_d( Mean_Joint_Percent_MEE_Absorption ~ HoppingRate_ID, conf.level = 0.95, ci = T )


## Ankle contribution to whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolvedAnkle %>%
   cohens_d( Mean_Joint_Percent_MEE_Generation ~ HoppingRate_ID, conf.level = 0.95, ci = T )




## Knee contribution to whole-limb MEE - Braking Phase
EnergyFlow_ParticipantMeans_ATxInvolvedKnee %>%
   cohens_d( Mean_Joint_Percent_MEE_Absorption ~ HoppingRate_ID, conf.level = 0.95, ci = T )


## Hip contribution to whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_ATxInvolvedHip %>%
   cohens_d( Mean_Joint_Percent_MEE_Generation ~ HoppingRate_ID, conf.level = 0.95, ci = T )


```

### Wilcoxon Effect Size

```{r 2.3 Hz}

## Whole-limb MEE - Propulsion Phase
EnergyFlow_ParticipantMeans_InvolvedVsControlAnkle_2.3Hz %>%
   wilcox_effsize( Mean_Limb_Generation_MEE ~ Group_ID, ci = T, comparisons = list( c( 'ATx', 'Control' ) ) )


```


#Linear Regression

### % Ankle Power Absorption

#### vs Morphology Group
```{r Braking}



LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup <- rlm( formula = (Mean_JointContribution_AveragePower_AbsorptionNeutralized/100)~Mean_SegmentAverageEnergy_Braking*Group_ID, data = AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups )

summary(LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup)

confint(LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup,method='boot') # significant



```



```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup <- hatvalues( LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup <- mean( Leverage_LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup > 2*AverageLeverage_LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup )
#No data points with high leverage based on hat values alone


#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup <- cooks.distance( LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup > 3*mean(CookD_LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup,na.rm=T) )

#Data Point 6 has high leverage

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup, aes(x=LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup )

residualPlots(LM_Joint_Percent_Power_AbsorptionvsThighWorkRateAndGroup,type='rstudent')


```



### % Ankle MEE Absorption

#### vs Morphology Group
```{r Braking}



LM_Joint_Percent_MEE_AbsorptionvsGroup <- lm(formula=sqrt(Mean_Joint_Percent_MEE_Absorption)~Group_by_Morphology_NotOrdered,data=EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz)
summary(LM_Joint_Percent_MEE_AbsorptionvsGroup)
confint(LM_Joint_Percent_MEE_AbsorptionvsGroup,method='boot') # significant


LM_Joint_Percent_MEE_AbsorptionvsGroup$xlevels

```



```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Percent_MEE_AbsorptionvsGroup <- hatvalues( LM_Joint_Percent_MEE_AbsorptionvsGroup ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Percent_MEE_AbsorptionvsGroup <- mean( Leverage_LM_Joint_Percent_MEE_AbsorptionvsGroup ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Percent_MEE_AbsorptionvsGroup > 2*AverageLeverage_LM_Joint_Percent_MEE_AbsorptionvsGroup )
#No data points with high leverage based on hat values alone


#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Percent_MEE_AbsorptionvsGroup <- cooks.distance( LM_Joint_Percent_MEE_AbsorptionvsGroup ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_MEE_AbsorptionvsGroup > 3*mean(CookD_LM_Joint_Percent_MEE_AbsorptionvsGroup,na.rm=T) )

#Data Point 6 has high leverage

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Joint_Percent_MEE_AbsorptionvsGroup ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_Joint_Percent_MEE_AbsorptionvsGroup, aes(x=LM_Joint_Percent_MEE_AbsorptionvsGroup$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Joint_Percent_MEE_AbsorptionvsGroup, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Percent_MEE_AbsorptionvsGroup )

residualPlots(LM_Joint_Percent_MEE_AbsorptionvsGroup,type='rstudent')


```

### ATx Only

#### Thigh Distal Transfer

##### vs Morphology
```{r Braking}



LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology <- lm( formula = EnergyFlow_ParticipantMeans_DistalShankOnly_ATxInvolvedLimb_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking~EnergyFlow_ParticipantMeans_DistalFootOnly_ATxInvolvedLimb_2.3Hz$Mean_BetweenLimbTendonThickness_mm)
summary(LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology)
confint(LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology,method='boot') # only intercept is significant


EnergyFlow_ParticipantMeans_DistalShankOnly_ATxInvolvedLimb_2.3Hz_NoATx18 <- EnergyFlow_ParticipantMeans_DistalShankOnly_ATxInvolvedLimb_2.3Hz %>%
   filter( Participant_ID != 'ATx18' )
EnergyFlow_ParticipantMeans_DistalFootOnly_ATxInvolvedLimb_2.3Hz_NoATx18 <- EnergyFlow_ParticipantMeans_DistalFootOnly_ATxInvolvedLimb_2.3Hz %>%
   filter( Participant_ID != 'ATx18' )

#Recalculate without ATx18
LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology <- lm( formula = EnergyFlow_ParticipantMeans_DistalShankOnly_ATxInvolvedLimb_2.3Hz_NoATx18$Mean_JointAverageTotalPowerTransfer_Braking~EnergyFlow_ParticipantMeans_DistalFootOnly_ATxInvolvedLimb_2.3Hz_NoATx18$Mean_BetweenLimbTendonThickness_mm)
summary(LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology)
confint(LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology <- lm( formula = Mean_Mean_JointAverageTotalPowerTransfer_Braking~Mean_BetweenLimbTendonThickness_mm,
                                                      data=EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18)
summary(LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology)
confint(LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology <- lm( formula = Mean_Mean_JointAverageTotalPowerTransfer_Braking~Mean_BetweenLimbTendonThickness_mm,
                                                      data=EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18)
summary(LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology)
confint(LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology <- hatvalues( LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology <- mean( Leverage_LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology > 2*AverageLeverage_LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18




#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology <- cooks.distance( LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology > 3*mean(CookD_LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology > 4/length( LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology, aes(x=LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology )

residualPlots(LM_Mean_JointAverageTotalPowerTransfer_BrakingvsATxMorphology,type='rstudent')


```




#### vs Laterality
```{r Braking}



LM_Joint_Percent_MEE_AbsorptionvsLaterality <- lm( formula = log(Mean_Joint_Percent_MEE_Absorption,base=10)~Group_by_Tendinopathy_Type,
                                                      data=EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz)
summary(LM_Joint_Percent_MEE_AbsorptionvsLaterality)
confint(LM_Joint_Percent_MEE_AbsorptionvsLaterality,method='boot') # only intercept is significant


#Recalculate without ATx18
LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data=EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data=EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
LM_Joint_Percent_MEE_AbsorptionvsATxMorphology <- lm( formula = Mean_Joint_Percent_MEE_Absorption~Mean_BetweenLimbTendonThickness_mm,
                                                      data=EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18)
summary(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology)
confint(LM_Joint_Percent_MEE_AbsorptionvsATxMorphology,method='boot') # only intercept i significant

```


```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_Joint_Percent_MEE_AbsorptionvsLaterality <- hatvalues( LM_Joint_Percent_MEE_AbsorptionvsLaterality ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_Joint_Percent_MEE_AbsorptionvsLaterality <- mean( Leverage_LM_Joint_Percent_MEE_AbsorptionvsLaterality ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_Joint_Percent_MEE_AbsorptionvsLaterality > 2*AverageLeverage_LM_Joint_Percent_MEE_AbsorptionvsLaterality )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_Joint_Percent_MEE_AbsorptionvsLaterality <- cooks.distance( LM_Joint_Percent_MEE_AbsorptionvsLaterality ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_MEE_AbsorptionvsLaterality > 3*mean(CookD_LM_Joint_Percent_MEE_AbsorptionvsLaterality,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_Joint_Percent_MEE_AbsorptionvsLaterality > 4/length( LM_Joint_Percent_MEE_AbsorptionvsLaterality$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_Joint_Percent_MEE_AbsorptionvsLaterality ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_Joint_Percent_MEE_AbsorptionvsLaterality, aes(x=LM_Joint_Percent_MEE_AbsorptionvsLaterality$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_Joint_Percent_MEE_AbsorptionvsLaterality, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_Joint_Percent_MEE_AbsorptionvsLaterality )

residualPlots(LM_Joint_Percent_MEE_AbsorptionvsLaterality,type='rstudent')


```


#Mixed Effects Models

## % Ankle MEE Absorption vs Group
```{r Braking}

LM_Joint_Percent_MEE_AbsorptionvsGroup <- lm(formula=Joint_Percent_MEE_Absorption~Group_by_Morphology,data=EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz)
summary(LM_Joint_Percent_MEE_AbsorptionvsGroup)
confint(LM_Joint_Percent_MEE_AbsorptionvsGroup,method='boot') # significant


MME_Joint_Percent_MEE_AbsorptionvsGroup_forICC <- lme(fixed=Joint_Percent_MEE_Absorption~1,data=EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz,random=~1|Participant_ID)


summary(MME_Joint_Percent_MEE_AbsorptionvsGroup_forICC)
(Joint_Percent_MEE_AbsorptionvsGroup_VarExplained = (8.630181^2) /( (8.630181^2) + (3.823851^2) ) )
#ICC = 0.84 - significant clustering

MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly <- lme(fixed=Joint_Percent_MEE_Absorption~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_by_Morphology,data=EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz,random= ~1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomSlopeOnly <- lme(fixed=Joint_Percent_MEE_Absorption~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_by_Morphology,data=EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz,random= ~TSContributiontoPFActivity_PropulsionPhase_Centered-1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffects <- lme(fixed=Joint_Percent_MEE_Absorption~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_by_Morphology,data=EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz,random= ~TSContributiontoPFActivity_PropulsionPhase_Centered|Participant_ID,method='REML')


summary(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly)#significant
intervals(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly)
summary(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomSlopeOnly)#significant
intervals(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomSlopeOnly)
summary(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffects)
intervals(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffects)#significant, but positive-definite covariance may not be necessary


MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffectsDiagonalCovar <- lme(fixed=Joint_Percent_MEE_Absorption~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_by_Morphology,data=EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz,random= list(Participant_ID=pdDiag(~TSContributiontoPFActivity_PropulsionPhase_Centered)),method='REML')
summary(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffectsDiagonalCovar) #significant
intervals(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffectsDiagonalCovar)

logLik(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly)*-2
logLik(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomSlopeOnly)*-2
logLik(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffects)*-2
logLik(MME_Joint_Percent_MEE_AbsorptionvsGroup_BothEffectsDiagonalCovar)*-2


### No diff between Both Effects and Both Effects with Diagonal Covar Matrix - Diagonal Matrix for effect of time on Gastroc Hz is best model. Intercept is 64.9 (62.1, 67.7); p=0, slope is -0.3 (-0.5, -0.2); p=0.  


anova(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly,LM_Joint_Percent_MEE_AbsorptionvsGroup)
##MME improves up on LM



plot(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly,Joint_Percent_MEE_Absorption~TSContributiontoPFActivity_PropulsionPhase_Centered,abline=c(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly$coefficients$fixed[1],MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly$coefficients$fixed[2]) )


plot( MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_AbsorptionvsGroup_RandomInterceptOnly,abline=c(0,1))

```


# Robust Mixed Effects Models

### Ankle Absorption Work Rate vs...

#### Thigh Absorption Work Rate
```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleWorkRatevsThighAbsorptionWorkRate_2.3Hz_1LimbPer3Groups <- rlmer( AnkleWorkRate_GenerationNeutralized~ThighAverageEnergy_Braking*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups )

#Check results structure using summary
summary( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_2.3Hz_1LimbPer3Groups )
#Group_ID 0 = ATx, 1 = Control

##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_forICC <- rlmer(AnkleWorkRate_GenerationNeutralized~1|Participant_ID,data=AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find variance for random intercept and residuals 
summary(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleWorkRatevsThighAbsorptionWorkRate_Braking_VarExplained = (1.0841) /( (1.0841) + (0.1201) ) )
#ICC = 0.90 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomInterceptOnly <- rlmer( AnkleWorkRate_GenerationNeutralized~ThighAverageEnergy_Braking*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find the standard errors for the model
summary(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomInterceptOnly)

#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RIOnly <- (1 - ( ( sum(residuals(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomInterceptOnly,type='response' )^2) / sum(getME(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomInterceptOnly,'y')^2))*( (dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.77

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.23517^2 + 0.03619^2 + 0.38048^2 + 0.06060^2 )/(0.9221 + 0.23517^2 + 0.03619^2 + 0.38048^2 + 0.06060^2 + 0.1109)
#R2 = 0.17
#Now add varionce from random effects o numerator
(0.9221 + 0.23517^2 + 0.03619^2 + 0.38048^2 + 0.06060^2 )/(0.9221 + 0.23517^2 + 0.03619^2 + 0.38048^2 + 0.06060^2 + 0.1109)
#R2 = 0.91

#Calculate Mean Squared Error for RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomInterceptOnly
( MSE_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomInterceptOnly,type='response' )^2 ) )
#MSE = 0.13



##Create mixed effects model for random slope only.
RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomSlopeOnly <- rlmer( AnkleWorkRate_GenerationNeutralized~ThighAverageEnergy_Braking*Group_ID+(ThighAverageEnergy_Braking-1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find the standard errors for the model
summary( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomSlopeOnly )


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RSOnly <- (1 - ( ( sum(residuals(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomSlopeOnly,type='response' )^2) / sum(getME(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomSlopeOnly,'y')^2) )*((dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.62

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random slope variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.04022^2 + 0.23459^2 + 0.06531^2 + 0.37766^2 )/(0.8626 + 0.04022^2 + 0.23459^2 + 0.06531^2 + 0.37766^2 + 0.3409)
#R2 = 0.14
#Now add varionce from random effects o numerator
(0.8626 + 0.04022^2 + 0.23459^2 + 0.06531^2 + 0.37766^2 )/(0.8626 + 0.04022^2 + 0.23459^2 + 0.06531^2 + 0.37766^2 + 0.3409)
#R2 = 0.76


#Calculate Mean Squared Error for RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomSlopeOnly
( MSE_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_RandomSlopeOnly,type='response' )^2 ) )
#MSE = 0.4



print( Sys.time() )

#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects <- rlmer( AnkleWorkRate_GenerationNeutralized~ThighAverageEnergy_Braking*Group_ID+(ThighAverageEnergy_Braking|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

print( Sys.time() )
   

#Use summary to find the standard errors for the model
summary( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )
   
#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects <- (1 - ( ( sum(residuals(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects,type='response' )^2) / sum(getME(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects,'y')^2) )*((dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.8

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + Random slope variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.24758^2 + 0.06587^2 + 0.40087^2 + 0.10772^2 )/(1.04519 + 0.04731 + 0.24758^2 + 0.40087^2 + 0.06587^2 + 0.10772^2 + 0.10338)
#R2 = 0.17
#Now add varionce from random effects o numerator
(1.04519 + 0.04731 + 0.24758^2 + 0.40087^2 + 0.06587^2 + 0.10772^2 )/(1.04519 + 0.04731 + 0.24758^2 + 0.40087^2 + 0.06587^2 + 0.10772^2 + 0.10338)
#R2 = 0.93
#Adding both random effects significantly increased R2


#Calculate Mean Squared Error for RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects
( MSE_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects <- mean( residuals(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects,type='response' )^2 ) )
#MSE = 0.12
#Model with both random effects has lowest MSE


##Both effects is best model.
summary( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )

```



```{r Check Model Assumptions}

plot( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects, Participant_ID~resid(.,type='p'))

plot( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects,abline=c(0,1))

```

#### Thigh Distal Transfer Work Rate
```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleWorkRatevsAverageThighTransferPower_2.3Hz_1LimbPer3Groups <- rlmer( AnkleWorkRate_GenerationNeutralized~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups )

#Check results structure using summary
summary( RMME_AnkleWorkRatevsAverageThighTransferPower_2.3Hz_1LimbPer3Groups )
#Group_ID 0 = ATx, 1 = Control

##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_forICC <- rlmer(AnkleWorkRate_GenerationNeutralized~1|Participant_ID,data=AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find variance for random intercept and residuals 
summary(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleWorkRatevsAverageThighTransferPower_Braking_VarExplained = (1.0841) /( (1.0841) + (0.1201) ) )
#ICC = 0.90 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomInterceptOnly <- rlmer( AnkleWorkRate_GenerationNeutralized~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find variance of fixed and random effects
summary( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomInterceptOnly )

#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleWorkRatevsAverageThighTransferPower_Braking_RIOnly <- (1 - ( ( sum(residuals(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomInterceptOnly,type='response' )^2) / sum(getME(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomInterceptOnly,'y')^2))*( (dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.77

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.13054^2 + 0.01435^2 + 0.21492^2 + 0.02410^2 )/(0.22032 + 0.13054^2 + 0.01435^2 + 0.21492^2 + 0.02410^2 + 0.03617)
#R2 = 0.2
#Now add varionce from random effects o numerator
(0.22032 + 0.13054^2 + 0.01435^2 + 0.21492^2 + 0.02410^2 )/(0.22032 + 0.13054^2 + 0.01435^2 + 0.21492^2 + 0.02410^2 + 0.03617)
#R2 = 0.89

#Calculate Mean Squared Error for RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomInterceptOnly
( MSE_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomInterceptOnly,type='response' )^2 ) )
#MSE = 0.04



##Create mixed effects model for random slope only.
RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomSlopeOnly <- rlmer( AnkleWorkRate_GenerationNeutralized~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer-1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleWorkRatevsAverageThighTransferPower_Braking_RSOnly <- (1 - ( ( sum(residuals(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomSlopeOnly,type='response' )^2) / sum(getME(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomSlopeOnly,'y')^2) )*((dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.62

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random slope variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.06240^2 + 0.03025^2 + 0.10368^2 + 0.04923^2 )/(0.01176 + 0.06240^2 + 0.03025^2 + 0.10368^2 + 0.04923^2 + 0.03833)
#R2 = 0.26
#Now add varionce from random effects o numerator
(0.01176 + 0.06240^2 + 0.03025^2 + 0.10368^2 + 0.04923^2 )/(0.01176 + 0.06240^2 + 0.03025^2 + 0.10368^2 + 0.04923^2 + 0.03833)
#R2 = 0.44


#Calculate Mean Squared Error for RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomSlopeOnly
( MSE_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomSlopeOnly,type='response' )^2 ) )
#MSE = 0.042



print( Sys.time() )

#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects <- rlmer( AnkleWorkRate_GenerationNeutralized~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

print( Sys.time() )
   
   
#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects <- (1 - ( ( sum(residuals(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects,type='response' )^2) / sum(getME(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects,'y')^2) )*((dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.8

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + Random slope variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.14315^2 + 0.02740^2 + 0.24168^2 + 0.04615^2 )/(0.28048 + 0.00913 + 0.14315^2 + 0.02740^2 + 0.24168^2 + 0.04615^2 + 0.03360)
#R2 = 0.20
#Now add varionce from random effects o numerator
(0.28048 + 0.00913 + 0.14315^2 + 0.02740^2 + 0.24168^2 + 0.04615^2 )/(0.28048 + 0.00913 + 0.14315^2 + 0.02740^2 + 0.24168^2 + 0.04615^2 + 0.03360)
#R2 = 0.92
#Adding both random effects significantly increased R2


#Calculate Mean Squared Error for RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects
( MSE_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects <- mean( residuals(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects,type='response' )^2 ) )
#MSE = 0.037
#Model with both random effects has lowest MSE


##Both effects is best model.
summary( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )

```



```{r Check Model Assumptions}

plot( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects, Participant_ID~resid(.,type='p'))

plot( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects,abline=c(0,1))

```




### Foot Proximal Transfer vs...



#### Group
```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_FootProxTransferAverageThighTransferPower_2.3Hz_1LimbPer3Groups <- rlmer( FootProxTransfer_Propulsion~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups )

#Check results structure using summary
summary( RMME_FootProxTransferAverageThighTransferPower_2.3Hz_1LimbPer3Groups )
#Group_ID 0 = ATx, 1 = Control

##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_FootProxTransferAverageThighTransferPower_Braking_forICC <- rlmer(FootProxTransfer_Propulsion~1|Participant_ID,data=AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find variance for random intercept and residuals 
summary(RMME_FootProxTransferAverageThighTransferPower_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleWorkRatevsAverageThighTransferPower_Braking_VarExplained = (0.12784) /( (0.12784) + (0.02876) ) )
#ICC = 0.82- significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_FootProxTransferAverageThighTransferPower_Braking_RandomInterceptOnly <- rlmer( FootProxTransfer_Propulsion~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find variance of fixed and random effects
summary( RMME_FootProxTransferAverageThighTransferPower_Braking_RandomInterceptOnly )

#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleWorkRatevsAverageThighTransferPower_Braking_RIOnly <- (1 - ( ( sum(residuals(RMME_FootProxTransferAverageThighTransferPower_Braking_RandomInterceptOnly,type='response' )^2) / sum(getME(RMME_FootProxTransferAverageThighTransferPower_Braking_RandomInterceptOnly,'y')^2))*( (dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.77

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.08092^2 + 0.01051^2 + 0.13385^2 + 0.01762^2 )/(0.07379 + 0.08092^2 + 0.01051^2 + 0.13385^2 + 0.01762^2 + 0.01967)
#R2 = 0.21
#Now add varionce from random effects o numerator
(0.07379 + 0.08092^2 + 0.01051^2 + 0.13385^2 + 0.01762^2 )/(0.07379 + 0.08092^2 + 0.01051^2 + 0.13385^2 + 0.01762^2 + 0.01967)
#R2 = 0.83

#Calculate Mean Squared Error for RMME_FootProxTransferAverageThighTransferPower_Braking_RandomInterceptOnly
( MSE_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomInterceptOnly <- mean( residuals(RMME_FootProxTransferAverageThighTransferPower_Braking_RandomInterceptOnly,type='response' )^2 ) )
#MSE = 0.022



##Create mixed effects model for random slope only.
RMME_FootProxTransferAverageThighTransferPower_Braking_RandomSlopeOnly <- rlmer( FootProxTransfer_Propulsion~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer-1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find variance of fixed and random effects
summary( RMME_FootProxTransferAverageThighTransferPower_Braking_RandomSlopeOnly )


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleWorkRatevsAverageThighTransferPower_Braking_RSOnly <- (1 - ( ( sum(residuals(RMME_FootProxTransferAverageThighTransferPower_Braking_RandomSlopeOnly,type='response' )^2) / sum(getME(RMME_FootProxTransferAverageThighTransferPower_Braking_RandomSlopeOnly,'y')^2) )*((dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.62

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random slope variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.04406^2 + 0.01806^2 + 0.07325^2 + 0.02943^2 )/(0.003645 + 0.04406^2 + 0.01806^2 + 0.07325^2 + 0.02943^2 + 0.019548)
#R2 = 0.27
#Now add varionce from random effects o numerator
(0.003645 + 0.04406^2 + 0.01806^2 + 0.07325^2 + 0.02943^2 )/(0.003645 + 0.04406^2 + 0.01806^2 + 0.07325^2 + 0.02943^2 + 0.019548)
#R2 = 0.38


#Calculate Mean Squared Error for RMME_FootProxTransferAverageThighTransferPower_Braking_RandomSlopeOnly
( MSE_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomSlopeOnly <- mean( residuals(RMME_FootProxTransferAverageThighTransferPower_Braking_RandomSlopeOnly,type='response' )^2 ) )
#MSE = 0.022



print( Sys.time() )

#Create robust mixed effects model with both random slope and random intercept
RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects <- rlmer( FootProxTransfer_Propulsion~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

print( Sys.time() )

#Use summary to find variance of fixed and random effects
summary( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )
   
   
#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects <- (1 - ( ( sum(residuals(RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects,type='response' )^2) / sum(getME(RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects,'y')^2) )*((dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.8

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + Random slope variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.08924^2 + 0.02021^2 + 0.15130^2 + 0.03383^2 )/(0.097875 + 0.005001 + 0.08924^2 + 0.02021^2 + 0.15130^2 + 0.03383^2 + 0.018375)
#R2 = 0.21
#Now add varionce from random effects o numerator
(0.097875 + 0.005001 + 0.08924^2 + 0.02021^2 + 0.15130^2 + 0.03383^2 )/(0.097875 + 0.005001 + 0.08924^2 + 0.02021^2 + 0.15130^2 + 0.03383^2 + 0.018375)
#R2 = 0.88
#Adding both random effects significantly increased R2


#Calculate Mean Squared Error for RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects
( MSE_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects <- mean( residuals(RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects,type='response' )^2 ) )
#MSE = 0.02
#Model with both random effects has lowest MSE


##Both effects is best model.
summary( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )

```



```{r Check Model Assumptions}

plot( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects, Participant_ID~resid(.,type='p'))

plot( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects,abline=c(0,1))

```



### Shank Net Work Rate (Braking) vs...

#### Ankle Absorption Work Rate
```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_ShankNetWorkvsAnkleAbsorptionWork_2.3Hz_1LimbPer3Groups <- rlmer( ShankAverageEnergy_Braking~AnkleWorkRate_GenerationNeutralized*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups )

#Check results structure using summary
summary( RMME_ShankNetWorkvsAnkleAbsorptionWork_2.3Hz_1LimbPer3Groups )
#Group_ID 0 = ATx, 1 = Control

##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_forICC <- rlmer(ShankAverageEnergy_Braking1|Participant_ID,data=AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find variance for random intercept and residuals 
summary(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(ShankNetWorkvsAnkleAbsorptionWork_Braking_VarExplained = (1.0841) /( (1.0841) + (0.1201) ) )
#ICC = 0.90 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomInterceptOnly <- rlmer( ShankAverageEnergy_Braking~AnkleWorkRate_GenerationNeutralized*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find the standard errors for the model
summary(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomInterceptOnly)

#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_ShankNetWorkvsAnkleAbsorptionWork_Braking_RIOnly <- (1 - ( ( sum(residuals(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomInterceptOnly,type='response' )^2) / sum(getME(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomInterceptOnly,'y')^2))*( (dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.77

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.23517^2 + 0.03619^2 + 0.38048^2 + 0.06060^2 )/(0.9221 + 0.23517^2 + 0.03619^2 + 0.38048^2 + 0.06060^2 + 0.1109)
#R2 = 0.17
#Now add varionce from random effects o numerator
(0.9221 + 0.23517^2 + 0.03619^2 + 0.38048^2 + 0.06060^2 )/(0.9221 + 0.23517^2 + 0.03619^2 + 0.38048^2 + 0.06060^2 + 0.1109)
#R2 = 0.91

#Calculate Mean Squared Error for RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomInterceptOnly
( MSE_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomInterceptOnly <- mean( residuals(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomInterceptOnly,type='response' )^2 ) )
#MSE = 0.13



##Create mixed effects model for random slope only.
RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomSlopeOnly <- rlmer( ShankAverageEnergy_Braking~AnkleWorkRate_GenerationNeutralized*Group_ID+(AnkleWorkRate_GenerationNeutralized-1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find the standard errors for the model
summary( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomSlopeOnly )


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_ShankNetWorkvsAnkleAbsorptionWork_Braking_RSOnly <- (1 - ( ( sum(residuals(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomSlopeOnly,type='response' )^2) / sum(getME(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomSlopeOnly,'y')^2) )*((dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.62

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random slope variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.04022^2 + 0.23459^2 + 0.06531^2 + 0.37766^2 )/(0.8626 + 0.04022^2 + 0.23459^2 + 0.06531^2 + 0.37766^2 + 0.3409)
#R2 = 0.14
#Now add varionce from random effects o numerator
(0.8626 + 0.04022^2 + 0.23459^2 + 0.06531^2 + 0.37766^2 )/(0.8626 + 0.04022^2 + 0.23459^2 + 0.06531^2 + 0.37766^2 + 0.3409)
#R2 = 0.76


#Calculate Mean Squared Error for RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomSlopeOnly
( MSE_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomSlopeOnly <- mean( residuals(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_RandomSlopeOnly,type='response' )^2 ) )
#MSE = 0.4



print( Sys.time() )

#Create robust mixed effects model with both random slope and random intercept
RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects <- rlmer( ShankAverageEnergy_Braking~AnkleWorkRate_GenerationNeutralized*Group_ID+(AnkleWorkRate_GenerationNeutralized|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

print( Sys.time() )
   

#Use summary to find the standard errors for the model
summary( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )
   
#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects <- (1 - ( ( sum(residuals(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects,type='response' )^2) / sum(getME(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects,'y')^2) )*((dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.8

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + Random slope variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.24758^2 + 0.06587^2 + 0.40087^2 + 0.10772^2 )/(1.04519 + 0.04731 + 0.24758^2 + 0.40087^2 + 0.06587^2 + 0.10772^2 + 0.10338)
#R2 = 0.17
#Now add varionce from random effects o numerator
(1.04519 + 0.04731 + 0.24758^2 + 0.40087^2 + 0.06587^2 + 0.10772^2 )/(1.04519 + 0.04731 + 0.24758^2 + 0.40087^2 + 0.06587^2 + 0.10772^2 + 0.10338)
#R2 = 0.93
#Adding both random effects significantly increased R2


#Calculate Mean Squared Error for RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects
( MSE_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects <- mean( residuals(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects,type='response' )^2 ) )
#MSE = 0.12
#Model with both random effects has lowest MSE


##Both effects is best model.
summary( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )

```



```{r Check Model Assumptions}

plot( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects, Participant_ID~resid(.,type='p'))

plot( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects,abline=c(0,1))

```


### Shank Proximal Transfer vs...

#### Group
```{r Find Best Model Structure}



#Perform normal robust mixed effects model, to check the results structure
RMME_ShankProxTransfervsGroup_2.3Hz_1LimbPer3Groups <- rlmer( ShankProxTransfer_Propulsion~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups )

#Check results structure using summary
summary( RMME_ShankProxTransfervsGroup_2.3Hz_1LimbPer3Groups )
#Group_ID 0 = ATx, 1 = Control

##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_ShankProxTransfervsGroup_Braking_forICC <- rlmer(ShankProxTransfer_Propulsion~1|Participant_ID,data=AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find variance for random intercept and residuals 
summary(RMME_ShankProxTransfervsGroup_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleWorkRatevsAverageThighTransferPower_Braking_VarExplained = (0.9866) /( (0.9866) + (0.1678) ) )
#ICC = 0.85- significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_ShankProxTransfervsGroup_Braking_RandomInterceptOnly <- rlmer( ShankProxTransfer_Propulsion~Group_ID+(1|Participant_ID), data = AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)

#Use summary to find variance of fixed and random effects
summary( RMME_ShankProxTransfervsGroup_Braking_RandomInterceptOnly )

#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleWorkRatevsAverageThighTransferPower_Braking_RIOnly <- (1 - ( ( sum(residuals(RMME_ShankProxTransfervsGroup_Braking_RandomInterceptOnly,type='response' )^2) / sum(getME(RMME_ShankProxTransfervsGroup_Braking_RandomInterceptOnly,'y')^2))*( (dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleWorkRatevsFootShankThighWorkRate_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.77

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.24618^2 + 0.39978^2 )/(1.0317 + 0.24618^2 + 0.39978^2 + 0.1678)
#R2 = 0.16
#Now add varionce from random effects o numerator
(1.0317 + 0.24618^2 + 0.399782^2  )/(1.0317 + 0.24618^2 + 0.39978^2 + 0.1678)
#R2 = 0.88

#Calculate Mean Squared Error for RMME_ShankProxTransfervsGroup_Braking_RandomInterceptOnly
( MSE_AnkleWorkRatevsAverageThighTransferPower_Braking_RandomInterceptOnly <- mean( residuals(RMME_ShankProxTransfervsGroup_Braking_RandomInterceptOnly,type='response' )^2 ) )
#MSE = 0.18


```



```{r Check Model Assumptions}

plot( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects, Participant_ID~resid(.,type='p'))

plot( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects,abline=c(0,1))

```








### Ankle Absorption Contribution vs...

#### Foot Power
```{r Find Best Model Structure}

##Split Groups By Morphology

## Control Group
AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Control')

## ATx Group, Less than 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'LessThan_2mm_Diff')

## ATx Group, Minimum of 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Minimum_2mm_Diff')


#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleContributionvsAverageFootPower_2.3Hz_1LimbPer3Groups <- rlmer( AnkleContribution_AveragePower_AbsorptionNeutralized~FootAverageEnergy_Braking*Group_by_Morphology+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups )


##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleContributionvsAverageFootPower_Braking_forICC <- rlmer(AnkleContribution_AveragePower_AbsorptionNeutralized~1|Participant_ID,data=AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance for random slope and residuals 
summary(RMME_AnkleContributionvsAverageFootPower_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleContributionvsAverageFootPower_Braking_VarExplained = (67.95) /( (67.95) + (21.52) ) )
#ICC = 0.76 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly <- rlmer( AnkleContribution_AveragePower_AbsorptionNeutralized~FootAverageEnergy_Braking*Group_by_Morphology+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleContributionvsAverageFootPower_Braking_RIOnly <- (1 - ( var(residuals(RMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly,type='response' )) / (var(getME(RMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly,'y')))*( (dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.78


#Calculate Mean Squared Error for RMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly
( MSE_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly,type='response' )^2 ) )
#MSE = 17.55


##Create mixed effects model for random slope only.
RMME_AnkleContributionvsAverageFootPower_Braking_RandomSlopeOnly <- rlmer(AnkleContribution_AveragePower_AbsorptionNeutralized~FootAverageEnergy_Braking*Group_by_Morphology+(FootAverageEnergy_Braking-1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleContributionvsAverageFootPower_Braking_RSOnly <- (1 - ( ( var(residuals(RMME_AnkleContributionvsAverageFootPower_Braking_RandomSlopeOnly,type='response' )) / var(getME(RMME_AnkleContributionvsAverageFootPower_Braking_RandomSlopeOnly,'y')) )*((dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.68


#Calculate Mean Squared Error for RMME_AnkleContributionvsAverageFootPower_Braking_RandomSlopeOnly
( MSE_AnkleContributionvsAverageFootPower_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleContributionvsAverageFootPower_Braking_RandomSlopeOnly,type='response' )^2 ) )
#MSE = 25.7




#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleContributionvsAverageFootPower_Braking_BothEffects <- rlmer(AnkleContribution_AveragePower_AbsorptionNeutralized~FootAverageEnergy_Braking*Group_by_Morphology+(FootAverageEnergy_Braking|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleContributionvsAverageFootPower_Braking_BothEffects <- (1 - ( ( var(residuals(RMME_AnkleContributionvsAverageFootPower_Braking_BothEffects,type='response' )) / var(getME(RMME_AnkleContributionvsAverageFootPower_Braking_BothEffects,'y')) )*((dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.8


#Calculate Mean Squared Error for RMME_AnkleContributionvsAverageFootPower_Braking_BothEffects
( MSE_AnkleContributionvsAverageFootPower_Braking_BothEffects <- mean( residuals(RMME_AnkleContributionvsAverageFootPower_Braking_BothEffects,type='response' )^2 ) )
#MSE = 16.2


##Both effects is best model.
summary( RMME_AnkleContributionvsAverageFootPower_Braking_BothEffects )

```




```{r Bootstrap Function}



##Split Groups By Morphology

## Control Group
AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Control')

## ATx Group, Less than 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'LessThan_2mm_Diff')

## ATx Group, Minimum of 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Minimum_2mm_Diff')






#Set number of iterations for bootstrap
iter <- 250

#Initialize data frame to hold boot strapped data values.
BootStrapList_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops <- vector( 'list', 1000)

BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops <- data.frame( MSE = rep( 0, iter ) )



#Find the unique Participant ID for all groups
UniqueParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID )

#Find the number of participants in all groups
( NumberofParticipants <- length( UniqueParticipantID ) )

NumberofRows_AllParticipants <- dim( AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups )[1]

#Find the unique Participant IDs for ATx participants with 2 mm alteration in morphology
Unique2mmDiffID <- unique( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$Participant_ID )

#Find number of ATx participants with 2 mm alteration in morphology
Numberof2mmDiffParticipants <- length( Unique2mmDiffID )

#Find number of data points for all ATx participants with 2 mm alteration in morphology
Numberof2mmDiffRows <- dim( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ATxResiduals_Min2mmDiff <- data.frame( Residuals = rep( 0, Numberof2mmDiffRows ) )



#Find the unique Participant IDs for ATx participants with less than 2 mm alteration in morphology
UniqueLessThan2mmDiffParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$Participant_ID )

#Find number of ATx participants with less than 2 mm alteration in morphology
NumberofLessThan2mmDiffParticipants <- length( UniqueLessThan2mmDiffParticipantID )

#Find number of data points for all ATx participants with less than 2 mm alteration in morphology
NumberofLessThan2mmDiffRows <- dim( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ATxResiduals_LessThan2mmDiff <- data.frame( Residuals = rep( 0, NumberofLessThan2mmDiffRows ) )





#Find the unique Participant IDs for Control participants
UniqueControlParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz$Participant_ID )

#Find number of Control participants
NumberofControlParticipants <- length( UniqueControlParticipantID )

#Find number of data points for all Control participants
NumberofControlRows <- dim( AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ControlResiduals <- data.frame( Residuals = rep( 0, NumberofControlRows ) )



#Run loop 1000 times for bootstrapping the regression
for (j in 1 : iter) {
   
   
   print(j)
   
   print( Sys.time() )
   
   #Take random sample of ALL participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   RandomSample <- sample( NumberofRows_AllParticipants, NumberofRows_AllParticipants, replace = T )
   
   RandomSampleNames <-  AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ RandomSample ]
   
   
   
   
   #Take random sample of ATx, Less than 2 mm altered morphology participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ATxLessThan2mmRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='LessThan_2mm_Diff'), NumberofControlRows, replace = T )
   
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ATxLessThan2mmRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ATxLessThan2mmRandomSample ]
   
   
   
   #Take random sample of ATx, Minimum of 2 mm altered morphology participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ATx2mmRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='Minimum_2mm_Diff'), NumberofControlRows, replace = T )
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ATx2mmRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ATx2mmRandomSample ]
   
   
   
   #Take random sample of Control participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ControlRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='Control'), NumberofControlRows, replace = T )
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ControlRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ControlRandomSample ]
   
   
   
   #Store participant names from all random samples, ATx + Control
   AllNames <- c( ATxLessThan2mmRandomSample_Names, ATx2mmRandomSample_Names, ControlRandomSample_Names )
   
   #Store all randomly sampled data point numbers, from all groups
   AllSamplePointsforBootstrap <- c( ATx2mmRandomSample, ATxLessThan2mmRandomSample, ControlRandomSample )
   
   #Set total number of data points to be used in regression.
   NumberofDataPoints <- length(AllSamplePointsforBootstrap)
   
   
   
   #Create a data frame where Participant_ID contains the randomly sampled Participant IDs
   IterationDataFrame <- data.frame( Participant_ID = AllNames )
   
   #Set all Group_ID values to Minimum_2mm_Diff, at first. Just initializes the column. Will replace this later.
   IterationDataFrame$Group_ID <- rep( 'Minimum_2mm_Diff', NumberofDataPoints)
   
   #Initialize a column named AnkleContribution_AveragePower_AbsorptionNeutralized. Set it to 0s
   IterationDataFrame$AnkleContribution_AveragePower_AbsorptionNeutralized <- rep( 0, NumberofDataPoints)
   
   #Initialize a column named FootAverageEnergy_Braking. Set it to 0s
   IterationDataFrame$FootAverageEnergy_Braking <- rep( 0, NumberofDataPoints)
   
   #Initialize a column named ThighAverageEnergy_Braking. Set it to 0s
   IterationDataFrame$ThighAverageEnergy_Braking <- rep( 0, NumberofDataPoints)
   
   
   #Loop runs once for each data point
   for ( k in 1 : NumberofDataPoints ) {
      
      
      #Store Group ID in Iteration Data Frame
      IterationDataFrame$Group_ID[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_ID[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store Group_by_Morphology in Iteration Data Frame
      IterationDataFrame$Group_by_Morphology[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology[  AllSamplePointsforBootstrap[ k ] ]
      
      #Store Participant ID in Iteration Data Frame
      IterationDataFrame$Participant_ID[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store AnkleContribution_AveragePower_AbsorptionNeutralized in Iteration Data Frame
      IterationDataFrame$AnkleContribution_AveragePower_AbsorptionNeutralized[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$AnkleContribution_AveragePower_AbsorptionNeutralized[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store FootAverageEnergy_Braking in Iteration Data Frame
      IterationDataFrame$FootAverageEnergy_Braking[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$FootAverageEnergy_Braking[ AllSamplePointsforBootstrap[ k ] ]
      
   }
   
   
   #Perform robust mixed effects models with Participant_ID as random effect.
   BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_BothEffects <- rlmer( AnkleContribution_AveragePower_AbsorptionNeutralized~FootAverageEnergy_Braking*Group_by_Morphology+(FootAverageEnergy_Braking|Participant_ID), data = IterationDataFrame )
   
   
   
   #    #Calculate residuals 
   #    #for ATx participants with minimum of 2 mm altered morphology. Plug the predicted data values for AnkleContribution_AveragePower_AbsorptionNeutralized into the regression formula: Fixed Intercept for Appropriate Group + (FootAverageEnergy_Braking*Fixed Slope)
   # for ( k in 1 : Numberof2mmDiffParticipants ) {
   #    
   #    #Find the number of data points corresponding to Participant K
   #    NumberofRows_ParticipantK <- length( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized[ which( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$Participant_ID == Unique2mmDiffID[ k ] ) ] )
   #       
   #    #Find the element number in UniqueParticipantID that corresponds to Participant K
   #    RowInUniqueParticipantID_ParticipantK <- which( UniqueParticipantID == Unique2mmDiffID[ k ] )
   #    
   #    #Use an if statement to change the code depending on whether we're processing the first participant vs all others
   #    if ( k == 1 ) {
   #       
   #       #Create a vector from 1 to the number of data points for Participant K
   #       RowstoFill <- c( 1 : NumberofRows_ParticipantK )
   #       
   #       #Find the total slope for Participant K by adding the fixed and random effects
   #       TotalSlope <- fixef( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly )[1] + ranef( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly )$Participant_ID[RowInUniqueParticipantID_ParticipantK,1]
   #       
   #       #Fill in ATxResiduals_Min2mmDiff using RowstoFill. Calculate this by finding the product of  FootAverageEnergy_Braking and the fixed effect slope, then add the total slope.
   #       ATxResiduals_Min2mmDiff[ RowstoFill ] <- AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized - ( TotalSlope + ( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$FootAverageEnergy_Braking * fixef( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly )[2] ) ) 
   #    
   #    } else {
   #       
   #       #Create a vector for the next rows to fill. Do this by adding 1 to RowstoFill then add the number of data points for Participant K to NumberofRows_ParticipantK
   #       RowstoFill <- c( (RowstoFill + 1) : (RowstoFill + NumberofRows_ParticipantK ) )
   #       
   #       #Fill in ATxResiduals_Min2mmDiff using RowstoFill
   #       ATxResiduals_Min2mmDiff[ RowstoFill ] <- AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized - ( TotalSlope + ( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$FootAverageEnergy_Braking * fixef( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly )[2] ) ) 
   #       
   #    }
   #    
   #    
   # 
   # }
   #    
   #    
   #    
   #    #Calculate residuals for ATx participants with less than 2 mm altered morphology
   #    ATxResiduals_LessThan2mm <- AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized - ( fixef( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly )[1] + ( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$FootAverageEnergy_Braking * fixef( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly )[2] ) )
   #    
   #    
   #    ControlResiduals <- Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$AnkleContribution_AveragePower_AbsorptionNeutralized - ( ( fixef( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly )[1] + fixef( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly )[3] ) + ( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$FootAverageEnergy_Braking * ( fixef( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly )[2] + fixef( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly )[4]  ) ) )
   
   # 
   # #Calculate MSE
   # BootStrapDataFrame_IndividualHops$RMSE[ j ] <- mean( c( ATxResiduals^2, ControlResiduals^2 ) )
   
   BootStrapList_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops[ j ] <- BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_BothEffects
   
   
   
   #Calculate MSE
   BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$RMSE[ j ] <- mean( residuals( BootstrapRMME_AnkleContributionvsAverageFootPower_Braking_BothEffects,type='response' )^2 )
   
   
   
}



save(BootStrapList_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops, file="BootStrapList_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops.RData")


save(BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops, file="BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops.RData")

```


```{r After BootStrap}
#Find the minimum root mean square error among all models
min( BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$RMSE )

#Save the model with the minimum root mean square error
FinalRMMEValues_AnkleContributionvsAverageFootPower_Braking_BothEffects <- BootStrapList_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops[[ which( BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$RMSE == min( BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$RMSE ) ) ]]

#Display summary of best model
summary(FinalRMMEValues_AnkleContributionvsAverageFootPower_Braking_BothEffects)
#Intercept is significant, effect of thigh average energy for control group is significant. No group differences in intercept or slope.


#Calculate standard error for fixed effect intercept
B0_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$FixedBeta0 - mean(BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$FixedBeta0 ) )^2 ) )

#Calculate 95% CI for fixed effect intercept by subtract 2*Standard Error from estimated fixed effect intercept
( B0_CI <- c(FinalRMMEValues_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly$FixedBeta0 - 2*B0_SE, FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly$FixedBeta0 + 2*B0_SE) )

#Calculate standard error for fixed effect slope
B1_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$FixedBeta1 - mean(BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$FixedBeta1 ) )^2 ) )

#Calculate 95% CI for fixed effect slope by subtract 2*Standard Error from estimated fixed effect slope
( B1_CI <- c(FinalRMMEValues_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly$FixedBeta1 - 2*B1_SE, FinalRMMEValues_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly$FixedBeta1 + 2*B1_SE) )


#Calculate standard error for effect of group on fixed effect intercept
B2_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$FixedBeta2 - mean(BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$FixedBeta2 ) )^2 ) )

#Calculate 95% CI for effect of group on fixed effect intercept by subtract 2*Standard Error from estimated effect of group on fixed effect intercept
( B2_CI <- c(FinalRMMEValues_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly$FixedBeta2 - 2*B2_SE, FinalRMMEValues_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly$FixedBeta2 + 2*B2_SE) )


#Calculate standard error for effect of group on fixed effect slope
B3_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_AnkleContributionvsAverageFoot_Braking_2.3Hz_IndividualHops$FixedBeta3 - mean(BootStrapDataFrame_AnkleContributionvsAverage_Braking_2.3Hz_IndividualHops$FixedBeta3 ) )^2 ) )

#Calculate 95% CI for effect of group on fixed effect slope by subtract 2*Standard Error from estimated effect of group on fixed effect slope
( B3_CI <- c(FinalRMMEValues_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly$FixedBeta3 - 2*B3_SE, FinalRMMEValues_AnkleContributionvsAverageFootPower_Braking_RandomInterceptOnly$FixedBeta3 + 2*B3_SE) )

```



#### Total Thigh Power
```{r Find Best Model Structure}

##Split Groups By Morphology

## Control Group
AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_ID == 'Control')

## ATx Group
AnkleContributionvsAverageFootShankThighPower_ATxInvolved_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_ID == 'ATx')

## ATx Group, Minimum of 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Minimum_2mm_Diff')


#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups <- rlmer( AnkleContribution_AveragePower_GenerationNeutralized~ThighAverageEnergy_Braking*Group_ID+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups )
summary(RMME_AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups)

##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleContributionvsAverageThighPower_Braking_forICC <- rlmer( (AnkleContribution_AveragePower_GenerationNeutralized/100)~1|Participant_ID,data=AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance for random slope and residuals 
summary(RMME_AnkleContributionvsAverageThighPower_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleContributionvsAverageThighPower_Braking_VarExplained = (177.01) /( (177.01) + (22.51) ) )
#ICC = 0.89 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly <- rlmer( (AnkleContribution_AveragePower_GenerationNeutralized/100)~ThighAverageEnergy_Braking*Group_ID+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleContributionvsAverageThighPower_Braking_RIOnly <- (1 - ( ( sum(residuals(RMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly,type='response' )^2) / (sum(getME(RMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly,'y')^2)) ) *( (dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.99


#Calculate Mean Squared Error for RMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly
( MSE_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly,type='response' )^2 ) )
#MSE = 0.0017


##Create mixed effects model for random slope only.
RMME_AnkleContributionvsAverageThighPower_Braking_RandomSlopeOnly <- rlmer( (AnkleContribution_AveragePower_GenerationNeutralized/100)~ThighAverageEnergy_Braking*Group_ID+(ThighAverageEnergy_Braking-1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleContributionvsAverageThighPower_Braking_RSOnly <- (1 - ( ( sum(residuals(RMME_AnkleContributionvsAverageThighPower_Braking_RandomSlopeOnly,type='response' )^2) / sum(getME(RMME_AnkleContributionvsAverageThighPower_Braking_RandomSlopeOnly,'y')^2) )*((dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.99


#Calculate Mean Squared Error for RMME_AnkleContributionvsAverageThighPower_Braking_RandomSlopeOnly
( MSE_AnkleContributionvsAverageThighPower_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleContributionvsAverageThighPower_Braking_RandomSlopeOnly,type='response' )^2 ) )
#MSE = 0.0047




#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects <- rlmer( (AnkleContribution_AveragePower_GenerationNeutralized/100)~ThighAverageEnergy_Braking*Group_ID+(ThighAverageEnergy_Braking|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleContributionvsAverageThighPower_Braking_BothEffects <- (1 - ( ( sum(residuals(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects,type='response' )^2) / (dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1) ) / ( sum(getME(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects,'y')^2) /(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1) ) ) ) )
#Adjusted R2 = 0.99


#Calculate Mean Squared Error for RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects
( MSE_AnkleContributionvsAverageThighPower_Braking_BothEffects <- mean( residuals(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects,type='response' )^2 ) )
#MSE = 0.0015


##Both effects is best model.
summary( RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects )

```


```{r Check Model Assumptions}

plot( RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects, Participant_ID~resid(.,type='p'))

plot( RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects,abline=c(0,1))

```


```{r Bootstrap Function}



##Split Groups By Morphology

## Control Group
AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Control')

## ATx Group, Less than 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'LessThan_2mm_Diff')

## ATx Group, Minimum of 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Minimum_2mm_Diff')






#Set number of iterations for bootstrap
iter <- 1000

#Initialize data frame to hold boot strapped data values.
BootStrapList_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops <- vector( 'list', 1000)

BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops <- data.frame( MSE = rep( 0, iter ) )



#Find the unique Participant ID for all groups
UniqueParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID )

#Find the number of participants in all groups
( NumberofParticipants <- length( UniqueParticipantID ) )

NumberofRows_AllParticipants <- dim( AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups )[1]

#Find the unique Participant IDs for ATx participants with 2 mm alteration in morphology
Unique2mmDiffID <- unique( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$Participant_ID )

#Find number of ATx participants with 2 mm alteration in morphology
Numberof2mmDiffParticipants <- length( Unique2mmDiffID )

#Find number of data points for all ATx participants with 2 mm alteration in morphology
Numberof2mmDiffRows <- dim( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ATxResiduals_Min2mmDiff <- data.frame( Residuals = rep( 0, Numberof2mmDiffRows ) )



#Find the unique Participant IDs for ATx participants with less than 2 mm alteration in morphology
UniqueLessThan2mmDiffParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$Participant_ID )

#Find number of ATx participants with less than 2 mm alteration in morphology
NumberofLessThan2mmDiffParticipants <- length( UniqueLessThan2mmDiffParticipantID )

#Find number of data points for all ATx participants with less than 2 mm alteration in morphology
NumberofLessThan2mmDiffRows <- dim( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ATxResiduals_LessThan2mmDiff <- data.frame( Residuals = rep( 0, NumberofLessThan2mmDiffRows ) )





#Find the unique Participant IDs for Control participants
UniqueControlParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz$Participant_ID )

#Find number of Control participants
NumberofControlParticipants <- length( UniqueControlParticipantID )

#Find number of data points for all Control participants
NumberofControlRows <- dim( AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ControlResiduals <- data.frame( Residuals = rep( 0, NumberofControlRows ) )

2

#Run loop 1000 times for bootstrapping the regression
for (j in 1 : 450) {
   
   
   print(j)
   
   print( Sys.time() )
   
   #Take random sample of ALL participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   RandomSample <- sample( NumberofRows_AllParticipants, NumberofRows_AllParticipants, replace = T )
   
   RandomSampleNames <-  AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ RandomSample ]
   
   
   
   
   #Take random sample of ATx, Less than 2 mm altered morphology participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ATxLessThan2mmRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='LessThan_2mm_Diff'), NumberofControlRows, replace = T )
   
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ATxLessThan2mmRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ATxLessThan2mmRandomSample ]
   
   
   
   #Take random sample of ATx, Minimum of 2 mm altered morphology participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ATx2mmRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='Minimum_2mm_Diff'), NumberofControlRows, replace = T )
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ATx2mmRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ATx2mmRandomSample ]
   
   
   
   #Take random sample of Control participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ControlRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='Control'), NumberofControlRows, replace = T )
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ControlRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ControlRandomSample ]
   
   
   
   #Store participant names from all random samples, ATx + Control
   AllNames <- c( ATxLessThan2mmRandomSample_Names, ATx2mmRandomSample_Names, ControlRandomSample_Names )
   
   #Store all randomly sampled data point numbers, from all groups
   AllSamplePointsforBootstrap <- c( ATx2mmRandomSample, ATxLessThan2mmRandomSample, ControlRandomSample )
   
   #Set total number of data points to be used in regression.
   NumberofDataPoints <- length(AllSamplePointsforBootstrap)
   
   
   
   #Create a data frame where Participant_ID contains the randomly sampled Participant IDs
   IterationDataFrame <- data.frame( Participant_ID = AllNames )
   
   #Set all Group_ID values to Minimum_2mm_Diff, at first. Just initializes the column. Will replace this later.
   IterationDataFrame$Group_ID <- rep( 'Minimum_2mm_Diff', NumberofDataPoints)
   
   #Initialize a column named AnkleContribution_AveragePower_AbsorptionNeutralized. Set it to 0s
   IterationDataFrame$AnkleContribution_AveragePower_AbsorptionNeutralized <- rep( 0, NumberofDataPoints)
   
   #Initialize a column named ThighAverageEnergy_Braking. Set it to 0s
   IterationDataFrame$ThighAverageEnergy_Braking <- rep( 0, NumberofDataPoints)
   
   #Initialize a column named ThighAverageEnergy_Braking. Set it to 0s
   IterationDataFrame$ThighAverageEnergy_Braking <- rep( 0, NumberofDataPoints)
   
   
   #Loop runs once for each data point
   for ( k in 1 : NumberofDataPoints ) {
      
      
      #Store Group ID in Iteration Data Frame
      IterationDataFrame$Group_ID[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_ID[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store Group_by_Morphology in Iteration Data Frame
      IterationDataFrame$Group_by_Morphology[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology[  AllSamplePointsforBootstrap[ k ] ]
      
      #Store Participant ID in Iteration Data Frame
      IterationDataFrame$Participant_ID[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store AnkleContribution_AveragePower_AbsorptionNeutralized in Iteration Data Frame
      IterationDataFrame$AnkleContribution_AveragePower_AbsorptionNeutralized[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$AnkleContribution_AveragePower_AbsorptionNeutralized[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store ThighAverageEnergy_Braking in Iteration Data Frame
      IterationDataFrame$ThighAverageEnergy_Braking[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$ThighAverageEnergy_Braking[ AllSamplePointsforBootstrap[ k ] ]
      
   }
   
   
   #Perform robust mixed effects models with Participant_ID as random effect.
   BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_BothEffects <- rlmer( AnkleContribution_AveragePower_AbsorptionNeutralized~ThighAverageEnergy_Braking*Group_by_Morphology+(ThighAverageEnergy_Braking|Participant_ID), data = IterationDataFrame )
   
   
   
   #    #Calculate residuals 
   #    #for ATx participants with minimum of 2 mm altered morphology. Plug the predicted data values for AnkleContribution_AveragePower_AbsorptionNeutralized into the regression formula: Fixed Intercept for Appropriate Group + (ThighAverageEnergy_Braking*Fixed Slope)
   # for ( k in 1 : Numberof2mmDiffParticipants ) {
   #    
   #    #Find the number of data points corresponding to Participant K
   #    NumberofRows_ParticipantK <- length( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized[ which( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$Participant_ID == Unique2mmDiffID[ k ] ) ] )
   #       
   #    #Find the element number in UniqueParticipantID that corresponds to Participant K
   #    RowInUniqueParticipantID_ParticipantK <- which( UniqueParticipantID == Unique2mmDiffID[ k ] )
   #    
   #    #Use an if statement to change the code depending on whether we're processing the first participant vs all others
   #    if ( k == 1 ) {
   #       
   #       #Create a vector from 1 to the number of data points for Participant K
   #       RowstoFill <- c( 1 : NumberofRows_ParticipantK )
   #       
   #       #Find the total slope for Participant K by adding the fixed and random effects
   #       TotalSlope <- fixef( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly )[1] + ranef( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly )$Participant_ID[RowInUniqueParticipantID_ParticipantK,1]
   #       
   #       #Fill in ATxResiduals_Min2mmDiff using RowstoFill. Calculate this by finding the product of  ThighAverageEnergy_Braking and the fixed effect slope, then add the total slope.
   #       ATxResiduals_Min2mmDiff[ RowstoFill ] <- AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized - ( TotalSlope + ( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$ThighAverageEnergy_Braking * fixef( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly )[2] ) ) 
   #    
   #    } else {
   #       
   #       #Create a vector for the next rows to fill. Do this by adding 1 to RowstoFill then add the number of data points for Participant K to NumberofRows_ParticipantK
   #       RowstoFill <- c( (RowstoFill + 1) : (RowstoFill + NumberofRows_ParticipantK ) )
   #       
   #       #Fill in ATxResiduals_Min2mmDiff using RowstoFill
   #       ATxResiduals_Min2mmDiff[ RowstoFill ] <- AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized - ( TotalSlope + ( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$ThighAverageEnergy_Braking * fixef( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly )[2] ) ) 
   #       
   #    }
   #    
   #    
   # 
   # }
   #    
   #    
   #    
   #    #Calculate residuals for ATx participants with less than 2 mm altered morphology
   #    ATxResiduals_LessThan2mm <- AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized - ( fixef( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly )[1] + ( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$ThighAverageEnergy_Braking * fixef( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly )[2] ) )
   #    
   #    
   #    ControlResiduals <- Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$AnkleContribution_AveragePower_AbsorptionNeutralized - ( ( fixef( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly )[1] + fixef( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly )[3] ) + ( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$ThighAverageEnergy_Braking * ( fixef( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly )[2] + fixef( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly )[4]  ) ) )
   
   # 
   # #Calculate MSE
   # BootStrapDataFrame_IndividualHops$RMSE[ j ] <- mean( c( ATxResiduals^2, ControlResiduals^2 ) )
   
   BootStrapList_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops[ j ] <- BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_BothEffects
   
   
   
   #Calculate MSE
   BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops$RMSE[ j ] <- mean( residuals( BootstrapRMME_AnkleContributionvsAverageThighPower_Braking_BothEffects,type='response' )^2 )
   
   
   
}



save(BootStrapList_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops, file="BootStrapList_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops.RData")


save(BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops, file="BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops.RData")

```



`


```{r After BootStrap}
#Find the minimum root mean square error among all models
min( BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops$RMSE )

#Save the model with the minimum root mean square error
FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_BothEffects <- BootStrapList_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops[[ which( BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops$RMSE == min( BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops$RMSE ) ) ]]

#Display summary of best model
summary(FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_BothEffects)
#Intercept is significant, effect of thigh average energy for control group is significant. No group differences in intercept or slope.


#Calculate standard error for fixed effect intercept
B0_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops$FixedBeta0 - mean(BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops$FixedBeta0 ) )^2 ) )

#Calculate 95% CI for fixed effect intercept by subtract 2*Standard Error from estimated fixed effect intercept
( B0_CI <- c(FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly$FixedBeta0 - 2*B0_SE, FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly$FixedBeta0 + 2*B0_SE) )

#Calculate standard error for fixed effect slope
B1_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops$FixedBeta1 - mean(BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops$FixedBeta1 ) )^2 ) )

#Calculate 95% CI for fixed effect slope by subtract 2*Standard Error from estimated fixed effect slope
( B1_CI <- c(FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly$FixedBeta1 - 2*B1_SE, FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly$FixedBeta1 + 2*B1_SE) )


#Calculate standard error for effect of group on fixed effect intercept
B2_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops$FixedBeta2 - mean(BootStrapDataFrame_AnkleContributionvsAverageThigh_Braking_2.3Hz_IndividualHops$FixedBeta2 ) )^2 ) )

#Calculate 95% CI for effect of group on fixed effect intercept by subtract 2*Standard Error from estimated effect of group on fixed effect intercept
( B2_CI <- c(FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly$FixedBeta2 - 2*B2_SE, FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly$FixedBeta2 + 2*B2_SE) )


#Calculate standard error for effect of group on fixed effect slope
B3_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_AnkleContributionvsAverage_Braking_2.3Hz_IndividualHops$FixedBeta3 - mean(BootStrapDataFrame_AnkleContributionvsAverage_Braking_2.3Hz_IndividualHops$FixedBeta3 ) )^2 ) )

#Calculate 95% CI for effect of group on fixed effect slope by subtract 2*Standard Error from estimated effect of group on fixed effect slope
( B3_CI <- c(FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly$FixedBeta3 - 2*B3_SE, FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly$FixedBeta3 + 2*B3_SE) )

```



```{r Check Model Assumptions}

plot( FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(FinalRMMEValues_AnkleContributionvsAverageThighPower_Braking_RandomInterceptOnly,abline=c(0,1))

```




#### Total Thigh Power Transfer
```{r Find Best Model Structure}

##Split Groups By Morphology

## Control Group
AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Control')

## ATx Group, Less than 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'LessThan_2mm_Diff')

## ATx Group, Minimum of 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Minimum_2mm_Diff')



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleContributionvsAverageThighTransferPower_2.3Hz_1LimbPer3Groups <- rlmer( AnkleContribution_AveragePower_AbsorptionNeutralized~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups )


##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleContributionvsAverageThighTransferPower_Braking_forICC <- rlmer(AnkleContribution_AveragePower_AbsorptionNeutralized~1|Participant_ID,data=AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance for random slope and residuals 
summary(RMME_AnkleContributionvsAverageThighTransferPower_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleContributionvsAverageThighTransferPower_Braking_VarExplained = (67.95) /( (67.95) + (21.52) ) )
#ICC = 0.76 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly <- rlmer( (AnkleContribution_AveragePower_GenerationNeutralized/100)~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleContributionvsAverageThighTransferPower_Braking_RIOnly <- (1 - ( ( sum(residuals(RMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly,type='response' )^2) / sum(getME(RMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly,'y')^2))*( (dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.77


#Calculate Mean Squared Error for RMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly
( MSE_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly <- mean( residuals(RMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly,type='response' )^2 ) )
#MSE = 18.3


##Create mixed effects model for random slope only.
RMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomSlopeOnly <- rlmer( (AnkleContribution_AveragePower_GenerationNeutralized/100)~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer-1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleContributionvsAverageThighTransferPower_Braking_RSOnly <- (1 - ( ( sum(residuals(RMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomSlopeOnly,type='response' )^2) / sum(getME(RMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomSlopeOnly,'y')^2) )*((dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.62


#Calculate Mean Squared Error for RMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomSlopeOnly
( MSE_AnkleContributionvsAverageThighTransferPower_Braking_RandomSlopeOnly <- mean( residuals(RMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomSlopeOnly,type='response' )^2 ) )
#MSE = 30.4



print( Sys.time() )

#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects <- rlmer( (AnkleContribution_AveragePower_GenerationNeutralized/100)~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)

print( Sys.time() )
   
   
#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects <- (1 - ( ( sum(residuals(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects,type='response' )^2) / sum(getME(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects,'y')^2) )*((dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.8


#Calculate Mean Squared Error for RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects
( MSE_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects <- mean( residuals(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects,type='response' )^2 ) )
#MSE = 16.4


##Both effects is best model.
summary( RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )

```



```{r Check Model Assumptions}

plot( RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects, Participant_ID~resid(.,type='p'))

plot( RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects,abline=c(0,1))

```



```{r Bootstrap Function}






#Set number of iterations for bootstrap
iter <- 1000

#Initialize data frame to hold boot strapped data values.
BootStrapList_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2 <- vector( 'list', iter )

BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2 <- data.frame( RMSE = rep( 0, iter ), Beta0 = rep( 0, iter ), Beta1 = rep( 0, iter ), Beta0forATxLessThan2mm = rep( 0, iter ), Beta0forATxMinimum2mm = rep( 0, iter ), Beta1forATxLessThan2mm = rep( 0, iter ), Beta1forATxMinimum2mm = rep( 0, iter ) )



#Find the unique Participant ID for all groups
UniqueParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID )

#Find the number of participants in all groups
( NumberofParticipants <- length( UniqueParticipantID ) )

NumberofRows_AllParticipants <- dim( AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups )[1]

#Find the unique Participant IDs for ATx participants with 2 mm alteration in morphology
Unique2mmDiffID <- unique( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$Participant_ID )

#Find number of ATx participants with 2 mm alteration in morphology
Numberof2mmDiffParticipants <- length( Unique2mmDiffID )

#Find number of data points for all ATx participants with 2 mm alteration in morphology
Numberof2mmDiffRows <- dim( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ATxResiduals_Min2mmDiff <- data.frame( Residuals = rep( 0, Numberof2mmDiffRows ) )



#Find the unique Participant IDs for ATx participants with less than 2 mm alteration in morphology
UniqueLessThan2mmDiffParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$Participant_ID )

#Find number of ATx participants with less than 2 mm alteration in morphology
NumberofLessThan2mmDiffParticipants <- length( UniqueLessThan2mmDiffParticipantID )

#Find number of data points for all ATx participants with less than 2 mm alteration in morphology
NumberofLessThan2mmDiffRows <- dim( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ATxResiduals_LessThan2mmDiff <- data.frame( Residuals = rep( 0, NumberofLessThan2mmDiffRows ) )





#Find the unique Participant IDs for Control participants
UniqueControlParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz$Participant_ID )

#Find number of Control participants
NumberofControlParticipants <- length( UniqueControlParticipantID )

#Find number of data points for all Control participants
NumberofControlRows <- dim( AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ControlResiduals <- data.frame( Residuals = rep( 0, NumberofControlRows ) )


#Run loop 1000 times for bootstrapping the regression
for (j in 1 : iter) {
   
   
   print(j)
   
   ( CurrentTime <- print( Sys.time() ) )
   
   #Take random sample of ALL participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   RandomSample <- sample( NumberofRows_AllParticipants, NumberofRows_AllParticipants, replace = T )
   
   RandomSampleNames <-  AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ RandomSample ]
   
   
   
   
   #Take random sample of ATx, Less than 2 mm altered morphology participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ATxLessThan2mmRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='LessThan_2mm_Diff'), NumberofControlRows, replace = T )
   
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ATxLessThan2mmRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ATxLessThan2mmRandomSample ]
   
   
   
   #Take random sample of ATx, Minimum of 2 mm altered morphology participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ATx2mmRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='Minimum_2mm_Diff'), NumberofControlRows, replace = T )
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ATx2mmRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ATx2mmRandomSample ]
   
   
   
   #Take random sample of Control participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ControlRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='Control'), NumberofControlRows, replace = T )
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ControlRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ControlRandomSample ]
   
   
   
   #Store participant names from all random samples, ATx + Control
   AllNames <- c( ATxLessThan2mmRandomSample_Names, ATx2mmRandomSample_Names, ControlRandomSample_Names )
   
   #Store all randomly sampled data point numbers, from all groups
   AllSamplePointsforBootstrap <- c( ATx2mmRandomSample, ATxLessThan2mmRandomSample, ControlRandomSample )
   
   #Set total number of data points to be used in regression.
   NumberofDataPoints <- length(AllSamplePointsforBootstrap)
   
   
   
   #Create a data frame where Participant_ID contains the randomly sampled Participant IDs
   IterationDataFrame <- data.frame( Participant_ID = AllNames )
   
   #Set all Group_ID values to Minimum_2mm_Diff, at first. Just initializes the column. Will replace this later.
   IterationDataFrame$Group_ID <- rep( 'Minimum_2mm_Diff', NumberofDataPoints)
   
   #Initialize a column named AnkleContribution_AveragePower_AbsorptionNeutralized. Set it to 0s
   IterationDataFrame$AnkleContribution_AveragePower_AbsorptionNeutralized <- rep( 0, NumberofDataPoints)
   
   #Initialize a column named ThighAverageEnergy_Braking. Set it to 0s
   IterationDataFrame$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer <- rep( 0, NumberofDataPoints)
   
   #Initialize a column named ThighAverageEnergy_Braking. Set it to 0s
   IterationDataFrame$ThighAverageEnergy_Braking <- rep( 0, NumberofDataPoints)
   
   
   #Loop runs once for each data point
   for ( k in 1 : NumberofDataPoints ) {
      
      
      #Store Group ID in Iteration Data Frame
      IterationDataFrame$Group_ID[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_ID[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store Group_by_Morphology in Iteration Data Frame
      IterationDataFrame$Group_by_Morphology[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology[  AllSamplePointsforBootstrap[ k ] ]
      
      #Store Participant ID in Iteration Data Frame
      IterationDataFrame$Participant_ID[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store AnkleContribution_AveragePower_AbsorptionNeutralized in Iteration Data Frame
      IterationDataFrame$AnkleContribution_AveragePower_AbsorptionNeutralized[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$AnkleContribution_AveragePower_AbsorptionNeutralized[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer in Iteration Data Frame
      IterationDataFrame$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer[ AllSamplePointsforBootstrap[ k ] ]
      
   }
   
   
   #Perform robust mixed effects models with Participant_ID as random effect.
   BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects <- rlmer( AnkleContribution_AveragePower_AbsorptionNeutralized~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_by_Morphology+(ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer|Participant_ID), data = IterationDataFrame )
   
   
   
   #    #Calculate residuals 
   #    #for ATx participants with minimum of 2 mm altered morphology. Plug the predicted data values for AnkleContribution_AveragePower_AbsorptionNeutralized into the regression formula: Fixed Intercept for Appropriate Group + (ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Fixed Slope)
   # for ( k in 1 : Numberof2mmDiffParticipants ) {
   #    
   #    #Find the number of data points corresponding to Participant K
   #    NumberofRows_ParticipantK <- length( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized[ which( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$Participant_ID == Unique2mmDiffID[ k ] ) ] )
   #       
   #    #Find the element number in UniqueParticipantID that corresponds to Participant K
   #    RowInUniqueParticipantID_ParticipantK <- which( UniqueParticipantID == Unique2mmDiffID[ k ] )
   #    
   #    #Use an if statement to change the code depending on whether we're processing the first participant vs all others
   #    if ( k == 1 ) {
   #       
   #       #Create a vector from 1 to the number of data points for Participant K
   #       RowstoFill <- c( 1 : NumberofRows_ParticipantK )
   #       
   #       #Find the total slope for Participant K by adding the fixed and random effects
   #       TotalSlope <- fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly )[1] + ranef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly )$Participant_ID[RowInUniqueParticipantID_ParticipantK,1]
   #       
   #       #Fill in ATxResiduals_Min2mmDiff using RowstoFill. Calculate this by finding the product of  ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer and the fixed effect slope, then add the total slope.
   #       ATxResiduals_Min2mmDiff[ RowstoFill ] <- AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized - ( TotalSlope + ( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer * fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly )[2] ) ) 
   #    
   #    } else {
   #       
   #       #Create a vector for the next rows to fill. Do this by adding 1 to RowstoFill then add the number of data points for Participant K to NumberofRows_ParticipantK
   #       RowstoFill <- c( (RowstoFill + 1) : (RowstoFill + NumberofRows_ParticipantK ) )
   #       
   #       #Fill in ATxResiduals_Min2mmDiff using RowstoFill
   #       ATxResiduals_Min2mmDiff[ RowstoFill ] <- AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized - ( TotalSlope + ( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer * fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly )[2] ) ) 
   #       
   #    }
   #    
   #    
   # 
   # }
   #    
   #    
   #    
   #    #Calculate residuals for ATx participants with less than 2 mm altered morphology
   #    ATxResiduals_LessThan2mm <- AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$AnkleContribution_AveragePower_AbsorptionNeutralized - ( fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly )[1] + ( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer * fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly )[2] ) )
   #    
   #    
   #    ControlResiduals <- Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$AnkleContribution_AveragePower_AbsorptionNeutralized - ( ( fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly )[1] + fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly )[3] ) + ( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer * ( fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly )[2] + fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_RandomInterceptOnly )[4]  ) ) )
   
   # 
   # #Calculate MSE
   # BootStrapDataFrame_IndividualHops2$RMSE[ j ] <- mean( c( ATxResiduals^2, ControlResiduals^2 ) )
   
   BootStrapList_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2[ j ] <- BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects
   
   #Calculate RMSE
   BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$RMSE[ j ] <- mean( residuals( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects,type='response' )^2 )
   
   #Add Fixed Effect Intercept for Controls to data frame
   BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta0[ j ] <- fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]
   
   #Add Fixed Effect Slope for Controls to data frame
   BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta1[ j ] <- fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]
   
   #Add Fixed Effect Intercept for ATx participants with less than 2mm altered morphology to data frame. Sum the 1st and 3rd fixed effects
   BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta0forATxLessThan2mm[ j ] <- fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ] + fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]
   
   #Add Fixed Effect Intercept for ATx participants with less than 2mm altered morphology to data frame. Sum the 1st and 3rd fixed effects
   BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta0forATxMinimum2mm[ j ] <- fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ] + fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ]
   
   
   
   
   #Add Fixed Effect Slope for ATx participants with less than 2mm altered morphology to data frame. Sum the 1st and 3rd fixed effects
   BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta1forATxLessThan2mm[ j ] <- fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ] + fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]
   
   #Add Fixed Effect Slope for ATx participants with less than 2mm altered morphology to data frame. Sum the 1st and 3rd fixed effects
   BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta1forATxMinimum2mm[ j ] <- fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ] + fixef( BootstrapRMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ]
   
   
   
   
   ( EndOfIterationTime <- print( Sys.time() ) )
   
   (TimeDiff <- EndOfIterationTime - CurrentTime)
   
}#End bootstrap


save(BootStrapList_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2, file="BootStrapList_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2.RData")


save(BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2, file="BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops.RData")

```



`


```{r After BootStrap}
#Find the minimum root mean square error among all models
min( BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops$RMSE )

#Save the model with the minimum root mean square error
FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects <- BootStrapList_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops[[ which( BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops$RMSE == min( BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops$RMSE ) ) ]]

#Display summary of best model
summary(FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)
#Intercept is significant, effect of thigh average energy for control group is significant. No group differences in intercept or slope.








## CODE BELOW IS FOR FIXED EFFECT INTERCEPT FOR CONTROL GROUP

#Calculate standard error for fixed effect intercept
B0_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta0 - mean(BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta0 ) )^2 ) )

#Calculate 95% CI for fixed effect intercept by subtract 2*Standard Error from estimated fixed effect intercept
( B0_CI <- c( fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[1] - 2*B0_SE, fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[1] + 2*B0_SE) )

#Calculate size of one arm of the CI for B0
BO_OneCIArm <- 2*B0_SE




## CODE BELOW IS FOR FIXED EFFECT SLOPE FOR CONTROL GROUP

#Calculate standard error for fixed effect slope
B1_SE <- sqrt( (1/(iter-1) )*sum( (  BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta1 - mean( BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta1 ) )^2 ) )

#Calculate 95% CI for fixed effect slope by subtract 2*Standard Error from estimated fixed effect slope
( B1_CI <- c( fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[2] - 2*B1_SE, fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[2] + 2*B1_SE) )

#Calculate size of one arm of the CI for B1
B1_OneCIArm <- 2*B1_SE




## CODE BELOW IS FOR EFFECT OF LESS THAN 2 mm GROUP ON FIXED EFFECT INTERCEPT

#Calculate standard error for effect of less than 2 mm ATx group on fixed effect intercept
Beta0forATxLessThan2mm_SE <- sqrt( (1/(iter-1) )*sum( (  BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta0forATxLessThan2mm - mean( BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta0forATxLessThan2mm ) )^2 ) )

#Calculate 95% CI for effect of group on fixed effect intercept by subtract 2*Standard Error from estimated effect of group on fixed effect intercept
( Beta0forATxLessThan2mm_CI <- c( fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[3] - 2*Beta0forATxLessThan2mm_SE, fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[3] + 2*Beta0forATxLessThan2mm_SE) )

#Calculate size of one arm of the CI for Beta0 forATxLessThan2mm
Beta0forATxLessThan2mm_OneCIArm <- 2*Beta0forATxLessThan2mm_SE




## CODE BELOW IS FOR EFFECT OF MINIMUM 2 mm GROUP ON FIXED EFFECT INTERCEPT

#Calculate standard error for effect of less than 2 mm ATx group on fixed effect intercept
Beta0forATxMinimum2mm_SE <- sqrt( (1/(iter-1) )*sum( (  BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta0forATxMinimum2mm - mean( BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta0forATxMinimum2mm ) )^2 ) )

#Calculate 95% CI for effect of group on fixed effect intercept by subtract 2*Standard Error from estimated effect of group on fixed effect intercept
( Beta0forATxMinimum2mm_CI <- c( fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[4] - 2*Beta0forATxMinimum2mm_SE, fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[4] + 2*Beta0forATxMinimum2mm_SE) )

#Calculate size of one arm of the CI for Beta0 forATxMinimum2mm
Beta0forATxMinimum2mm_OneCIArm <- 2*Beta0forATxMinimum2mm_SE






## CODE BELOW IS FOR EFFECT OF LESS THAN 2 mm GROUP ON FIXED EFFECT SLOPE

#Calculate standard error for effect of ATx Less Than 2mm group on fixed effect slope
Beta1forATxLessThan2mm_SE <- sqrt( (1/(iter-1) )*sum( (  BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta1forATxLessThan2mm - mean( BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta1forATxLessThan2mm ) )^2 ) )

#Calculate 95% CI for effect of ATx Less Than 2mm group on fixed effect slope by subtract 2*Standard Error from estimated effect of group on fixed effect slope
( Beta1forATxLessThan2mm_CI <- c( fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[5] - 2*Beta1forATxLessThan2mm_SE, fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[5] + 2*Beta1forATxLessThan2mm_SE) )

#Calculate size of one arm of the CI for Beta1 forATxLessThan2mm
Beta1forATxLessThan2mm_OneCIArm <- 2*Beta1forATxLessThan2mm_SE






## CODE BELOW IS FOR EFFECT OF MINIMUM 2 mm GROUP ON FIXED EFFECT SLOPE

#Calculate standard error for effect of ATx Less Than 2mm group on fixed effect slope
Beta1forATxMinimum2mm_SE <- sqrt( (1/(iter-1) )*sum( (  BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta1forATxMinimum2mm - mean( BootStrapDataFrame_AnkleContributionvsAverageThighPowerTransfer_Braking_2.3Hz_IndividualHops2$Beta1forATxMinimum2mm ) )^2 ) )

#Calculate 95% CI for effect of ATx Less Than 2mm group on fixed effect slope by subtract 2*Standard Error from estimated effect of group on fixed effect slope
( Beta1forATxMinimum2mm_CI <- c( fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[6] - 2*Beta1forATxMinimum2mm_SE, fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[6] + 2*Beta1forATxMinimum2mm_SE) )

#Calculate size of one arm of the CI for Beta1 forATxMinimum2mm
Beta1forATxMinimum2mm_OneCIArm <- 2*Beta1forATxMinimum2mm_SE







#Add model parameters to data frame
FinalModelParameters_RMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects <- data.frame(  B0_SE = B0_SE, B0_CI = B0_CI, BO_OneCIArm = BO_OneCIArm, 
                                                                                                                 B1_SE = B1_SE, B1_CI = B1_CI, B1_OneCIArm = B1_OneCIArm, 
                                                                                                                 Beta0forATxLessThan2mm_SE = Beta0forATxLessThan2mm_SE, Beta0forATxLessThan2mm_CI = Beta0forATxLessThan2mm_CI, Beta0forATxLessThan2mm_OneCIArm = Beta0forATxLessThan2mm_OneCIArm, 
                                                                                                                 Beta0forATxMinimum2mm_SE = Beta0forATxMinimum2mm_SE, Beta0forATxMinimum2mm_CI = Beta0forATxMinimum2mm_CI, Beta0forATxMinimum2mm_OneCIArm = Beta0forATxMinimum2mm_OneCIArm, 
                                                                                                                 Beta1forATxLessThan2mm_SE = Beta1forATxLessThan2mm_SE, Beta1forATxLessThan2mm_CI = Beta1forATxLessThan2mm_CI, Beta1forATxLessThan2mm_OneCIArm = Beta1forATxLessThan2mm_OneCIArm, 
                                                                                                                 Beta1forATxMinimum2mm_SE = Beta1forATxMinimum2mm_SE, Beta1forATxMinimum2mm_CI = Beta1forATxMinimum2mm_CI, Beta1forATxMinimum2mm_OneCIArm = Beta1forATxMinimum2mm_OneCIArm )


```






```{r Check Model Assumptions}

plot( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects, Participant_ID~resid(.,type='p'))

plot( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects,abline=c(0,1))

```




### Ankle Generation Contribution vs...

#### Total Thigh Power Transfer
```{r Find Best Model Structure}

##Split Groups By Morphology

## Control Group
AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Control')

## ATx Group, Less than 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'LessThan_2mm_Diff')

## ATx Group, Minimum of 2 mm altered morphology
AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups %>% filter( Group_by_Morphology == 'Minimum_2mm_Diff')



#Perform normal robust mixed effects model, to check the results structure
RMME_AnkleContributionvsAverageThighTransferPower_2.3Hz_1LimbPer3Groups <- rlmer( AnkleContribution_AveragePower_AbsorptionnNeutralized~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups )


##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_forICC <- rlmer( (AnkleContribution_AveragePower_AbsorptionNeutralized/100)~1|Participant_ID,data=AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance for random slope and residuals 
summary(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_forICC)

#ICC = within-subject / (within-subject+residual)
(AnkleGenerationContributionvsAverageThighDistalTransferPower_VarExplained = (0.006850) /( (0.006850) + (0.002121) ) )
#ICC = 0.76 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomInterceptOnly <- rlmer( (AnkleContribution_AveragePower_AbsorptionNeutralized/100)~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleGenerationContributionvsAverageThighDistalTransferPower_RIOnly <- (1 - ( ( sum(residuals(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomInterceptOnly,type='response' )^2) / sum(getME(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomInterceptOnly,'y')^2))*( (dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.77


#Calculate Mean Squared Error for RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomInterceptOnly
( MSE_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomInterceptOnly <- mean( residuals(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomInterceptOnly,type='response' )^2 ) )
#MSE = 0.0016


##Create mixed effects model for random slope only.
RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomSlopeOnly <- rlmer( (AnkleContribution_AveragePower_AbsorptionNeutralized/100)~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer-1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleGenerationContributionvsAverageThighDistalTransferPower_RSOnly <- (1 - ( ( sum(residuals(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomSlopeOnly,type='response' )^2) / sum(getME(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomSlopeOnly,'y')^2) )*((dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.62


#Calculate Mean Squared Error for RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomSlopeOnly
( MSE_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomSlopeOnly <- mean( residuals(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_RandomSlopeOnly,type='response' )^2 ) )
#MSE = 0.0016



print( Sys.time() )

#Create robust mixed effects model with both random slope and random intercept
RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects <- rlmer( (AnkleContribution_AveragePower_AbsorptionNeutralized/100)~ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Group_ID+(ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)

print( Sys.time() )
   
   
#Calculate adjusted R2 for model with random slope only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects <- (1 - ( ( sum(residuals(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects,type='response' )^2) / sum(getME(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects,'y')^2) )*((dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
#Adjusted R2 = 0.8


#Calculate Mean Squared Error for RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects
( MSE_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects <- mean( residuals(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects,type='response' )^2 ) )
#MSE = 0.0015


##Both effects is best model.
summary( RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects )

```



```{r Check Model Assumptions}

plot( RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects, Participant_ID~resid(.,type='p'))

plot( RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects,abline=c(0,1))

```


### Thigh Power Transfer as DV
#### Group ID
```{r Find Best Model Structure}


#Perform normal robust mixed effects model, to check the results structure
RMME_AverageThighTransferPowervsGroupByMorphology_2.3Hz_1LimbPer3Groups <- rlmer( ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer~Group_by_Morphology+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups )


##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_AverageThighTransferPowervsGroupByMorphology_Braking_forICC <- rlmer(ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer~1|Participant_ID,data=AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance for random slope and residuals 
summary(RMME_AverageThighTransferPowervsGroupByMorphology_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(AverageThighTransferPowervsGroupByMorphology_Braking_VarExplained = (1.7251) /( (1.7251) + (0.2595) ) )
#ICC = 0.87 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly <- rlmer( ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer~Group_ID+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_AverageThighTransferPowervsGroupByMorphology_Braking_RIOnly <- (1 - ( var(residuals(RMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly,type='response' )) / (var(getME(RMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly,'y')))*( (dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.77


#Use summary to find variances for fixed and random effects
summary( RMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.3245^2 + 0.5270^2)/(1.7936 + 0.3245^2 + 0.5270^2 + 0.2595)
#R2 = 0.23
#Now add varionce from random effects o numerator
(1.7936 + 0.3245^2 + 0.5270^2 )/(1.7936+ 0.3245^2 + 0.5270^2 + 0.2595)
#R2 = 0.89

#No significant difference between groups. 

```


```{r Bootstrap Function}






#Set number of iterations for bootstrap
iter <- 1000

#Initialize data frame to hold boot strapped data values.
BootStrapList_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2 <- vector( 'list', iter )

BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2 <- data.frame( RMSE = rep( 0, iter ), Beta0 = rep( 0, iter ), Beta1 = rep( 0, iter ), Beta0forATxLessThan2mm = rep( 0, iter ), Beta0forATxMinimum2mm = rep( 0, iter ), Beta1forATxLessThan2mm = rep( 0, iter ), Beta1forATxMinimum2mm = rep( 0, iter ) )



#Find the unique Participant ID for all groups
UniqueParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID )

#Find the number of participants in all groups
( NumberofParticipants <- length( UniqueParticipantID ) )

NumberofRows_AllParticipants <- dim( AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups )[1]

#Find the unique Participant IDs for ATx participants with 2 mm alteration in morphology
Unique2mmDiffID <- unique( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$Participant_ID )

#Find number of ATx participants with 2 mm alteration in morphology
Numberof2mmDiffParticipants <- length( Unique2mmDiffID )

#Find number of data points for all ATx participants with 2 mm alteration in morphology
Numberof2mmDiffRows <- dim( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ATxResiduals_Min2mmDiff <- data.frame( Residuals = rep( 0, Numberof2mmDiffRows ) )



#Find the unique Participant IDs for ATx participants with less than 2 mm alteration in morphology
UniqueLessThan2mmDiffParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$Participant_ID )

#Find number of ATx participants with less than 2 mm alteration in morphology
NumberofLessThan2mmDiffParticipants <- length( UniqueLessThan2mmDiffParticipantID )

#Find number of data points for all ATx participants with less than 2 mm alteration in morphology
NumberofLessThan2mmDiffRows <- dim( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ATxResiduals_LessThan2mmDiff <- data.frame( Residuals = rep( 0, NumberofLessThan2mmDiffRows ) )





#Find the unique Participant IDs for Control participants
UniqueControlParticipantID <- unique( AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz$Participant_ID )

#Find number of Control participants
NumberofControlParticipants <- length( UniqueControlParticipantID )

#Find number of data points for all Control participants
NumberofControlRows <- dim( AnkleContributionvsAverageFootShankThighPower_ControlMatchedDominance_2.3Hz )[1]

#Initialize a vector to hold the residuals for all ATx participants with 2 mm alteration in morphology
ControlResiduals <- data.frame( Residuals = rep( 0, NumberofControlRows ) )


#Run loop 1000 times for bootstrapping the regression
for (j in 1 : iter) {
   
   
   print(j)
   
   ( CurrentTime <- print( Sys.time() ) )
   
   #Take random sample of ALL participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   RandomSample <- sample( NumberofRows_AllParticipants, NumberofRows_AllParticipants, replace = T )
   
   RandomSampleNames <-  AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ RandomSample ]
   
   
   
   
   #Take random sample of ATx, Less than 2 mm altered morphology participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ATxLessThan2mmRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='LessThan_2mm_Diff'), NumberofControlRows, replace = T )
   
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ATxLessThan2mmRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ATxLessThan2mmRandomSample ]
   
   
   
   #Take random sample of ATx, Minimum of 2 mm altered morphology participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ATx2mmRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='Minimum_2mm_Diff'), NumberofControlRows, replace = T )
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ATx2mmRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ATx2mmRandomSample ]
   
   
   
   #Take random sample of Control participants. Use sample - first argument numbers the original data points, second arg says how many data points to take in the random sample, set replace to T to allow taking a data point more than once
   ControlRandomSample <- sample( which(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology=='Control'), NumberofControlRows, replace = T )
   #Take the random sample from above and pull out the relevant Participant Names. Store them.
   ControlRandomSample_Names <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ ControlRandomSample ]
   
   
   
   #Store participant names from all random samples, ATx + Control
   AllNames <- c( ATxLessThan2mmRandomSample_Names, ATx2mmRandomSample_Names, ControlRandomSample_Names )
   
   #Store all randomly sampled data point numbers, from all groups
   AllSamplePointsforBootstrap <- c( ATx2mmRandomSample, ATxLessThan2mmRandomSample, ControlRandomSample )
   
   #Set total number of data points to be used in regression.
   NumberofDataPoints <- length(AllSamplePointsforBootstrap)
   
   
   
   #Create a data frame where Participant_ID contains the randomly sampled Participant IDs
   IterationDataFrame <- data.frame( Participant_ID = AllNames )
   
   #Set all Group_ID values to Minimum_2mm_Diff, at first. Just initializes the column. Will replace this later.
   IterationDataFrame$Group_ID <- rep( 'Minimum_2mm_Diff', NumberofDataPoints)
   
   #Initialize a column named ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer. Set it to 0s
   IterationDataFrame$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer <- rep( 0, NumberofDataPoints)
   
   #Initialize a column named ThighAverageEnergy_Braking. Set it to 0s
   IterationDataFrame$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer <- rep( 0, NumberofDataPoints)
   
   #Initialize a column named ThighAverageEnergy_Braking. Set it to 0s
   IterationDataFrame$ThighAverageEnergy_Braking <- rep( 0, NumberofDataPoints)
   
   
   #Loop runs once for each data point
   for ( k in 1 : NumberofDataPoints ) {
      
      
      #Store Group ID in Iteration Data Frame
      IterationDataFrame$Group_ID[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_ID[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store Group_by_Morphology in Iteration Data Frame
      IterationDataFrame$Group_by_Morphology[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Group_by_Morphology[  AllSamplePointsforBootstrap[ k ] ]
      
      #Store Participant ID in Iteration Data Frame
      IterationDataFrame$Participant_ID[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$Participant_ID[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer in Iteration Data Frame
      IterationDataFrame$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer[ AllSamplePointsforBootstrap[ k ] ]
      
      #Store ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer in Iteration Data Frame
      IterationDataFrame$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer[ k ] <- AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer[ AllSamplePointsforBootstrap[ k ] ]
      
   }
   
   
   #Perform robust mixed effects models with Participant_ID as random effect.
   BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly <- rlmer( ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer~Group_by_Morphology+(1|Participant_ID), data = IterationDataFrame )
   
    
   
   #    #Calculate residuals 
   #    #for ATx participants with minimum of 2 mm altered morphology. Plug the predicted data values for ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer into the regression formula: Fixed Intercept for Appropriate Group + (ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer*Fixed Slope)
   # for ( k in 1 : Numberof2mmDiffParticipants ) {
   #    
   #    #Find the number of data points corresponding to Participant K
   #    NumberofRows_ParticipantK <- length( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer[ which( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$Participant_ID == Unique2mmDiffID[ k ] ) ] )
   #       
   #    #Find the element number in UniqueParticipantID that corresponds to Participant K
   #    RowInUniqueParticipantID_ParticipantK <- which( UniqueParticipantID == Unique2mmDiffID[ k ] )
   #    
   #    #Use an if statement to change the code depending on whether we're processing the first participant vs all others
   #    if ( k == 1 ) {
   #       
   #       #Create a vector from 1 to the number of data points for Participant K
   #       RowstoFill <- c( 1 : NumberofRows_ParticipantK )
   #       
   #       #Find the total slope for Participant K by adding the fixed and random effects
   #       TotalSlope <- fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[1] + ranef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )$Participant_ID[RowInUniqueParticipantID_ParticipantK,1]
   #       
   #       #Fill in ATxResiduals_Min2mmDiff using RowstoFill. Calculate this by finding the product of  ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer and the fixed effect slope, then add the total slope.
   #       ATxResiduals_Min2mmDiff[ RowstoFill ] <- AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer - ( TotalSlope + ( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer * fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[2] ) ) 
   #    
   #    } else {
   #       
   #       #Create a vector for the next rows to fill. Do this by adding 1 to RowstoFill then add the number of data points for Participant K to NumberofRows_ParticipantK
   #       RowstoFill <- c( (RowstoFill + 1) : (RowstoFill + NumberofRows_ParticipantK ) )
   #       
   #       #Fill in ATxResiduals_Min2mmDiff using RowstoFill
   #       ATxResiduals_Min2mmDiff[ RowstoFill ] <- AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer - ( TotalSlope + ( AnkleContributionvsAverageFootShankThighPower_Min2Diff_2.3Hz$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer * fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[2] ) ) 
   #       
   #    }
   #    
   #    
   # 
   # }
   #    
   #    
   #    
   #    #Calculate residuals for ATx participants with less than 2 mm altered morphology
   #    ATxResiduals_LessThan2mm <- AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer - ( fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[1] + ( AnkleContributionvsAverageFootShankThighPower_LessThan2mm_2.3Hz$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer * fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[2] ) )
   #    
   #    
   #    ControlResiduals <- Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer - ( ( fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[1] + fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[3] ) + ( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer * ( fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[2] + fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[4]  ) ) )
   
   # 
   # #Calculate MSE
   # BootStrapDataFrame_IndividualHops2$RMSE[ j ] <- mean( c( ATxResiduals^2, ControlResiduals^2 ) )
   
   BootStrapList_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2[ j ] <- BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly
   
   #Calculate RMSE
   BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$RMSE[ j ] <- mean( residuals( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly,type='response' )^2 )
   
   #Add Fixed Effect Intercept for Controls to data frame
   BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta0[ j ] <- fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[ 1 ]
   
   #Add Fixed Effect Slope for Controls to data frame
   BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta1[ j ] <- fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[ 2 ]
   
   #Add Fixed Effect Intercept for ATx participants with less than 2mm altered morphology to data frame. Sum the 1st and 3rd fixed effects
   BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta0forATxLessThan2mm[ j ] <- fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[ 1 ] + fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[ 3 ]
   
   #Add Fixed Effect Intercept for ATx participants with less than 2mm altered morphology to data frame. Sum the 1st and 3rd fixed effects
   BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta0forATxMinimum2mm[ j ] <- fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[ 1 ] + fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[ 4 ]
   
   
   
   
   #Add Fixed Effect Slope for ATx participants with less than 2mm altered morphology to data frame. Sum the 1st and 3rd fixed effects
   BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta1forATxLessThan2mm[ j ] <- fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[ 2 ] + fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[ 5 ]
   
   #Add Fixed Effect Slope for ATx participants with less than 2mm altered morphology to data frame. Sum the 1st and 3rd fixed effects
   BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta1forATxMinimum2mm[ j ] <- fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[ 2 ] + fixef( BootstrapRMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[ 6 ]
   
   
   
   
   ( EndOfIterationTime <- print( Sys.time() ) )
   
   (TimeDiff <- EndOfIterationTime - CurrentTime)
   
}#End bootstrap


save(BootStrapList_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2, file="BootStrapList_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2.RData")


save(BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2, file="BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops.RData")

```



`


```{r After BootStrap}
#Find the minimum root mean square error among all models
min( BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$RMSE )

#Save the model with the minimum root mean square error
FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly <- BootStrapList_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2[[ which( BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$RMSE == min( BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$RMSE ) ) ]]

#Display summary of best model
summary(FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly)
#Intercept is significant, effect of thigh average energy for control group is significant. No group differences in intercept or slope.








## CODE BELOW IS FOR FIXED EFFECT INTERCEPT FOR CONTROL GROUP

#Calculate standard error for fixed effect intercept
B0_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta0 - mean(BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta0 ) )^2 ) )

#Calculate 95% CI for fixed effect intercept by subtract 2*Standard Error from estimated fixed effect intercept
( B0_CI <- c( fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[1] - 2*B0_SE, fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[1] + 2*B0_SE) )

#Calculate size of one arm of the CI for B0
BO_OneCIArm <- 2*B0_SE




## CODE BELOW IS FOR FIXED EFFECT SLOPE FOR CONTROL GROUP

#Calculate standard error for fixed effect slope
B1_SE <- sqrt( (1/(iter-1) )*sum( (  BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta1 - mean( BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta1 ) )^2 ) )

#Calculate 95% CI for fixed effect slope by subtract 2*Standard Error from estimated fixed effect slope
( B1_CI <- c( fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[2] - 2*B1_SE, fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[2] + 2*B1_SE) )

#Calculate size of one arm of the CI for B1
B1_OneCIArm <- 2*B1_SE




## CODE BELOW IS FOR EFFECT OF LESS THAN 2 mm GROUP ON FIXED EFFECT INTERCEPT

#Calculate standard error for effect of less than 2 mm ATx group on fixed effect intercept
Beta0forATxLessThan2mm_SE <- sqrt( (1/(iter-1) )*sum( (  BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta0forATxLessThan2mm - mean( BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta0forATxLessThan2mm ) )^2 ) )

#Calculate 95% CI for effect of group on fixed effect intercept by subtract 2*Standard Error from estimated effect of group on fixed effect intercept
( Beta0forATxLessThan2mm_CI <- c( fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[3] - 2*Beta0forATxLessThan2mm_SE, fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[3] + 2*Beta0forATxLessThan2mm_SE) )

#Calculate size of one arm of the CI for Beta0 forATxLessThan2mm
Beta0forATxLessThan2mm_OneCIArm <- 2*Beta0forATxLessThan2mm_SE




## CODE BELOW IS FOR EFFECT OF MINIMUM 2 mm GROUP ON FIXED EFFECT INTERCEPT

#Calculate standard error for effect of less than 2 mm ATx group on fixed effect intercept
Beta0forATxMinimum2mm_SE <- sqrt( (1/(iter-1) )*sum( (  BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta0forATxMinimum2mm - mean( BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta0forATxMinimum2mm ) )^2 ) )

#Calculate 95% CI for effect of group on fixed effect intercept by subtract 2*Standard Error from estimated effect of group on fixed effect intercept
( Beta0forATxMinimum2mm_CI <- c( fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[4] - 2*Beta0forATxMinimum2mm_SE, fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[4] + 2*Beta0forATxMinimum2mm_SE) )

#Calculate size of one arm of the CI for Beta0 forATxMinimum2mm
Beta0forATxMinimum2mm_OneCIArm <- 2*Beta0forATxMinimum2mm_SE






## CODE BELOW IS FOR EFFECT OF LESS THAN 2 mm GROUP ON FIXED EFFECT SLOPE

#Calculate standard error for effect of ATx Less Than 2mm group on fixed effect slope
Beta1forATxLessThan2mm_SE <- sqrt( (1/(iter-1) )*sum( (  BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta1forATxLessThan2mm - mean( BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta1forATxLessThan2mm ) )^2 ) )

#Calculate 95% CI for effect of ATx Less Than 2mm group on fixed effect slope by subtract 2*Standard Error from estimated effect of group on fixed effect slope
( Beta1forATxLessThan2mm_CI <- c( fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[5] - 2*Beta1forATxLessThan2mm_SE, fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[5] + 2*Beta1forATxLessThan2mm_SE) )

#Calculate size of one arm of the CI for Beta1 forATxLessThan2mm
Beta1forATxLessThan2mm_OneCIArm <- 2*Beta1forATxLessThan2mm_SE






## CODE BELOW IS FOR EFFECT OF MINIMUM 2 mm GROUP ON FIXED EFFECT SLOPE

#Calculate standard error for effect of ATx Less Than 2mm group on fixed effect slope
Beta1forATxMinimum2mm_SE <- sqrt( (1/(iter-1) )*sum( (  BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta1forATxMinimum2mm - mean( BootStrapDataFrame_AnkleContributionvsGroupByMorphology_Braking_2.3Hz_IndividualHops2$Beta1forATxMinimum2mm ) )^2 ) )

#Calculate 95% CI for effect of ATx Less Than 2mm group on fixed effect slope by subtract 2*Standard Error from estimated effect of group on fixed effect slope
( Beta1forATxMinimum2mm_CI <- c( fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[6] - 2*Beta1forATxMinimum2mm_SE, fixef( FinalRMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly )[6] + 2*Beta1forATxMinimum2mm_SE) )

#Calculate size of one arm of the CI for Beta1 forATxMinimum2mm
Beta1forATxMinimum2mm_OneCIArm <- 2*Beta1forATxMinimum2mm_SE







#Add model parameters to data frame
FinalModelParameters_RMMEValues_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly <- data.frame(  B0_SE = B0_SE, B0_CI = B0_CI, BO_OneCIArm = BO_OneCIArm, 
                                                                                                                 B1_SE = B1_SE, B1_CI = B1_CI, B1_OneCIArm = B1_OneCIArm, 
                                                                                                                 Beta0forATxLessThan2mm_SE = Beta0forATxLessThan2mm_SE, Beta0forATxLessThan2mm_CI = Beta0forATxLessThan2mm_CI, Beta0forATxLessThan2mm_OneCIArm = Beta0forATxLessThan2mm_OneCIArm, 
                                                                                                                 Beta0forATxMinimum2mm_SE = Beta0forATxMinimum2mm_SE, Beta0forATxMinimum2mm_CI = Beta0forATxMinimum2mm_CI, Beta0forATxMinimum2mm_OneCIArm = Beta0forATxMinimum2mm_OneCIArm, 
                                                                                                                 Beta1forATxLessThan2mm_SE = Beta1forATxLessThan2mm_SE, Beta1forATxLessThan2mm_CI = Beta1forATxLessThan2mm_CI, Beta1forATxLessThan2mm_OneCIArm = Beta1forATxLessThan2mm_OneCIArm, 
                                                                                                                 Beta1forATxMinimum2mm_SE = Beta1forATxMinimum2mm_SE, Beta1forATxMinimum2mm_CI = Beta1forATxMinimum2mm_CI, Beta1forATxMinimum2mm_OneCIArm = Beta1forATxMinimum2mm_OneCIArm )


```





```{r Check Model Assumptions}

plot( RMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( RMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_AverageThighTransferPowervsGroupByMorphology_Braking_RandomInterceptOnly,abline=c(0,1))

```



### Foot Proximal Transfer Work Rate as DV
#### Group ID
```{r Find Best Model Structure}


#Perform normal robust mixed effects model, to check the results structure
RMME_FootProximalTransferWorkRatevsGroup_2.3Hz_1LimbPer3Groups <- rlmer( FootAverageEnergyTransfer_Propulsion~Group_ID+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups )


##Robust mixed effects to calculate ICC. Contains random intercept but no fixed effects
RMME_FootProximalTransferWorkRatevsGroup_Braking_forICC <- rlmer(FootAverageEnergyTransfer_Propulsion~1|Participant_ID,data=AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Use summary to find variance for random slope and residuals 
summary(RMME_FootProximalTransferWorkRatevsGroup_Braking_forICC)

#ICC = within-subject / (within-subject+residual)
(FootProximalTransferWorkRatevsGroup_Braking_VarExplained = (0.12784) /( (0.12784) + (0.02876) ) )
#ICC = 0.82 - significant clustering. Appropriate to use mixed effects



##Create mixed effects model for random intercept only.
RMME_FootProximalTransferWorkRatevsGroup_Braking_RandomInterceptOnly <- rlmer( FootAverageEnergyTransfer_Propulsion~Group_ID+(1|Participant_ID), data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)


#Calculate adjusted R2 for model with random intercept only. Formula = Sum of Square Residuals/Total Sum of Square * [ (n-1)/(n-#ofpredictors-1) ]. 4 predictors because have 2 IV, 1 interaction effect
( AdjustR2_FootProximalTransferWorkRatevsGroup_Braking_RIOnly <- (1 - ( var(residuals(RMME_FootProximalTransferWorkRatevsGroup_Braking_RandomInterceptOnly,type='response' )) / (var(getME(RMME_FootProximalTransferWorkRatevsGroup_Braking_RandomInterceptOnly,'y')))*( (dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-1)/(dim(AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups)[1]-3-1)) ) ) )
##Adjusted R2 = 0.77


#Use summary to find variances for fixed and random effects
summary( RMME_FootProximalTransferWorkRatevsGroup_Braking_RandomInterceptOnly )

#R2 for mixed effects model. Numerator = variance from fixed effects - square the SE. Denominator = Random intercept variance + square of fixed intercept SE + square of fixed slope SE + square of fixed effect of group on intercept SE + square of fixed effect of group on slope SE + residual SE
(0.08758^2 + 0.14222^2)/(0.13031 + 0.08758^2 + 0.14222^2 + 0.02876)
#R2 = 0.15
#Now add varionce from random effects o numerator
(0.13031 + 0.08758^2 + 0.14222^2 )/(0.13031+ 0.08758^2 + 0.14222^2 + 0.02876)
#R2 = 0.85

#No significant difference between groups. 

```



```{r Check Model Assumptions}

plot( RMME_FootProximalTransferWorkRatevsGroup_Braking_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( RMME_FootProximalTransferWorkRatevsGroup_Braking_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_FootProximalTransferWorkRatevsGroup_Braking_RandomInterceptOnly,abline=c(0,1))

```



## SE Function

```{r}

standard_error <- function(x) {
   
   sd(x)/sqrt( length( x ) )
   
}

```

## Calculate SE

```{r}

#JointContributions_MEEAbsorption_ATx_2.3Hz_


```

## Between-Group Differences

### Ankle

```{r 2.3 Hz}


#Group difference in braking phase duration
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_BrakingPhaseLength_s[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_BrakingPhaseLength_s[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_BrakingPhaseLength_s[1]


#Group difference in propulsion phase duration
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_PropulsionPhaseLength_s[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_PropulsionPhaseLength_s[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_PropulsionPhaseLength_s[1]


#Group difference in ground contact phase duration
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_GroundContactPhaseLength_s[2] +  - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_GroundContactPhaseLength_s[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_GroundContactPhaseLength_s[1]
   


#Group difference in whole-limb MEE, braking phase
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Absorption_MEE[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Absorption_MEE[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Absorption_MEE[1]





#Group difference in whole-limb MEE, Propulsion phase
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Generation_MEE[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Generation_MEE[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Limb_Generation_MEE[1]



#Group difference in raw ankle MEE, BRAKING phase
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_MEE[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_MEE[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_MEE[1]




#Group difference in raw ankle MEE, PROPULSION phase
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_MEE[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_MEE[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_MEE[1]




#Group difference in ankle contribution to whole-limb MEE, BRAKING phase
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Percent_MEE_Absorption[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Percent_MEE_Absorption[1] )




#Group difference in ankle contribution to whole-limb MEE, PROPULSION phase
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Percent_MEE_Generation[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Percent_MEE_Generation[1] ) 




#Group difference in braking phase RoM
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_BrakingPhase[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_BrakingPhase[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_BrakingPhase[1]

#Group difference in propulsion phase RoM
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_PropulsionPhase[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_PropulsionPhase[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_SagittalRoM_PropulsionPhase[1]




#Group difference in braking phase angular velocity
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Absorption[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Absorption[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Absorption[1]

#Group difference in propulsion phase angular velocity
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Generation[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Generation[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Peak_Joint_AngularVelocity_Generation[1]




#Group difference in braking phase torque impulse
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_SagittalTorqueImpulse[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_SagittalTorqueImpulse[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Absorption_SagittalTorqueImpulse[1]

#Group difference in propulsion phase torque impulse
( EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_SagittalTorqueImpulse[2] - EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_SagittalTorqueImpulse[1] ) / EnergyFlow_GroupMeans_InvolvedVsControlAnkle_2.3Hz$Mean_Joint_Generation_SagittalTorqueImpulse[1]

```

## Between-Rate Differences

### Ankle

```{r 2.0 vs 2.3 Hz}


#ATx group difference in whole-limb MEE, braking phase
( EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Limb_Absorption_MEE[2] - EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Limb_Absorption_MEE[1] ) / EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Limb_Absorption_MEE[1]

#Control group difference in whole-limb MEE, braking phase
( EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Limb_Absorption_MEE[2] - EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Limb_Absorption_MEE[1] ) / EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Limb_Absorption_MEE[1]




#ATx group difference in whole-limb MEE, Propulsion phase
( EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Limb_Generation_MEE[2] - EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Limb_Generation_MEE[1] ) / EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Limb_Generation_MEE[1]

#Control group difference in whole-limb MEE, Propulsion phase
( EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Limb_Generation_MEE[2] - EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Limb_Generation_MEE[1] ) / EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Limb_Generation_MEE[1]









#ATx group difference in raw ankle MEE, BRAKING phase
( EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Joint_Absorption_MEE[2] - EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Joint_Absorption_MEE[1] ) / EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Joint_Absorption_MEE[1]


#Control group difference in raw ankle MEE, BRAKING phase
( EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Joint_Absorption_MEE[2] - EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Joint_Absorption_MEE[1] ) / EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Joint_Absorption_MEE[1]





#ATx group difference in raw ankle MEE, PROPULSION phase
( EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Joint_Generation_MEE[2] - EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Joint_Generation_MEE[1] ) / EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Joint_Generation_MEE[1]


#Control group difference in raw ankle MEE, PROPULSION phase
( EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Joint_Generation_MEE[2] - EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Joint_Generation_MEE[1] ) / EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Joint_Generation_MEE[1]










#ATx group difference in ankle contribution to whole-limb MEE, BRAKING phase
( EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Joint_Percent_MEE_Absorption[2] - EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Joint_Percent_MEE_Absorption[1] )


#Control group difference in ankle contribution to whole-limb MEE, BRAKING phase
( EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Joint_Percent_MEE_Absorption[2] - EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Joint_Percent_MEE_Absorption[1] )





#ATx group difference in ankle contribution to whole-limb MEE, PROPULSION phase
( EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Joint_Percent_MEE_Generation[2] - EnergyFlow_GroupMeans_Involved_2.0and2.3Hz_AnkleOnly$Mean_Joint_Percent_MEE_Generation[1] )


#Control group difference in ankle contribution to whole-limb MEE, PROPULSION phase
( EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Joint_Percent_MEE_Generation[2] - EnergyFlow_GroupMeans_Control_2.0and2.3Hz_AnkleOnly$Mean_Joint_Percent_MEE_Generation[1] )


```


## PLOTS

```{r Tendon Morphology }



(Power1 <- ggplot(data = TendonMorphology, aes(y = DifferenceinTendonThickness_mm, x = DistancefromCalcanealInsertion_cm  ) ) +
      
      
      geom_hline( yintercept = 2, linewidth = 1.75, color = 'black' ) +
    
    
      geom_vline( xintercept = 2, linewidth = 1.75, color = 'darkgray', linetype = 'dashed' ) +
      
    
    
      geom_text( label = 'MDC = 0.08 mm', size = 10, x = 3, y = 3.8, color = 'black', fontface = 'bold' )+
    
      
      #Arrow segment from 1 to max of y-axis.
   geom_segment( aes( x = 0.1, xend = 0.1, y = 2, yend = 4 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Literature-Informed \n Reduction in \n Tendon Stiffness', size = 10, x = 1, y = 3.55, color = 'black', fontface = 'bold' )+
      
      
    
    
      #Arrow segment from 0 to 1 of x-axis.
   geom_segment( aes( x = 0.01, xend = 1.98, y = 0, yend = 0 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'both', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Insertion', size = 10, x = 1, y = 0.06, color = 'black', fontface = 'bold' )+
    
    
      
      #Arrow segment from 2 to max of x-axis.
   geom_segment( aes( x = 2.01, xend = 6, y = 0, yend = 0 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'both', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Achilles Midsubstance', size = 10, x = 4, y = 0.06, color = 'black', fontface = 'bold' )+
      
      
      
      
      
      #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.0Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.0Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      

   
   
   geom_dotplot( aes( fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, stroke = 2) +
   
   
   
   
   scale_color_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                 'ATx08' = met.brewer('Renoir')[2],
                                 'ATx10'=met.brewer('Renoir')[3], 
                                 'ATx12'=met.brewer('Renoir')[4],
                                 'ATx17'=met.brewer('Renoir')[5],
                                 'ATx18'=met.brewer('Renoir')[6],
                                 'ATx19'=met.brewer('Renoir')[7],
                                 'ATx21'=met.brewer('Renoir')[8],
                                 'ATx24'=met.brewer('Renoir')[9],
                                 'ATx25'=met.brewer('Renoir')[10],
                                 'ATx27'=met.brewer('Renoir')[11],
                                 'ATx34'=met.brewer('Renoir')[12],
                                 'HC01'=met.brewer('Renoir')[1], 
                                 'HC19' = met.brewer('Renoir')[2],
                                 'HC12'=met.brewer('Renoir')[3], 
                                 'HC05'=met.brewer('Renoir')[4],
                                 'HC06'=met.brewer('Renoir')[5],
                                 'HC08'=met.brewer('Renoir')[6],
                                 'HC20'=met.brewer('Renoir')[7],
                                 'HC11'=met.brewer('Renoir')[8],
                                 'HC17'=met.brewer('Renoir')[9],
                                 'HC21'=met.brewer('Renoir')[11],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics=c('color'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                'ATx08' = met.brewer('Renoir')[2],
                                'ATx10'=met.brewer('Renoir')[3], 
                                'ATx12'=met.brewer('Renoir')[4],
                                'ATx17'=met.brewer('Renoir')[5],
                                'ATx18'=met.brewer('Renoir')[6],
                                'ATx19'=met.brewer('Renoir')[7],
                                'ATx21'=met.brewer('Renoir')[8],
                                'ATx24'=met.brewer('Renoir')[9],
                                'ATx25'=met.brewer('Renoir')[10],
                                'ATx27'=met.brewer('Renoir')[11],
                                'ATx34'=met.brewer('Renoir')[12],
                                'HC01'=met.brewer('Renoir')[1], 
                                'HC19' = met.brewer('Renoir')[2],
                                'HC12'=met.brewer('Renoir')[3], 
                                'HC05'=met.brewer('Renoir')[4],
                                'HC06'=met.brewer('Renoir')[5],
                                'HC08'=met.brewer('Renoir')[6],
                                'HC20'=met.brewer('Renoir')[7],
                                'HC11'=met.brewer('Renoir')[8],
                                'HC17'=met.brewer('Renoir')[9],
                                'HC21'=met.brewer('Renoir')[11] ),
                     name = '',
                     aesthetics=c('fill'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
   
   
   
   scale_y_continuous( breaks = seq( 0, 4, by = 0.25 ), limits = c( 0, 4 ) )+
   
   
   scale_x_continuous( breaks = seq( 0, 6, by = 0.5 ), limits = c( 0, 6 ) )+
   
   
   labs( title=' Interlimb Difference in Achilles Tendon Thickness \n (Involved - Non-Involved)',x='Measurement Distance from Calcaneal Insertion (cm)', y = ' Difference in Thickness (mm) ' ) +
   
   
   guides(color='none',size='none',fill= 'none', alpha = 'none' )+
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=30)  ) 

)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Morphology/', 'Dissertation_TendonMicroMorphology.png', width = 5000, height = 5000, units = 'px' )

```

### Participant Means

`

##### 2 ATx Groups - Laterality


###### 2.3 Hz



```{r Limb MEE Absorption }






(ATxLimbMEEAbsorb1 <- ggplot(data = EnergyFlow_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(y = Mean_Limb_Absorption_MEE, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#4d9221'   ) +
    
        #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  )+ 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = Limb_ID ), linewidth = 2, show.legend = F  )+ 
    
   
      
      geom_path( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Limb_Absorption_MEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend=FALSE ) +

    geom_dotplot( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_Limb_Absorption_MEE, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 1.75, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
   


                scale_color_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41' ),
                               name = '',
                               aesthetics=c('color'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34','Involved','Non-Involved' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks=seq(0,1.4,by=0.2),limits=c(0,1.4) )+
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
   
      labs(title=' Total Limb MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x='Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```



```{r Raw Absorption MEE }






(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Absorption_MEE, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#1b9e77'   ) +
    
      

      geom_path( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes(x = Limb_ID, y = Mean_Joint_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend=FALSE ) +
      
        #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  )+ 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = Limb_ID ), linewidth = 2, show.legend = F  )+ 
    
   
    geom_dotplot( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('Renoir')[1], 
                                              
'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      

   scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02') ,
                         name = 'Joint ID',aesthetics=c('fill'),labels=c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title=' Raw Joint MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x='Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color='none',size='none',fill='none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```








##### 2 ATx Groups - Morphology
```{r % Braking Ankle MEE vs Morphology } 

(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18, aes(x = Mean_BetweenLimbTendonThickness_mm, y = Mean_Joint_Percent_MEE_Absorption  ) ) +
      
      
   
   
   geom_point( aes( fill = Participant_ID ), shape = 21, color = 'white',size = 5, stroke = 2) +
   
    
    geom_abline( aes( intercept = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$coefficients[1], slope = LM_Joint_Percent_MEE_AbsorptionvsATxMorphology$coefficients[2] ), linewidth = 2, color = 'black' ) +
   
   
   scale_color_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                 'ATx08' = met.brewer('Renoir')[2],
                                 'ATx10'=met.brewer('Renoir')[3], 
                                 'ATx12'=met.brewer('Renoir')[4],
                                 'ATx17'=met.brewer('Renoir')[5],
                                 'ATx18'=met.brewer('Renoir')[6],
                                 'ATx19'=met.brewer('Renoir')[7],
                                 'ATx21'=met.brewer('Renoir')[8],
                                 'ATx24'=met.brewer('Renoir')[9],
                                 'ATx25'=met.brewer('Renoir')[10],
                                 'ATx27'=met.brewer('Renoir')[11],
                                 'ATx34'=met.brewer('Renoir')[12],
                                 'HC01'=met.brewer('Renoir')[1], 
                                 'HC19' = met.brewer('Renoir')[2],
                                 'HC12'=met.brewer('Renoir')[3], 
                                 'HC05'=met.brewer('Renoir')[4],
                                 'HC06'=met.brewer('Renoir')[5],
                                 'HC08'=met.brewer('Renoir')[6],
                                 'HC20'=met.brewer('Renoir')[7],
                                 'HC11'=met.brewer('Renoir')[8],
                                 'HC17'=met.brewer('Renoir')[9],
                                 'HC21'=met.brewer('Renoir')[11],
                                 'Involved' = '#c51b7d', 
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                      name = '',
                      aesthetics=c('color'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
   scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                'ATx08' = met.brewer('Renoir')[2],
                                'ATx10'=met.brewer('Renoir')[3], 
                                'ATx12'=met.brewer('Renoir')[4],
                                'ATx17'=met.brewer('Renoir')[5],
                                'ATx18'=met.brewer('Renoir')[6],
                                'ATx19'=met.brewer('Renoir')[7],
                                'ATx21'=met.brewer('Renoir')[8],
                                'ATx24'=met.brewer('Renoir')[9],
                                'ATx25'=met.brewer('Renoir')[10],
                                'ATx27'=met.brewer('Renoir')[11],
                                'ATx34'=met.brewer('Renoir')[12],
                                'HC01'=met.brewer('Renoir')[1], 
                                'HC19' = met.brewer('Renoir')[2],
                                'HC12'=met.brewer('Renoir')[3], 
                                'HC05'=met.brewer('Renoir')[4],
                                'HC06'=met.brewer('Renoir')[5],
                                'HC08'=met.brewer('Renoir')[6],
                                'HC20'=met.brewer('Renoir')[7],
                                'HC11'=met.brewer('Renoir')[8],
                                'HC17'=met.brewer('Renoir')[9],
                                'HC21'=met.brewer('Renoir')[11] ),
                     name = '',
                     aesthetics=c('fill'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
   
   
   
   scale_x_continuous( breaks = seq( 0, 4, by = 0.25 ), limits = c( 0, 4 ) )+
   
   
   scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits = c( 0, 1 ) )+
   
   
   labs( title=' Ankle Contribution to Whole-Limb MEE Absorption vs \n Between-Limb Difference in Tendon Thickness',x='Difference in Thickness (mm)', y = ' Contribution to MEE Absorption (%) ' ) +
   
   
   guides(color='none',size='none',fill= 'none', alpha = 'none' )+
   
   
   theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
         axis.title.x = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
         axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
         axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
         axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
         axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
         legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
         legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=30)  ) 

)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Power/', 'Dissertation_AnklePercentMEEvsTendonThickness.png', width = 5000, height = 5000, units = 'px' )
```



##### Involved vs Non-Involved

###### 2.3 Hz


###### Segment Average Energy
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_SegmentAverageEnergy_Braking, x = Segment_ID_Name ) ) +
      
      #Create a horizontal line at 0 to divide power absorption and generation
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
    
    
      #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = 0.1, yend = 12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow
      geom_text( label = 'Generation', size = 10, x = 1.4, y = 11.5, color = 'black', fontface = 'bold' )+
    
      #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = -0.1, yend = -12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow
      geom_text( label = 'Absorption', size = 10, x = 1.4, y = -11.5, color = 'black', fontface = 'bold' )+
    
    
    #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Segment_ID_Name, Group_ID ) ), color = '#2630A2', linewidth = 2.5, show.legend = F, na.rm = T  )+ 
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Segment_ID_Name, Group_ID ), color = Segment_ID_Name ), linewidth = 2, show.legend = F, na.rm = T  )+ 
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_SegmentAverageEnergy_Braking, x = Segment_ID_Name, fill = Participant_ID, alpha = Participant_ID, alpha = Participant_ID, group = interaction(  Segment_ID_Name, Group_ID, Participant_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 30, inherit.aes = F, stroke = 2, na.rm = T, binwidth = 1/56, binpositions = 'all', stackgroups=T, stackratio = 0.8 ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
    
    
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-14, 14, by = 2), limits = c(-14, 14) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Segment_ID_Name is a categorical variable
      scale_x_discrete( labels = c( 'Foot'='Foot', 'Shank' = 'Shank', 'Thigh' = 'Thigh', 'Pelvis' = 'Pelvis' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Segment Work Rate Across Entire Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
      
      facet_wrap( vars( Limb_ID ), nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AverageSegmentPower_BrakingPhase_2.3Hz_ATxInvolvedvsNonInvolved.png', width = 5750, height = 5750, units = 'px' )

```


```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_SegmentAverageEnergy_Propulsion, x = Segment_ID_Name ) ) +
      
      #Create a horizontal line at 0 to divide power absorption and generation
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
    
    
      #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = 0.1, yend = 12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow
      geom_text( label = 'Generation', size = 10, x = 1.4, y = 11.5, color = 'black', fontface = 'bold' )+
    
      #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = -0.1, yend = -12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow
      geom_text( label = 'Absorption', size = 10, x = 1.4, y = -11.5, color = 'black', fontface = 'bold' )+
    
    
    
     #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Segment_ID_Name, Group_ID ) ), color = '#2630A2', linewidth = 2.5, show.legend = F, na.rm = T  )+ 

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Segment_ID_Name, Group_ID ), color = Segment_ID_Name ), linewidth = 2, show.legend = F, na.rm = T  )+ 
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_SegmentAverageEnergy_Propulsion, x = Segment_ID_Name, fill = Participant_ID, alpha = Participant_ID, alpha = Participant_ID, group = interaction(  Segment_ID_Name, Group_ID, Participant_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 30, inherit.aes = F, stroke = 2, na.rm = T, binwidth = 1/56, binpositions = 'all', stackgroups=T, stackratio = 0.8 ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-14, 14, by = 2), limits = c(-14, 14) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Segment_ID_Name is a categorical variable
      scale_x_discrete( labels = c( 'Foot'='Foot', 'Shank' = 'Shank', 'Thigh' = 'Thigh', 'Pelvis' = 'Pelvis' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Segment Work Rate Across Entire Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
      
      facet_wrap( vars( Limb_ID ), nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AverageSegmentPower_PropulsionPhase_2.3Hz_ATxInvolvedvsNonInvolved.png', width = 5750, height = 5750, units = 'px' )

```


###### Average Total Energy Transfer
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_JointAverageTotalPowerTransfer_Braking, x = Joint_ID ) ) +
    
      
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAverageTotalPowerTransfer_Braking, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_ATx_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking, na.rm = T ) )/22, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole', na.rm = T ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(0, 13, by = 1), limits = c(0, 13) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle' = 'Ankle','Knee' = 'Knee','Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Total Joint Energy Transfer Across Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Limb_ID ), nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAverageTotalEnergyTransfer_BrakingPhase_2.3Hz_ATxInvolvedvsNonInvolved.png', width = 6000, height = 6000, units = 'px' )

```




```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_JointAveragePassivePower_forSegment_Propulsion, x = Joint_ID ) ) +
      
      
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_JointAverageTotalPowerTransfer_Propulsion, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_ATx_2.3Hz$Mean_JointAverageTotalPowerTransfer_Propulsion, na.rm = T ) )/14, dotsize = 0.75,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole', na.rm = T ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(0, 13, by = 1), limits = c(0, 13) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle' = 'Ankle','Knee' = 'Knee','Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Total Joint Energy Transfer Across Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Limb_ID ), nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAverageTotalEnergyTransfer_PropulsionPhase_2.3Hz_ATxInvolvedvsNonInvolved.png', width = 6000, height = 6000, units = 'px' )

```




##### Control

###### 2.3 Hz

```{r Limb MEE Absorption }






(ATxLimbMEEAbsorb1 <- ggplot(data = EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz, aes(y = Mean_Limb_Absorption_MEE, x = Limb_ID  ) ) +
      
    
        #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    
    

      stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  )+ 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  )+ 
    
   
   

    geom_dotplot( data = EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz, aes( y = Mean_Limb_Absorption_MEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1.75, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
   


                scale_color_manual(values = c( 'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                          'HC12'=met.brewer('Renoir')[3], 
                                          'HC05'=met.brewer('Renoir')[4],
                                          'HC06'=met.brewer('Renoir')[5],
                                          'HC08'=met.brewer('Renoir')[6],
                                          'HC20'=met.brewer('Renoir')[7],
                                          'HC11'=met.brewer('Renoir')[8],
                                          'HC17'=met.brewer('Renoir')[9],
                                          'HC21'=met.brewer('Renoir')[11],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics=c('color'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
      
      
      scale_y_continuous(breaks=seq(0,1.4,by=0.2),limits=c(0,1.4) )+
    
    
      scale_x_discrete(labels = c( 'Dominance Matched' ) )+
      
   
      labs(title=' Total Limb MEE - Braking Phase  \n 2.3 Hz Hopping - Control Group',x='Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)




```




```{r Raw Absorption MEE }






(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_Joint_Absorption_MEE, x = Limb_ID  ) ) +
      

      geom_hline( yintercept = mean( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Absorption_MEE ), linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
    
    geom_text( label = expression( paste( 'Control ', mu ) ), size = 8, x = 2.25, y = 1.08, color = '#4d9221'   ) +
    
      

      geom_path( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes(x = Limb_ID, y = Mean_Joint_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend=FALSE ) +
      
        #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  )+ 
   
    
      stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Limb_ID ), linewidth = 2, show.legend = F  )+ 
    
   
    geom_dotplot( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.935 ) +
      #Knee
   geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.9 ) +
      #Hip
   geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.865 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('Renoir')[1], 
                                              
'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      

   scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02') ,
                         name = 'Joint ID',aesthetics=c('fill'),labels=c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title=' Raw Joint MEE - Braking Phase  \n 2.3 Hz Hopping - ATx Group',x='Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color='none',size='none',fill='none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx' ) ), nrow = 1 )

 
)


```






##### 2 Limbs for ATx, 1 Control Limb



###### 2.0 Hz

```{r Limb Total Support Moment - Propulsion Phase }




CI <- mean_cl_boot( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.0Hz$Mean_TotalLimbSupportMoment_PropulsionPhase )




(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.0Hz, aes(y = Mean_TotalLimbSupportMoment_PropulsionPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
    
      
      geom_text( data = subset( EnergyFlow_ParticipantMeans_3Limbs_2.0Hz, Group_by_Tendinopathy_Type == 'Bilateral' ), label = '95% CI', size = 10, x = 0.675, y = CI$ymax + 4, color = '#4d9221', fontface = 'bold' )+

      
        #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.0Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.0Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    
    
    
      stat_summary( fun.data = 'mean_cl_boot'  ,
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  )+ 

    
      stat_summary( fun.data = 'mean_cl_boot'  ,
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  )+ 
    
   
      
      geom_path( data = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.0Hz, aes(x = Limb_ID, y = Mean_TotalLimbSupportMoment_PropulsionPhase, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend=FALSE ) +
   
      
    geom_dotplot( data = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.0Hz, aes( y = Mean_TotalLimbSupportMoment_PropulsionPhase, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3, ) +
      

   


                scale_color_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                              
'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12],
                                    'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                          'HC12'=met.brewer('Renoir')[3], 
                                          'HC05'=met.brewer('Renoir')[4],
                                          'HC06'=met.brewer('Renoir')[5],
                                          'HC08'=met.brewer('Renoir')[6],
                                          'HC20'=met.brewer('Renoir')[7],
                                          'HC11'=met.brewer('Renoir')[8],
                                          'HC17'=met.brewer('Renoir')[9],
                                          'HC21'=met.brewer('Renoir')[11],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics=c('color'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12],
                                    'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                          'HC12'=met.brewer('Renoir')[3], 
                                          'HC05'=met.brewer('Renoir')[4],
                                          'HC06'=met.brewer('Renoir')[5],
                                          'HC08'=met.brewer('Renoir')[6],
                                          'HC20'=met.brewer('Renoir')[7],
                                          'HC11'=met.brewer('Renoir')[8],
                                          'HC17'=met.brewer('Renoir')[9],
                                          'HC21'=met.brewer('Renoir')[11] ),
                               name = '',
                               aesthetics=c('fill'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
    
      
      
      scale_y_continuous( breaks = seq( -175, 0, by = 25 ), limits = c( -175, 0 ) )+
    
    
      scale_x_discrete(labels = c( 'Involved'='Involved', ' Non-Involved ', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) )+
      
   
      labs(title=' Total Limb Support Moment \n Propulsion Phase - 2 Hz Hopping',x='Limb ID', y = ' Support Moment (N-m/kg) ' ) +
      
      
      guides(color='none',size='none',fill='none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=35)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )

 
)



ggsave( 'Dissertation_LimbTotalSupportMoment_PropulsionPhase_2.0Hz_3Limbs.png', width = 5500, height = 5500, units = 'px' )


```




```{r Raw Absorption MEE }




CI <- mean_cl_boot( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.0Hz$Mean_Joint_Absorption_MEE )




(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_3Limbs_2.0Hz, aes(y = Mean_Joint_Absorption_MEE, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
      
      geom_text( data = subset( EnergyFlow_ParticipantMeans_3Limbs_2.0Hz, Group_by_Tendinopathy_Type == 'Bilateral' ), label = '95% CI', size = 10, x = 1.5, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' )+

      
      
        #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.0Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.0Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
    
      stat_summary( fun.data = 'mean_cl_boot'  ,
geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  )+ 
    
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  )+ 
    
      
      geom_path( data = EnergyFlow_ParticipantMeans_ATx_2.0Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend=FALSE ) +
   
      
    geom_dotplot( data = EnergyFlow_ParticipantMeans_3Limbs_2.0Hz, aes( y = Mean_Joint_Absorption_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( data = subset( EnergyFlow_ParticipantMeans_3Limbs_2.0Hz, Group_by_Tendinopathy_Type == 'Bilateral' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.95 ) +
      #Knee
   geom_text( data = subset( EnergyFlow_ParticipantMeans_3Limbs_2.0Hz, Group_by_Tendinopathy_Type == 'Bilateral' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.915 ) +
      #Hip
   geom_text( data = subset( EnergyFlow_ParticipantMeans_3Limbs_2.0Hz, Group_by_Tendinopathy_Type == 'Bilateral' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.88 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('Renoir')[1], 
                                              
'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12],
                                    'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                          'HC12'=met.brewer('Renoir')[3], 
                                          'HC05'=met.brewer('Renoir')[4],
                                          'HC06'=met.brewer('Renoir')[5],
                                          'HC08'=met.brewer('Renoir')[6],
                                          'HC20'=met.brewer('Renoir')[7],
                                          'HC11'=met.brewer('Renoir')[8],
                                          'HC17'=met.brewer('Renoir')[9],
                                          'HC21'=met.brewer('Renoir')[11],
'Matched Dominance' = '#4d9221' ), labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      

   scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02') ,
                         name = 'Joint ID',aesthetics=c('fill'),labels=c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
    
      scale_x_discrete(labels = c( 'Involved'='Involved', ' Non-Involved ', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) )+
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title=' Raw Joint MEE - Braking Phase - 2 Hz Hopping ',x='Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color='none',size='none',fill='none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=35)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )

 
)



ggsave( 'Dissertation_RawJointMEEAbsorption_2.0Hz_3Limbs.png', width = 5500, height = 5500, units = 'px' )

```






###### vs VAS
```{r % Absorption MEE }



(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.0Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, x = Mean_VAS_Rating  ) ) +
      

    geom_vline( data = NULL, xintercept = mean( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.0Hz$Mean_VAS_Rating), color = '#1b9e77', linetype = 'dashed', linewidth = 1.5  ) +

    
    geom_hline( data = NULL, yintercept = mean( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.0Hz$Mean_Joint_Percent_MEE_Absorption), color = '#1b9e77', linetype = 'dashed', linewidth = 1.5  ) +
 
    
    
#Arrow segment from 0 to max of x-axis.
   geom_segment( aes( y = mean( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.0Hz$Mean_Joint_Percent_MEE_Absorption) + 0.01, yend = 1, x = 0.02, xend = 0.02 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 ), color = '#7570b3'  ) +
   
#Text explaining purpose of above arrow   
   geom_text( label = 'Greater than Control Mean', size = 11, x =0.01 , y = 0.9, color = '#7570b3' , fontface = 'bold') +
   
   
   
    
    geom_smooth( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_Joint_Percent_MEE_Absorption, x = Mean_VAS_Rating, color = Limb_ID, group = interaction( Group_by_Tendinopathy_Type, Limb_ID ) ), formula = y ~ x, linewidth = 1.5, na.rm = T, method = 'lm', se = F ) +
 
 
    geom_point( data = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.0Hz, aes( fill = Limb_ID, group = interaction( Group_by_Tendinopathy_Type, Limb_ID), shape = Group_by_Tendinopathy_Type ), color = 'white', size = 10, stroke = 2 ) +
   

    
    # geom_point( data = EnergyFlow_BetweenLimbDiff_3Limbs_Ankle_2.0Hz, aes( fill = Group_ID, group = Participant_ID , shape = Group_by_Tendinopathy_Type ), color = 'white', stroke = 2, size= 10*RobustLM_MEEAbsorptionRatiovsVAS$rweights ) +


    
 
    
    # geom_abline( intercept = RobustLM_MEEAbsorptionRatiovsVAS$coefficients[ 1 ],
    #              slope = RobustLM_MEEAbsorptionRatiovsVAS$coefficients[ 2 ],
    #              color = 'white', linewidth = 3, alpha = 0.5 ) +
    # 
    # geom_abline( intercept = RobustLM_MEEAbsorptionRatiovsVAS$coefficients[ 1 ],
    #              slope = RobustLM_MEEAbsorptionRatiovsVAS$coefficients[ 2 ],
    #              color = '#d95f02', linewidth = 2, alpha = 0.5 ) +
      
    
    
    
    
    geom_text( label = 'Involved Limb', color = '#c51b7d', size = 10, x = 3.25, y = 0.92 ) + 
    
    geom_text( label = 'Non-Involved Limb', color = '#7fbc41', size = 10, x = 3.25, y = 0.86 ) + 
      
    geom_text( label = 'Control Limb', color = '#4d9221', size = 10, x = 3.25, y = 0.82 ) + 
    
    
    
    
   
   
   
   
   
#Arrow segment from 1 to min of y-axis   
   geom_segment( aes( x = -6.5, xend = -6.5, y = 0.98, yend = 0 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
#Text explaining purpose of above arrow   
   geom_text( label = 'Less than Control', size = 9, x = -3.5, y = 0.25 ) +
      

   
   
   
   
      scale_fill_manual(values = c('ATx' = '#d95f02', 'Control' = '#1b9e77', 'Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02','Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221',
                                    'ATx07'=met.brewer('Renoir')[1], 
                                    'ATx08' = met.brewer('Renoir')[2],
                                    'ATx10'=met.brewer('Renoir')[3], 
                                    'ATx12'=met.brewer('Renoir')[4],
                                    'ATx17'=met.brewer('Renoir')[5],
                                    'ATx18'=met.brewer('Renoir')[6],
                                    'ATx19'=met.brewer('Renoir')[7],
                                    'ATx21'=met.brewer('Renoir')[8],
                                    'ATx24'=met.brewer('Renoir')[9],
                                    'ATx25'=met.brewer('Renoir')[10],
                                    'ATx27'=met.brewer('Renoir')[11],
                                    'ATx34'=met.brewer('Renoir')[12],
                                    'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                    'HC12'=met.brewer('Renoir')[3], 
                                    'HC05'=met.brewer('Renoir')[4],
                                    'HC06'=met.brewer('Renoir')[5],
                                    'HC08'=met.brewer('Renoir')[6],
                                    'HC20'=met.brewer('Renoir')[7],
                                    'HC11'=met.brewer('Renoir')[8],
                                    'HC17'=met.brewer('Renoir')[9],
                                    'HC21'=met.brewer('Renoir')[11] ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      

   
   scale_color_manual(values = c( 'ATx' = '#d95f02', 'Control' = '#1b9e77','Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221' ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
    
      
      
      scale_y_continuous(breaks = seq( 0, 1, by = 0.1 ), limits = c(0, 1) )+
    
    
      scale_x_continuous( breaks = seq( 0, 7, by = 0.5 ), limits = c( 0, 7 ) )+
   
   
   scale_shape_manual( values = c( 'Unilateral' = 21, 'Bilateral' = 22, 'Control' = 23 ), labels = c('Unilateral ATx', 'Bilateral ATx', 'Control ATx') ) +
    
      
      labs(title=' Ankle Contribution to Whole-Limb MEE Absorption vs \n Visual Analog Score - 2.0 Hz Hopping', x='VAS (out of 10)', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color='none',size='none',fill = 'none', alpha = 'none', shape = guide_legend( title = 'Limb ID', nrow = 1, override.aes = list( fill = 'black' ) ) )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) 
 
)




```

###### 2.3 Hz



```{r Limb MEE Generation }




CI <- mean_cl_boot( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Limb_Generation_MEE )




(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz, aes(y = Mean_Limb_Generation_MEE, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
    
      
      geom_text( label = '95% CI', size = 10, x = 0.675, y = CI$ymax + 0.025, color = '#4d9221', fontface = 'bold' )+

      
        #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    
    
    
      stat_summary( fun.data = 'mean_cl_boot'  ,
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  )+ 

    
      stat_summary( fun.data = 'mean_cl_boot'  ,
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ) , color = Limb_ID ), linewidth = 2, show.legend = F  )+ 
    
   
      
      geom_path( data = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz, aes(x = Limb_ID, y = Mean_Limb_Generation_MEE, group = interaction( Participant_ID) , color = Participant_ID), linewidth = 2.5, show.legend=FALSE ) +
   
      
    geom_dotplot( data = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz, aes( y = Mean_Limb_Generation_MEE, x = Limb_ID, fill = Participant_ID ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   


                scale_color_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                              
'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12],
                                    'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                          'HC12'=met.brewer('Renoir')[3], 
                                          'HC05'=met.brewer('Renoir')[4],
                                          'HC06'=met.brewer('Renoir')[5],
                                          'HC08'=met.brewer('Renoir')[6],
                                          'HC20'=met.brewer('Renoir')[7],
                                          'HC11'=met.brewer('Renoir')[8],
                                          'HC17'=met.brewer('Renoir')[9],
                                          'HC21'=met.brewer('Renoir')[11],
'Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221'),
                               name = '',
                               aesthetics=c('color'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
   
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12],
                                    'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                          'HC12'=met.brewer('Renoir')[3], 
                                          'HC05'=met.brewer('Renoir')[4],
                                          'HC06'=met.brewer('Renoir')[5],
                                          'HC08'=met.brewer('Renoir')[6],
                                          'HC20'=met.brewer('Renoir')[7],
                                          'HC11'=met.brewer('Renoir')[8],
                                          'HC17'=met.brewer('Renoir')[9],
                                          'HC21'=met.brewer('Renoir')[11] ),
                               name = '',
                               aesthetics=c('fill'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
    
      
      
      scale_y_continuous(breaks=seq(0,1.6,by=0.1),limits=c(0,1.6) )+
    
    
      scale_x_discrete(labels = c( 'Involved'='Involved', ' Non-Involved ', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) )+
      
   
      labs(title=' Total Limb MEE - Propulsion Phase - 2.3 Hz Hopping ',x='Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color='none',size='none',fill='none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=35)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )

 
)



ggsave( 'Dissertation_LimbMEEGeneration_2.3Hz_3Limbs.png', width = 5500, height = 5500, units = 'px' )


```





```{r Raw Absorption MEE }




CI <- mean_cl_boot( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Absorption_MEE )




(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_3Limbs_2.3Hz, aes(y = Mean_Joint_Absorption_MEE, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
    
      
      geom_text( label = '95% CI', size = 10, x = 0.7, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' )+

      
      
        #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
    
    

    
    
      stat_summary( fun.data = 'mean_cl_boot'  ,
geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, show.legend = F  )+ 
    
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Limb_ID ), color = Joint_ID ), linewidth = 2, show.legend = F  )+ 
    
      
      geom_path( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes(x = Limb_ID, y = Mean_Joint_Absorption_MEE, group = interaction( Participant_ID, Joint_ID) , color = Participant_ID), linewidth = 2.5, show.legend=FALSE ) +
   
      
    geom_dotplot( data = EnergyFlow_ParticipantMeans_3Limbs_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Limb_ID ) ), color = 'white', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      

   
      #Add color-coded data labels
      #Ankle
   geom_text( data = subset( EnergyFlow_ParticipantMeans_3Limbs_2.3Hz, Group_by_Tendinopathy_Type == 'Bilateral' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.5, y = 0.95 ) +
      #Knee
   geom_text( data = subset( EnergyFlow_ParticipantMeans_3Limbs_2.3Hz, Group_by_Tendinopathy_Type == 'Bilateral' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.5, y = 0.915 ) +
      #Hip
   geom_text( data = subset( EnergyFlow_ParticipantMeans_3Limbs_2.3Hz, Group_by_Tendinopathy_Type == 'Bilateral' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.5, y = 0.88 ) +
   
   
   
      
      scale_color_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('Renoir')[1], 
                                              
'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12],
                                    'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                          'HC12'=met.brewer('Renoir')[3], 
                                          'HC05'=met.brewer('Renoir')[4],
                                          'HC06'=met.brewer('Renoir')[5],
                                          'HC08'=met.brewer('Renoir')[6],
                                          'HC20'=met.brewer('Renoir')[7],
                                          'HC11'=met.brewer('Renoir')[8],
                                          'HC17'=met.brewer('Renoir')[9],
                                          'HC21'=met.brewer('Renoir')[11],
'Matched Dominance' = '#4d9221' ), labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      

   scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02') ,
                         name = 'Joint ID',aesthetics=c('fill'),labels=c('Ankle','Knee','Hip') ) +
    
      
      
      scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
    
      scale_x_discrete(labels = c( 'Involved'='Involved', ' Non-Involved ', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) )+
      
    scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
    
      
      labs(title=' Raw Joint MEE - Braking Phase - 2.3 Hz Hopping ',x='Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color='none',size='none',fill='none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=35)  ) +
   
   facet_wrap( vars( Group_by_Tendinopathy_Type ), labeller = labeller( Group_by_Tendinopathy_Type = c( 'Unilateral' = 'Unilateral ATx', 'Bilateral' = 'Bilateral ATx', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )

 
)



ggsave( 'Dissertation_RawJointMEEAbsorption_2.3Hz_3Limbs.png', width = 5500, height = 5500, units = 'px' )

```




##### 2.3 Hz
```{r Limb Total Support Moment - Propulsion Phase }




CI <- mean_cl_boot( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_TotalLimbSupportMoment_PropulsionPhase )




(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz, aes(y = Mean_TotalLimbSupportMoment_PropulsionPhase, x = Limb_ID  ) ) +
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#4d9221' ) +
      
      
      geom_text( data = subset( EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz, Group_by_Morphology == 'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 4, color = '#4d9221', fontface = 'bold' )+
      
      
      #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Group_by_Morphology, Limb_ID ) , color = Group_by_Morphology ), linewidth = 2, show.legend = F  )+ 
      
      
      
      
      
      
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPerGroup_Ankle_2.3Hz, aes( y = Mean_TotalLimbSupportMoment_PropulsionPhase, x = Limb_ID, fill = Participant_ID ), color = 'black', stackdir = 'center' , binaxis = 'y', dotsize = 0.75, inherit.aes = F, stroke = 3, ) +
      
      
      
      
      
      scale_color_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                    
                                    'ATx08' = met.brewer('Renoir')[2],
                                    'ATx10'=met.brewer('Renoir')[3], 
                                    'ATx12'=met.brewer('Renoir')[4],
                                    'ATx17'=met.brewer('Renoir')[5],
                                    'ATx18'=met.brewer('Renoir')[6],
                                    'ATx19'=met.brewer('Renoir')[7],
                                    'ATx21'=met.brewer('Renoir')[8],
                                    'ATx24'=met.brewer('Renoir')[9],
                                    'ATx25'=met.brewer('Renoir')[10],
                                    'ATx27'=met.brewer('Renoir')[11],
                                    'ATx34'=met.brewer('Renoir')[12],
                                    'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                    'HC12'=met.brewer('Renoir')[3], 
                                    'HC05'=met.brewer('Renoir')[4],
                                    'HC06'=met.brewer('Renoir')[5],
                                    'HC08'=met.brewer('Renoir')[6],
                                    'HC20'=met.brewer('Renoir')[7],
                                    'HC11'=met.brewer('Renoir')[8],
                                    'HC17'=met.brewer('Renoir')[9],
                                    'HC21'=met.brewer('Renoir')[11],
                                    'Involved' = '#c51b7d', 
                                    'Non-Involved' = '#7fbc41',
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ),
                         name = '',
                         aesthetics=c('color'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21','Involved','Non-Involved', 'Matched Dominance' ) ) +
      
      
      
      scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                   'ATx08' = met.brewer('Renoir')[2],
                                   'ATx10'=met.brewer('Renoir')[3], 
                                   'ATx12'=met.brewer('Renoir')[4],
                                   'ATx17'=met.brewer('Renoir')[5],
                                   'ATx18'=met.brewer('Renoir')[6],
                                   'ATx19'=met.brewer('Renoir')[7],
                                   'ATx21'=met.brewer('Renoir')[8],
                                   'ATx24'=met.brewer('Renoir')[9],
                                   'ATx25'=met.brewer('Renoir')[10],
                                   'ATx27'=met.brewer('Renoir')[11],
                                   'ATx34'=met.brewer('Renoir')[12],
                                   'HC01'=met.brewer('Renoir')[1], 
                                   'HC19' = met.brewer('Renoir')[2],
                                   'HC12'=met.brewer('Renoir')[3], 
                                   'HC05'=met.brewer('Renoir')[4],
                                   'HC06'=met.brewer('Renoir')[5],
                                   'HC08'=met.brewer('Renoir')[6],
                                   'HC20'=met.brewer('Renoir')[7],
                                   'HC11'=met.brewer('Renoir')[8],
                                   'HC17'=met.brewer('Renoir')[9],
                                   'HC21'=met.brewer('Renoir')[11] ),
                        name = '',
                        aesthetics=c('fill'), labels=c('ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ) ) +
      
      
      
      scale_y_continuous( breaks = seq( -175, 0, by = 25 ), limits = c( -175, 0 ) )+
      
      
      scale_x_discrete(labels = c( 'Involved'='Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) )+
      
      
      labs(title=' Total Limb Support Moment \n Propulsion Phase - 2.3 Hz Hopping',x='Limb ID', y = ' Support Moment (N-m/kg) ' ) +
      
      
      guides(color='none',size='none',fill='none', alpha = 'none' )+
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=30,face='bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_LimbTotalSupportMoment_PropulsionPhase_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )


```




```{r Raw Absorption MEE }




CI <- mean_cl_boot( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Absorption_MEE )




(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz, aes(y = Mean_Joint_Absorption_MEE, x = Limb_ID  ) ) +
      
      
      geom_hline( yintercept = CI$ymin, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_hline( yintercept = CI$ymax, linewidth = 1.5, linetype = 'dashed', color = '#1b9e77' ) +
      
      
      geom_text( data = subset( EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz, Group_by_Morphology == 'Minimum_2mm_Diff' ), label = '95% CI', size = 11.5, x = 0.575, y = CI$ymax + 0.02, color = '#1b9e77', fontface = 'bold' )+
      
      
      
      #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', linewidth = 3, inherit.aes = F ) +
      
      
      #geom_segment( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), linewidth = 1.5, inherit.aes = F ) +
      
      
      
      
      
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_by_Morphology ), color = Joint_ID ), linewidth = 2, show.legend = F  )+ 
      
      
      
      
      
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, x = Limb_ID, fill = Joint_ID, group = interaction( Joint_ID, Group_by_Morphology ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 1.25, inherit.aes = F, stroke = 3, binwidth = 1/50 ) +
      
      
      
      #Add color-coded data labels
      #Ankle
      geom_text( data = subset( EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz, Group_by_Morphology == 'Minimum_2mm_Diff' ), label = 'Ankle', size = 12, color = '#1b9e77', x = 1.2, y = 0.95, fontface = 'bold' ) +
      #Knee
      geom_text( data = subset( EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz, Group_by_Morphology == 'Minimum_2mm_Diff' ), label = 'Knee', size = 12, color = '#7570b3', x = 1.2, y = 0.915, fontface = 'bold' ) +
      #Hip
      geom_text( data = subset( EnergyFlow_ParticipantMeans_1LimbPerGroup_2.3Hz, Group_by_Morphology == 'Minimum_2mm_Diff' ), label = 'Hip', size = 12, color = '#d95f02', x = 1.2, y = 0.88, fontface = 'bold' ) +
      
      
      
      
      scale_color_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('Renoir')[1], 
                                    
                                    'ATx08' = met.brewer('Renoir')[2],
                                    'ATx10'=met.brewer('Renoir')[3], 
                                    'ATx12'=met.brewer('Renoir')[4],
                                    'ATx17'=met.brewer('Renoir')[5],
                                    'ATx18'=met.brewer('Renoir')[6],
                                    'ATx19'=met.brewer('Renoir')[7],
                                    'ATx21'=met.brewer('Renoir')[8],
                                    'ATx24'=met.brewer('Renoir')[9],
                                    'ATx25'=met.brewer('Renoir')[10],
                                    'ATx27'=met.brewer('Renoir')[11],
                                    'ATx34'=met.brewer('Renoir')[12],
                                    'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                    'HC12'=met.brewer('Renoir')[3], 
                                    'HC05'=met.brewer('Renoir')[4],
                                    'HC06'=met.brewer('Renoir')[5],
                                    'HC08'=met.brewer('Renoir')[6],
                                    'HC20'=met.brewer('Renoir')[7],
                                    'HC11'=met.brewer('Renoir')[8],
                                    'HC17'=met.brewer('Renoir')[9],
                                    'HC21'=met.brewer('Renoir')[11],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ), labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
      
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02') ,
                        name = 'Joint ID',aesthetics=c('fill'),labels=c('Ankle','Knee','Hip') ) +
      
      
      
      scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
      
      
      scale_x_discrete(labels = c( 'Involved'='Involved', 'Matched Dominance' = 'Matched to \n Involved Dominance' ) )+
      
      scale_alpha_manual( values = c( 'ATx07' = 1, 'HC01' = 1, 'ATx10' = 0.8, 'HP08' = 0.8, 'ATx18' = 0.7, 'HP09' = 0.7 ), aesthetics = 'alpha' ) +
      
      
      labs(title=' Raw Joint MEE - Braking Phase - 2.3 Hz Hopping ',x='Limb ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
      
      
      guides(color='none',size='none',fill='none', alpha = 'none' )+
      
      
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=30,face='bold')  ) +
      
      facet_wrap( vars( Group_by_Morphology ), labeller = labeller( Group_by_Morphology = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ), nrow = 1, scales = 'free_x' )
   
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Power/2.3 Hz/Group Comparison', filename = 'Dissertation_RawJointMEEAbsorption_2.3Hz_1LimbPer3Groups.png', width = 5500, height = 5500, units = 'px' )

```




### 2 Groups, 1 Limb/Group

#### Ankle Work Rate vs Thigh Transfer Rate

```{r Braking Phase }

AnkleWorkRatevsAverageThighTransferPower_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID,

Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,

Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,

Mean_JointWorkRate_GenerationNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointAveragePower_Braking_GenerationNeutralized,

Mean_JointWorkRate_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized,

Mean_SegmentAverageEnergyTransfer_Braking = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking,

Mean_SegmentAverageEnergyTransfer_Propulsion = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Propulsion)


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleWorkRatevsAverageThighTransferPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointWorkRate_GenerationNeutralized, x = Mean_SegmentAverageEnergyTransfer_Braking ) ) +
      
      
      geom_text( label = expression( 'ATx: Ankle Work Rate = 0.31 + 0.061' %*% 'Thigh transfer work rate'), x = 2.5, y = 0.745, size = 11, fontface = 'bold' ) +
      
      geom_text( label = expression( 'Control: Ankle Work Rate = 0.31 + 0.066' %*% 'Thigh transfer work rate'), x = 2.5, y = 0.725, size = 11, fontface = 'bold' ) +
      
      geom_smooth( formula = y ~ x, aes( group = Group_ID, color = Group_ID ), linewidth = 6, method = 'lm' ) +
      
      # #Regression line for ATx
      # geom_abline( intercept = fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[1],
      #              slope = fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[2],
      #              linewidth = 6, color = 'black'  )+
      # 
      # #Regression line for ATx
      # geom_abline( intercept = fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[1],
      #              slope = fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[2],
      #              linewidth = 5, color = '#c51b7d'  )+
      # 
      # 
      # #Regression line for Control
      # geom_abline( intercept = fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[1]+fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[3],
      #              slope = fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[2]+fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[4],
      #              linewidth = 6, color = 'black'  )+
      # 
      # 
      # #Regression line for Control
      # geom_abline( intercept = fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[1]+fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[3],
      #              slope = fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[2]+fixef(RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects)[4],
      #              linewidth = 5, color = '#4d9221'  )+
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'ATx' = '#c51b7d',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 7, by = 1), limits = c(0, 7) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( -7, 0, by = 1 ), limits =  c( -7, 0 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23, 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Absorption Work Rate vs \n Thigh Braking Phase Distal Energy Transfer Work Rate \n 2.3 Hz Hopping ', x='Thigh Distal Energy Transfer Work Rate (W/kg)', y = ' Ankle Absorption Work Rate (W/kg) ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d','Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the legend background
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionWorkRatevsThighEnergyTransferWorkRate_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5750, height = 5750, units = 'px' )

```



```{r Propulsion Phase }

AnkleContributionvsAverageThighTransferPower_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID,

Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,

Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,

Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized,

Mean_JointContribution_AveragePower_GenerationNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized,

Mean_SegmentAverageEnergyTransfer_Braking = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking)


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageThighTransferPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointWorkRate_AbsorptionNeutralized, x = Mean_SegmentAverageEnergyTransfer_Braking ) ) +
      
      
      geom_text( label = expression( 'ATx: Ankle Contribution = 0.39 + 0.049' %*% 'Thigh transfer work rate'), x = 2.5, y = 0.745, size = 11, fontface = 'bold' ) +
      
      geom_text( label = expression( 'Control: Ankle Contribution = 0.41 + 0.041' %*% 'Thigh transfer work rate'), x = 2.5, y = 0.725, size = 11, fontface = 'bold' ) +
      
      
      #Regression line for ATx
      geom_abline( intercept = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[1],
                   slope = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[2],
                   linewidth = 6, color = 'black'  )+
 
      #Regression line for ATx
      geom_abline( intercept = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[1],
                   slope = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[2],
                   linewidth = 5, color = '#c51b7d'  )+
      
 
      #Regression line for Control
      geom_abline( intercept = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[1]+fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[3],
                   slope = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[2]+fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[4],
                   linewidth = 6, color = 'black'  )+
      
      
      #Regression line for Control
      geom_abline( intercept = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[1]+fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[3],
                   slope = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[2]+fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[4],
                   linewidth = 5, color = '#4d9221'  )+
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'ATx' = '#c51b7d',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 7, by = 1), limits = c(0, 7) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23, 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Generation Work Rate vs \n Thigh Braking Phase Distal Energy Transfer Work Rate \n 2.3 Hz Hopping ', x='Thigh Distal Energy Transfer Work Rate (W/kg)', y = ' Ankle Generation Work Rate (W/kg) ) ' ) +
    
      
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d','Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleGenerationWorkRatevsThighDistalEnergyTransferWorkRate_2.3Hz_1LimbPer2Groups.png', width = 5750, height = 5750, units = 'px' )

```





#### Ankle Power Contribution vs Thigh Work Rate
```{r Braking Phase }

AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID,

Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,

Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,

Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized,

Mean_SegmentAverageEnergy_Braking = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking )


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
      
      geom_text( label = expression( 'ATx: Ankle Contribution = 0.62 - 0.074' %*% 'Thigh work rate'), x = -0.5, y = 0.445, size = 11, fontface = 'bold' ) +
      
      geom_text( label = expression( 'Control: Ankle Contribution = 0.65 - 0.085' %*% 'Thigh work rate'), x = -0.5, y = 0.425, size = 11, fontface = 'bold' ) +
      
      
      #Regression line for ATx
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[1],
                   slope = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[2],
                   linewidth = 6, color = 'black'  )+
 
      #Regression line for ATx
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[1],
                   slope = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[2],
                   linewidth = 5, color = '#c51b7d'  )+
      
 
      #Regression line for Control
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[1]+fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[3],
                   slope = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[2]+fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[4],
                   linewidth = 6, color = 'black'  )+
      
      
      #Regression line for Control
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[1]+fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[3],
                   slope = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[2]+fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[4],
                   linewidth = 5, color = '#4d9221'  )+
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'ATx' = '#c51b7d',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-3, 5, by = 1), limits = c(-3, 5) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23, 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Thigh Braking Phase Work Rate \n 2.3 Hz Hopping ', x='Thigh Work Rate (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d','Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsAverageThighPower_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5750, height = 5750, units = 'px' )

```



```{r Braking Phase, Individual Hops }

AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID,

Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,

Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,

Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized,

Mean_SegmentAverageEnergy_Braking = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking )


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageFootShankThighPower_IndividualHops_2.3Hz_1LimbPer3Groups, aes(y = AnkleContribution_AveragePower_GenerationNeutralized/100, x = ThighAverageEnergy_Braking ) ) +
      
      
      #Regression line for ATx
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[1],
                   slope = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[2],
                   linewidth = 6, color = 'black'  )+
 
      #Regression line for ATx
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[1],
                   slope = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[2],
                   linewidth = 5, color = '#c51b7d'  )+
      
 
      #Regression line for Control
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[1]+fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[3],
                   slope = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[2]+fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[4],
                   linewidth = 6, color = 'black'  )+
      
      
      #Regression line for Control
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[1]+fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[3],
                   slope = fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[2]+fixef(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects)[4],
                   linewidth = 5, color = '#4d9221'  )+
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID, group = Group_ID ), color = 'black', size = 10*getME(RMME_AnkleContributionvsAverageThighPower_Braking_BothEffects,'w_e'), stroke = 3, na.rm = T ) +
      

      
      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'ATx' = '#c51b7d',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-1.5, 5, by = 0.5), limits = c(-1.5, 5) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23, 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Thigh Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Thigh Work Rate (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d','Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsAverageThighPower_IndividualHops_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5750, height = 5750, units = 'px' )

```



###### 
```{r Propulsion Phase }

AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz_NoATx36$Group_ID,

Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,

Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz_NoATx36$Participant_ID,

Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz_NoATx36$Mean_JointContribution_AveragePower_AbsorptionNeutralized,

Mean_SegmentAverageEnergy_Propulsion = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Propulsion )


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Propulsion ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_ID ), color = 'black', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_ID, color = Group_ID ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'ATx' = '#c51b7d',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-3, 5, by = 1), limits = c(-3, 5) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23, 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Generation vs \n Thigh Work Rate Across Entire Propulsion Phase \n 2.3 Hz Hopping ', x='Thigh Work Rate (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d','Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsAverageThighPower_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 5750, height = 5750, units = 'px' )

```


#### Ankle Contribution vs Thigh Transfer Rate

```{r Braking Phase }

AnkleContributionvsAverageThighTransferPower_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID,

Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,

Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,

Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized,

Mean_SegmentAverageEnergyTransfer_Braking = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking)


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageThighTransferPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergyTransfer_Braking ) ) +
      
      
      geom_text( label = expression( 'ATx: Ankle Contribution = 0.31 + 0.061' %*% 'Thigh transfer work rate'), x = 2.5, y = 0.745, size = 11, fontface = 'bold' ) +
      
      geom_text( label = expression( 'Control: Ankle Contribution = 0.31 + 0.066' %*% 'Thigh transfer work rate'), x = 2.5, y = 0.725, size = 11, fontface = 'bold' ) +
      
      
      #Regression line for ATx
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[1],
                   slope = fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[2],
                   linewidth = 6, color = 'black'  )+
 
      #Regression line for ATx
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[1],
                   slope = fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[2],
                   linewidth = 5, color = '#c51b7d'  )+
      
 
      #Regression line for Control
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[1]+fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[3],
                   slope = fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[2]+fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[4],
                   linewidth = 6, color = 'black'  )+
      
      
      #Regression line for Control
      geom_abline( intercept = fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[1]+fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[3],
                   slope = fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[2]+fixef(RMME_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects)[4],
                   linewidth = 5, color = '#4d9221'  )+
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'ATx' = '#c51b7d',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 7, by = 1), limits = c(0, 7) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23, 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Thigh Braking Phase Distal Transfer Work Rate \n 2.3 Hz Hopping ', x='Thigh Distal Transfer Work Rate (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d','Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionContributionvsAverageThighPowerTransfer_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5750, height = 5750, units = 'px' )

```



```{r Propulsion Phase }

AnkleContributionvsAverageThighTransferPower_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID,

Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,

Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,

Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized,

Mean_JointContribution_AveragePower_GenerationNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_GenerationNeutralized,

Mean_SegmentAverageEnergyTransfer_Braking = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking)


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageThighTransferPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergyTransfer_Braking ) ) +
      
      
      geom_text( label = expression( 'ATx: Ankle Contribution = 0.39 + 0.049' %*% 'Thigh transfer work rate'), x = 2.5, y = 0.745, size = 11, fontface = 'bold' ) +
      
      geom_text( label = expression( 'Control: Ankle Contribution = 0.41 + 0.041' %*% 'Thigh transfer work rate'), x = 2.5, y = 0.725, size = 11, fontface = 'bold' ) +
      
      
      #Regression line for ATx
      geom_abline( intercept = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[1],
                   slope = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[2],
                   linewidth = 6, color = 'black'  )+
 
      #Regression line for ATx
      geom_abline( intercept = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[1],
                   slope = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[2],
                   linewidth = 5, color = '#c51b7d'  )+
      
 
      #Regression line for Control
      geom_abline( intercept = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[1]+fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[3],
                   slope = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[2]+fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[4],
                   linewidth = 6, color = 'black'  )+
      
      
      #Regression line for Control
      geom_abline( intercept = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[1]+fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[3],
                   slope = fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[2]+fixef(RMME_AnkleGenerationContributionvsAverageThighDistalTransferPower_BothEffects)[4],
                   linewidth = 5, color = '#4d9221'  )+
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'ATx' = '#c51b7d',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 7, by = 1), limits = c(0, 7) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23, 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Generation vs \n Thigh Braking Phase Distal Transfer Work Rate \n 2.3 Hz Hopping ', x='Thigh Distal Transfer Work Rate (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d','Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleGenerationContributionvsAverageThighDistalPowerTransfer_2.3Hz_1LimbPer2Groups.png', width = 5750, height = 5750, units = 'px' )

```





##### Joint Work Rate vs Thigh Energy Transfer Work Rate

```{r Braking Phase }


ThighEnergyTransferWorkRatevsMorphology_1LimbPer2Groups_2.3Hz <- data.frame( Group_ID = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Group_ID,
                                                                  Group_by_Morphology = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored, 
                                                                  Participant_ID = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Participant_ID, 
                                                                  Mean_JointAverageTotalPowerTransfer_Braking = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking,
                                                                  Mean_JointAverageTotalPowerTransfer_Propulsion = EnergyFlow_ParticipantMeans_DistalShankOnly_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Propulsion,
                                                                  
Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz_NoATx36$Mean_JointContribution_AveragePower_AbsorptionNeutralized,      
                                                                  
Mean_JointContribution_AveragePower_GenerationNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz_NoATx36$Mean_JointContribution_AveragePower_GenerationNeutralized,     
                                                                  
Mean_JointWorkRate_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz_NoATx36$Mean_JointAveragePower_Propulsion_AbsorptionNeutralized,      
                                                                  
Mean_JointWorkRate_GenerationNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz_NoATx36$Mean_JointAveragePower_Braking_GenerationNeutralized )




#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = ThighEnergyTransferWorkRatevsMorphology_1LimbPer2Groups_2.3Hz, aes(y = Mean_JointWorkRate_GenerationNeutralized, x = Mean_JointAverageTotalPowerTransfer_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, se = F, linewidth = 5, aes( group = Group_ID, color = Group_ID ) ) +
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Group_ID ),  color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


#Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'ATx' = '#c51b7d',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23, 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq(0, 7, by = 1), limits = c(0, 7) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( -7, 0, by = 1 ), limits =  c( -7, 0 ) )+
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Braking Phase Work Rate vs \n Thigh Braking Phase Energy Transfer Work Rate  \n 2.3 Hz Hopping', y = 'Ankle Work Rate (W/kg)', x = ' Thigh Energy Transfer Work Rate (W/kg) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d','Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleBrakingWorkRatevsThighBrakingEnergyTransferWorkRate.png', width = 6250, height = 6250, units = 'px' )

```




```{r Propulsion Phase }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = ThighEnergyTransferWorkRatevsMorphology_2.3Hz_ATxInvolvedLimb, aes(y = Mean_JointWorkRate_AbsorptionNeutralized, x = Mean_JointAverageTotalPowerTransfer_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, se = F, linewidth = 5, aes( group = Group_ID, color = Group_ID ) ) +
      
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = Participant_ID, alpha = Participant_ID, shape = Group_ID ),  color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


#Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'ATx' = '#c51b7d',
                                     'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23, 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(0, 7, by = 0.5), limits = c(0, 7) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 7, by = 0.5 ), limits =  c( 0, 7 ) )+
      
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Propulsion Phase Work Rate vs \n Thigh Braking Phase Energy Transfer Work Rate \n 2.3 Hz Hopping', y = 'Ankle Work Rate (W/kg)', x = ' Thigh Energy Transfer Work Rate (W/kg) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d','Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnklePropulsionWorkRatevsThighBrakingEnergyTransferWorkRate.png', width = 6250, height = 6250, units = 'px' )

```


#### Non-Regressions

###### Segment Average Energy
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_SegmentAverageEnergy_Braking, x = Segment_ID_Name ) ) +
      
      #Create a horizontal line at 0 to divide power absorption and generation
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
    
      #Add wilcoxon rank sum test results for pelvis. Only show on ATx facet
      geom_text( label = 'Pelvis: Median Diff (95% CI) = -0.031 (-0.83,0.84), \n p = 0.95', aes( color = 'Pelvis' ), size = 9.25, y = 11.2, x = 2.55, data = subset( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_ID == 'ATx' ), fontface = 'bold'  ) +
      
    
      #Add wilcoxon rank sum test results for thigh. Only show on ATx facet
      geom_text( label = 'Thigh: Median Diff (95% CI) = 0.12 (-0.28,0.84), \n p = 0.64', aes( color = 'Thigh' ), size = 9.5, y = 9, x = 2.5, data = subset( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_ID == 'ATx' ), fontface = 'bold'  ) +
      
    
      #Add t test results for shank. Only show on Control facet
      geom_text( label = 'Shank: Mean Diff (95% CI) = -0.29 (-1.06,0.49), \n p = 0.45', aes( color = 'Shank' ), size = 9.5, y = 11.2, x = 2.5, data = subset( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_ID == 'Control' ), fontface = 'bold'  ) +
      
    
      #Add t test results for foot. Only show on Control facet
      geom_text( label = 'Foot: Mean Diff (95% CI) = 0.46 (-0.0.47,0.96), \n p = 0.074', aes( color = 'Foot' ), size = 9.5, y = 9, x = 2.5, data = subset( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_ID == 'Control' ), fontface = 'bold'  ) +
    
    
    
    
      #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = 0.1, yend = 14 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow
      geom_text( label = 'Into Segment', size = 12, x = 1.35, y = 13.75, color = 'black', fontface = 'bold' )+
    
      #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = -0.1, yend = -14 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow
      geom_text( label = 'From Segment', size = 12, x = 1.4, y = -13.75, color = 'black', fontface = 'bold' )+
    
    
    #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Segment_ID_Name, Group_ID ) ), color = '#2630A2', linewidth = 2.5, show.legend = F, na.rm = T  )+ 
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Segment_ID_Name, Group_ID ), color = Segment_ID_Name ), linewidth = 2, show.legend = F, na.rm = T  )+ 
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_SegmentAverageEnergy_Braking, x = Segment_ID_Name, fill = Participant_ID, alpha = Participant_ID, alpha = Participant_ID, group = interaction(  Segment_ID_Name, Group_ID, Participant_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 30, inherit.aes = F, stroke = 2, na.rm = T, binwidth = 1/56, binpositions = 'all', stackgroups=T, stackratio = 0.8 ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
    
    
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-14, 14, by = 2), limits = c(-14, 14) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Segment_ID_Name is a categorical variable
      scale_x_discrete( labels = c( 'Foot'='Foot', 'Shank' = 'Shank', 'Thigh' = 'Thigh', 'Pelvis' = 'Pelvis' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Segment Work Rate Across Entire Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 35,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 35, face = 'bold' )  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AverageSegmentPower_BrakingPhase_2.3Hz_ATxvsControl.png', width = 5750, height = 5750, units = 'px' )

```


```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_SegmentAverageEnergy_Propulsion, x = Segment_ID_Name ) ) +
      
      #Create a horizontal line at 0 to divide power absorption and generation
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
    
    
      #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = 0.1, yend = 14 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow
      geom_text( label = 'Into Segment', size = 12, x = 1.35, y = 13.75, color = 'black', fontface = 'bold' )+
    
      #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = -0.1, yend = -14 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow
      geom_text( label = 'From Segment', size = 12, x = 1.4, y = -13.75, color = 'black', fontface = 'bold' )+
    
    
     #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Segment_ID_Name, Group_ID ) ), color = '#2630A2', linewidth = 2.5, show.legend = F, na.rm = T  )+ 

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Segment_ID_Name, Group_ID ), color = Segment_ID_Name ), linewidth = 2, show.legend = F, na.rm = T  )+ 
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_SegmentAverageEnergy_Propulsion, x = Segment_ID_Name, fill = Participant_ID, alpha = Participant_ID, alpha = Participant_ID, group = interaction(  Segment_ID_Name, Group_ID, Participant_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 30, inherit.aes = F, stroke = 2, na.rm = T, binwidth = 1/56, binpositions = 'all', stackgroups=T, stackratio = 0.8 ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-14, 14, by = 2), limits = c(-14, 14) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Segment_ID_Name is a categorical variable
      scale_x_discrete( labels = c( 'Foot'='Foot', 'Shank' = 'Shank', 'Thigh' = 'Thigh', 'Pelvis' = 'Pelvis' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Segment Work Rate Across Entire Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AverageSegmentPower_PropulsionPhase_2.3Hz_ATxvsControl.png', width = 5750, height = 5750, units = 'px' )

```


###### Average Total Energy Transfer
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAverageTotalPowerTransfer_Braking, x = Joint_ID ) ) +
    
   #Add geom_text to display regression equations   
    geom_text( label = 'ATx Mean Thigh Distal Transfer Work Rate = \n 4.47*', size = 10, color = '#c51b7d', x = 'Knee', y = 10, fontface = 'bold', data = subset( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_ID == 'ATx' ) ) +
    
   #Add geom_text to display regression equations   
    geom_text( label =  'Control Mean Thigh Distal Transfer Work Rate = \n 4.60', size = 9.5, color = '#4d9221', x = 'Knee', y = 10, fontface = 'bold', data = subset( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_ID == 'Control' ) ) +
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAverageTotalPowerTransfer_Braking, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking, na.rm = T ) )/22, dotsize = 0.5, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole', na.rm = T ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 3, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(0, 13, by = 1), limits = c(0, 13) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( limits = c( 'Hip', 'Knee', 'Ankle' ), labels = c( 'Ankle' = 'Shank to \n Foot','Knee' = 'Thigh to \n Shank','Hip' = 'Pelvis to \n Thigh' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Joint Transfer Work Rate - Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Transfer Direction', y = ' Transfer Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointTransferWorkRate_BrakingPhase_2.3Hz_ATxvsControl.png', width = 6000, height = 6000, units = 'px' )

```




```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAveragePassivePower_forSegment_Propulsion, x = Joint_ID ) ) +
      
      
    
   #Add geom_text to display regression equations   
    geom_text( label = 'ATx Mean Foot Proximal Transfer Work Rate = \n 1.36*', size = 10, color = '#c51b7d', x = 'Knee', y = 12, fontface = 'bold', data = subset( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_ID == 'ATx' ) ) +
    
   #Add geom_text to display regression equations   
    geom_text( label = 'ATx Mean Shank Proximal Transfer Work Rate = \n 3.87*', size = 10, color = '#c51b7d', x = 'Knee', y = 10.5, fontface = 'bold', data = subset( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_ID == 'ATx' ) ) +
    
    
    
    
   #Add geom_text to display regression equations   
    geom_text( label =  'Control Mean Foot Proximal Transfer Work Rate = \n 1.32', size = 9.5, color = '#4d9221', x = 'Knee', y = 12, fontface = 'bold', data = subset( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_ID == 'Control' ) ) +
    
    
   #Add geom_text to display regression equations   
    geom_text( label =  'Control Mean Shank Proximal Transfer Work Rate = \n 3.95', size = 9.5, color = '#4d9221', x = 'Knee', y = 10.5, fontface = 'bold', data = subset( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, Group_ID == 'Control' ) ) +
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAverageTotalPowerTransfer_Propulsion, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Propulsion, na.rm = T ) )/14, dotsize = 0.5,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole', na.rm = T ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 3, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(0, 13, by = 1), limits = c(0, 13) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( limits = c( 'Hip', 'Knee', 'Ankle' ), labels = c( 'Ankle' = 'Foot to \n Shank','Knee' = 'Shank to \n Thigh','Hip' = 'Thigh to \n Pelvis' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='Joint Transfer Work Rate - Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Transfer Direction', y = ' Transfer Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Group_ID ), nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointTransferWorkRate_PropulsionPhase_2.3Hz_ATxvsControl.png', width = 6000, height = 6000, units = 'px' )

```


###### Average Joint Reaction Force
```{r Braking Phase X}



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'X' ),  ], aes(y = Mean_AverageJointReactionForce_BrakingPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
    

    
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'X' ),  ], aes( y = Mean_AverageJointReactionForce_BrakingPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y', dotsize = 5, inherit.aes = F, stroke = 2.5, na.rm = T, binpositions = 'all', stackgroups=T, stackratio = 0.8, binwidth= 1/50 ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-2.5, 1.5, by = 0.5), limits = c( -2.5, 1.5 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Reaction Force Across Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Reaction Force (N/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_XAxisAverageJointReactionForce_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Propulsion Phase X}



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'X' ),  ], aes(y = Mean_AverageJointReactionForce_PropulsionPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
    

    
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'X' ),  ], aes( y = Mean_AverageJointReactionForce_PropulsionPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y',, dotsize = 5, inherit.aes = F, stroke = 2.5, na.rm = T, binpositions = 'all', stackgroups=T, stackratio = 0.8, binwidth= 1/50 ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-2.5, 1.5, by = 0.5), limits = c( -2.5, 1.5 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Reaction Force Across Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Reaction Force (N/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_XAxisAverageJointReactionForce_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```







```{r Braking Phase Y}



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], aes(y = Mean_AverageJointReactionForce_BrakingPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
    
      #Arrow segment from 0 to max of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = 0.1, yend = 1.5 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow - for Y-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID == 'Y' ), label = 'Anterior Force', size = 10, x = 1.4, y = 1.25, color = 'black', fontface = 'bold' )+
    
    
    
      #Arrow segment from 0 to min of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = -0.1, yend = -2.5 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow - for Y-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID == 'Y' ), label = 'Posterior Force', size = 10, x = 1.4, y = -2.25, color = 'black', fontface = 'bold' )+
    
    
    
    

      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], aes( y = Mean_AverageJointReactionForce_BrakingPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y',, dotsize = 5, inherit.aes = F, stroke = 2.5, na.rm = T, binpositions = 'all', stackgroups=T, stackratio = 0.8, binwidth= 1/50 ) +
    
    
      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-2.5, 1.5, by = 0.5), limits = c( -2.5, 1.5 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Reaction Force Across Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Reaction Force (N/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_YAxisAverageJointReactionForce_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Propulsion Phase Y}



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], aes(y = Mean_AverageJointReactionForce_PropulsionPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
    
      #Arrow segment from 0 to max of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = 0.1, yend = 1.5 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow - for Y-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID == 'Y' ), label = 'Anterior Force', size = 10, x = 1.4, y = 1.25, color = 'black', fontface = 'bold' )+
    
    
    
      #Arrow segment from 0 to min of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = -0.1, yend = -2.5 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow - for Y-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID == 'Y' ), label = 'Posterior Force', size = 10, x = 1.4, y = -2.25, color = 'black', fontface = 'bold' )+
    
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], aes( y = Mean_AverageJointReactionForce_PropulsionPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y',, dotsize = 5, inherit.aes = F, stroke = 2.5, na.rm = T, binpositions = 'all', stackgroups=T, stackratio = 0.8, binwidth= 1/50 ) +
      
    
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 
    
    


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-2.5, 1.5, by = 0.5), limits = c( -2.5, 1.5 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Reaction Force Across Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Reaction Force (N/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_YAxisAverageJointReactionForce_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```








```{r Braking Phase Z}



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], aes(y = Mean_AverageJointReactionForce_BrakingPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
    
      #Arrow segment from 0 to max of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = 0.1, yend = 1.5 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow - for Z-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID == 'Z' ), label = 'Compression Force', size = 10, x = 1.6, y = 1.25, color = 'black', fontface = 'bold' )+
    
    
    
      #Arrow segment from 0 to min of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = -0.1, yend = -2.5 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow - for Z-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID == 'Z' ), label = 'Distraction Force', size = 10, x = 1.5, y = -2.25, color = 'black', fontface = 'bold' )+
    
    
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], aes( y = Mean_AverageJointReactionForce_BrakingPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y',, dotsize = 5, inherit.aes = F, stroke = 2.5, na.rm = T, binpositions = 'all', stackgroups=T, stackratio = 0.8, binwidth= 1/50 ) +
    
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 
    
    
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-2.5, 1.5, by = 0.5), limits = c( -2.5, 1.5 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Reaction Force Across Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Reaction Force (N/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_ZAxisAverageJointReactionForce_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```



```{r Propulsion Phase Z}



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], aes(y = Mean_AverageJointReactionForce_PropulsionPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
    
      #Arrow segment from 0 to max of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = 0.1, yend = 1.5 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow - for Z-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID == 'Z' ), label = 'Compression Force', size = 10, x = 1.6, y = 1.25, color = 'black', fontface = 'bold' )+
    
    
    
      #Arrow segment from 0 to min of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = -0.1, yend = -2.5 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow - for Z-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID == 'Z' ), label = 'Distraction Force', size = 10, x = 1.5, y = -2.25, color = 'black', fontface = 'bold' )+
    
    
    
    

      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], aes( y = Mean_AverageJointReactionForce_PropulsionPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', stackdir = 'centerwhole' , binaxis = 'y',, dotsize = 5, inherit.aes = F, stroke = 2.5, na.rm = T, binpositions = 'all', stackgroups=T, stackratio = 0.8, binwidth= 1/50 ) +
      

    
      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 
    
    
    

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-2.5, 1.5, by = 0.5), limits = c( -2.5, 1.5 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Reaction Force Across Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Reaction Force (N/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_ZAxisAverageJointReactionForce_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```


###### Average Joint Linear Velocity
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'X' ),  ], aes(y = Mean_AverageJointLinearVel_BrakingPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
 
    

      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'X' ),  ], aes( y = Mean_AverageJointLinearVel_BrakingPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', 
                    binwidth = diff(range( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_AverageJointLinearVel_BrakingPhase[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'X' ) ] ) )/9, dotsize = 1.25,
                    inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
    
    
      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -0.12, 0.12, by = 0.02 ), limits = c( -0.12, 0.12 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Linear Velocity - Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Linear Velocity (m/s) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars(Group_ID ), nrow = 1 )
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_XAxisAverageJointLinearVelocity_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'X' ),  ], aes(y = Mean_AverageJointLinearVel_PropulsionPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
 
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'X' ),  ], aes( y = Mean_AverageJointLinearVel_PropulsionPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', 
                    binwidth = diff(range( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_AverageJointLinearVel_PropulsionPhase[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'X' ) ] ) )/9, dotsize = 1.25,
                    inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      


      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -0.12, 0.12, by = 0.02 ), limits = c( -0.12, 0.12 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Linear Velocity - Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Linear Velocity (m/s) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_XAxisAverageJointLinearVelocity_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```






```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], aes(y = Mean_AverageJointLinearVel_BrakingPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
    
      #Arrow segment from 0 to max of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = 0.005, yend = 0.12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow - for Y-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID == 'Y' ), label = 'Anterior', size = 10, x = 1, y = 0.11, color = 'black', fontface = 'bold' )+
    
    
    
      #Arrow segment from 0 to min of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = -0.005, yend = -0.12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow - for Y-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID == 'Y' ), label = 'Posterior', size = 10, x = 1, y = -0.11, color = 'black', fontface = 'bold' )+
    
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], aes( y = Mean_AverageJointLinearVel_BrakingPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_AverageJointLinearVel_BrakingPhase[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ) ] ) )/12, dotsize = 0.45,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -0.12, 0.12, by = 0.02 ), limits = c( -0.12, 0.12 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Linear Velocity - Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Linear Velocity (m/s) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_YAxisAverageJointLinearVelocity_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], aes(y = Mean_AverageJointLinearVel_PropulsionPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
    
      #Arrow segment from 0 to max of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = 0.005, yend = 0.12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow - for Y-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID == 'Y' ), label = 'Anterior', size = 10, x = 1, y = 0.11, color = 'black', fontface = 'bold' )+
    
    
    
      #Arrow segment from 0 to min of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = -0.005, yend = -0.12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow - for Y-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], Axis_ID == 'Y' ), label = 'Posterior', size = 10, x = 1, y = -0.11, color = 'black', fontface = 'bold' )+
    
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ),  ], aes( y = Mean_AverageJointLinearVel_PropulsionPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_AverageJointLinearVel_BrakingPhase[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Y' ) ] ) )/26, dotsize = 1.25,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      

    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -0.12, 0.12, by = 0.02 ), limits = c( -0.12, 0.12 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Linear Velocity - Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Linear Velocity (m/s) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_YAxisAverageJointLinearVelocity_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], aes(y = Mean_AverageJointLinearVel_BrakingPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
    
      #Arrow segment from 0 to max of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = 0.005, yend = 0.12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow - for Z-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID == 'Z' ), label = 'Superior', size = 10, x = 1, y = 0.11, color = 'black', fontface = 'bold' )+
    
    
    
      #Arrow segment from 0 to min of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = -0.005, yend = -0.12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow - for Z-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID == 'Z' ), label = 'Inferior', size = 10, x = 1, y = -0.11, color = 'black', fontface = 'bold' )+
    
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], aes( y = Mean_AverageJointLinearVel_BrakingPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_AverageJointLinearVel_BrakingPhase[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ) ] ) )/20, dotsize = 1.25,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      

    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 
    

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -0.12, 0.12, by = 0.02 ), limits = c( -0.12, 0.12 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Linear Velocity - Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Linear Velocity (m/s) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_ZAxisAverageJointLinearVelocity_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```




```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], aes(y = Mean_AverageJointLinearVel_PropulsionPhase, x = Joint_ID ) ) +
      
      #Create a horizontal line at 0 to divide compression vs distraction force
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
      
    
    
      #Arrow segment from 0 to max of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = 0.005, yend = 0.12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow - for Z-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID == 'Z' ), label = 'Superior', size = 10, x = 1, y = 0.11, color = 'black', fontface = 'bold' )+
    
    
    
      #Arrow segment from 0 to min of y-axis - for Y-axis and Z-axis data
   geom_segment( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID != 'X' ), aes( x = 0.5, xend = 0.5, y = -0.005, yend = -0.12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow - for Z-axis data
      geom_text( data = subset( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], Axis_ID == 'Z' ), label = 'Inferior', size = 10, x = 1, y = -0.11, color = 'black', fontface = 'bold' )+
    
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ),  ], aes( y = Mean_AverageJointLinearVel_PropulsionPhase, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_ID, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_AverageJointLinearVel_BrakingPhase[ which( JointReactionForceandLinearVel_ParticipantMeans_1LimbPer3Groups_2.3Hz$Axis_ID == 'Z' ) ] ) )/20, dotsize = 1.25,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      

    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID, Group_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 
    

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( -0.12, 0.12, by = 0.02 ), limits = c( -0.12, 0.12 ) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle'='Ankle', 'Knee' = 'Knee', 'Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Joint Linear Velocity - Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Joint ID', y = ' Joint Linear Velocity (m/s) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars( Group_ID ), nrow = 1 )
   
)


ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_ZAxisAverageJointLinearVelocity_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 5500, height = 5500, units = 'px' )

```


##### Regressions


###### Ankle Power Contribution vs Thigh Work Rate
```{r Braking Phase }


AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID,

Group_ID = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_ID_NotFactored,

Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,

Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized,

Mean_SegmentAverageEnergy_Braking = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking )


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_ID ), color = 'black', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_ID, color = Group_ID ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c(
                                 'Control' = '#4d9221' ,
                         'ATx' = '#c51b7d' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221',
                                 'ATx' = '#c51b7d'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-4, 6, by = 1), limits = c(-4, 6) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21, 'ATx' = 23 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control', 'ATx' = 'ATx' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Thigh Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Average Thigh Power (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d', 'Control' = '#4d9221'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) + 
      
      facet_wrap( vars(Group_ID), nrow = 1 )
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsAverageThighPower_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5750, height = 5750, units = 'px' )

```






###### Ankle Power Contribution vs Thigh Braking Phase Transfer Work Rate
```{r Braking Phase }

AnkleContributionvsAverageThighTransferPower_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID,

Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,

Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID,

Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized,

Mean_SegmentAverageEnergy_Braking = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking )


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageThighTransferPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_ID ), color = 'black', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_ID, color = Group_ID ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID, group = Group_ID ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c(
                                 'Control' = '#4d9221' ,
                         'ATx' = '#c51b7d' ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221',
                                 'ATx' = '#c51b7d'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-4, 6, by = 1), limits = c(-4, 6) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21, 'ATx' = 23 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control', 'ATx' = 'ATx' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Thigh Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Average Thigh Power (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d', 'Control' = '#4d9221'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) + 
      
      facet_wrap( vars(Group_ID), nrow = 1 )
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsAverageThighPower_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 5750, height = 5750, units = 'px' )

```


###### Average Active Power
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAverageActivePower_forSegment_Braking, x = Segment_ID_Name ) ) +
      
      #Create a horizontal line at 0 to divide power absorption and generation
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
    
    #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 2.5, y = 13.75, fontface = 'bold' ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 2.5, y = 13, fontface = 'bold' ) +
      #Hip
      geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 2.5, y = 12.3, fontface = 'bold' ) +
      
    
    
      #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = 0.1, yend = 12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow
      geom_text( label = 'Generation', size = 10, x = 1.4, y = 11.5, color = 'black', fontface = 'bold' )+
    
      #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = -0.1, yend = -12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow
      geom_text( label = 'Absorption', size = 10, x = 1.4, y = -11.5, color = 'black', fontface = 'bold' )+
    
    
    
    

      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAverageActivePower_forSegment_Braking, x = Segment_ID_Name, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Segment_ID_Name, Group_by_Morphology, Participant_ID, Joint_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all', binwidth = diff(range( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_JointAverageActivePower_forSegment_Braking, na.rm = T ) )/8.5, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      

    
    
      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 
    
    

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-14, 14, by = 2), limits = c(-14, 14) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Segment_ID_Name is a categorical variable
      scale_x_discrete( labels = c( 'Foot'='Foot', 'Shank' = 'Shank', 'Thigh' = 'Thigh', 'Pelvis' = 'Pelvis' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Active Power To Segments Across Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Group_ID) , nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAverageActivePowerToSegment_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 6000, height = 6000, units = 'px' )

```




```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAverageActivePower_forSegment_Propulsion, x = Segment_ID_Name ) ) +
      
      #Create a horizontal line at 0 to divide power absorption and generation
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
    
    #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 2.5, y = 13.75, fontface = 'bold' ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 2.5, y = 13, fontface = 'bold' ) +
      #Hip
      geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 2.5, y = 12.3, fontface = 'bold' ) +
      
    
    
      #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = 0.1, yend = 12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow
      geom_text( label = 'Generation', size = 10, x = 1.4, y = 11.5, color = 'black', fontface = 'bold' )+
    
      #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = -0.1, yend = -12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow
      geom_text( label = 'Absorption', size = 10, x = 1.4, y = -11.5, color = 'black', fontface = 'bold' )+
    
    
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAverageActivePower_forSegment_Propulsion, x = Segment_ID_Name, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Segment_ID_Name, Group_by_Morphology, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_JointAverageActivePower_forSegment_Propulsion, na.rm = T ) )/48, dotsize = 1,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-14, 14, by = 2), limits = c(-14, 14) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Segment_ID_Name is a categorical variable
      scale_x_discrete( labels = c( 'Foot'='Foot', 'Shank' = 'Shank', 'Thigh' = 'Thigh', 'Pelvis' = 'Pelvis' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Active Power To Segments Across Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Group_ID) , nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAverageActivePowerToSegment_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 6000, height = 6000, units = 'px' )

```




###### Average Passive Power
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAveragePassivePower_forSegment_Braking, x = Segment_ID_Name ) ) +
      
      #Create a horizontal line at 0 to divide power absorption and generation
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
    
    #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 2.5, y = 13.75, fontface = 'bold' ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 2.5, y = 13, fontface = 'bold' ) +
      #Hip
      geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 2.5, y = 12.3, fontface = 'bold' ) +
      
    
    
      #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = 0.1, yend = 12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow
      geom_text( label = 'Generation', size = 10, x = 1.4, y = 11.5, color = 'black', fontface = 'bold' )+
    
      #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = -0.1, yend = -12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow
      geom_text( label = 'Absorption', size = 10, x = 1.4, y = -11.5, color = 'black', fontface = 'bold' )+
    
    
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAveragePassivePower_forSegment_Braking, x = Segment_ID_Name, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Segment_ID_Name, Group_by_Morphology, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_JointAveragePassivePower_forSegment_Braking, na.rm = T ) )/48, dotsize = 1,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-14, 14, by = 2), limits = c(-14, 14) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Segment_ID_Name is a categorical variable
      scale_x_discrete( labels = c( 'Foot'='Foot', 'Shank' = 'Shank', 'Thigh' = 'Thigh', 'Pelvis' = 'Pelvis' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Passive Power To Segments Across Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Group_ID) , nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAveragePassivePowerToSegment_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 6000, height = 6000, units = 'px' )

```




```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAveragePassivePower_forSegment_Propulsion, x = Segment_ID_Name ) ) +
      
      #Create a horizontal line at 0 to divide power absorption and generation
      geom_hline( yintercept = 0, linewidth = 1.5, color = 'black' ) +
      
    
    #Add color-coded data labels
      #Ankle
      geom_text( label = 'Ankle', size = 12, color = '#1b9e77', x = 2.5, y = 13.75, fontface = 'bold' ) +
      #Knee
      geom_text( label = 'Knee', size = 12, color = '#7570b3', x = 2.5, y = 13, fontface = 'bold' ) +
      #Hip
      geom_text( label = 'Hip', size = 12, color = '#d95f02', x = 2.5, y = 12.3, fontface = 'bold' ) +
      
    
    
      #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = 0.1, yend = 12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for upward arrow
      geom_text( label = 'Generation', size = 10, x = 1.4, y = 11.5, color = 'black', fontface = 'bold' )+
    
      #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.5, xend = 0.5, y = -0.1, yend = -12 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
    #Create label for downward arrow
      geom_text( label = 'Absorption', size = 10, x = 1.4, y = -11.5, color = 'black', fontface = 'bold' )+
    
    
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAveragePassivePower_forSegment_Propulsion, x = Segment_ID_Name, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Segment_ID_Name, Group_by_Morphology, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_JointAveragePassivePower_forSegment_Propulsion ) )/32, dotsize = 1,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole' ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(-14, 14, by = 2), limits = c(-14, 14) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Segment_ID_Name is a categorical variable
      scale_x_discrete( labels = c( 'Foot'='Foot', 'Shank' = 'Shank', 'Thigh' = 'Thigh', 'Pelvis' = 'Pelvis' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Passive Power To Segments Across Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Group_ID) , nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAveragePassivePowerToSegment_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 6000, height = 6000, units = 'px' )

```



###### Average Total Energy Transfer
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAverageTotalPowerTransfer_Braking, x = Joint_ID ) ) +
    
      
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAverageTotalPowerTransfer_Braking, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_by_Morphology, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Braking, na.rm = T ) )/22, dotsize = 0.75, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole', na.rm = T ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(0, 13, by = 1), limits = c(0, 13) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle' = 'Ankle','Knee' = 'Knee','Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Total Joint Energy Transfer Across Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Group_ID) , nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAverageTotalEnergyTransfer_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 6000, height = 6000, units = 'px' )

```




```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAveragePassivePower_forSegment_Propulsion, x = Joint_ID ) ) +
      
      
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAverageTotalPowerTransfer_Propulsion, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_by_Morphology, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_JointAverageTotalPowerTransfer_Propulsion, na.rm = T ) )/14, dotsize = 0.75,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole', na.rm = T ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 2, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(0, 13, by = 1), limits = c(0, 13) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( labels = c( 'Ankle' = 'Ankle','Knee' = 'Knee','Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Total Joint Energy Transfer Across Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Group_ID) , nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointAverageTotalEnergyTransfer_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 6000, height = 6000, units = 'px' )

```

###### Average Active Energy Transfer
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAverageActivePowerTransfer_Braking, x = Joint_ID ) ) +
    
      
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAverageActivePowerTransfer_Braking, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_by_Morphology, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_JointAverageActivePowerTransfer_Braking, na.rm = T ) )/22, dotsize = 0.45, inherit.aes = F, stackgroups = T, stackdir = 'centerwhole', na.rm = T ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 3, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(0, 0.2, by = 0.02), limits = c(0, 0.2) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( limits = c('Ankle', 'Knee', 'Hip'), labels = c( 'Ankle' = 'Ankle','Knee' = 'Knee','Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Joint Active Transfer Work Rate - Braking Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Active Transfer Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Group_ID) , nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointActiveTransferWorkRate_BrakingPhase_2.3Hz_1LimbPer2Groups.png', width = 6000, height = 6000, units = 'px' )

```




```{r Propulsion Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes(y = Mean_JointAverageActivePowerTransfer_Propulsion, x = Joint_ID ) ) +
      
      
    
    
      
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_dotplot( data = EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz, aes( y = Mean_JointAverageActivePowerTransfer_Propulsion, x = Joint_ID, fill = Participant_ID, alpha = Participant_ID, group = interaction(  Joint_ID, Group_by_Morphology, Participant_ID ) ), color = 'black', binaxis = 'y', binpositions = 'all',                      binwidth = diff(range( EnergyFlow_ParticipantMeans_1LimbPer3Groups_2.3Hz$Mean_JointAverageActivePowerTransfer_Propulsion, na.rm = T ) )/14, dotsize = 0.45,                     inherit.aes = F, stackgroups = T, stackdir = 'centerwhole', na.rm = T ) +
      
    
    

      #Create crossbar containing estimated group mean and 95% confidence interval for group mean
      stat_summary( fun.data = 'mean_cl_boot'  ,
                    geom="crossbar", width=0.5, aes( group = interaction( Joint_ID ), color = Joint_ID ), linewidth = 3, show.legend = F, na.rm = T  )+ 


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Foot' = met.brewer('Ingres')[1], 'Shank' = met.brewer('Ingres')[2], 'Thigh' = met.brewer('Ingres')[7], 'Pelvis' = met.brewer('Ingres')[8],
                                    'Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Joint ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq(0, 13, by = 1), limits = c(0, 13) )+
      
      #Specify the labels for the x-axis. Use scale_x_discrete because Joint_ID is a categorical variable
      scale_x_discrete( limits = c('Ankle', 'Knee', 'Hip'), labels = c( 'Ankle' = 'Ankle','Knee' = 'Knee','Hip' = 'Hip' ) )+
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Joint Active Transfer Work Rate - Propulsion Phase \n Participant/Group Means for Involved/Matched Limb \n 2.3 Hz Hopping ', x='Segment ID', y = ' Active Transfer Work Rate (W/kg) ' ) +
      
      #Remove all legends
      guides( color='none',size='none', fill = 'none', alpha = 'none' )+
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            #Adjust the color of the boxes around each symbol in the legend
            legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  )  +
      
      facet_wrap( vars( Group_ID) , nrow = 1, scales = 'free_x' )
   
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_JointActiveTransferWorkRate_PropulsionPhase_2.3Hz_1LimbPer2Groups.png', width = 6000, height = 6000, units = 'px' )

```



#### Regressions



###### vs VAS


```{r % Absorption MEE }



(Power1 <- ggplot(data = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz, aes( y = Mean_Joint_Percent_MEE_Absorption, x = Mean_VAS_Rating  ) ) +
      

    geom_vline( data = NULL, xintercept = mean( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_VAS_Rating), color = '#1b9e77', linetype = 'dashed', linewidth = 1.5  ) +

    
    geom_hline( data = NULL, yintercept = mean( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Percent_MEE_Absorption), color = '#1b9e77', linetype = 'dashed', linewidth = 1.5  ) +
 
    
    
#Arrow segment from 0 to max of x-axis.
   geom_segment( aes( y = mean( EnergyFlow_ParticipantMeans_Control_MatchedDominanceAnkle_2.3Hz$Mean_Joint_Percent_MEE_Absorption) + 0.01, yend = 1, x = 0.042, xend = 0.04 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 ), color = '#7570b3'  ) +
   
#Text explaining purpose of above arrow   
   geom_text( label = 'Greater than Control Mean', size = 11, x =0.09 , y = 0.9, color = '#7570b3' , fontface = 'bold') +
   
   
   
    
    geom_smooth( data = EnergyFlow_ParticipantMeans_ATx_2.3Hz_AnkleOnly, aes( y = Mean_Joint_Percent_MEE_Absorption, x = Mean_VAS_Rating, color = Limb_ID, group = interaction( Group_by_Tendinopathy_Type, Limb_ID ) ), formula = y ~ x, linewidth = 1.5, na.rm = T, method = 'lm', se = F ) +
 
 
    geom_point( data = EnergyFlow_ParticipantMeans_3Limbs_Ankle_2.3Hz, aes( fill = Limb_ID, group = interaction( Group_by_Tendinopathy_Type, Limb_ID), shape = Group_by_Tendinopathy_Type ), color = 'black', size = 10, stroke = 2 ) +
   

    
    # geom_point( data = EnergyFlow_BetweenLimbDiff_3Limbs_Ankle_2.3Hz, aes( fill = Group_ID, group = Participant_ID , shape = Group_by_Tendinopathy_Type ), color = 'white', stroke = 2, size= 10*RobustLM_MEEAbsorptionRatiovsVAS$rweights ) +


    
 
    
    # geom_abline( intercept = RobustLM_MEEAbsorptionRatiovsVAS$coefficients[ 1 ],
    #              slope = RobustLM_MEEAbsorptionRatiovsVAS$coefficients[ 2 ],
    #              color = 'white', linewidth = 3, alpha = 0.5 ) +
    # 
    # geom_abline( intercept = RobustLM_MEEAbsorptionRatiovsVAS$coefficients[ 1 ],
    #              slope = RobustLM_MEEAbsorptionRatiovsVAS$coefficients[ 2 ],
    #              color = '#d95f02', linewidth = 2, alpha = 0.5 ) +
      
    
    
    
    
    geom_text( label = 'Involved Limb', color = '#c51b7d', size = 10, x = 3.25, y = 0.9 ) + 
    
    geom_text( label = 'Non-Involved Limb', color = '#7fbc41', size = 10, x = 3.25, y = 0.86 ) + 
      
    geom_text( label = 'Control Limb', color = '#4d9221', size = 10, x = 3.25, y = 0.82 ) + 
    
    
    
    
   
   
   
   
   
#Arrow segment from 1 to min of y-axis   
   geom_segment( aes( x = -6.5, xend = -6.5, y = 0.98, yend = 0 ), linewidth = 2.5, arrow=arrow(length=unit(5,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
   
#Text explaining purpose of above arrow   
   geom_text( label = 'Less than Control', size = 9, x = -3.5, y = 0.25 ) +
      

   
   
   
   
      scale_fill_manual(values = c('ATx' = '#d95f02', 'Control' = '#1b9e77', 'Ankle' = '#1b9e77','Knee' = '#7570b3','Hip' = '#d95f02','Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221',
                                    'ATx07'=met.brewer('Renoir')[1], 
                                    'ATx08' = met.brewer('Renoir')[2],
                                    'ATx10'=met.brewer('Renoir')[3], 
                                    'ATx12'=met.brewer('Renoir')[4],
                                    'ATx17'=met.brewer('Renoir')[5],
                                    'ATx18'=met.brewer('Renoir')[6],
                                    'ATx19'=met.brewer('Renoir')[7],
                                    'ATx21'=met.brewer('Renoir')[8],
                                    'ATx24'=met.brewer('Renoir')[9],
                                    'ATx25'=met.brewer('Renoir')[10],
                                    'ATx27'=met.brewer('Renoir')[11],
                                    'ATx34'=met.brewer('Renoir')[12],
                                    'HC01'=met.brewer('Renoir')[1], 
                                    'HC19' = met.brewer('Renoir')[2],
                                    'HC12'=met.brewer('Renoir')[3], 
                                    'HC05'=met.brewer('Renoir')[4],
                                    'HC06'=met.brewer('Renoir')[5],
                                    'HC08'=met.brewer('Renoir')[6],
                                    'HC20'=met.brewer('Renoir')[7],
                                    'HC11'=met.brewer('Renoir')[8],
                                    'HC17'=met.brewer('Renoir')[9],
                                    'HC21'=met.brewer('Renoir')[11] ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC19', 'HC20', 'HC21' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      

   
   scale_color_manual(values = c( 'ATx' = '#d95f02', 'Control' = '#1b9e77','Involved' = '#c51b7d', 
'Non-Involved' = '#7fbc41',
'Matched Dominance' = '#4d9221' ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
    
      
      
      scale_y_continuous(breaks = seq( 0, 1, by = 0.1 ), limits = c(0, 1) )+
    
    
      scale_x_continuous( breaks = seq( 0, 7, by = 0.5 ), limits = c( 0, 7 ) )+
   
   
   scale_shape_manual( values = c( 'Unilateral' = 21, 'Bilateral' = 22, 'Control' = 23 ), labels = c('Unilateral ATx', 'Bilateral ATx', 'Control ATx') ) +
    
      
      labs(title=' Ankle Contribution to Whole-Limb MEE Absorption vs \n Visual Analog Score - 2.3 Hz Hopping', x='VAS (out of 10)', y = ' Mechanical Energy Expenditure Contribution ( max = 1 ) ' ) +
      
      
      guides(color='none',size='none',fill = 'none', alpha = 'none', shape = guide_legend( title = 'Limb ID', nrow = 1, override.aes = list( fill = 'black' ) ) )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) 
 
)




```



###### 2.3 Hz

###### Ankle Work Rate vs Thigh Net Absorption Work Rate
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleWorkRatevsFootShankThighWorkRate_ParticipantMeans_2.3Hz_1LimbPer3Groups, aes(y = Mean_AnkleWorkRate_GenerationNeutralized, x = Mean_ThighAverageEnergy_Braking ) ) +
   
    
    
    geom_text( label = expression( 'ATx Ankle Absorption Work Rate = -3.52* + 0.34' %*% 'Thigh Net Work Rate*') , parse = T, size = 13, x = 2, y = 0.6, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold' ) +
    
    geom_text( label = expression( 'Control Ankle Absorption Work Rate = -3.95 + 0.38' %*% 'Thigh Net Work Rate' ), parse = T, size = 13, x = 2, y = 0.1, color = '#4d9221', nudge_y = -0.25, fontface = 'bold' ) +
   
    
#Regression line for ATx07
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[1,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[1,2], linewidth = 0.75, colour = met.brewer('OKeeffe1')[1] ) +
   
   
    
#Regression line for ATx08
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[2,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[2,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[2] ) +
   
   
    
#Regression line for ATx10
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[3,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[3,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[3] ) +
   
   
    
#Regression line for ATx12
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[4,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[4,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[4] ) + 
   
   
    
#Regression line for ATx17
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[5,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[5,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 5 ] ) +    
   
   
    
#Regression line for ATx18
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[6,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[6,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 6 ] ) + 
   
   
    
#Regression line for ATx19
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[7,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[7,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 7 ] ) + 
   
   
    
#Regression line for ATx21
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[8,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[8,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 8 ] ) + 
   
   
    
#Regression line for ATx24
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[9,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[9,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 9 ] ) + 
   
   
    
#Regression line for ATx25
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[10,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[10,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 10 ] ) + 
   
   
    
#Regression line for ATx27
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[11,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[11,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 11 ] ) + 
   
   
    
#Regression line for ATx34
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[12,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[12,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 12 ] ) + 
   
   
    
#Regression line for ATx36
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[13,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[13,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 1 ] ) + 
   
   
    
#Regression line for ATx38
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[14,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[14,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 2 ] ) + 
   
   
    
#Regression line for ATx41
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[15,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[15,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 3 ] ) + 
   
   
    
#Regression line for ATx44
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[16,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[16,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 4 ] ) + 
   
   
    
#Regression line for ATx49
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[17,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[17,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 5 ] ) + 
   
   
    
#Regression line for ATx50
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[18,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[18,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 6 ] ) + 
   
   
    
#Regression line for HC01
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[19,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[19,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 1 ] ) + 
   
   
    
#Regression line for HC05
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[20,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[20,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 4 ] ) +
   
   
    
#Regression line for HC06
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[21,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[21,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 5 ] ) +
   
   
    
#Regression line for HC11
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[22,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[22,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[8]  ) +
   
   
    
#Regression line for HC12
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[23,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[23,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 3 ] ) +
   
   
    
#Regression line for HC17
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[24,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[24,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 9 ] ) +
   
   
    
#Regression line for HC18
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[25,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[25,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 12 ] ) +
   
   
    
#Regression line for HC19
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[26,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[26,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 2 ] ) +
   
   
    
#Regression line for HC20
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[27,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[27,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 7 ] ) +
   
   
    
#Regression line for HC21
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[28,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[28,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 11 ] ) +
   
   
    
#Regression line for HC25
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[29,1], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )$Participant_ID[29,2], linewidth = 0.75, color = met.brewer('OKeeffe1')[ 12 ] ) +
    
    
    
   #Regression line for Control Group
      geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for Control Group
      geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ]+ fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 3 ], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 4 ], linewidth = 9, color = '#4d9221' ) +
    
    
    
    #Regression line for ATx Group
      geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for ATx Group
      geom_abline( intercept = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 1 ], slope = fixef( RMME_AnkleWorkRatevsThighAbsorptionWorkRate_Braking_BothEffects )[ 2 ], linewidth = 9, color = '#c51b7d' ) +
   
   

   

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID ), color = 'white', size = 13, stroke = 2, na.rm = T ) +
      

      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', "ATx07"=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ,
                                 'ATx' = '#c51b7d' ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('color') ) +
    
   
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ,
                                 'ATx' = '#c51b7d' ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq(-1, 5, by = 0.5), limits = c(-1, 5) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( -8, 0, by = 1 ), limits =  c( -8, 1 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23,  'Control' = 21 ), labels = c( 'ATx' = 'ATx', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Absorption Work Rate vs Thigh Net Work Rate \n 2.3 Hz Hopping - Braking Phase ', x='Thigh Net Work Rate (W/kg)', y = ' Ankle Absorption Work Rate (W/kg) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d', 'Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 42,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 27,lineheight=100),
            legend.title = element_text(size = 27),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the background color for the entire legend
            legend.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionWorkRatevsThighNetWorkRate_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```


###### Ankle Work Rate vs Thigh Average Total Power Transfer
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleWorkRatevsFootShankThighWorkRate_ParticipantMeans_2.3Hz_1LimbPer3Groups, aes(y = Mean_AnkleWorkRate_GenerationNeutralized, x = ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer ) ) +
   
    
    
    geom_text( label = expression( 'ATx Ankle Absorption Work Rate = -0.94* - 0.55' %*% 'Thigh Transfer*' ), parse = T, size = 13, x = 4, y = 0.6, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold' ) +
    
    geom_text( label = expression( 'Control Ankle Absorption Work Rate = -0.58 - 0.70' %*% 'Thigh Transfer*' ), parse = T, size = 13, x = 4, y = 0.1, color = '#4d9221', nudge_y = -0.25, fontface = 'bold' ) +
   
    
#Regression line for ATx07
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[1,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[1,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) +
   
   
    
#Regression line for ATx08
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[2,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[2,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) +
   
   
    
#Regression line for ATx10
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[3,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[3,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) +
   
   
    
#Regression line for ATx12
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[4,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[4,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[4] ) + 
   
   
    
#Regression line for ATx17
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[5,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[5,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) +    
   
   
    
#Regression line for ATx18
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[6,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[6,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 6 ] ) + 
   
   
    
#Regression line for ATx19
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[7,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[7,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 7 ] ) + 
   
   
    
#Regression line for ATx21
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[8,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[8,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 8 ] ) + 
   
   
    
#Regression line for ATx24
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[9,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[9,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 9 ] ) + 
   
   
    
#Regression line for ATx25
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[10,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[10,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 10 ] ) + 
   
   
    
#Regression line for ATx27
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[11,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[11,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 11 ] ) + 
   
   
    
#Regression line for ATx34
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[12,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[12,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) + 
   
   
    
#Regression line for ATx36
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[13,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[13,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) + 
   
   
    
#Regression line for ATx38
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[14,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[14,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) + 
   
   
    
#Regression line for ATx41
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[15,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[15,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) + 
   
   
    
#Regression line for ATx44
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[16,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[16,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 4 ] ) + 
   
   
    
#Regression line for ATx49
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[17,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[17,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) + 
   
   
    
#Regression line for ATx50
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[18,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[18,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 6 ] ) + 
   
   
    
#Regression line for HC01
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[19,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[19,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) + 
   
   
    
#Regression line for HC05
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[20,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[20,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 4 ] ) +
   
   
    
#Regression line for HC06
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[21,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[21,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) +
   
   
    
#Regression line for HC11
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[22,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[22,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 8 ] ) +
   
   
    
#Regression line for HC12
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[23,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[23,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) +
   
   
    
#Regression line for HC17
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[24,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[24,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 9 ] ) +
   
   
    
#Regression line for HC18
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[25,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[25,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) +
   
   
    
#Regression line for HC19
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[26,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[26,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) +
   
   
    
#Regression line for HC20
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[27,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[27,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 7 ] ) +
   
   
    
#Regression line for HC21
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[28,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[28,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 11 ] ) +
   
   
    
#Regression line for HC25
         geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[29,1], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[29,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) +
    
    
    
   #Regression line for Control Group
      geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for Control Group
      geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 3 ], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 4 ], linewidth = 9, color = '#4d9221' ) +
    
    
    
    #Regression line for ATx Group
      geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for ATx Group
      geom_abline( intercept = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 1 ], slope = fixef( RMME_AnkleWorkRatevsAverageThighTransferPower_Braking_BothEffects )[ 2 ], linewidth = 9, color = '#c51b7d' ) +
   
   

   

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID ), color = 'white', size = 10, stroke = 2, na.rm = T ) +
      

      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', "ATx07"=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ,
                                 'ATx' = '#c51b7d' ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('color') ) +
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ,
                                 'ATx' = '#c51b7d' ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq(0, 8, by = 1), limits = c(0, 8) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( -8, 0, by = 1 ), limits =  c( -8, 1 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23,  'Control' = 21 ), labels = c( 'ATx' = 'ATx', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Absorption Work Rate vs Thigh Distal Transfer Work Rate \n 2.3 Hz Hopping ', x='Thigh Transfer Work Rate (W/kg)', y = ' Ankle Absorption Work Rate (W/kg) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d', 'Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 42,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 27,lineheight=100),
            legend.title = element_text(size = 27),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the background color for the entire legend
            legend.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleAbsorptionWorkRatevsThighDistalPowerTransfer_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```


###### Foot Proximal Transfer Work Rate vs Thigh Distal Transfer Work Rate
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleWorkRatevsFootShankThighWorkRate_ParticipantMeans_2.3Hz_1LimbPer3Groups, aes(y = FootProxTransfer_Propulsion, x = ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer ) ) +
   
    
    
    geom_text( label = expression( 'ATx Foot Transfer Work Rate =  0.47* + 0.20' %*% 'Thigh Transfer Work Rate*' ), parse = T, size = 13, x = 4, y = 3.6, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold' ) +
    
    geom_text( label = expression( 'Control Foot Transfer Work Rate = 0.64 + 0.15' %*% 'Thigh Transfer Work Rate' ), parse = T, size = 13, x = 4, y = 3.1, color = '#4d9221', nudge_y = -0.25, fontface = 'bold' ) +
   
    
#Regression line for ATx07
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[1,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[1,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) +
   
   
    
#Regression line for ATx08
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[2,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[2,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) +
   
   
    
#Regression line for ATx10
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[3,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[3,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) +
   
   
    
#Regression line for ATx12
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[4,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[4,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[4] ) + 
   
   
    
#Regression line for ATx17
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[5,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[5,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) +    
   
   
    
#Regression line for ATx18
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[6,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[6,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 6 ] ) + 
   
   
    
#Regression line for ATx19
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[7,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[7,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 7 ] ) + 
   
   
    
#Regression line for ATx21
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[8,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[8,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 8 ] ) + 
   
   
    
#Regression line for ATx24
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[9,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[9,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 9 ] ) + 
   
   
    
#Regression line for ATx25
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[10,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[10,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 10 ] ) + 
   
   
    
#Regression line for ATx27
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[11,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[11,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 11 ] ) + 
   
   
    
#Regression line for ATx34
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[12,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[12,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) + 
   
   
    
#Regression line for ATx36
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[13,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[13,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) + 
   
   
    
#Regression line for ATx38
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[14,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[14,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) + 
   
   
    
#Regression line for ATx41
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[15,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[15,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) + 
   
   
    
#Regression line for ATx44
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[16,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[16,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 4 ] ) + 
   
   
    
#Regression line for ATx49
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[17,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[17,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) + 
   
   
    
#Regression line for ATx50
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[18,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[18,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 6 ] ) + 
   
   
    
#Regression line for HC01
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[19,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[19,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) + 
   
   
    
#Regression line for HC05
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[20,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[20,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 4 ] ) +
   
   
    
#Regression line for HC06
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[21,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[21,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) +
   
   
    
#Regression line for HC11
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[22,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[22,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 8 ] ) +
   
   
    
#Regression line for HC12
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[23,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[23,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) +
   
   
    
#Regression line for HC17
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[24,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[24,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 9 ] ) +
   
   
    
#Regression line for HC18
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[25,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[25,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) +
   
   
    
#Regression line for HC19
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[26,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[26,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) +
   
   
    
#Regression line for HC20
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[27,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[27,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 7 ] ) +
   
   
    
#Regression line for HC21
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[28,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[28,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 11 ] ) +
   
   
    
#Regression line for HC25
         geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[29,1], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[29,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) +
    
    
    
   #Regression line for Control Group
      geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for Control Group
      geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ], linewidth = 9, color = '#4d9221' ) +
    
    
    
    #Regression line for ATx Group
      geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for ATx Group
      geom_abline( intercept = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ], slope = fixef( RMME_FootProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ], linewidth = 9, color = '#c51b7d' ) +
   
   

   

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID ), color = 'white', size = 10, stroke = 2, na.rm = T ) +
      

      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', "ATx07"=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ,
                                 'ATx' = '#c51b7d' ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('color') ) +
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ,
                                 'ATx' = '#c51b7d' ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq(0, 8, by = 1), limits = c(0, 8) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 8, by = 1 ), limits =  c( 0, 8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23,  'Control' = 21 ), labels = c( 'ATx' = 'ATx', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Foot Proximal Transfer Work Rate vs Thigh Distal Transfer Work Rate \n 2.3 Hz Hopping ', x='Thigh Distal Transfer Work Rate (W/kg)', y = ' Foot Proximal Transfer Work Rate (W/kg) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d', 'Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 39,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 27,lineheight=100),
            legend.title = element_text(size = 27),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the background color for the entire legend
            legend.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_FootProximalTransferWorkRatevsThighDistalTransferWorkRate_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```



###### Shank Average Net Work vs Ankle Average Absorption Work
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleWorkRatevsFootShankThighWorkRate_ParticipantMeans_2.3Hz_1LimbPer3Groups, aes(y = Mean_ShankAverageEnergy_Braking, x = Mean_AnkleWorkRate_GenerationNeutralized ) ) +
   
    
    
    geom_text( label = expression( 'ATx Average Shank Work  =  -2.85* - 0.83' %*% 'Average Ankle Absorption Work*' ), parse = T, size = 13, x = 4, y = 7.6, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold' ) +
    
    geom_text( label = expression( 'Control Average Shank Work = -2.42 - 0.69' %*% 'Average Ankle Absorption Work' ), parse = T, size = 13, x = 4, y = 7.1, color = '#4d9221', nudge_y = -0.25, fontface = 'bold' ) +
   
    
# #Regression line for ATx07
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[1,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[1,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) +
#    
#    
#     
# #Regression line for ATx08
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[2,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[2,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) +
#    
#    
#     
# #Regression line for ATx10
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[3,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[3,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) +
#    
#    
#     
# #Regression line for ATx12
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[4,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[4,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[4] ) + 
#    
#    
#     
# #Regression line for ATx17
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[5,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[5,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) +    
#    
#    
#     
# #Regression line for ATx18
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[6,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[6,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 6 ] ) + 
#    
#    
#     
# #Regression line for ATx19
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[7,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[7,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 7 ] ) + 
#    
#    
#     
# #Regression line for ATx21
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[8,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[8,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 8 ] ) + 
#    
#    
#     
# #Regression line for ATx24
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[9,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[9,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 9 ] ) + 
#    
#    
#     
# #Regression line for ATx25
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[10,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[10,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 10 ] ) + 
#    
#    
#     
# #Regression line for ATx27
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[11,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[11,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 11 ] ) + 
#    
#    
#     
# #Regression line for ATx34
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[12,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[12,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) + 
#    
#    
#     
# #Regression line for ATx36
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[13,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[13,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) + 
#    
#    
#     
# #Regression line for ATx38
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[14,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[14,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) + 
#    
#    
#     
# #Regression line for ATx41
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[15,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[15,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) + 
#    
#    
#     
# #Regression line for ATx44
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[16,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[16,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 4 ] ) + 
#    
#    
#     
# #Regression line for ATx49
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[17,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[17,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) + 
#    
#    
#     
# #Regression line for ATx50
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[18,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[18,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 6 ] ) + 
#    
#    
#     
# #Regression line for HC01
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[19,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[19,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) + 
#    
#    
#     
# #Regression line for HC05
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[20,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[20,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 4 ] ) +
#    
#    
#     
# #Regression line for HC06
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[21,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[21,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) +
#    
#    
#     
# #Regression line for HC11
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[22,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[22,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 8 ] ) +
#    
#    
#     
# #Regression line for HC12
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[23,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[23,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) +
#    
#    
#     
# #Regression line for HC17
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[24,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[24,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 9 ] ) +
#    
#    
#     
# #Regression line for HC18
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[25,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[25,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) +
#    
#    
#     
# #Regression line for HC19
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[26,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[26,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) +
#    
#    
#     
# #Regression line for HC20
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[27,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[27,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 7 ] ) +
#    
#    
#     
# #Regression line for HC21
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[28,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[28,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 11 ] ) +
#    
#    
#     
# #Regression line for HC25
#          geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[29,1], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )$Participant_ID[29,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) +
    
    
    
   #Regression line for Control Group
      geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for Control Group
      geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ]+ fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 3 ], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 4 ], linewidth = 9, color = '#4d9221' ) +
    
    
    
    #Regression line for ATx Group
      geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for ATx Group
      geom_abline( intercept = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 1 ], slope = fixef( RMME_ShankNetWorkvsAnkleAbsorptionWork_Braking_BothEffects )[ 2 ], linewidth = 9, color = '#c51b7d' ) +
   
   

   

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID ), color = 'black', size = 10, stroke = 2, na.rm = T ) +
      

      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', "ATx07"=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ,
                                 'ATx' = '#c51b7d' ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('color') ) +
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ,
                                 'ATx' = '#c51b7d' ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq(-7, 0, by = 1), limits = c(-7, 0) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( -2, 2.5, by = 0.5 ), limits =  c( -2, 2.5 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23,  'Control' = 21 ), labels = c( 'ATx' = 'ATx', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Average Shank Work vs Average Ankle Absorption Work \n 2.3 Hz Hopping - Braking Phase ', x='Average Ankle Absorption Work (W/kg)', y = ' Average Shank Work (W/kg) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d', 'Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 38,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 27,lineheight=100),
            legend.title = element_text(size = 27),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the background color for the entire legend
            legend.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) +
   
   facet_wrap( vars(Group_ID) )
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AverageShankWorkvsAverageAnkleAbsorptionWork_2.3Hz_1LimbPer3Groups_GroupFacets.png', width = 5750, height = 5750, units = 'px' )

```


###### Shank Proximal Transfer Work Rate vs Thigh Distal Transfer Work Rate
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleWorkRatevsFootShankThighWorkRate_ParticipantMeans_2.3Hz_1LimbPer3Groups, aes(y = ShankProxTransfer_Propulsion, x = ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer ) ) +
   
    
    
    geom_text( label = expression( 'ATx Shank Transfer Work Rate =  1.71* + 0.49' %*% 'Thigh Transfer Work Rate*' ), parse = T, size = 13, x = 4, y = 7.6, color = '#c51b7d', nudge_y = -0.25, fontface = 'bold' ) +
    
    geom_text( label = expression( 'Control Shank Transfer Work Rate = 1.76 + 0.49' %*% 'Thigh Transfer Work Rate' ), parse = T, size = 13, x = 4, y = 7.1, color = '#4d9221', nudge_y = -0.25, fontface = 'bold' ) +
   
    
#Regression line for ATx07
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[1,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[1,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) +
   
   
    
#Regression line for ATx08
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[2,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[2,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) +
   
   
    
#Regression line for ATx10
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[3,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[3,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) +
   
   
    
#Regression line for ATx12
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[4,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[4,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[4] ) + 
   
   
    
#Regression line for ATx17
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[5,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[5,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) +    
   
   
    
#Regression line for ATx18
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[6,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[6,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 6 ] ) + 
   
   
    
#Regression line for ATx19
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[7,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[7,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 7 ] ) + 
   
   
    
#Regression line for ATx21
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[8,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[8,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 8 ] ) + 
   
   
    
#Regression line for ATx24
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[9,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[9,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 9 ] ) + 
   
   
    
#Regression line for ATx25
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[10,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[10,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 10 ] ) + 
   
   
    
#Regression line for ATx27
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[11,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[11,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 11 ] ) + 
   
   
    
#Regression line for ATx34
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[12,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[12,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) + 
   
   
    
#Regression line for ATx36
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[13,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[13,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) + 
   
   
    
#Regression line for ATx38
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[14,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[14,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) + 
   
   
    
#Regression line for ATx41
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[15,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[15,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) + 
   
   
    
#Regression line for ATx44
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[16,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[16,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 4 ] ) + 
   
   
    
#Regression line for ATx49
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[17,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[17,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) + 
   
   
    
#Regression line for ATx50
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[18,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[18,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 6 ] ) + 
   
   
    
#Regression line for HC01
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[19,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[19,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 1 ] ) + 
   
   
    
#Regression line for HC05
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[20,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[20,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 4 ] ) +
   
   
    
#Regression line for HC06
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[21,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[21,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 5 ] ) +
   
   
    
#Regression line for HC11
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[22,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[22,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 8 ] ) +
   
   
    
#Regression line for HC12
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[23,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[23,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 3 ] ) +
   
   
    
#Regression line for HC17
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[24,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[24,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 9 ] ) +
   
   
    
#Regression line for HC18
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[25,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[25,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) +
   
   
    
#Regression line for HC19
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[26,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[26,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 2 ] ) +
   
   
    
#Regression line for HC20
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[27,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[27,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 7 ] ) +
   
   
    
#Regression line for HC21
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[28,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[28,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 11 ] ) +
   
   
    
#Regression line for HC25
         geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[29,1], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )$Participant_ID[29,2], linewidth = 1.5, color = met.brewer('OKeeffe1')[ 12 ] ) +
    
    
    
   #Regression line for Control Group
      geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for Control Group
      geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 3 ], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 4 ], linewidth = 9, color = '#4d9221' ) +
    
    
    
    #Regression line for ATx Group
      geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for ATx Group
      geom_abline( intercept = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 1 ], slope = fixef( RMME_ShankProxTransferAverageThighTransferPower_Braking_BothEffects )[ 2 ], linewidth = 9, color = '#c51b7d' ) +
   
   

   

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_ID, fill = Participant_ID, alpha = Participant_ID ), color = 'white', size = 10, stroke = 2, na.rm = T ) +
      

      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', "ATx07"=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ,
                                 'ATx' = '#c51b7d' ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('color') ) +
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221' ,
                                 'ATx' = '#c51b7d' ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq(0, 8, by = 1), limits = c(0, 8) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 8, by = 1 ), limits =  c( 0, 8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'ATx' = 23,  'Control' = 21 ), labels = c( 'ATx' = 'ATx', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Shank Proximal Transfer Work Rate vs Thigh Distal Transfer Work Rate \n 2.3 Hz Hopping ', x='Thigh Distal Transfer Work Rate (W/kg)', y = ' Shank Proximal Transfer Work Rate (W/kg) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'ATx' = '#c51b7d', 'Control' = '#4d9221'  ) ), nrow = 1 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 38,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 27,lineheight=100),
            legend.title = element_text(size = 27),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the background color for the entire legend
            legend.background = element_rect( color='black', linewidth=1, fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_ShankProximalTransferWorkRatevsThighDistalTransferWorkRate_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```

###### Ankle Power Contribution vs Foot Work Rate
```{r Braking Phase }

AnkleContributionvsAverageFootPower_2.3Hz_1LimbPer3Groups <- data.frame( x = rep( 1, 22 ) )

AnkleContributionvsAverageFootPower_2.3Hz_1LimbPer3Groups$Group_ID <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID

AnkleContributionvsAverageFootPower_2.3Hz_1LimbPer3Groups$Group_by_Morphology <- EnergyFlow_ParticipantMeans_ProximalFootOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored

AnkleContributionvsAverageFootPower_2.3Hz_1LimbPer3Groups$Participant_ID <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID

AnkleContributionvsAverageFootPower_2.3Hz_1LimbPer3Groups$Mean_JointContribution_AveragePower_AbsorptionNeutralized <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized

AnkleContributionvsAverageFootPower_2.3Hz_1LimbPer3Groups$Mean_SegmentAverageEnergy_Braking <- EnergyFlow_ParticipantMeans_ProximalFootOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageFootPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology ), color = 'white', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_by_Morphology, fill = Participant_ID, alpha = Participant_ID, group = Group_by_Morphology ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      


      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-4, 6, by = 1), limits = c(-4, 6) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Foot Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Average Foot Power (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsAverageFootPower_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```



###### Ankle Power Contribution vs Shank Work Rate
```{r Braking Phase }

AnkleContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups <- data.frame( x = rep( 1, 22 ) )

AnkleContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups$Group_ID <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID

AnkleContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups$Group_by_Morphology <- EnergyFlow_ParticipantMeans_ProximalShankOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored

AnkleContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups$Participant_ID <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID

AnkleContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups$Mean_JointContribution_AveragePower_AbsorptionNeutralized <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized

AnkleContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups$Mean_SegmentAverageEnergy_Braking <- EnergyFlow_ParticipantMeans_ProximalShankOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology ), color = 'white', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_by_Morphology, fill = Participant_ID, alpha = Participant_ID, group = Group_by_Morphology ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-4, 6, by = 1), limits = c(-4, 6) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Shank Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Average Shank Power (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsAverageShankPower_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```


###### Ankle Power Contribution vs Thigh Work Rate
```{r Braking Phase }

AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups <- data.frame( Group_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz_NoATx36$Group_ID,

Group_by_Morphology = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored,

Participant_ID = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz_NoATx36$Participant_ID,

Mean_JointContribution_AveragePower_AbsorptionNeutralized = Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz_NoATx36$Mean_JointContribution_AveragePower_AbsorptionNeutralized,

Mean_SegmentAverageEnergy_Braking = EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking )


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology ), color = 'black', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_by_Morphology, fill = Participant_ID, alpha = Participant_ID, group = Group_by_Morphology ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-4, 6, by = 1), limits = c(-4, 6) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Thigh Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Average Thigh Power (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsAverageThighPower_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```


```{r Propulsion Phase }

AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups <- data.frame( x = rep( 1, 22 ) )

AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Group_ID <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID

AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Group_by_Morphology <- EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored

AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Participant_ID <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID

AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Mean_JointContribution_AveragePower_AbsorptionNeutralized <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized

AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Mean_SegmentAverageEnergy_Braking <- EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
 
      
   
   
    
#Regression line for ATx07
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[1,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[1,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) +
   
   
    
#Regression line for ATx08
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[2,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[2,2], linewidth = 1.5, color = '#c51b7d', alpha = 0.6 ) +
   
   
    
#Regression line for ATx10
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[3,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[3,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) +
   
   
    
#Regression line for ATx12
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[4,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[4,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx17
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[5,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[5,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) +    
   
   
    
#Regression line for ATx18
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[6,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[6,2], linewidth = 1.5, color = '#c51b7d', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx19
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[7,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[7,2], linewidth = 1.5, color = '#c51b7d', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx21
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[8,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[8,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx24
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[9,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[9,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx25
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[10,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[10,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx27
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[11,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[11,2], linewidth = 1.5, color = '#c51b7d', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx34
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[12,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[12,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) + 
   
   
    
#Regression line for HC01
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[13,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[13,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) + 
   
   
    
#Regression line for HC05
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[14,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[14,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC06
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[15,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[15,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC11
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[16,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[16,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC12
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[17,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[17,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC17
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[18,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[18,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC19
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[19,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[19,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC20
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[20,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[20,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC21
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[21,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[21,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC25
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[22,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[22,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
    
    
    
    
    
   #Regression line for ATx Less Than 2 mm Group
      geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for ATx Less Than 2 mm Group
      geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ] + fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ], linewidth = 9, color = '#7fbc41' ) +
    
    
    
    
    #Regression line for ATx Minimum 2 mm Group
      geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for ATx Minimum 2 mm Group
      geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ] + fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ], linewidth = 9, color = '#c51b7d' ) +
   
   
    
    
#Regression line for Control Group
     geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ], linewidth = 10, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ], linewidth = 9, color = '#4d9221' ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_by_Morphology, fill = Participant_ID, alpha = Participant_ID, group = Group_by_Morphology ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-4, 6, by = 1), limits = c(-4, 6) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Thigh Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Average Thigh Power (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsAverageThighPower_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```



###### Ankle Power Contribution vs Thigh Average Total Power Transfer
```{r Braking Phase }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsAverageFootShankThighPower_ParticipantMeans_2.3Hz_1LimbPer3Groups, aes(y = Mean_AnkleContribution_AveragePower_AbsorptionNeutralized, x = ThighAverageEnergyTransfer_Braking_PositiveIsDistalTransfer ) ) +
   
   
    
#Regression line for ATx07
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[1,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[1,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) +
   
   
    
#Regression line for ATx08
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[2,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[2,2], linewidth = 1.5, color = '#c51b7d', alpha = 0.6 ) +
   
   
    
#Regression line for ATx10
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[3,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[3,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) +
   
   
    
#Regression line for ATx12
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[4,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[4,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx17
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[5,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[5,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) +    
   
   
    
#Regression line for ATx18
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[6,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[6,2], linewidth = 1.5, color = '#c51b7d', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx19
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[7,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[7,2], linewidth = 1.5, color = '#c51b7d', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx21
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[8,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[8,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx24
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[9,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[9,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx25
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[10,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[10,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx27
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[11,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[11,2], linewidth = 1.5, color = '#c51b7d', alpha = 0.6 ) + 
   
   
    
#Regression line for ATx34
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[12,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[12,2], linewidth = 1.5, color = '#7fbc41', alpha = 0.6 ) + 
   
   
    
#Regression line for HC01
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[13,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[13,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) + 
   
   
    
#Regression line for HC05
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[14,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[14,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC06
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[15,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[15,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC11
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[16,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[16,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC12
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[17,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[17,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC17
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[18,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[18,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC19
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[19,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[19,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC20
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[20,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[20,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC21
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[21,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[21,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
   
   
    
#Regression line for HC25
         geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[22,1], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+ranef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )$Participant_ID[22,2], linewidth = 1.5, color = '#4d9221', alpha = 0.6 ) +
    
    
    
    
    
   #Regression line for ATx Less Than 2 mm Group
      geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for ATx Less Than 2 mm Group
      geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ] + fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 3 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 5 ], linewidth = 9, color = '#7fbc41' ) +
    
    
    
    
    #Regression line for ATx Minimum 2 mm Group
      geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ], linewidth = 10, color = 'white' ) +
   
    
   #Regression line for ATx Minimum 2 mm Group
      geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ] + fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 4 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ]+fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 6 ], linewidth = 9, color = '#c51b7d' ) +
   
   
    
    
#Regression line for Control Group
     geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ], linewidth = 10, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 1 ], slope = fixef( FinalRMMEValues_AnkleContributionvsAverageThighTransferPower_Braking_BothEffects )[ 2 ], linewidth = 9, color = '#4d9221' ) +
      
 
   

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_by_Morphology, fill = Participant_ID, alpha = Participant_ID, group = Group_by_Morphology ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq(0, 8, by = 1), limits = c(0, 8) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 30, 80, by = 10 ), limits =  c( 30, 80 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Thigh Distal Power Transfer \n Across Entire Braking Phase - 2.3 Hz Hopping ', x='Work Rate Transfer (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsThighDistalPowerTransfer_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```




###### Ankle Power Contribution vs Knee Average Passive Power for Thigh
```{r Braking Phase }

AnkleContributionvsKneeAvgPassivePwer_2.3Hz_1LimbPer3Groups <- data.frame( x = rep( 1, 22 ) )

AnkleContributionvsKneeAvgPassivePwer_2.3Hz_1LimbPer3Groups$Group_ID <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Group_ID

AnkleContributionvsKneeAvgPassivePwer_2.3Hz_1LimbPer3Groups$Group_by_Morphology <- EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored

AnkleContributionvsKneeAvgPassivePwer_2.3Hz_1LimbPer3Groups$Participant_ID <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Participant_ID

AnkleContributionvsKneeAvgPassivePwer_2.3Hz_1LimbPer3Groups$Mean_JointContribution_AveragePower_AbsorptionNeutralized <- Power_ParticipantMeans_1LimbPer3Groups_Ankle_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized

AnkleContributionvsKneeAvgPassivePwer_2.3Hz_1LimbPer3Groups$Mean_JointAveragePassivePower_forSegment_Braking <- EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_JointAveragePassivePower_forSegment_Braking


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = AnkleContributionvsKneeAvgPassivePwer_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_JointAveragePassivePower_forSegment_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology ), color = 'white', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_by_Morphology, fill = Participant_ID, alpha = Participant_ID, group = Group_by_Morphology ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
       #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq(-14, 14, by = 2), limits = c(-14, 14) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0.3, 0.8, by = 0.1 ), limits =  c( 0.3, 0.8 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Ankle Contribution To Whole-Limb Power Absorption vs \n Knee Average Passive Power for Thigh \n Across Entire Braking Phase - 2.3 Hz Hopping ', x='Average Passive Power for Thigh (W/kg)', y = ' Ankle Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_AnkleContributionvsKneeAvgPassivePwer4Thigh_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```



###### Knee Power Contribution vs Shank Work Rate
```{r Braking Phase }

KneeContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups <- data.frame( x = rep( 1, 22 ) )

KneeContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups$Group_ID <- Power_ParticipantMeans_1LimbPer3Groups_Knee_2.3Hz$Group_ID

KneeContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups$Group_by_Morphology <- EnergyFlow_ParticipantMeans_ProximalShankOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored

KneeContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups$Participant_ID <- Power_ParticipantMeans_1LimbPer3Groups_Knee_2.3Hz$Participant_ID

KneeContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups$Mean_JointContribution_AveragePower_AbsorptionNeutralized <- Power_ParticipantMeans_1LimbPer3Groups_Knee_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized

KneeContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups$Mean_SegmentAverageEnergy_Braking <- EnergyFlow_ParticipantMeans_ProximalShankOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = KneeContributionvsAverageShankPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology ), color = 'white', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_by_Morphology, fill = Participant_ID, alpha = Participant_ID, group = Group_by_Morphology ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-4, 6, by = 1), limits = c(-4, 6) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 0.6, by = 0.1 ), limits =  c( 0, 0.6 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Knee Contribution To Whole-Limb Power Absorption vs \n Shank Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Average Shank Power (W/kg)', y = ' Knee Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_KneeContributionvsAverageShankPower_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```



###### Knee Power Contribution vs Thigh Work Rate
```{r Braking Phase }

KneeContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups <- data.frame( x = rep( 1, 22 ) )

KneeContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Group_ID <- Power_ParticipantMeans_1LimbPer3Groups_Knee_2.3Hz$Group_ID

KneeContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Group_by_Morphology <- EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored

KneeContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Participant_ID <- Power_ParticipantMeans_1LimbPer3Groups_Knee_2.3Hz$Participant_ID

KneeContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Mean_JointContribution_AveragePower_AbsorptionNeutralized <- Power_ParticipantMeans_1LimbPer3Groups_Knee_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized

KneeContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Mean_SegmentAverageEnergy_Braking <- EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = KneeContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology ), color = 'white', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_by_Morphology, fill = Participant_ID, alpha = Participant_ID, group = Group_by_Morphology ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-4, 6, by = 1), limits = c(-4, 6) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 0.6, by = 0.1 ), limits =  c( 0, 0.6 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Knee Contribution To Whole-Limb Power Absorption vs \n Thigh Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Average Thigh Power (W/kg)', y = ' Knee Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_KneeContributionvsAverageThighPower_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```



###### Hip Power Contribution vs Thigh Work Rate
```{r Braking Phase }

HipContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups <- data.frame( x = rep( 1, 22 ) )

HipContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Group_ID <- Power_ParticipantMeans_1LimbPer3Groups_Hip_2.3Hz$Group_ID

HipContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Group_by_Morphology <- EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored

HipContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Participant_ID <- Power_ParticipantMeans_1LimbPer3Groups_Hip_2.3Hz$Participant_ID

HipContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Mean_JointContribution_AveragePower_AbsorptionNeutralized <- Power_ParticipantMeans_1LimbPer3Groups_Hip_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized

HipContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups$Mean_SegmentAverageEnergy_Braking <- EnergyFlow_ParticipantMeans_ProximalThighOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = HipContributionvsAverageThighPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology ), color = 'white', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_by_Morphology, fill = Participant_ID, alpha = Participant_ID, group = Group_by_Morphology ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
       #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-4, 6, by = 1), limits = c(-4, 6) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 0.6, by = 0.1 ), limits =  c( 0, 0.6 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Hip Contribution To Whole-Limb Power Absorption vs \n Thigh Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Average Thigh Power (W/kg)', y = ' Hip Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_HipContributionvsAverageThighPower_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```

###### Hip Power Contribution vs Pelvis Work Rate
```{r Braking Phase }

HipContributionvsAveragePelvisPower_2.3Hz_1LimbPer3Groups <- data.frame( x = rep( 1, 22 ) )

HipContributionvsAveragePelvisPower_2.3Hz_1LimbPer3Groups$Group_ID <- Power_ParticipantMeans_1LimbPer3Groups_Hip_2.3Hz$Group_ID

HipContributionvsAveragePelvisPower_2.3Hz_1LimbPer3Groups$Group_by_Morphology <- EnergyFlow_ParticipantMeans_ProximalPelvisOnly_1LimbPer3Groups_2.3Hz$Group_by_Morphology_NotFactored

HipContributionvsAveragePelvisPower_2.3Hz_1LimbPer3Groups$Participant_ID <- Power_ParticipantMeans_1LimbPer3Groups_Hip_2.3Hz$Participant_ID

HipContributionvsAveragePelvisPower_2.3Hz_1LimbPer3Groups$Mean_JointContribution_AveragePower_AbsorptionNeutralized <- Power_ParticipantMeans_1LimbPer3Groups_Hip_2.3Hz$Mean_JointContribution_AveragePower_AbsorptionNeutralized

HipContributionvsAveragePelvisPower_2.3Hz_1LimbPer3Groups$Mean_SegmentAverageEnergy_Braking <- EnergyFlow_ParticipantMeans_ProximalPelvisOnly_1LimbPer3Groups_2.3Hz$Mean_SegmentAverageEnergy_Braking


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = HipContributionvsAveragePelvisPower_2.3Hz_1LimbPer3Groups, aes(y = Mean_JointContribution_AveragePower_AbsorptionNeutralized/100, x = Mean_SegmentAverageEnergy_Braking ) ) +
      
 
      #Use geom_smooth to plot regression lines. Make this wider than the one below, to outline the one below in white
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology ), color = 'white', se = F, linewidth = 5 ) +
      
      #Use geom_smooth to plot regression lines.
      geom_smooth( method = 'lm', formula = y~x, aes( group = Group_by_Morphology, color = Group_by_Morphology ), se = F, linewidth = 3 ) +
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( shape = Group_by_Morphology, fill = Participant_ID, alpha = Participant_ID, group = Group_by_Morphology ), color = 'black', size = 10, stroke = 3, na.rm = T ) +
      

      
      

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
       #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[12],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[12],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                    'Matched Dominance' = '#4d9221',
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Control' = '#4d9221'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=1,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 1,
                                    'HC18'=0.75 ) ) +
      
      
      #Specify the limits and ticks of the y-axis
      scale_x_continuous( breaks = seq(-13, -4, by = 1), limits = c(-13, -4) )+
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 0.6, by = 0.1 ), limits =  c( 0, 0.6 ) )+
    
    
      #Specify the shapes for each morphology group
      scale_shape_manual( values = c( 'LessThan_2mm_Diff' = 22, 'Minimum_2mm_Diff' = 23, 'Control' = 21 ), labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ) ) +
      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Hip Contribution To Whole-Limb Power Absorption vs \n Pelvis Work Rate Across Entire Braking Phase \n 2.3 Hz Hopping ', x='Average Pelvis Power (W/kg)', y = ' Hip Contribution ( max = 1 ) ' ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Group ID', override.aes = list( size = 15, fill = c(  'Control' = '#4d9221','LessThan_2mm_Diff' = '#7fbc41','Minimum_2mm_Diff' = '#c51b7d'  ) ), nrow = 2 ) )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 45,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 40,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 45,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255, alpha = 55) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 30, face = 'bold' )  ) 
 
)



ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/Energy Flow/2.3 Hz/Group Comparison', filename = 'Dissertation_HipContributionvsAveragePelvisPower_BrakingPhase_2.3Hz_1LimbPer3Groups.png', width = 5750, height = 5750, units = 'px' )

```

