---
title: "DTOW Preactivation Onset Tinkering 28-Mar-2024"
output: html_document
date: "2024-03-28"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load - Libraries

```{r Load Libraries, message=FALSE , include=FALSE,results='hide'}
library(R.matlab)
library(ggplot2)
library(pander)
library(stargazer)
library(gridExtra)
library(ggpubr)
library(RColorBrewer)
library(reshape2)
library(effsize)
library(ggsignif)
library(lme4)
library(ggeffects)
library(effects)
library(clubSandwich)
library(DescTools)
library(readxl)
library(xlsx)
library(dplyr)
library(shadowtext)
library(MetBrewer)
library(sjstats)
library(coin)
library(rstatix)
library(tidyverse)
library(datarium)
library(svglite)
library(MASS)
library(car)
library(robustlmm)
library(nlme)
library(showtext)


font_add( 'Arial Black', regular = 'Arial Black.ttf' )
font_add( 'Arial Bold Italic', regular = 'Arial Bold Italic.ttf' )
font_add( 'Arial Bold', regular = 'Arial Bold.ttf' )
font_add( 'Arial Italic', regular = 'Arial Italic.ttf' )

setTimeLimit(cpu= Inf, elapsed = Inf, transient = FALSE)

setTimeLimit(cpu= Inf, elapsed = Inf, transient = FALSE)
```

## Load Data

```{r ATx + Control Data}

PreactivationOnsetFakeData <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/Preactivation Onset Tinkering/PreactivationOnset_FakeData.xlsx', sheet = 2 ) )


PreactivationOnsetFakeData$Participant_ID[ which( PreactivationOnsetFakeData$Group_ID == 1 & PreactivationOnsetFakeData$Participant_ID == 1 ) ] <- 'ATx07'

PreactivationOnsetFakeData$Participant_ID[ which( PreactivationOnsetFakeData$Group_ID == 1 & PreactivationOnsetFakeData$Participant_ID == 2 ) ] <- 'ATx18'

PreactivationOnsetFakeData$Participant_ID[ which( PreactivationOnsetFakeData$Group_ID == 1 & PreactivationOnsetFakeData$Participant_ID == 3 ) ] <- 'ATx08'

PreactivationOnsetFakeData$Participant_ID[ which( PreactivationOnsetFakeData$Group_ID == 1 & PreactivationOnsetFakeData$Participant_ID == 4 ) ] <- 'ATx25'

PreactivationOnsetFakeData$Participant_ID[ which( PreactivationOnsetFakeData$Group_ID == 1 & PreactivationOnsetFakeData$Participant_ID == 5 ) ] <- 'ATx34'


PreactivationOnsetFakeData$Participant_ID[ which( PreactivationOnsetFakeData$Group_ID == 2 & PreactivationOnsetFakeData$Participant_ID == 1 ) ] <- 'HC01'

PreactivationOnsetFakeData$Participant_ID[ which( PreactivationOnsetFakeData$Group_ID == 2 & PreactivationOnsetFakeData$Participant_ID == 2 ) ] <- 'HC05'

PreactivationOnsetFakeData$Participant_ID[ which( PreactivationOnsetFakeData$Group_ID == 2 & PreactivationOnsetFakeData$Participant_ID == 3 ) ] <- 'HC06'

PreactivationOnsetFakeData$Participant_ID[ which( PreactivationOnsetFakeData$Group_ID == 2 & PreactivationOnsetFakeData$Participant_ID == 4 ) ] <- 'HC11'

PreactivationOnsetFakeData$Participant_ID[ which( PreactivationOnsetFakeData$Group_ID == 2 & PreactivationOnsetFakeData$Participant_ID == 5 ) ] <- 'HC12'



PreactivationOnsetFakeData$Group_ID[ which( PreactivationOnsetFakeData$Group_ID == 1 )  ] <- 'ATx'

PreactivationOnsetFakeData$Group_ID[ which( PreactivationOnsetFakeData$Group_ID == 2 )  ] <- 'Control'


PreactivationOnsetFakeData$Muscle_ID[ which( PreactivationOnsetFakeData$Muscle_ID == 2 )  ] <- 'LatGas'

PreactivationOnsetFakeData$Muscle_ID[ which( PreactivationOnsetFakeData$Muscle_ID == 3 )  ] <- 'Sol'

PreactivationOnsetFakeData$Muscle_ID[ which( PreactivationOnsetFakeData$Muscle_ID == 4 )  ] <- 'PL'

PreactivationOnsetFakeData$Muscle_ID[ which( PreactivationOnsetFakeData$Muscle_ID == 5 )  ] <- 'TA'


PreactivationOnsetFakeData$EMGPreProcessing[ which( PreactivationOnsetFakeData$EMGPreProcessing == 1 )  ] <- 'NonTKEO'

PreactivationOnsetFakeData$EMGPreProcessing[ which( PreactivationOnsetFakeData$EMGPreProcessing == 2 )  ] <- 'TKEO'



PreactivationOnsetFakeData$DetectionMethod[ which( PreactivationOnsetFakeData$DetectionMethod == 1 )  ] <- 'SD Threshold_RestingEMG'

PreactivationOnsetFakeData$DetectionMethod[ which( PreactivationOnsetFakeData$DetectionMethod == 2 )  ] <- 'SD Threshold_IndividualBaseline'

PreactivationOnsetFakeData$DetectionMethod[ which( PreactivationOnsetFakeData$DetectionMethod == 3 )  ] <- 'SantelloMcDonagh'

```


## DPLYR
```{r Medial Gastroc}


PreactivationOnsetFakeData_MedGas <- PreactivationOnsetFakeData %>%
   filter( Muscle_ID == 'MedGas' )

```


```{r Lateral Gastroc}


PreactivationOnsetFakeData_LatGas <- PreactivationOnsetFakeData %>%
   filter( Muscle_ID == 'LatGas' )

```


```{r Sol}


PreactivationOnsetFakeData_Sol <- PreactivationOnsetFakeData %>%
   filter( Muscle_ID == 'Sol' )

```


```{r PL}


PreactivationOnsetFakeData_PL <- PreactivationOnsetFakeData %>%
   filter( Muscle_ID == 'PL' )

```


```{r TA }


PreactivationOnsetFakeData_TA <- PreactivationOnsetFakeData %>%
   filter( Muscle_ID == 'TA' )

```




## PLOTS

### Non-Absolute Error

```{r MedGas }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = PreactivationOnsetFakeData_MedGas, aes(y = OnsetError_s*1000, x = DetectionMethod ) ) +
 

          #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.75, xend = 0.75, y = 0.1, yend = 100 ), linewidth = 5, arrow=arrow(length=unit(10,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Activation After True Onset', size = 25, x = 1.5, y = 97, color = 'black', fontface = 'bold',family='Arial Bold' )+
 

          #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.75, xend = 0.75, y = -0.1, yend = -100 ), linewidth = 5, arrow=arrow(length=unit(10,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Activation Before True Onset', size = 25, x = 1.5, y = -97, color = 'black', fontface = 'bold',family='Arial Bold' )+

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 46, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 42, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( -120, 120, by = 20 ), limits =  c( -120, 120 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Medial Gastroc ', x='Detection Method', y = ' Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) +
    
    facet_wrap( vars( Group_ID ), labeller = labeller( c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control' ) ) )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_MedGas.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```









```{r LatGas }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationLatGas <- ggplot(data = PreactivationOnsetFakeData_LatGas, aes(y = OnsetError_s*1000, x = DetectionMethod ) ) +
 

          #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.75, xend = 0.75, y = 0.1, yend = 100 ), linewidth = 5, arrow=arrow(length=unit(10,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Activation After True Onset', size = 25, x = 1.5, y = 97, color = 'black', fontface = 'bold',family='Arial Bold' )+
 

          #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.75, xend = 0.75, y = -0.1, yend = -100 ), linewidth = 5, arrow=arrow(length=unit(10,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Activation Before True Onset', size = 25, x = 1.5, y = -97, color = 'black', fontface = 'bold',family='Arial Bold' )+

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( data = subset( PreactivationOnsetFakeData_LatGas, DetectionMethod == 'SD Threshold_RestingEMG'  ), label = " 'Mean' %+-% '95% CI' ", size = 30, x = 1.875, y = 19.95, fontface = 'bold', family='Arial Bold', parse = T  ) +
   
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = -70, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = -73, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( -120, 120, by = 20 ), limits =  c( -120, 120 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Lateral Gastroc ', x='Detection Method', y = ' Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) +
    
    facet_wrap( vars( Group_ID ), labeller = labeller( c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control' ) ) )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_LatGas.png', width = 22000, height = 20000, units = 'px', limitsize = F )

```


```{r Sol }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationSol <- ggplot(data = PreactivationOnsetFakeData_Sol, aes(y = OnsetError_s*1000, x = DetectionMethod ) ) +
 

          #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.75, xend = 0.75, y = 0.1, yend = 100 ), linewidth = 5, arrow=arrow(length=unit(10,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Activation After True Onset', size = 25, x = 1.5, y = 97, color = 'black', fontface = 'bold',family='Arial Bold' )+
 

          #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.75, xend = 0.75, y = -0.1, yend = -100 ), linewidth = 5, arrow=arrow(length=unit(10,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Activation Before True Onset', size = 25, x = 1.5, y = -97, color = 'black', fontface = 'bold',family='Arial Bold' )+

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( data = subset( PreactivationOnsetFakeData_Sol, DetectionMethod == 'SD Threshold_RestingEMG'  ), label = " 'Mean' %+-% '95% CI' ", size = 30, x = 1.875, y = 19.95, fontface = 'bold', family='Arial Bold', parse = T  ) +
   
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = -70, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = -73, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( -120, 120, by = 20 ), limits =  c( -120, 120 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Soleus ', x='Detection Method', y = ' Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) +
    
    facet_wrap( vars( Group_ID ), labeller = labeller( c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control' ) ) )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_Sol.png', width = 22000, height = 20000, units = 'px', limitsize = F )

```





```{r PL }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationPL <- ggplot(data = PreactivationOnsetFakeData_PL, aes(y = OnsetError_s*1000, x = DetectionMethod ) ) +
 

          #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.75, xend = 0.75, y = 0.1, yend = 100 ), linewidth = 5, arrow=arrow(length=unit(10,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Activation After True Onset', size = 25, x = 1.5, y = 97, color = 'black', fontface = 'bold',family='Arial Bold' )+
 

          #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.75, xend = 0.75, y = -0.1, yend = -100 ), linewidth = 5, arrow=arrow(length=unit(10,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Activation Before True Onset', size = 25, x = 1.5, y = -97, color = 'black', fontface = 'bold',family='Arial Bold' )+

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( data = subset( PreactivationOnsetFakeData_PL, DetectionMethod == 'SD Threshold_RestingEMG'  ), label = " 'Mean' %+-% '95% CI' ", size = 30, x = 1.875, y = 19.95, fontface = 'bold', family='Arial Bold', parse = T  ) +
   
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = -70, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = -73, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( -120, 120, by = 20 ), limits =  c( -120, 120 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Peroneus Longus ', x='Detection Method', y = ' Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) +
    
    facet_wrap( vars( Group_ID ), labeller = labeller( c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control' ) ) )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_PL.png', width = 22000, height = 20000, units = 'px', limitsize = F )

```





```{r TA }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationTA <- ggplot(data = PreactivationOnsetFakeData_TA, aes(y = OnsetError_s*1000, x = DetectionMethod ) ) +
 

          #Arrow segment from 0 to max of y-axis.
   geom_segment( aes( x = 0.75, xend = 0.75, y = 0.1, yend = 100 ), linewidth = 5, arrow=arrow(length=unit(10,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Activation After True Onset', size = 25, x = 1.5, y = 97, color = 'black', fontface = 'bold',family='Arial Bold' )+
 

          #Arrow segment from 0 to min of y-axis.
   geom_segment( aes( x = 0.75, xend = 0.75, y = -0.1, yend = -100 ), linewidth = 5, arrow=arrow(length=unit(10,'mm'), ends = 'last', type = 'open', angle = 40 )  ) +
      
      geom_text( label = 'Activation Before True Onset', size = 25, x = 1.5, y = -97, color = 'black', fontface = 'bold',family='Arial Bold' )+

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( data = subset( PreactivationOnsetFakeData_TA, DetectionMethod == 'SD Threshold_RestingEMG'  ), label = " 'Mean' %+-% '95% CI' ", size = 30, x = 1.875, y = 19.95, fontface = 'bold', family='Arial Bold', parse = T  ) +
   
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = -70, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = -73, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( -120, 120, by = 20 ), limits =  c( -120, 120 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Tibialis Anterior ', x='Detection Method', y = ' Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) +
    
    facet_wrap( vars( Group_ID ), labeller = labeller( c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control' ) ) )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_TA.png', width = 22000, height = 20000, units = 'px', limitsize = F )

```


### Absolute Error

```{r MedGas }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = PreactivationOnsetFakeData_MedGas, aes(y = abs( OnsetError_s*1000 ), x = DetectionMethod ) ) +
 
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 33, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 30, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 110, by = 10 ), limits =  c( 0, 110 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Medial Gastroc ', x='Detection Method', y = ' Absolute Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) +
    
    facet_wrap( vars( Group_ID ), labeller = labeller( c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control' ) ) )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_MedGas_AbsoluteError.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```









```{r LatGas }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationLatGas <- ggplot(data = PreactivationOnsetFakeData_LatGas, aes(y = abs( OnsetError_s*1000 ), x = DetectionMethod ) ) +
 
    
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 33, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 30, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 110, by = 10 ), limits =  c( 0, 110 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Lateral Gastroc ', x='Detection Method', y = ' Absolute Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) +
    
    facet_wrap( vars( Group_ID ), labeller = labeller( c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control' ) ) )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_LatGas_AbsoluteError.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```









```{r Sol }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationSol <- ggplot(data = PreactivationOnsetFakeData_Sol, aes(y = abs( OnsetError_s*1000 ), x = DetectionMethod ) ) +
 

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 33, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 30, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 110, by = 10), limits =  c( 0, 110 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Soleus ', x='Detection Method', y = ' Absolute Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) +
    
    facet_wrap( vars( Group_ID ), labeller = labeller( c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control' ) ) )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_Sol_AbsoluteError.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```




```{r PL }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationPL <- ggplot(data = PreactivationOnsetFakeData_PL, aes(y = abs( OnsetError_s*1000 ), x = DetectionMethod ) ) +
 

    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 33, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 30, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 110, by = 10), limits =  c( 0, 110 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Peroneus Longus ', x='Detection Method', y = ' Absolute Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) +
    
    facet_wrap( vars( Group_ID ), labeller = labeller( c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control' ) ) )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_PL_AbsoluteError.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```




```{r TA }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationTA <- ggplot(data = PreactivationOnsetFakeData_TA, aes(y = abs( OnsetError_s*1000 ), x = DetectionMethod ) ) +
 
    
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 33, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 30, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 110, by = 10 ), limits =  c( 0, 110 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Tibialis Anterior ', x='Detection Method', y = ' Absolute Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) +
    
    facet_wrap( vars( Group_ID ), labeller = labeller( c( 'ATx' = 'Achilles Tendinopathy', 'Control' = 'Healthy Control' ) ) )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_TA_AbsoluteError.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```


## No Facet Wrap
```{r MedGas }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationLatGas <- ggplot(data = PreactivationOnsetFakeData_MedGas, aes(y = abs( OnsetError_s*1000 ), x = DetectionMethod ) ) +
 
    
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 33, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 30, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 110, by = 10 ), limits =  c( 0, 110 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Medial Gastroc ', x='Detection Method', y = ' Absolute Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_MedGas_AbsoluteError_NoFacetWrap.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```


```{r LatGas }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationLatGas <- ggplot(data = PreactivationOnsetFakeData_LatGas, aes(y = abs( OnsetError_s*1000 ), x = DetectionMethod ) ) +
 
    
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 33, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 30, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 110, by = 10 ), limits =  c( 0, 110 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Lateral Gastroc ', x='Detection Method', y = ' Absolute Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_LatGas_AbsoluteError_NoFacetWrap.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```





```{r Sol }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationSol <- ggplot(data = PreactivationOnsetFakeData_Sol, aes(y = abs( OnsetError_s*1000 ), x = DetectionMethod ) ) +
 
    
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 33, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 30, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 110, by = 10 ), limits =  c( 0, 110 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Soleus ', x='Detection Method', y = ' Absolute Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_Sol_AbsoluteError_NoFacetWrap.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```






```{r PL }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationPL <- ggplot(data = PreactivationOnsetFakeData_PL, aes(y = abs( OnsetError_s*1000 ), x = DetectionMethod ) ) +
 
    
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 33, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 30, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 110, by = 10 ), limits =  c( 0, 110 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Peroneus Longus ', x='Detection Method', y = ' Absolute Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_PL_AbsoluteError_NoFacetWrap.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```



```{r TA }



#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(PreactivationTA <- ggplot(data = PreactivationOnsetFakeData_TA, aes(y = abs( OnsetError_s*1000 ), x = DetectionMethod ) ) +
 
    
    
      
      #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      geom_point( aes( fill = EMGPreProcessing, alpha = Participant_ID, group = EMGPreProcessing ), shape = 23,  size = 20, stroke = 3, color = 'black',  na.rm = T, position = position_jitter( seed = 1, height = 0, width = 0.3 ) ) +
      
    
    
    
stat_summary( fun.data = 'mean_cl_boot',
geom="crossbar", aes( group = EMGPreProcessing , color =EMGPreProcessing ), linewidth = 5, show.legend = F  )+ 
   
   
   geom_text( label = " 'Mean' %+-% '95% CI' ", size = 30, x = 2.875, y = -12, fontface = 'bold', family='Arial Bold', parse = T ) +
   
   geom_text( label = 'Bandpass Filtered, Rectified', size = 30, x = 2, y = 33, color = '#998ec3', fontface = 'bold', family='Arial Bold' ) +
   
   geom_text( label = 'Bandpass Filtered, TKEO Conditioned, Rectified', size = 30, x = 2, y = 30, color = '#f1a340', fontface = 'bold', family='Arial Bold' ) +

      #     #Use geom dotplot to create scatter plot but group points with similar values into the same bin
      # geom_point( aes( x = HoppingHeight_cm_LimbMeanCentered, y =  JointContribution_AveragePower_GenerationNeutralized ,  fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), shape = 23, size = 30, stroke = 3, color = 'white',  na.rm = T, data = AnkleAbsorptionContributionVsLimbCenteredHopHeight_ParticipantAverages_NotRMME ) +
   
  
      #Specify the limits and ticks of the y-axis
      scale_x_discrete( limits =  c( 'SD Threshold_RestingEMG', 'SD Threshold_IndividualBaseline', 'SantelloMcDonagh' ), labels = c( 'SD Threshold \n Baseline from Resting EMG', 'SD Threshold \n Baseline from Each Hop', 'Santello-McDonagh Method' ) )+
      
      
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks=seq( 0, 110, by = 10 ), limits =  c( 0, 110 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Comparison Between Pre-Activation Onset Detection Methods \n Tibialis Anterior ', x='Detection Method', y = ' Absolute Error in Onset ( ms ) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221',
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[2] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                 'TKEO'='#f1a340',
                                 'NonTKEO'='#998ec3',
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[3], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC08'=met.brewer('OKeeffe1')[6],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[8],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[7],
                                    'HC18'=met.brewer('OKeeffe1')[2],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx36'=0.75,
                                    'ATx49'=0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC12'= 1, 
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC08'= 1,
                                    'HC20'= 1,
                                    'HC11'= 1,
                                    'HC17'= 1,
                                    'HC21'= 1,
                                    'HC25'= 0.75,
                                    'HC18'=0.75 ) ) +
      

         
      #Specify shapes
      scale_shape_manual( values = c( 'NonTKEO' = 21,
                                 'TKEO' = 23 ), labels = c( 'Band-pass Filtered, Rectified', 'Bandpassed, TKEO, Rectified' ) ) +
      
    
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = guide_legend( title = 'Pre-Processing Method', override.aes = list( size = 30 ) ), stroke = 'none' )+ 
      
    
      #Adjust the plot theme
      theme(plot.title = element_text(size = 85,hjust = 0.5,face = 'bold',family='Arial Bold'),
            axis.title.x = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.left = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic'),
            axis.title.y.right = element_text(size = 90,face = 'bold.italic',family='Arial Bold Italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 65,face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.y.right=element_text(size=50,color='darkred',face = 'bold.italic',family='Arial Bold Italic'),
            axis.text.x  =  element_text(size = 60,face = 'bold.italic',family='Arial Bold Italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 65, lineheight=100),
            legend.title = element_text(size = 65),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust legend background color
            legend.background = element_rect( fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255 ) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.x = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 65, face = 'bold',family='Arial Bold' )  ) 
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/PreactivationOnsetTinkering', filename = 'Dissertation_PreactivationOnsetTinkering_TA_AbsoluteError_NoFacetWrap.png', width = 20000, height = 20000, units = 'px', limitsize = F )

```