---
title: "MLR Dissertation MEE~EMG 27-Feb-2023"
author: "David Ortiz"
date: "2023-02-28"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load - Libraries
```{r Load Libraries, message=FALSE , include=FALSE,results='hide'}
library(R.matlab)
library(ggplot2)
library(pander)
library(stargazer)
library(gridExtra)
library(ggpubr)
library(RColorBrewer)
library(reshape2)
library(effsize)
library(ggsignif)
library(lme4)
library(nlme)
library(ggeffects)
library(effects)
library(clubSandwich)
library(DescTools)
library(readxl)
library(xlsx)
library(dplyr)
library(shadowtext)
library(MetBrewer)
library(sjstats)
library(coin)
library(rstatix)
library(tidyverse)
library(datarium)
library(MASS)
library(car)
library(robustlmm)

setTimeLimit(cpu= Inf, elapsed = Inf, transient = FALSE)
```


## Load Data

### Individual Hops
```{r EMG Magnitude/Coactivation}

Coactivation_IndividualHops <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/EMG/EMG MagnitudeCoactivation/PostQuals_HoppingCoactivationRatio.xlsx' ) )


#Next lines will convert Participant ID numbers into labels
Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID==1) ] <- 'ATx07'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 2) ] <- 'ATx08'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 3) ] <- 'ATx10'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 4) ] <- 'ATx12'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 5) ] <- 'ATx17'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 6) ] <- 'ATx18'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 7) ] <- 'ATx19'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 8) ] <- 'ATx21'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 9) ] <- 'ATx24'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 10) ] <- 'ATx25'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 11) ] <- 'ATx27'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 12) ] <- 'ATx34'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 13) ] <- 'ATx38'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 14) ] <- 'ATx41'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 15) ] <- 'ATx44'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 16) ] <- 'ATx50'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 17) ] <- 'ATx36'

Coactivation_IndividualHops$Participant_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Participant_ID == 18) ] <- 'ATx49'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx39'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx74'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx65'








TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 1) ] <- 'HC05'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 2) ] <- 'HC06'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 3) ] <- 'HC11'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 4) ] <- 'HC12'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 5) ] <- 'HC17'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 6) ] <- 'HC18'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 7) ] <- 'HC19'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 8) ] <- 'HC20'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 9) ] <- 'HC21'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 10) ] <- 'HC25'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 11) ] <- 'HC42'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 12) ] <- 'HC45'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 13) ] <- 'HC44'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 14) ] <- 'HC48'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 15) ] <- 'HC65'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 16) ] <- 'HC67'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 17) ] <- 'HC68'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 18) ] <- 'HC30'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 19) ] <- 'HC31'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 20) ] <- 'HC32'






#Convert Limb_ID numbers into labels. The numbers are the same between groups, so need to tell the code to find the limbs for the ATx group separately from the Control group
Coactivation_IndividualHops$Limb_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Limb_ID==1) ] <- 'Involved'

Coactivation_IndividualHops$Limb_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Limb_ID==2) ] <- 'Non-Involved'


Coactivation_IndividualHops$Limb_ID[which(Coactivation_IndividualHops$Group_ID == 2 & Coactivation_IndividualHops$Limb_ID==1) ] <- 'Matched Dominance'

Coactivation_IndividualHops$Limb_ID[which(Coactivation_IndividualHops$Group_ID == 2 & Coactivation_IndividualHops$Limb_ID==2) ] <- 'Contralateral'


#Convert Limb ID into a categorical variable. Order the levels based on their position in the levels vector
Coactivation_IndividualHops$Limb_ID <- factor( Coactivation_IndividualHops$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )


#Group 1 is the ATx group
Coactivation_IndividualHops$Group_ID[which(Coactivation_IndividualHops$Group_ID==1) ] <- 'ATx'

#Group 2 is the Control group
Coactivation_IndividualHops$Group_ID[which(Coactivation_IndividualHops$Group_ID==2) ] <- 'Control'




```







### Participant Means
```{r EMG Magnitude/Coactivation}

Coactivation_ParticipantMeans <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/EMG/EMG MagnitudeCoactivation/PostQuals_HoppingCoactivationRatio_ParticipantMeansPerRate.xlsx' ) )

#Participant 1 of Group 1 is ATx07
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID==1) ] <- 'ATx07'

#Participant 2 of Group 1 is ATx10
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID==2) ] <- 'ATx08'

#Participant 2 of Group 1 is ATx10
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID==3) ] <- 'ATx10'

#Participant 2 of Group 1 is ATx10
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID==4) ] <- 'ATx12'

#Participant 3 of Group 1 is ATx17
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID==5) ] <- 'ATx17'

#Participant 4 of Group 1 is ATx18
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID==6) ] <- 'ATx18'

#Participant 5 of Group 1 is ATx19
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID==7) ] <- 'ATx19'

#Participant 6 of Group 1 is ATx21
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 8) ] <- 'ATx21'

#Participant 6 of Group 1 is ATx21
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 9) ] <- 'ATx24'

#Participant 6 of Group 1 is ATx21
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 10) ] <- 'ATx25'

#Participant 6 of Group 1 is ATx21
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 11) ] <- 'ATx27'

#Participant 6 of Group 1 is ATx21
Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 12) ] <- 'ATx34'

Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 13) ] <- 'ATx38'

Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 14) ] <- 'ATx41'

Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 15) ] <- 'ATx44'

Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 16) ] <- 'ATx50'

Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 17) ] <- 'ATx36'

Coactivation_ParticipantMeans$Participant_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Participant_ID == 18) ] <- 'ATx49'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx39'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx74'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 1 & TotalPower$Participant_ID == 18) ] <- 'ATx65'





TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 1) ] <- 'HC05'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 2) ] <- 'HC06'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 3) ] <- 'HC11'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 4) ] <- 'HC12'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 5) ] <- 'HC17'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 6) ] <- 'HC18'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 7) ] <- 'HC19'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 8) ] <- 'HC20'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 9) ] <- 'HC21'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 10) ] <- 'HC25'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 11) ] <- 'HC42'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 12) ] <- 'HC45'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 13) ] <- 'HC44'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 14) ] <- 'HC48'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 15) ] <- 'HC65'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 16) ] <- 'HC67'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 17) ] <- 'HC68'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 18) ] <- 'HC30'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 19) ] <- 'HC31'

TotalPower$Participant_ID[which(TotalPower$Group_ID == 2 & TotalPower$Participant_ID == 20) ] <- 'HC32'







#Limb 1 of Group 1 is the Involved Limb
Coactivation_ParticipantMeans$Limb_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Limb_ID==1) ] <- 'Involved'

#Limb 1 of Group 1 is the Non-Involved Limb
Coactivation_ParticipantMeans$Limb_ID[which(Coactivation_ParticipantMeans$Group_ID == 1 & Coactivation_ParticipantMeans$Limb_ID==2) ] <- 'Non-Involved'


Coactivation_ParticipantMeans$Limb_ID[which(Coactivation_ParticipantMeans$Group_ID == 2 & Coactivation_ParticipantMeans$Limb_ID==1) ] <- 'Matched Dominance'

Coactivation_ParticipantMeans$Limb_ID[which(Coactivation_ParticipantMeans$Group_ID == 2 & Coactivation_ParticipantMeans$Limb_ID==2) ] <- 'Contralateral'


#Convert Limb ID into a categorical variable. Order the levels based on their position in the levels vector
Coactivation_ParticipantMeans$Limb_ID <- factor( Coactivation_ParticipantMeans$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )



#Group 1 is the ATx group
Coactivation_ParticipantMeans$Group_ID[which(Coactivation_ParticipantMeans$Group_ID==1) ] <- 'ATx'

#Group 2 is the Control group
Coactivation_ParticipantMeans$Group_ID[which(Coactivation_ParticipantMeans$Group_ID==2) ] <- 'Control'




#Calculate LatGas contribution to TS activation
   #Braking Phase
Coactivation_ParticipantMeans$Mean_LatGasContributiontoAllTS_BrakingPhase <- Coactivation_ParticipantMeans$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase - Coactivation_ParticipantMeans$Mean_MedGasContributiontoAllTS_BrakingPhase

   #Propulsion Phase
Coactivation_ParticipantMeans$Mean_LatGasContributiontoAllTS_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase - Coactivation_ParticipantMeans$Mean_MedGasContributiontoAllTS_PropulsionPhase


```


###Group Means
```{r EMG Coactivation}

Coactivation_GroupMeans_ <- as.data.frame( read_xlsx( '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Excel/EMG/EMG MagnitudeCoactivation/PostQuals_HoppingCoactivationRatio_GroupMeansPerRate25-Aug-2023.xlsx' ) )




#Convert Limb_ID numbers into labels. The numbers are the same between groups, so need to tell the code to find the limbs for the ATx group separately from the Control group
Coactivation_IndividualHops$Limb_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Limb_ID==1) ] <- 'Involved'

Coactivation_IndividualHops$Limb_ID[which(Coactivation_IndividualHops$Group_ID == 1 & Coactivation_IndividualHops$Limb_ID==2) ] <- 'Non-Involved'


Coactivation_IndividualHops$Limb_ID[which(Coactivation_IndividualHops$Group_ID == 2 & Coactivation_IndividualHops$Limb_ID==1) ] <- 'Matched Dominance'

Coactivation_IndividualHops$Limb_ID[which(Coactivation_IndividualHops$Group_ID == 2 & Coactivation_IndividualHops$Limb_ID==2) ] <- 'Contralateral'


#Convert Limb ID into a categorical variable. Order the levels based on their position in the levels vector
Coactivation_IndividualHops$Limb_ID <- factor( Coactivation_IndividualHops$Limb_ID, levels = c('Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral'), ordered = T )



#Group 1 is the ATx group
Coactivation_GroupMeans_$Group_ID[which(Coactivation_GroupMeans_$Group_ID==1) ] <- 'ATx'

#Group 2 is the Control group
Coactivation_GroupMeans_$Group_ID[which(Coactivation_GroupMeans_$Group_ID==2) ] <- 'Control'



#Convert Group_ID into a categorical variable
Coactivation_GroupMeans_$Group_ID <- factor(Coactivation_GroupMeans_$Group_ID)





#Calculate LatGas contribution to TS activation
   #Braking Phase
Coactivation_GroupMeans_$Mean_LatGasContributiontoAllTS_BrakingPhase <- Coactivation_GroupMeans_$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase - Coactivation_GroupMeans_$Mean_MedGasContributiontoAllTS_BrakingPhase

   #Propulsion Phase
Coactivation_GroupMeans_$Mean_LatGasContributiontoAllTS_PropulsionPhase <- Coactivation_GroupMeans_$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase - Coactivation_GroupMeans_$Mean_MedGasContributiontoAllTS_PropulsionPhase



#Create a new column, Group_by_Tendinopathy_Type. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
Coactivation_IndividualHops$Group_by_Tendinopathy_Type <- 'Control'

#Change the labels of Group_by_Tendinopathy_Type depending on the participant
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx07' ) ] <- 'Unilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx08' ) ] <- 'Bilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx10' ) ] <- 'Bilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx12' ) ] <- 'Unilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx17' ) ] <- 'Unilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx18' ) ] <- 'Bilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx19' ) ] <- 'Bilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx21' ) ] <- 'Unilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx24' ) ] <- 'Bilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx25' ) ] <- 'Unilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx27' ) ] <- 'Bilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx34' ) ] <- 'Bilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx36' ) ] <- 'Bilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx38' ) ] <- 'Unilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx41' ) ] <- 'Unilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx44' ) ] <- 'Unilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx49' ) ] <- 'Bilateral'
Coactivation_IndividualHops$Group_by_Tendinopathy_Type[ which( Coactivation_IndividualHops$Participant_ID == 'ATx50' ) ] <- 'Unilateral'

#Convert Group_by_Tendinopathy_Type into a categorical variable
Coactivation_IndividualHops$Group_by_Tendinopathy_Type <- factor( Coactivation_IndividualHops$Group_by_Tendinopathy_Type, levels = c( 'Unilateral', 'Bilateral', 'Control'), ordered = T )


#Create a new column, Group_by_Morphology. Will first assign the Control label to all rows. The following lines of code will change the labels depending on the participant
Coactivation_IndividualHops$Group_by_Morphology <- 'Control'

#Change the labels of Group_by_Morphology depending on the participant
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx07' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx08' ) ] <- 'Minimum_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx10' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx12' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx17' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx18' ) ] <- 'Minimum_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx19' ) ] <- 'Minimum_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx21' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx24' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx25' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx27' ) ] <- 'Minimum_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx34' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx38' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx41' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx44' ) ] <- 'Minimum_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx50' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx36' ) ] <- 'LessThan_2mm_Diff'
Coactivation_IndividualHops$Group_by_Morphology[ which( Coactivation_IndividualHops$Participant_ID == 'ATx49' ) ] <- 'LessThan_2mm_Diff'


#Convert Group_by_Morphology into a categorical variable. Order the labels based on their position in the levels vector.
Coactivation_IndividualHops$Group_by_Morphology_NotFactored <- Coactivation_IndividualHops$Group_by_Morphology


#Convert Group_by_Morphology into a categorical variable
Coactivation_IndividualHops$Group_by_Morphology <- factor( Coactivation_IndividualHops$Group_by_Morphology, levels = c( 'LessThan_2mm_Diff', 'Minimum_2mm_Diff', 'Control'), ordered = T )

```




## Combine Data Sets
```{r Find Unique Group IDs}

UniqueGroupID <- unique( Coactivation_ParticipantMeans$Group_ID )



```

### Individual Hops
```{r Initialize New Data Set}

#Create new data set
Dissertation_CombinedMEEandEMG_IndividualHops <- Coactivation_IndividualHops


#Add coactivation data to Dissertation_CombinedMEEandEMG_IndividualHops

   #MedGas iEMG for Contact phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_ContactPhase <- Coactivation_IndividualHops$MedGas_iEMG_ContactPhase

   #LatGas iEMG for Contact phase            
Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_ContactPhase <- Coactivation_IndividualHops$GasLat_iEMG_ContactPhase

   #Sol iEMG for Contact phase            
Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_ContactPhase <- Coactivation_IndividualHops$Sol_iEMG_ContactPhase

   #PL iEMG for Contact phase            
Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_ContactPhase <- Coactivation_IndividualHops$PL_iEMG_ContactPhase

   #TA iEMG for Contact phase            
Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_ContactPhase <- Coactivation_IndividualHops$TA_iEMG_ContactPhase





   #MedGas iEMG for braking phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_BrakingPhase <- Coactivation_IndividualHops$MedGas_iEMG_BrakingPhase

   #LatGas iEMG for braking phase            
Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_BrakingPhase <- Coactivation_IndividualHops$GasLat_iEMG_BrakingPhase

   #Sol iEMG for braking phase            
Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_BrakingPhase <- Coactivation_IndividualHops$Sol_iEMG_BrakingPhase

   #PL iEMG for braking phase            
Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_BrakingPhase <- Coactivation_IndividualHops$PL_iEMG_BrakingPhase

   #TA iEMG for braking phase            
Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_BrakingPhase <- Coactivation_IndividualHops$TA_iEMG_BrakingPhase



   #MedGas iEMG for Propulsion phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase <- Coactivation_IndividualHops$MedGas_iEMG_PropulsionPhase

   #LatGas iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase <- Coactivation_IndividualHops$GasLat_iEMG_PropulsionPhase

   #Sol iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase <- Coactivation_IndividualHops$Sol_iEMG_PropulsionPhase

   #PL iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_PropulsionPhase <- Coactivation_IndividualHops$PL_iEMG_PropulsionPhase

   #TA iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_PropulsionPhase <- Coactivation_IndividualHops$TA_iEMG_PropulsionPhase





   #TSContributiontoPFActivity for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_ContactPhase <- Coactivation_IndividualHops$AllTSContributiontoPFActivity_ContactPhase

   #MedGasandSolContributiontoPFActivity for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasandSolContributiontoPFActivity_ContactPhase <- Coactivation_IndividualHops$MedGasandSolContributiontoPFActivity_ContactPhase

   #MedGasContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasContributiontoAllTS_ContactPhase <- Coactivation_IndividualHops$MedGasContributiontoTSActivation_ContactPhase

   #TAvsAllPF_CoactivationRatio for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TAvsAllPF_CoactivationRatio_ContactPhase <- Coactivation_IndividualHops$TAvsAllPF_CoactivationRatio_ContactPhase

   #TwoJointTS_Contribution2AllPF for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_ContactPhase <- Coactivation_IndividualHops$GastrocnemiiContributiontoPFActivity_ContactPhase

   #OneJointTS_Contribution2AllPF for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_ContactPhase <- Coactivation_IndividualHops$SolContributiontoTSActivity_ContactPhase

   #SolContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$SolContributiontoAllTS_ContactPhase <- Coactivation_IndividualHops$SolContributiontoTSActivity_ContactPhase

#GastrocnemiiContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$GastrocnemiiContributiontoAllTS_ContactPhase <- Coactivation_IndividualHops$GastrocnemiiContributiontoTSActivtion_ContactPhase






   #TSContributiontoPFActivity for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase <- Coactivation_IndividualHops$TSContributiontoPFActivityBrakingPhase

   #MedGasandSolContributiontoPFActivity for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasandSolContributiontoPFActivity_BrakingPhase <- Coactivation_IndividualHops$MedGasandSolContributiontoPFActivity_BrakingPhase

   #MedGasContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasContributiontoAllTS_BrakingPhase <- Coactivation_IndividualHops$MedGasContributiontoAllTS_BrakingPhase

   #TAvsAllPF_CoactivationRatio for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TAvsAllPF_CoactivationRatio_BrakingPhase <- Coactivation_IndividualHops$TAvsAllPF_CoactivationRatio_BrakingPhase

   #TwoJointTS_Contribution2AllPF for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase <- Coactivation_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase

   #OneJointTS_Contribution2AllPF for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase <- Coactivation_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase

   #SolContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$SolContributiontoAllTS_BrakingPhase <- Coactivation_IndividualHops$SolContributiontoAllTS_BrakingPhase

#GastrocnemiiContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$GastrocnemiiContributiontoAllTS_BrakingPhase <- Coactivation_IndividualHops$GastrocnemiiContributiontoAllTS_BrakingPhase





#TSContributiontoPFActivity for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase <- Coactivation_IndividualHops$TSContributiontoPFActivity_PropulsionPhase

   #MedGasandSolContributiontoPFActivity for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasandSolContributiontoPFActivity_PropulsionPhase <- Coactivation_IndividualHops$MedGasandSolContributiontoPFActivity_PropulsionPhase

   #MedGasContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasContributiontoAllTS_PropulsionPhase <- Coactivation_IndividualHops$MedGasContributiontoAllTS_PropulsionPhase

   #TAvsAllPF_CoactivationRatio for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TAvsAllPF_CoactivationRatio_PropulsionPhase <- Coactivation_IndividualHops$TAvsAllPF_CoactivationRatio_PropulsionPhase

   #TwoJointTS_Contribution2AllPF for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase <- Coactivation_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase

   #OneJointTS_Contribution2AllPF for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase <- Coactivation_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase

   #SolContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$SolContributiontoAllTS_PropulsionPhase <- Coactivation_IndividualHops$SolContributiontoAllTS_PropulsionPhase

#GastrocnemiiContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$GastrocnemiiContributiontoAllTS_PropulsionPhase <- Coactivation_IndividualHops$GastrocnemiiContributiontoAllTS_PropulsionPhase



#PF Activation Ratio (Hop:SLVJ) for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase <- Coactivation_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase

#PF Activation Ratio (Hop:SLVJ) for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase <- Coactivation_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase

#PF Activation Ratio (Hop:SLVJ) for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase <- Coactivation_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase


```



```{r Replace Values in New Data Set }

for ( j in 1 : length( UniqueGroupID )  ) {
   
   #Find all rows of Dissertation_CombinedMEEandEMG_IndividualHops that belong to Group J
   Dissertation_CombinedMEEandEMG_IndividualHops_GroupIndices <- which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == UniqueGroupID[ j ] )
   
   #Find the different hopping rates for Group J
   UniqueHoppingRate <- unique( Dissertation_CombinedMEEandEMG_IndividualHops$HoppingRate_ID[ Dissertation_CombinedMEEandEMG_IndividualHops_GroupIndices ] )
   
   for (k in 1 : length( UniqueHoppingRate )  ) {
      
      #Find all rows of Dissertation_CombinedMEEandEMG_IndividualHops that belong to Group J and Hopping Rate K
      Dissertation_CombinedMEEandEMG_IndividualHops_HoppingRateKIndices <- which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == UniqueGroupID[ j ] & Dissertation_CombinedMEEandEMG_IndividualHops$HoppingRate_ID == UniqueHoppingRate[ k ] )
   
      #Find the different participants for Group J and Hopping Rate K
      UniqueParticipantID <- unique( Dissertation_CombinedMEEandEMG_IndividualHops$Participant_ID[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == UniqueGroupID[ j ] & Dissertation_CombinedMEEandEMG_IndividualHops$HoppingRate_ID == UniqueHoppingRate[ k ] ) ] )
   
      
      for ( l in 1 : length( UniqueParticipantID ) ) {
         
         #Find all rows of Dissertation_CombinedMEEandEMG_IndividualHops that belong to Group J, Hopping Rate K, Participant L
         Dissertation_CombinedMEEandEMG_IndividualHops_ParticipantLIndices <- which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == UniqueGroupID[ j ] & Dissertation_CombinedMEEandEMG_IndividualHops$HoppingRate_ID == UniqueHoppingRate[ k ] & Dissertation_CombinedMEEandEMG_IndividualHops$Participant_ID == UniqueParticipantID[ l ] )
         
         
         #Find the different limbs for Group J, Hopping Rate K, Participant L
         UniqueLimbID <- unique( Dissertation_CombinedMEEandEMG_IndividualHops$Limb_ID[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == UniqueGroupID[ j ] & Dissertation_CombinedMEEandEMG_IndividualHops$HoppingRate_ID == UniqueHoppingRate[ k ] & Dissertation_CombinedMEEandEMG_IndividualHops$Participant_ID == UniqueParticipantID[ l ] ) ] )
         
         
         for (m in 1 : length( UniqueLimbID ) ) {
            
            #Find all rows of Dissertation_CombinedMEEandEMG_IndividualHops that belong to Group J, Hopping Rate K, Participant L, Limb M
            Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices <- which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == UniqueGroupID[ j ] & Dissertation_CombinedMEEandEMG_IndividualHops$HoppingRate_ID == UniqueHoppingRate[ k ] & Dissertation_CombinedMEEandEMG_IndividualHops$Participant_ID == UniqueParticipantID[ l ] & Dissertation_CombinedMEEandEMG_IndividualHops$Limb_ID == UniqueLimbID[ m ] )
            
            
            #Find all rows of Coactivation_IndividualHops that belong to Group J, Hopping Rate K, Participant L, Limb M
            Coactivation_LimbMIndices <- which( Coactivation_IndividualHops$Group_ID == UniqueGroupID[ j ] & Coactivation_IndividualHops$HoppingRate_ID == UniqueHoppingRate[ k ] & Coactivation_IndividualHops$Participant_ID == UniqueParticipantID[ l ] & Coactivation_IndividualHops$Limb_ID == UniqueLimbID[ m ] )
         
            
#Code below will replace coactivation/EMG data values in Dissertation_CombinedMEEandEMG_IndividualHops with the correct ones for each group-participant-hopping rate-limb combo. Need to do this because the number of observations in Dissertation_CombinedMEEandEMG_IndividualHops is greater than that in Coactivation_IndividualHops. Therefore, when the EMG/coactivation data was added to Dissertation_CombinedMEEandEMG_IndividualHops, values were repeated but not necessarily in the correct places.
            
            
   #MedGas iEMG for Contact phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$MedGas_iEMG_ContactPhase[ Coactivation_LimbMIndices ]

   #LatGas iEMG for Contact phase            
Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$GasLat_iEMG_ContactPhase[ Coactivation_LimbMIndices ]

   #Sol iEMG for Contact phase            
Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$Sol_iEMG_ContactPhase[ Coactivation_LimbMIndices ]

   #PL iEMG for Contact phase            
Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$PL_iEMG_ContactPhase[ Coactivation_LimbMIndices ]

   #TA iEMG for Contact phase            
Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$TA_iEMG_ContactPhase[ Coactivation_LimbMIndices ]            
            
            
            
   #MedGas iEMG for braking phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$MedGas_iEMG_BrakingPhase[ Coactivation_LimbMIndices ]


   #LatGas iEMG for braking phase            
Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$GasLat_iEMG_BrakingPhase[ Coactivation_LimbMIndices ]

   #Sol iEMG for braking phase            
Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$Sol_iEMG_BrakingPhase[ Coactivation_LimbMIndices ]

   #PL iEMG for braking phase            
Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$PL_iEMG_BrakingPhase[ Coactivation_LimbMIndices ]

   #TA iEMG for braking phase            
Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$TA_iEMG_BrakingPhase[ Coactivation_LimbMIndices ]



   #MedGas iEMG for Propulsion phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$MedGas_iEMG_PropulsionPhase[ Coactivation_LimbMIndices ]

   #LatGas iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$GasLat_iEMG_PropulsionPhase[ Coactivation_LimbMIndices ]

   #Sol iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$Sol_iEMG_PropulsionPhase[ Coactivation_LimbMIndices ]

   #PL iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$PL_iEMG_PropulsionPhase[ Coactivation_LimbMIndices ]

   #TA iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$TA_iEMG_PropulsionPhase[ Coactivation_LimbMIndices ]



   #TSContributiontoPFActivity for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$AllTSContributiontoPFActivity_ContactPhase[ Coactivation_LimbMIndices ]

   #MedGasandSolContributiontoPFActivity for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasandSolContributiontoPFActivity_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$MedGasandSolContributiontoPFActivity_ContactPhase[ Coactivation_LimbMIndices ]

   #MedGasContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasContributiontoAllTS_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$MedGasContributiontoTSActivation_ContactPhase[ Coactivation_LimbMIndices ]

   #TAvsAllPF_CoactivationRatio for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TAvsAllPF_CoactivationRatio_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$TAvsAllPF_CoactivationRatio_ContactPhase[ Coactivation_LimbMIndices ]

   #TwoJointTS_Contribution2AllPF for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$GastrocnemiiContributiontoPFActivity_ContactPhase[ Coactivation_LimbMIndices ]

   #OneJointTS_Contribution2AllPF for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$SolContributiontoTSActivity_ContactPhase[ Coactivation_LimbMIndices ]

   #SolContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$SolContributiontoAllTS_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$SolContributiontoTSActivity_ContactPhase[ Coactivation_LimbMIndices ]

#GastrocnemiiContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$GastrocnemiiContributiontoAllTS_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$GastrocnemiiContributiontoTSActivtion_ContactPhase[ Coactivation_LimbMIndices ]





   #TSContributiontoPFActivity for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$TSContributiontoPFActivityBrakingPhase[ Coactivation_LimbMIndices ]

   #MedGasandSolContributiontoPFActivity for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasandSolContributiontoPFActivity_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$MedGasandSolContributiontoPFActivity_BrakingPhase[ Coactivation_LimbMIndices ]

   #MedGasContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasContributiontoAllTS_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$MedGasContributiontoAllTS_BrakingPhase[ Coactivation_LimbMIndices ]

   #TAvsAllPF_CoactivationRatio for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TAvsAllPF_CoactivationRatio_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$TAvsAllPF_CoactivationRatio_BrakingPhase[ Coactivation_LimbMIndices ]

   #TwoJointTS_Contribution2AllPF for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase[ Coactivation_LimbMIndices ]

   #OneJointTS_Contribution2AllPF for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase[ Coactivation_LimbMIndices ]

   #SolContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$SolContributiontoAllTS_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$SolContributiontoAllTS_BrakingPhase[ Coactivation_LimbMIndices ]

#GastrocnemiiContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$GastrocnemiiContributiontoAllTS_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$GastrocnemiiContributiontoAllTS_BrakingPhase[ Coactivation_LimbMIndices ]





#TSContributiontoPFActivity for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$TSContributiontoPFActivity_PropulsionPhase[ Coactivation_LimbMIndices ]

   #MedGasandSolContributiontoPFActivity for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasandSolContributiontoPFActivity_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$MedGasandSolContributiontoPFActivity_PropulsionPhase[ Coactivation_LimbMIndices ]

   #MedGasContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$MedGasContributiontoAllTS_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$MedGasContributiontoAllTS_PropulsionPhase[ Coactivation_LimbMIndices ]

   #TAvsAllPF_CoactivationRatio for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TAvsAllPF_CoactivationRatio_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$TAvsAllPF_CoactivationRatio_PropulsionPhase[ Coactivation_LimbMIndices ]

   #TwoJointTS_Contribution2AllPF for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase[ Coactivation_LimbMIndices ]

   #OneJointTS_Contribution2AllPF for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase[ Coactivation_LimbMIndices ]

   #SolContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$SolContributiontoAllTS_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$SolContributiontoAllTS_PropulsionPhase[ Coactivation_LimbMIndices ]

#GastrocnemiiContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$GastrocnemiiContributiontoAllTS_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$GastrocnemiiContributiontoAllTS_PropulsionPhase[ Coactivation_LimbMIndices ]



#PF Activation Ratio (Hop:SLVJ) for Contact Phase
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase[ Coactivation_LimbMIndices ]

#PF Activation Ratio (Hop:SLVJ) for Braking Phase
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase[ Coactivation_LimbMIndices ]

#PF Activation Ratio (Hop:SLVJ) for Propulsion Phase
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ Dissertation_CombinedMEEandEMG_IndividualHops_LimbMIndices ] <- Coactivation_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ Coactivation_LimbMIndices ]
            
            
         }#End for loop for Limb ID
         
         
      }#End for loop for Participant ID
   
   
   }#End for loop for Hopping Rate ID
   
}#End for loop for Group ID


Dissertation_CombinedMEEandEMG_IndividualHops$TotalTSActivation_PropulsionPhase <- Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase + Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase + Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase


```


```{r Multiply Ratios By 100}
Dissertation_CombinedMEEandEMG_IndividualHops$EugeneContributionIndx <- Dissertation_CombinedMEEandEMG_IndividualHops$EugeneContributionIndx*100

Dissertation_CombinedMEEandEMG_IndividualHops$Joint_Percent_MEE_Generation <- Dissertation_CombinedMEEandEMG_IndividualHops$Joint_Percent_MEE_Generation*100


Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase*100

Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase*100






Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase <- Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase*100

Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase <- Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase*100



Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase <- Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase*100

Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase <- Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase*100


Dissertation_CombinedMEEandEMG_IndividualHops$KneetoAnkleMEERatio_Braking <- Dissertation_CombinedMEEandEMG_IndividualHops$KneePercentMEE_ofAnkleandKneeMEE_Braking / Dissertation_CombinedMEEandEMG_IndividualHops$AnklePercentMEE_ofAnkleandKneeMEE_Braking

Dissertation_CombinedMEEandEMG_IndividualHops$KneetoAnkleMEERatio_Propulsion <- Dissertation_CombinedMEEandEMG_IndividualHops$KneePercentMEE_ofAnkleandKneeMEE_Propulsion / Dissertation_CombinedMEEandEMG_IndividualHops$AnklePercentMEE_ofAnkleandKneeMEE_Propulsion

Dissertation_CombinedMEEandEMG_IndividualHops$KneetoAnkleMEERatio_Contact <- Dissertation_CombinedMEEandEMG_IndividualHops$KneePercentMEE_ofAnkleandKneeMEE_Contact / Dissertation_CombinedMEEandEMG_IndividualHops$AnklePercentMEE_ofAnkleandKneeMEE_Contact

```


```{r Center Predictors}
#Center TS contribution for braking phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )

#Center TS contribution for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )










#Center Two-Joint TS contribution for braking phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )

#Center Two-Joint TS contribution for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TwoJointTS_Contribution2AllPF_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )








#Center One-Joint TS contribution for braking phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )

#Center One-Joint TS contribution for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$OneJointTS_Contribution2AllPF_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )






#Center Sol iEMG for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$Sol_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )





#Center PL iEMG for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_PropulsionPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PL_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )










#Center MedGas iEMG for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$MedGas_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )










#Center GasLat iEMG for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$GasLat_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )





#Center TA iEMG for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_PropulsionPhase

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TA_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )





#Divide TSContributiontoPFActivity_PropulsionPhase by 100 to better match scale of raw joint MEE
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Maxof1 <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase/100

#Center TS contribution for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Maxof1_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Maxof1

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Maxof1_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Maxof1[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Maxof1[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Maxof1_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Maxof1[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase_Maxof1[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )








#Center PF activation ratio (Hop:SLVJ) for contact phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase


#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_ContactPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )





#Center PF activation ratio (Hop:SLVJ) for braking phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase


#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )





#Center PF activation ratio (Hop:SLVJ) for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase


#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )
```


### Participant Means

```{r Initialize New Data Set}

#Create new data set
Dissertation_CombinedMEEandEMG <- Coactivation_ParticipantMeans


#Add coactivation data to Dissertation_CombinedMEEandEMG

   #MedGas iEMG for Contact phase
Dissertation_CombinedMEEandEMG$Mean_MedGas_iEMG_ContactPhase <- Coactivation_ParticipantMeans$Mean_MedGas_iEMG_ContactPhase

   #LatGas iEMG for Contact phase            
Dissertation_CombinedMEEandEMG$Mean_GasLat_iEMG_ContactPhase <- Coactivation_ParticipantMeans$Mean_GasLat_iEMG_ContactPhase

   #Sol iEMG for Contact phase            
Dissertation_CombinedMEEandEMG$Mean_Sol_iEMG_ContactPhase <- Coactivation_ParticipantMeans$Mean_Sol_iEMG_ContactPhase

   #PL iEMG for Contact phase            
Dissertation_CombinedMEEandEMG$Mean_PL_iEMG_ContactPhase <- Coactivation_ParticipantMeans$Mean_PL_iEMG_ContactPhase

   #TA iEMG for Contact phase            
Dissertation_CombinedMEEandEMG$Mean_TA_iEMG_ContactPhase <- Coactivation_ParticipantMeans$Mean_TA_iEMG_ContactPhase





   #MedGas iEMG for braking phase
Dissertation_CombinedMEEandEMG$Mean_MedGas_iEMG_BrakingPhase <- Coactivation_ParticipantMeans$Mean_MedGas_iEMG_BrakingPhase

   #LatGas iEMG for braking phase            
Dissertation_CombinedMEEandEMG$Mean_GasLat_iEMG_BrakingPhase <- Coactivation_ParticipantMeans$Mean_GasLat_iEMG_BrakingPhase

   #Sol iEMG for braking phase            
Dissertation_CombinedMEEandEMG$Mean_Sol_iEMG_BrakingPhase <- Coactivation_ParticipantMeans$Mean_Sol_iEMG_BrakingPhase

   #PL iEMG for braking phase            
Dissertation_CombinedMEEandEMG$Mean_PL_iEMG_BrakingPhase <- Coactivation_ParticipantMeans$Mean_PL_iEMG_BrakingPhase

   #TA iEMG for braking phase            
Dissertation_CombinedMEEandEMG$Mean_TA_iEMG_BrakingPhase <- Coactivation_ParticipantMeans$Mean_TA_iEMG_BrakingPhase



   #MedGas iEMG for Propulsion phase
Dissertation_CombinedMEEandEMG$Mean_MedGas_iEMG_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_MedGas_iEMG_PropulsionPhase

   #LatGas iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG$Mean_GasLat_iEMG_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_GasLat_iEMG_PropulsionPhase

   #Sol iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG$Mean_Sol_iEMG_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_Sol_iEMG_PropulsionPhase

   #PL iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG$Mean_PL_iEMG_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_PL_iEMG_PropulsionPhase

   #TA iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG$Mean_TA_iEMG_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_TA_iEMG_PropulsionPhase





   #TSContributiontoPFActivity for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_ContactPhase <- Coactivation_ParticipantMeans$Mean_AllTSContributiontoPFActivity_ContactPhase

   #MedGasandSolContributiontoPFActivity for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasandSolContributiontoPFActivity_ContactPhase <- Coactivation_ParticipantMeans$Mean_MedGasandSolContributiontoPFActivity_ContactPhase

   #MedGasContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasContributiontoAllTS_ContactPhase <- Coactivation_ParticipantMeans$Mean_MedGasContributiontoTSActivation_ContactPhase

   #TAvsAllPF_CoactivationRatio for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_TAvsAllPF_CoactivationRatio_ContactPhase <- Coactivation_ParticipantMeans$Mean_TAvsAllPF_CoactivationRatio_ContactPhase

   #TwoJointTS_Contribution2AllPF for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_ContactPhase <- Coactivation_ParticipantMeans$Mean_GastrocnemiiContributiontoPFActivity_ContactPhase

   #OneJointTS_Contribution2AllPF for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_ContactPhase <- Coactivation_ParticipantMeans$Mean_SolContributiontoTSActivity_ContactPhase

   #SolContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_ContactPhase <- Coactivation_ParticipantMeans$Mean_SolContributiontoTSActivity_ContactPhase

#GastrocnemiiContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_ContactPhase <- Coactivation_ParticipantMeans$Mean_GastrocnemiiContributiontoTSActivtion_ContactPhase






   #TSContributiontoPFActivity for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase <- Coactivation_ParticipantMeans$Mean_TSContributiontoPFActivityBrakingPhase

   #MedGasandSolContributiontoPFActivity for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasandSolContributiontoPFActivity_BrakingPhase <- Coactivation_ParticipantMeans$Mean_MedGasandSolContributiontoPFActivity_BrakingPhase

   #MedGasContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasContributiontoAllTS_BrakingPhase <- Coactivation_ParticipantMeans$Mean_MedGasContributiontoAllTS_BrakingPhase

   #TAvsAllPF_CoactivationRatio for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase <- Coactivation_ParticipantMeans$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase

   #TwoJointTS_Contribution2AllPF for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase <- Coactivation_ParticipantMeans$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase

   #OneJointTS_Contribution2AllPF for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_BrakingPhase <- Coactivation_ParticipantMeans$Mean_OneJointTS_Contribution2AllPF_BrakingPhase

   #SolContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_BrakingPhase <- Coactivation_ParticipantMeans$Mean_SolContributiontoAllTS_BrakingPhase

#GastrocnemiiContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase <- Coactivation_ParticipantMeans$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase





#TSContributiontoPFActivity for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_TSContributiontoPFActivity_PropulsionPhase

   #MedGasandSolContributiontoPFActivity for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasandSolContributiontoPFActivity_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_MedGasandSolContributiontoPFActivity_PropulsionPhase

   #MedGasContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasContributiontoAllTS_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_MedGasContributiontoAllTS_PropulsionPhase

   #TAvsAllPF_CoactivationRatio for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase

   #TwoJointTS_Contribution2AllPF for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase

   #OneJointTS_Contribution2AllPF for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase

   #SolContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_SolContributiontoAllTS_PropulsionPhase

#GastrocnemiiContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase



#PF Activation Ratio (Hop:SLVJ) for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase <- Coactivation_ParticipantMeans$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase

#PF Activation Ratio (Hop:SLVJ) for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase <- Coactivation_ParticipantMeans$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase

#PF Activation Ratio (Hop:SLVJ) for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase <- Coactivation_ParticipantMeans$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase

```



```{r Replace Values in New Data Set }

for ( j in 1 : length( UniqueGroupID )  ) {
   
   #Find all rows of Dissertation_CombinedMEEandEMG that belong to Group J
   Dissertation_CombinedMEEandEMG_GroupIndices <- which( Dissertation_CombinedMEEandEMG$Group_ID == UniqueGroupID[ j ] )
   
   #Find the different hopping rates for Group J
   UniqueHoppingRate <- unique( Dissertation_CombinedMEEandEMG$HoppingRate_ID[ Dissertation_CombinedMEEandEMG_GroupIndices ] )
   
   for (k in 1 : length( UniqueHoppingRate )  ) {
      
      #Find all rows of Dissertation_CombinedMEEandEMG that belong to Group J and Hopping Rate K
      Dissertation_CombinedMEEandEMG_HoppingRateKIndices <- which( Dissertation_CombinedMEEandEMG$Group_ID == UniqueGroupID[ j ] & Dissertation_CombinedMEEandEMG$HoppingRate_ID == UniqueHoppingRate[ k ] )
   
      #Find the different participants for Group J and Hopping Rate K
      UniqueParticipantID <- unique( Dissertation_CombinedMEEandEMG$Participant_ID[ which( Dissertation_CombinedMEEandEMG$Group_ID == UniqueGroupID[ j ] & Dissertation_CombinedMEEandEMG$HoppingRate_ID == UniqueHoppingRate[ k ] ) ] )
   
      
      for ( l in 1 : length( UniqueParticipantID ) ) {
         
         #Find all rows of Dissertation_CombinedMEEandEMG that belong to Group J, Hopping Rate K, Participant L
         Dissertation_CombinedMEEandEMG_ParticipantLIndices <- which( Dissertation_CombinedMEEandEMG$Group_ID == UniqueGroupID[ j ] & Dissertation_CombinedMEEandEMG$HoppingRate_ID == UniqueHoppingRate[ k ] & Dissertation_CombinedMEEandEMG$Participant_ID == UniqueParticipantID[ l ] )
         
         
         #Find the different limbs for Group J, Hopping Rate K, Participant L
         UniqueLimbID <- unique( Dissertation_CombinedMEEandEMG$Limb_ID[ which( Dissertation_CombinedMEEandEMG$Group_ID == UniqueGroupID[ j ] & Dissertation_CombinedMEEandEMG$HoppingRate_ID == UniqueHoppingRate[ k ] & Dissertation_CombinedMEEandEMG$Participant_ID == UniqueParticipantID[ l ] ) ] )
         
         
         for (m in 1 : length( UniqueLimbID ) ) {
            
            #Find all rows of Dissertation_CombinedMEEandEMG that belong to Group J, Hopping Rate K, Participant L, Limb M
            Dissertation_CombinedMEEandEMG_LimbMIndices <- which( Dissertation_CombinedMEEandEMG$Group_ID == UniqueGroupID[ j ] & Dissertation_CombinedMEEandEMG$HoppingRate_ID == UniqueHoppingRate[ k ] & Dissertation_CombinedMEEandEMG$Participant_ID == UniqueParticipantID[ l ] & Dissertation_CombinedMEEandEMG$Limb_ID == UniqueLimbID[ m ] )
            
            
            #Find all rows of Coactivation_ParticipantMeans that belong to Group J, Hopping Rate K, Participant L, Limb M
            Coactivation_LimbMIndices <- which( Coactivation_ParticipantMeans$Group_ID == UniqueGroupID[ j ] & Coactivation_ParticipantMeans$HoppingRate_ID == UniqueHoppingRate[ k ] & Coactivation_ParticipantMeans$Participant_ID == UniqueParticipantID[ l ] & Coactivation_ParticipantMeans$Limb_ID == UniqueLimbID[ m ] )
         
            
#Code below will replace coactivation/EMG data values in Dissertation_CombinedMEEandEMG with the correct ones for each group-participant-hopping rate-limb combo. Need to do this because the number of observations in Dissertation_CombinedMEEandEMG is greater than that in Coactivation_ParticipantMeans. Therefore, when the EMG/coactivation data was added to Dissertation_CombinedMEEandEMG, values were repeated but not necessarily in the correct places.
            
            
   #MedGas iEMG for Contact phase
Dissertation_CombinedMEEandEMG$Mean_MedGas_iEMG_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_MedGas_iEMG_ContactPhase[ Coactivation_LimbMIndices ]

   #LatGas iEMG for Contact phase            
Dissertation_CombinedMEEandEMG$Mean_GasLat_iEMG_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_GasLat_iEMG_ContactPhase[ Coactivation_LimbMIndices ]

   #Sol iEMG for Contact phase            
Dissertation_CombinedMEEandEMG$Mean_Sol_iEMG_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_Sol_iEMG_ContactPhase[ Coactivation_LimbMIndices ]

   #PL iEMG for Contact phase            
Dissertation_CombinedMEEandEMG$Mean_PL_iEMG_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_PL_iEMG_ContactPhase[ Coactivation_LimbMIndices ]

   #TA iEMG for Contact phase            
Dissertation_CombinedMEEandEMG$Mean_TA_iEMG_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_TA_iEMG_ContactPhase[ Coactivation_LimbMIndices ]            
            
            
            
   #MedGas iEMG for braking phase
Dissertation_CombinedMEEandEMG$Mean_MedGas_iEMG_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_MedGas_iEMG_BrakingPhase[ Coactivation_LimbMIndices ]


   #LatGas iEMG for braking phase            
Dissertation_CombinedMEEandEMG$Mean_GasLat_iEMG_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_GasLat_iEMG_BrakingPhase[ Coactivation_LimbMIndices ]

   #Sol iEMG for braking phase            
Dissertation_CombinedMEEandEMG$Mean_Sol_iEMG_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_Sol_iEMG_BrakingPhase[ Coactivation_LimbMIndices ]

   #PL iEMG for braking phase            
Dissertation_CombinedMEEandEMG$Mean_PL_iEMG_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_PL_iEMG_BrakingPhase[ Coactivation_LimbMIndices ]

   #TA iEMG for braking phase            
Dissertation_CombinedMEEandEMG$Mean_TA_iEMG_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_TA_iEMG_BrakingPhase[ Coactivation_LimbMIndices ]



   #MedGas iEMG for Propulsion phase
Dissertation_CombinedMEEandEMG$Mean_MedGas_iEMG_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_MedGas_iEMG_PropulsionPhase[ Coactivation_LimbMIndices ]

   #LatGas iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG$Mean_GasLat_iEMG_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_GasLat_iEMG_PropulsionPhase[ Coactivation_LimbMIndices ]

   #Sol iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG$Mean_Sol_iEMG_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_Sol_iEMG_PropulsionPhase[ Coactivation_LimbMIndices ]

   #PL iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG$Mean_PL_iEMG_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_PL_iEMG_PropulsionPhase[ Coactivation_LimbMIndices ]

   #TA iEMG for Propulsion phase            
Dissertation_CombinedMEEandEMG$Mean_TA_iEMG_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_TA_iEMG_PropulsionPhase[ Coactivation_LimbMIndices ]



   #TSContributiontoPFActivity for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_AllTSContributiontoPFActivity_ContactPhase[ Coactivation_LimbMIndices ]

   #MedGasandSolContributiontoPFActivity for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasandSolContributiontoPFActivity_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_MedGasandSolContributiontoPFActivity_ContactPhase[ Coactivation_LimbMIndices ]

   #MedGasContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasContributiontoAllTS_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_MedGasContributiontoTSActivation_ContactPhase[ Coactivation_LimbMIndices ]

   #TAvsAllPF_CoactivationRatio for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_TAvsAllPF_CoactivationRatio_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_TAvsAllPF_CoactivationRatio_ContactPhase[ Coactivation_LimbMIndices ]

   #TwoJointTS_Contribution2AllPF for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_GastrocnemiiContributiontoPFActivity_ContactPhase[ Coactivation_LimbMIndices ]

   #OneJointTS_Contribution2AllPF for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_SolContributiontoTSActivity_ContactPhase[ Coactivation_LimbMIndices ]

   #SolContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_SolContributiontoTSActivity_ContactPhase[ Coactivation_LimbMIndices ]

#GastrocnemiiContributiontoAllTS for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_GastrocnemiiContributiontoTSActivtion_ContactPhase[ Coactivation_LimbMIndices ]





   #TSContributiontoPFActivity for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_TSContributiontoPFActivityBrakingPhase[ Coactivation_LimbMIndices ]

   #MedGasandSolContributiontoPFActivity for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasandSolContributiontoPFActivity_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_MedGasandSolContributiontoPFActivity_BrakingPhase[ Coactivation_LimbMIndices ]

   #MedGasContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasContributiontoAllTS_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_MedGasContributiontoAllTS_BrakingPhase[ Coactivation_LimbMIndices ]

   #TAvsAllPF_CoactivationRatio for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase[ Coactivation_LimbMIndices ]

   #TwoJointTS_Contribution2AllPF for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase[ Coactivation_LimbMIndices ]

   #OneJointTS_Contribution2AllPF for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_OneJointTS_Contribution2AllPF_BrakingPhase[ Coactivation_LimbMIndices ]

   #SolContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_SolContributiontoAllTS_BrakingPhase[ Coactivation_LimbMIndices ]

#GastrocnemiiContributiontoAllTS for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ Coactivation_LimbMIndices ]





#TSContributiontoPFActivity for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_TSContributiontoPFActivity_PropulsionPhase[ Coactivation_LimbMIndices ]

   #MedGasandSolContributiontoPFActivity for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasandSolContributiontoPFActivity_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_MedGasandSolContributiontoPFActivity_PropulsionPhase[ Coactivation_LimbMIndices ]

   #MedGasContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_MedGasContributiontoAllTS_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_MedGasContributiontoAllTS_PropulsionPhase[ Coactivation_LimbMIndices ]

   #TAvsAllPF_CoactivationRatio for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase[ Coactivation_LimbMIndices ]

   #TwoJointTS_Contribution2AllPF for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase[ Coactivation_LimbMIndices ]

   #OneJointTS_Contribution2AllPF for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase[ Coactivation_LimbMIndices ]

   #SolContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_SolContributiontoAllTS_PropulsionPhase[ Coactivation_LimbMIndices ]

#GastrocnemiiContributiontoAllTS for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ Coactivation_LimbMIndices ]
            


#PF Activation Ratio (Hop:SLVJ) for Contact Phase
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase[ Coactivation_LimbMIndices ]

#PF Activation Ratio (Hop:SLVJ) for Braking Phase
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase[ Coactivation_LimbMIndices ]

#PF Activation Ratio (Hop:SLVJ) for Propulsion Phase
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ Dissertation_CombinedMEEandEMG_LimbMIndices ] <- Coactivation_ParticipantMeans$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ Coactivation_LimbMIndices ]

            
         }#End for loop for Limb ID
         
         
      }#End for loop for Participant ID
   
   
   }#End for loop for Hopping Rate ID
   
}#End for loop for Group ID


Dissertation_CombinedMEEandEMG$Mean_TotalTSActivation_PropulsionPhase <- Dissertation_CombinedMEEandEMG$Mean_MedGas_iEMG_PropulsionPhase + Dissertation_CombinedMEEandEMG$Mean_GasLat_iEMG_PropulsionPhase + Dissertation_CombinedMEEandEMG$Mean_Sol_iEMG_PropulsionPhase

```


```{r Multiply Ratios By 100}
Dissertation_CombinedMEEandEMG$Mean_EugeneContributionIndx <- Dissertation_CombinedMEEandEMG$Mean_EugeneContributionIndx*100

Dissertation_CombinedMEEandEMG$Mean_Joint_Percent_MEE_Generation <- Dissertation_CombinedMEEandEMG$Mean_Joint_Percent_MEE_Generation*100


Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase <- Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase*100

Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase <- Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase*100






Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase <- Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase*100

Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase <- Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase*100



Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_BrakingPhase <- Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_BrakingPhase*100

Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase <- Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase*100


Dissertation_CombinedMEEandEMG$Mean_KneetoAnkleMEERatio_Braking <- Dissertation_CombinedMEEandEMG$Mean_KneePercentMEE_ofAnkleandKneeMEE_Braking / Dissertation_CombinedMEEandEMG$Mean_AnklePercentMEE_ofAnkleandKneeMEE_Braking

Dissertation_CombinedMEEandEMG$Mean_KneetoAnkleMEERatio_Propulsion <- Dissertation_CombinedMEEandEMG$Mean_KneePercentMEE_ofAnkleandKneeMEE_Propulsion / Dissertation_CombinedMEEandEMG$Mean_AnklePercentMEE_ofAnkleandKneeMEE_Propulsion

Dissertation_CombinedMEEandEMG$Mean_KneetoAnkleMEERatio_Contact <- Dissertation_CombinedMEEandEMG$Mean_KneePercentMEE_ofAnkleandKneeMEE_Contact / Dissertation_CombinedMEEandEMG$Mean_AnklePercentMEE_ofAnkleandKneeMEE_Contact

```



```{r Center the Predictors}
#Center the TS Contribution data for braking phase
   #Initialize the variable
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase
   
   #Subtract ATx group mean from all ATx TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

   #Subtract Control group mean from all Control TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )




#Center the TS Contribution data for Propulsion phase
   #Initialize the variable
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase
   
   #Subtract ATx group mean from all ATx TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

   #Subtract Control group mean from all Control TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )







#Center the One-Joint TS Contribution data for braking phase
   #Initialize the variable
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_BrakingPhase
   

   #Subtract ATx group mean from all ATx TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

   #Subtract Control group mean from all Control TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )




#Center the One-Joint TS Contribution data for Propulsion phase
   #Initialize the variable
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_PropulsionPhase
   
   #Subtract ATx group mean from all ATx TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

   #Subtract Control group mean from all Control TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_SolContributiontoAllTS_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )










#Center the Two-Joint TS Contribution data for braking phase
   #Initialize the variable
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase
   
   #Subtract ATx group mean from all ATx TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

   #Subtract Control group mean from all Control TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )




#Center the Two-Joint TS Contribution data for Propulsion phase
   #Initialize the variable
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase
   
   #Subtract ATx group mean from all ATx TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

   #Subtract Control group mean from all Control TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )







#Center PF activation ratio (Hop:SLVJ) for contact phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase


#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_ContactPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )





#Center PF activation ratio (Hop:SLVJ) for braking phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase


#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )





#Center PF activation ratio (Hop:SLVJ) for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase


#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_PFActivationRatio_HopvsMSLVJ_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )

```



## Calculate PL Contribution
```{r Individual Hops}


#For Braking phase. PL contribution = 1 - triceps surae contribution
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_BrakingPhase <- 100 - Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_BrakingPhase

#For Propulsion phase. PL contribution = 1 - triceps surae contribution
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase <- 100 - Dissertation_CombinedMEEandEMG_IndividualHops$TSContributiontoPFActivity_PropulsionPhase



#Center the Two-Joint TS Contribution data for braking phase
   #Initialize the variable
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_BrakingPhase
   

   #Subtract ATx group mean from all ATx TS Contribution values
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

   #Subtract Control group mean from all Control TS Contribution values
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )




#Center the Two-Joint TS Contribution data for Propulsion phase
   #Initialize the variable
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase
   
   #Subtract ATx group mean from all ATx TS Contribution values
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

   #Subtract Control group mean from all Control TS Contribution values
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )






#Divide TSContributiontoPFActivity_PropulsionPhase by 100 to better match scale of raw joint MEE
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Maxof1 <- Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase/100

#Center TS contribution for propulsion phase. Start by initializing the variable
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Maxof1_Centered <- Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Maxof1

#Next, replace all values for ATx group with mean-centered values --> subtract ATx mean
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Maxof1_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Maxof1[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Maxof1[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'ATx' ) ] )

#Finally, replace all values for Control group with mean-centered values --> subtract Control mean
Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Maxof1_Centered[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Maxof1[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG_IndividualHops$PLContributiontoPFActivity_PropulsionPhase_Maxof1[ which( Dissertation_CombinedMEEandEMG_IndividualHops$Group_ID == 'Control' ) ] )


```





```{r Participant Means}

#For Braking phase. PL contribution = 1 - triceps surae contribution
Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_BrakingPhase <- 100 - Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_BrakingPhase

#For Propulsion phase. PL contribution = 1 - triceps surae contribution
Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_PropulsionPhase <- 100 - Dissertation_CombinedMEEandEMG$Mean_TSContributiontoPFActivity_PropulsionPhase



#Center the Two-Joint TS Contribution data for braking phase
   #Initialize the variable
Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_BrakingPhase
   
   #Subtract ATx group mean from all ATx TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

   #Subtract Control group mean from all Control TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_BrakingPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )




#Center the Two-Joint TS Contribution data for Propulsion phase
   #Initialize the variable
Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_PropulsionPhase
   
   #Subtract ATx group mean from all ATx TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] <- Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'ATx' ) ] )

   #Subtract Control group mean from all Control TS Contribution values
Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_PropulsionPhase_Centered[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] <- Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] - mean( Dissertation_CombinedMEEandEMG$Mean_PLContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG$Group_ID == 'Control' ) ] )






```


## DPLYR

### EMG Only

#### Both Groups
```{r Individual Hops}


#Create data frame containing 2.0 and 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_IndividualHops_InvolvedvsControl_2.0and2.3Hz <- Coactivation_IndividualHops %>% filter( Limb_ID != 'Non-Involved', HoppingRate_ID != 0.0 )

#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_IndividualHops_InvolvedvsControl_2.3Hz <- Coactivation_IndividualHops %>% filter( Limb_ID != 'Non-Involved', HoppingRate_ID == '2.3' )

```



```{r Participant Means}


#Create data frame containing 2.0 and 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz <- Coactivation_ParticipantMeans %>% filter( Limb_ID != 'Non-Involved', HoppingRate_ID != 0.0 )


#Create data frame containing 2.3 Hz data, participant means
Coactivation_ParticipantMeans_2.3Hz <- Coactivation_ParticipantMeans %>% filter( HoppingRate_ID == '2.3' )


#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, participant means
Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz <- Coactivation_ParticipantMeans %>% filter( Limb_ID != 'Non-Involved', HoppingRate_ID == '2.3' )


```




```{r Group Means}


#Create data frame containing 2.0 and 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz <- Coactivation_GroupMeans_ %>% filter( Limb_ID != 'Non-Involved', HoppingRate_ID != 0.0 )


#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_GroupMeans_InvolvedvsControl_2.3Hz <- Coactivation_GroupMeans_ %>% filter( Limb_ID != 'Non-Involved', HoppingRate_ID == '2.3' )


```



#### ATx Only
```{r Individual Hops}



#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_IndividualHops_ATx_2.3Hz <- Coactivation_IndividualHops %>% filter( Group_ID == 'ATx', HoppingRate_ID == '2.3' )

#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_IndividualHops_ATx_Ankle_2.3Hz <- Coactivation_IndividualHops %>% filter( Group_ID == 'ATx', HoppingRate_ID == '2.3', Joint_ID == 'Ankle' )




#Create data frame containing 2.0 and 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_IndividualHops_Involved_2.0and2.3Hz <- Coactivation_IndividualHops %>% filter( Limb_ID == 'Involved', HoppingRate_ID != 0.0 )

#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_IndividualHops_Involved_2.3Hz <- Coactivation_IndividualHops %>% filter( Limb_ID != 'Involved', HoppingRate_ID == '2.3' )

```



```{r Participant Means}




#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_ParticipantMeans_ATx_2.3Hz <- Coactivation_ParticipantMeans %>% filter( Group_ID == 'ATx', HoppingRate_ID == '2.3' )



#Create data frame containing 2.0 and 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_ParticipantMeans_Involved_2.0and2.3Hz <- Coactivation_ParticipantMeans %>% filter( Limb_ID == 'Involved', HoppingRate_ID != 0.0 )



#Create data frame containing 2.3 Hz data for ATx involved limb, participant means
Coactivation_ParticipantMeans_Involved_2.3Hz <- Coactivation_ParticipantMeans %>% filter( Limb_ID == 'Involved', HoppingRate_ID == '2.3' )


#Create data frame containing 2.3 Hz data for ATx non-involved limb, participant means
Coactivation_ParticipantMeans_NonInvolved_2.3Hz <- Coactivation_ParticipantMeans %>% filter( Limb_ID == 'Non-Involved', HoppingRate_ID == '2.3' )

```



```{r Group Means}


#Create data frame containing 2.0 and 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_GroupMeans_Involved_2.0and2.3Hz <- Coactivation_GroupMeans_ %>% filter( Limb_ID == 'Involved', HoppingRate_ID != 0.0 )


#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_GroupMeans_Involved_2.3Hz <- Coactivation_GroupMeans_ %>% filter( Limb_ID != 'Involved', HoppingRate_ID == '2.3' )

```



#### Control Only
```{r Individual Hops}


#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_IndividualHops_Control_2.3Hz <- Coactivation_IndividualHops %>% filter( Group_ID == 'Control', HoppingRate_ID == '2.3' )

#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_IndividualHops_Control_Ankle_2.3Hz <- Coactivation_IndividualHops %>% filter( Group_ID == 'Control', HoppingRate_ID == '2.3', Joint_ID == 'Ankle' )


#Create data frame containing 2.0 and 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_IndividualHops_Control_2.0and2.3Hz <- Coactivation_IndividualHops %>% filter( Limb_ID == 'Matched Control', HoppingRate_ID != 0.0 )

#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_IndividualHops_Control_2.3Hz <- Coactivation_IndividualHops %>% filter( Limb_ID != 'Matched Control', HoppingRate_ID == '2.3' )

```



```{r Participant Means}



#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_ParticipantMeans_Control_2.3Hz <- Coactivation_ParticipantMeans %>% filter( Group_ID == 'Control', HoppingRate_ID == '2.3' )


#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_ParticipantMeans_Control_Ankle_2.3Hz <- Coactivation_ParticipantMeans %>% filter( Group_ID == 'Control', HoppingRate_ID == '2.3', Joint_ID == 'Ankle' )




#Create data frame containing 2.0 and 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_ParticipantMeans_Control_2.0and2.3Hz <- Coactivation_ParticipantMeans %>% filter( Limb_ID == 'Matched Control', HoppingRate_ID != 0.0 )

#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_ParticipantMeans_Control_2.3Hz <- Coactivation_ParticipantMeans %>% filter( Limb_ID != 'Matched Control', HoppingRate_ID == '2.3' )

```



```{r Group Means}


#Create data frame containing 2.0 and 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_GroupMeans_Control_2.0and2.3Hz <- Coactivation_GroupMeans_ %>% filter( Limb_ID == 'Matched Control', HoppingRate_ID != 0.0 )

#Create data frame containing 2.3 Hz data for ATx involved limb and Control matched limb, individual hop data
Coactivation_GroupMeans_Control_2.3Hz <- Coactivation_GroupMeans_ %>% filter( Limb_ID != 'Matched Control', HoppingRate_ID == '2.3' )

```



### Combined MEE and EMG
```{r Involved Limb Only, Ankle Only}

#2 Hz Only
Dissertation_CombinedMEEandEMG_2Hz_InvolvedAnkle <- Dissertation_CombinedMEEandEMG %>%
   filter( Limb_ID == 'Involved' & Joint_ID == 'Ankle' & HoppingRate_ID == 2 )

#2.3 Hz Only
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle <- Dissertation_CombinedMEEandEMG %>%
   filter( Limb_ID == 'Involved' & Joint_ID == 'Ankle' & HoppingRate_ID == '2.3' )


#2.3 Hz Only
Dissertation_CombinedMEEandEMG_IndividualHops_2and2.3Hz_InvolvedAnkle <- Dissertation_CombinedMEEandEMG_IndividualHops %>%
   filter( Limb_ID == 'Involved' & Joint_ID == 'Ankle' & HoppingRate_ID != 0 )




##2.3 Hz Only, Individual Hops
Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedAnkle <- Dissertation_CombinedMEEandEMG_IndividualHops %>%
   filter( Limb_ID == 'Involved' & Joint_ID == 'Ankle' & HoppingRate_ID == '2.3' )

##2.3 Hz Only, Individual Hops
Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedKnee <- Dissertation_CombinedMEEandEMG_IndividualHops %>%
   filter( Limb_ID == 'Involved' & Joint_ID == 'Knee' & HoppingRate_ID == '2.3' )

```


```{r Control Only, Ankle Only}

#2 Hz Only
Dissertation_CombinedMEEandEMG_2Hz_ControlAnkle <- Dissertation_CombinedMEEandEMG %>%
   filter( Limb_ID == 'Matched Control' & Joint_ID == 'Ankle' & HoppingRate_ID == 2 )

#2.3 Hz Only
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle <- Dissertation_CombinedMEEandEMG %>%
   filter( Limb_ID == 'Matched Control' & Joint_ID == 'Ankle' & HoppingRate_ID == '2.3' )




#2.3 Hz Only
Dissertation_CombinedMEEandEMG_IndividualHops_2and2.3Hz_ControlAnkle <- Dissertation_CombinedMEEandEMG_IndividualHops %>%
   filter( Limb_ID == 'Matched Control' & Joint_ID == 'Ankle' & HoppingRate_ID != 0 )


##2.3 Hz Only, Individual Hops
Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_ControlAnkle <- Dissertation_CombinedMEEandEMG_IndividualHops %>%
   filter( Limb_ID == 'Matched Control' & Joint_ID == 'Ankle' & HoppingRate_ID == '2.3' )

```




```{r Involved Limb vs Control Only, Ankle Only}

#All Hopping Rates, Ankle Only
Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle <- Dissertation_CombinedMEEandEMG %>%
   filter( Limb_ID != 'Non-Involved' & Joint_ID == 'Ankle')


#2 Hz Only, Ankle Only
Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle <- Dissertation_CombinedMEEandEMG %>%
   filter( Limb_ID != 'Non-Involved' & Joint_ID == 'Ankle' & HoppingRate_ID == 2 )


#2.3 Hz Only, Ankle Only
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle <- Dissertation_CombinedMEEandEMG %>%
   filter( Limb_ID != 'Non-Involved' & Joint_ID == 'Ankle' & HoppingRate_ID == '2.3' )

#2.3 Hz Only, Knee Only
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlKnee <- Dissertation_CombinedMEEandEMG %>%
   filter( Limb_ID != 'Non-Involved' & Joint_ID == 'Knee' & HoppingRate_ID == '2.3' )

#2.3 Hz Only
Dissertation_CombinedMEEandEMG_2and2.3Hz_InvolvedvsControlAnkle <- Dissertation_CombinedMEEandEMG %>%
   filter( Limb_ID != 'Non-Involved' & Joint_ID == 'Ankle' & HoppingRate_ID != 0 )



##2.3 Hz Only, Ankle Only - Individual Hops Data
Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle <- Dissertation_CombinedMEEandEMG_IndividualHops %>%
   filter( Limb_ID != 'Non-Involved' & Joint_ID == 'Ankle' & HoppingRate_ID == '2.3' )


##2.3 Hz Only, Knee Only - Individual Hops Data
Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee <- Dissertation_CombinedMEEandEMG_IndividualHops %>%
   filter( Limb_ID != 'Non-Involved' & Joint_ID == 'Knee' & HoppingRate_ID == '2.3' )

```


## Total Activations

### Both Rates

####Both Groups
```{r Individual Hops}




```




```{r Participant Means}

#Total PF activation, Braking phase
Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_TotalPFActivation_BrakingPhase = 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_Sol_iEMG_BrakingPhase +
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_PL_iEMG_BrakingPhase




#Total TS activation, Braking phase
Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_TotalTSActivation_BrakingPhase = 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_Sol_iEMG_BrakingPhase







#Total PF activation, Propulsion phase
Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_TotalPFActivation_PropulsionPhase = 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_Sol_iEMG_PropulsionPhase +
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_PL_iEMG_PropulsionPhase




#Total TS activation, Propulsion phase
Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_TotalTSActivation_PropulsionPhase = 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz$Mean_Sol_iEMG_PropulsionPhase



```




```{r Group Means}

#Total PF activation, Braking phase
Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_TotalPFActivation_BrakingPhase = 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_Sol_iEMG_BrakingPhase +
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_PL_iEMG_BrakingPhase




#Total TS activation, Braking phase
Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_TotalTSActivation_BrakingPhase = 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_Sol_iEMG_BrakingPhase







#Total PF activation, Propulsion phase
Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_TotalPFActivation_PropulsionPhase = 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_Sol_iEMG_PropulsionPhase +
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_PL_iEMG_PropulsionPhase




#Total TS activation, Propulsion phase
Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_TotalTSActivation_PropulsionPhase = 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.0and2.3Hz$Mean_Sol_iEMG_PropulsionPhase



```



#### ATx
```{r Group Means}

#Total PF activation, Braking phase
Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_TotalPFActivation_BrakingPhase = 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_Sol_iEMG_BrakingPhase +
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_PL_iEMG_BrakingPhase




#Total TS activation, Braking phase
Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_TotalTSActivation_BrakingPhase = 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_Sol_iEMG_BrakingPhase







#Total PF activation, Propulsion phase
Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_TotalPFActivation_PropulsionPhase = 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_Sol_iEMG_PropulsionPhase +
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_PL_iEMG_PropulsionPhase




#Total TS activation, Propulsion phase
Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_TotalTSActivation_PropulsionPhase = 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_Involved_2.0and2.3Hz$Mean_Sol_iEMG_PropulsionPhase



```



#### Control
```{r Group Means}

#Total PF activation, Braking phase
Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_TotalPFActivation_BrakingPhase = 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_Sol_iEMG_BrakingPhase +
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_PL_iEMG_BrakingPhase




#Total TS activation, Braking phase
Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_TotalTSActivation_BrakingPhase = 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_Sol_iEMG_BrakingPhase







#Total PF activation, Propulsion phase
Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_TotalPFActivation_PropulsionPhase = 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_Sol_iEMG_PropulsionPhase +
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_PL_iEMG_PropulsionPhase




#Total TS activation, Propulsion phase
Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_TotalTSActivation_PropulsionPhase = 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_Control_2.0and2.3Hz$Mean_Sol_iEMG_PropulsionPhase



```



### 2.3 Hz
```{r Participant Means}

#Total PF activation, Braking phase
Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_TotalPFActivation_BrakingPhase = 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_Sol_iEMG_BrakingPhase +
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_PL_iEMG_BrakingPhase




#Total TS activation, Braking phase
Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_TotalTSActivation_BrakingPhase = 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_Sol_iEMG_BrakingPhase







#Total PF activation, Propulsion phase
Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_TotalPFActivation_PropulsionPhase = 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_Sol_iEMG_PropulsionPhase +
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_PL_iEMG_PropulsionPhase




#Total TS activation, Propulsion phase
Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_TotalTSActivation_PropulsionPhase = 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz$Mean_Sol_iEMG_PropulsionPhase



```

```{r Group Means}

#Total PF activation, Braking phase
Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_TotalPFActivation_BrakingPhase = 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_Sol_iEMG_BrakingPhase +
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_PL_iEMG_BrakingPhase




#Total TS activation, Braking phase
Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_TotalTSActivation_BrakingPhase = 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_GasLat_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_MedGas_iEMG_BrakingPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_Sol_iEMG_BrakingPhase







#Total PF activation, Propulsion phase
Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_TotalPFActivation_PropulsionPhase = 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_Sol_iEMG_PropulsionPhase +
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_PL_iEMG_PropulsionPhase




#Total TS activation, Propulsion phase
Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_TotalTSActivation_PropulsionPhase = 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_GasLat_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_MedGas_iEMG_PropulsionPhase + 
   Coactivation_GroupMeans_InvolvedvsControl_2.3Hz$Mean_Sol_iEMG_PropulsionPhase



```




## Stats

### Linear Regression

### ATx Only

#### MedGas iEMG

##### vs Morphology
```{r Contact Phase}



LM_MedGasiEMGContactPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_ContactPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz)
summary(LM_MedGasiEMGContactPhasevsATxMorphology)
confint(LM_MedGasiEMGContactPhasevsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx18
LM_MedGasiEMGContactPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_ContactPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_MedGasiEMGContactPhasevsATxMorphology)
confint(LM_MedGasiEMGContactPhasevsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
LM_MedGasiEMGContactPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_ContactPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18)
summary(LM_MedGasiEMGContactPhasevsATxMorphology)
confint(LM_MedGasiEMGContactPhasevsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
LM_MedGasiEMGContactPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_ContactPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18)
summary(LM_MedGasiEMGContactPhasevsATxMorphology)
confint(LM_MedGasiEMGContactPhasevsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_MedGasiEMGContactPhasevsATxMorphology <- hatvalues( LM_MedGasiEMGContactPhasevsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_MedGasiEMGContactPhasevsATxMorphology <- mean( Leverage_LM_MedGasiEMGContactPhasevsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_MedGasiEMGContactPhasevsATxMorphology > 2*AverageLeverage_LM_MedGasiEMGContactPhasevsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_MedGasiEMGContactPhasevsATxMorphology <- cooks.distance( LM_MedGasiEMGContactPhasevsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_MedGasiEMGContactPhasevsATxMorphology > 3*mean(CookD_LM_MedGasiEMGContactPhasevsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_MedGasiEMGContactPhasevsATxMorphology > 4/length( LM_MedGasiEMGContactPhasevsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_MedGasiEMGContactPhasevsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_MedGasiEMGContactPhasevsATxMorphology, aes(x=LM_MedGasiEMGContactPhasevsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_MedGasiEMGContactPhasevsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_MedGasiEMGContactPhasevsATxMorphology )

residualPlots(LM_MedGasiEMGContactPhasevsATxMorphology,type='rstudent')


```




```{r Braking Phase}



LM_MedGasiEMGBrakingPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_BrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz, na.action = na.omit)
summary(LM_MedGasiEMGBrakingPhasevsATxMorphology)
confint(LM_MedGasiEMGBrakingPhasevsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx18
LM_MedGasiEMGBrakingPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_BrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_MedGasiEMGBrakingPhasevsATxMorphology)
confint(LM_MedGasiEMGBrakingPhasevsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
LM_MedGasiEMGBrakingPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_BrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18)
summary(LM_MedGasiEMGBrakingPhasevsATxMorphology)
confint(LM_MedGasiEMGBrakingPhasevsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
LM_MedGasiEMGBrakingPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_BrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18)
summary(LM_MedGasiEMGBrakingPhasevsATxMorphology)
confint(LM_MedGasiEMGBrakingPhasevsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_MedGasiEMGBrakingPhasevsATxMorphology <- hatvalues( LM_MedGasiEMGBrakingPhasevsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_MedGasiEMGBrakingPhasevsATxMorphology <- mean( Leverage_LM_MedGasiEMGBrakingPhasevsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_MedGasiEMGBrakingPhasevsATxMorphology > 2*AverageLeverage_LM_MedGasiEMGBrakingPhasevsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_MedGasiEMGBrakingPhasevsATxMorphology <- cooks.distance( LM_MedGasiEMGBrakingPhasevsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_MedGasiEMGBrakingPhasevsATxMorphology > 3*mean(CookD_LM_MedGasiEMGBrakingPhasevsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_MedGasiEMGBrakingPhasevsATxMorphology > 4/length( LM_MedGasiEMGBrakingPhasevsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_MedGasiEMGBrakingPhasevsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_MedGasiEMGBrakingPhasevsATxMorphology, aes(x=LM_MedGasiEMGBrakingPhasevsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_MedGasiEMGBrakingPhasevsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_MedGasiEMGBrakingPhasevsATxMorphology )

residualPlots(LM_MedGasiEMGBrakingPhasevsATxMorphology,type='rstudent')


```



```{r Propulsion Phase}



LM_MedGasiEMGPropulsionPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz, na.action = na.omit)
summary(LM_MedGasiEMGPropulsionPhasevsATxMorphology)
confint(LM_MedGasiEMGPropulsionPhasevsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx18
LM_MedGasiEMGPropulsionPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_MedGasiEMGPropulsionPhasevsATxMorphology)
confint(LM_MedGasiEMGPropulsionPhasevsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
LM_MedGasiEMGPropulsionPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18)
summary(LM_MedGasiEMGPropulsionPhasevsATxMorphology)
confint(LM_MedGasiEMGPropulsionPhasevsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
LM_MedGasiEMGPropulsionPhasevsATxMorphology <- lm( formula = Mean_MedGas_iEMG_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18)
summary(LM_MedGasiEMGPropulsionPhasevsATxMorphology)
confint(LM_MedGasiEMGPropulsionPhasevsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_LM_MedGasiEMGPropulsionPhasevsATxMorphology <- hatvalues( LM_MedGasiEMGPropulsionPhasevsATxMorphology ) )

#Find average leverage value for PropulsionPhase_2Hz.
( AverageLeverage_LM_MedGasiEMGPropulsionPhasevsATxMorphology <- mean( Leverage_LM_MedGasiEMGPropulsionPhasevsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_MedGasiEMGPropulsionPhasevsATxMorphology > 2*AverageLeverage_LM_MedGasiEMGPropulsionPhasevsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for PropulsionPhase_2Hz
( CookD_LM_MedGasiEMGPropulsionPhasevsATxMorphology <- cooks.distance( LM_MedGasiEMGPropulsionPhasevsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_MedGasiEMGPropulsionPhasevsATxMorphology > 3*mean(CookD_LM_MedGasiEMGPropulsionPhasevsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_MedGasiEMGPropulsionPhasevsATxMorphology > 4/length( LM_MedGasiEMGPropulsionPhasevsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_MedGasiEMGPropulsionPhasevsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_MedGasiEMGPropulsionPhasevsATxMorphology, aes(x=LM_MedGasiEMGPropulsionPhasevsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_MedGasiEMGPropulsionPhasevsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_MedGasiEMGPropulsionPhasevsATxMorphology )

residualPlots(LM_MedGasiEMGPropulsionPhasevsATxMorphology,type='rstudent')


```



#### Eugene PF Contribution Index

##### vs Morphology
```{r Braking}



LM_EugeneContributionIndxvsATxMorphology <- lm( formula = Mean_EugeneContributionIndx~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz)
summary(LM_EugeneContributionIndxvsATxMorphology)
confint(LM_EugeneContributionIndxvsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx18
LM_EugeneContributionIndxvsATxMorphology <- lm( formula = Mean_EugeneContributionIndx~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_EugeneContributionIndxvsATxMorphology)
confint(LM_EugeneContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
LM_EugeneContributionIndxvsATxMorphology <- lm( formula = Mean_EugeneContributionIndx~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18)
summary(LM_EugeneContributionIndxvsATxMorphology)
confint(LM_EugeneContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
LM_EugeneContributionIndxvsATxMorphology <- lm( formula = Mean_EugeneContributionIndx~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18)
summary(LM_EugeneContributionIndxvsATxMorphology)
confint(LM_EugeneContributionIndxvsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_EugeneContributionIndxvsATxMorphology <- hatvalues( LM_EugeneContributionIndxvsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_EugeneContributionIndxvsATxMorphology <- mean( Leverage_LM_EugeneContributionIndxvsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_EugeneContributionIndxvsATxMorphology > 2*AverageLeverage_LM_EugeneContributionIndxvsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_EugeneContributionIndxvsATxMorphology <- cooks.distance( LM_EugeneContributionIndxvsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_EugeneContributionIndxvsATxMorphology > 3*mean(CookD_LM_EugeneContributionIndxvsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_EugeneContributionIndxvsATxMorphology > 4/length( LM_EugeneContributionIndxvsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_EugeneContributionIndxvsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_EugeneContributionIndxvsATxMorphology, aes(x=LM_EugeneContributionIndxvsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_EugeneContributionIndxvsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_EugeneContributionIndxvsATxMorphology )

residualPlots(LM_EugeneContributionIndxvsATxMorphology,type='rstudent')


```




##### vs Morphology
```{r Braking}



LM_EugeneContributionIndxvsATxMorphology <- lm( formula = Mean_EugeneContributionIndx~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz)
summary(LM_EugeneContributionIndxvsATxMorphology)
confint(LM_EugeneContributionIndxvsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx18
LM_EugeneContributionIndxvsATxMorphology <- lm( formula = Mean_EugeneContributionIndx~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_EugeneContributionIndxvsATxMorphology)
confint(LM_EugeneContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
LM_EugeneContributionIndxvsATxMorphology <- lm( formula = Mean_EugeneContributionIndx~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or18)
summary(LM_EugeneContributionIndxvsATxMorphology)
confint(LM_EugeneContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
LM_EugeneContributionIndxvsATxMorphology <- lm( formula = Mean_EugeneContributionIndx~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx07or12or18)
summary(LM_EugeneContributionIndxvsATxMorphology)
confint(LM_EugeneContributionIndxvsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_EugeneContributionIndxvsATxMorphology <- hatvalues( LM_EugeneContributionIndxvsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_EugeneContributionIndxvsATxMorphology <- mean( Leverage_LM_EugeneContributionIndxvsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_EugeneContributionIndxvsATxMorphology > 2*AverageLeverage_LM_EugeneContributionIndxvsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_EugeneContributionIndxvsATxMorphology <- cooks.distance( LM_EugeneContributionIndxvsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_EugeneContributionIndxvsATxMorphology > 3*mean(CookD_LM_EugeneContributionIndxvsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_EugeneContributionIndxvsATxMorphology > 4/length( LM_EugeneContributionIndxvsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_EugeneContributionIndxvsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_EugeneContributionIndxvsATxMorphology, aes(x=LM_EugeneContributionIndxvsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_EugeneContributionIndxvsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_EugeneContributionIndxvsATxMorphology )

residualPlots(LM_EugeneContributionIndxvsATxMorphology,type='rstudent')


```




#### DTOW PF Contribution Index

##### vs Morphology
```{r Braking}



LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityBrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx50
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50' )
LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityBrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
#
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx49or50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50', Participant_ID != 'ATx49' )

LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityBrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx49or50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx38or49or50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50', Participant_ID != 'ATx49', Participant_ID != 'ATx38' )
LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityBrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx38or49or50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_TSContributionIndxvsATxMorphology <- hatvalues( LM_TSContributionIndxvsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_TSContributionIndxvsATxMorphology <- mean( Leverage_LM_TSContributionIndxvsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_TSContributionIndxvsATxMorphology > 2*AverageLeverage_LM_TSContributionIndxvsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_TSContributionIndxvsATxMorphology <- cooks.distance( LM_TSContributionIndxvsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_TSContributionIndxvsATxMorphology > 3*mean(CookD_LM_TSContributionIndxvsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_TSContributionIndxvsATxMorphology > 4/length( LM_TSContributionIndxvsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_TSContributionIndxvsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_TSContributionIndxvsATxMorphology, aes(x=LM_TSContributionIndxvsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_TSContributionIndxvsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_TSContributionIndxvsATxMorphology )

residualPlots(LM_TSContributionIndxvsATxMorphology,type='rstudent')


```





```{r Propulsion}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Joint_Absorption_MEE )

LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx50
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50' )
LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
#
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50', Participant_ID != 'ATx18' )

LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx38or49or50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50', Participant_ID != 'ATx49', Participant_ID != 'ATx38' )
LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityPropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx38or49or50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_LM_TSContributionIndxvsATxMorphology <- hatvalues( LM_TSContributionIndxvsATxMorphology ) )

#Find average leverage value for PropulsionPhase_2Hz.
( AverageLeverage_LM_TSContributionIndxvsATxMorphology <- mean( Leverage_LM_TSContributionIndxvsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_TSContributionIndxvsATxMorphology > 2*AverageLeverage_LM_TSContributionIndxvsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for PropulsionPhase_2Hz
( CookD_LM_TSContributionIndxvsATxMorphology <- cooks.distance( LM_TSContributionIndxvsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_TSContributionIndxvsATxMorphology > 3*mean(CookD_LM_TSContributionIndxvsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_TSContributionIndxvsATxMorphology > 4/length( LM_TSContributionIndxvsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_TSContributionIndxvsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_TSContributionIndxvsATxMorphology, aes(x=LM_TSContributionIndxvsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_TSContributionIndxvsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_TSContributionIndxvsATxMorphology )

residualPlots(LM_TSContributionIndxvsATxMorphology,type='rstudent')


```


###### Between-Limb Diff

###### vs Morphology
```{r Braking}



LM_TSContributionIndxvsATxMorphology <- lm( formula = (Coactivation_ParticipantMeans_Involved_2.3Hz$Mean_TSContributiontoPFActivityBrakingPhase-Coactivation_ParticipantMeans_NonInvolved_2.3Hz$Mean_TSContributiontoPFActivityBrakingPhase)~Coactivation_ParticipantMeans_Involved_2.3Hz$Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx50
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx18' )

Coactivation_ParticipantMeans_ATxNonInvolvedAnkle_2.3Hz_NoATx18 <- Coactivation_ParticipantMeans_NonInvolved_2.3Hz %>%
   filter( Participant_ID != 'ATx18' )


LM_TSContributionIndxvsATxMorphology <- lm( formula = (Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18$Mean_TSContributiontoPFActivityBrakingPhase-Coactivation_ParticipantMeans_ATxNonInvolvedAnkle_2.3Hz_NoATx18$Mean_TSContributiontoPFActivityBrakingPhase)~Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18$Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18)
summary(LM_TSContributionIndxvsATxMorphology)

confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
#
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx49or50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50', Participant_ID != 'ATx49' )

LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityBrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx49or50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx38or49or50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50', Participant_ID != 'ATx49', Participant_ID != 'ATx38' )
LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityBrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx38or49or50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_TSContributionIndxvsATxMorphology <- hatvalues( LM_TSContributionIndxvsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_TSContributionIndxvsATxMorphology <- mean( Leverage_LM_TSContributionIndxvsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_TSContributionIndxvsATxMorphology > 2*AverageLeverage_LM_TSContributionIndxvsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_TSContributionIndxvsATxMorphology <- cooks.distance( LM_TSContributionIndxvsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_TSContributionIndxvsATxMorphology > 3*mean(CookD_LM_TSContributionIndxvsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_TSContributionIndxvsATxMorphology > 4/length( LM_TSContributionIndxvsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_TSContributionIndxvsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_TSContributionIndxvsATxMorphology, aes(x=LM_TSContributionIndxvsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_TSContributionIndxvsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_TSContributionIndxvsATxMorphology )

residualPlots(LM_TSContributionIndxvsATxMorphology,type='rstudent')


```





```{r Propulsion}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Joint_Absorption_MEE )

LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx50
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50' )
LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
#
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50', Participant_ID != 'ATx18' )

LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx18or50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx07 or ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx38or49or50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50', Participant_ID != 'ATx49', Participant_ID != 'ATx38' )
LM_TSContributionIndxvsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityPropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx38or49or50)
summary(LM_TSContributionIndxvsATxMorphology)
confint(LM_TSContributionIndxvsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```


#### TA Coactivation Ratio

##### vs Morphology
```{r Braking}



LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TAvsAllPF_CoactivationRatio_BrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz)
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or27 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx12', Participant_ID != 'ATx27' )

LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityBrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or27)
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or27or50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx12', Participant_ID != 'ATx27', Participant_ID != 'ATx50' )

LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityBrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or27or50 )
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx07 or ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or27or50or49 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx12', Participant_ID != 'ATx27', Participant_ID != 'ATx50', Participant_ID != 'ATx49' )

LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityBrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or27or50or49 )
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS




#Recalculate without ATx07 or ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or27or50or49or38 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx12', Participant_ID != 'ATx27', Participant_ID != 'ATx50', Participant_ID != 'ATx49', Participant_ID != 'ATx38' )

LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivityBrakingPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or27or50or49or38 )
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS



```




```{r Check Assumptions - All Participants}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_LM_TACoactivationRatiovsATxMorphology <- hatvalues( LM_TACoactivationRatiovsATxMorphology ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_LM_TACoactivationRatiovsATxMorphology <- mean( Leverage_LM_TACoactivationRatiovsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_TACoactivationRatiovsATxMorphology > 2*AverageLeverage_LM_TACoactivationRatiovsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for BrakingPhase_2Hz
( CookD_LM_TACoactivationRatiovsATxMorphology <- cooks.distance( LM_TACoactivationRatiovsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_TACoactivationRatiovsATxMorphology > 3*mean(CookD_LM_TACoactivationRatiovsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_TACoactivationRatiovsATxMorphology > 4/length( LM_TACoactivationRatiovsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_TACoactivationRatiovsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_TACoactivationRatiovsATxMorphology, aes(x=LM_TACoactivationRatiovsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_TACoactivationRatiovsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_TACoactivationRatiovsATxMorphology )

residualPlots(LM_TACoactivationRatiovsATxMorphology,type='rstudent')


```





```{r Propulsion}



LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_Involved_2.3Hz)
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx12' )

LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12)
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept i significant


#Recalculate without ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx12', Participant_ID != 'ATx50' )

LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or50 )
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept is significant


#Recalculate without ATx07 or ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or50or18 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx12', Participant_ID != 'ATx18', Participant_ID != 'ATx50' )

LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or50or18 )
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS




#Recalculate without ATx07 or ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or50or18or38 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx12', Participant_ID != 'ATx18', Participant_ID != 'ATx50', Participant_ID != 'ATx38' )

LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or50or18or38 )
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS





#Recalculate without ATx07 or ATx12 and without 18
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or50or18or38or49 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx12', Participant_ID != 'ATx18', Participant_ID != 'ATx50', Participant_ID != 'ATx38', Participant_ID != 'ATx49' )

LM_TACoactivationRatiovsATxMorphology <- lm( formula = Mean_TSContributiontoPFActivity_PropulsionPhase~Mean_BetweenLimbTendonThickness_mm,
                                                      data=Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx12or50or18or38or49 )
summary(LM_TACoactivationRatiovsATxMorphology)
confint(LM_TACoactivationRatiovsATxMorphology,method='boot') # only intercept i significant
#FINAL DATA SET FOR MORPHOLOGY ANALYSIS

```




```{r Check Assumptions - All Participants}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_LM_TACoactivationRatiovsATxMorphology <- hatvalues( LM_TACoactivationRatiovsATxMorphology ) )

#Find average leverage value for PropulsionPhase_2Hz.
( AverageLeverage_LM_TACoactivationRatiovsATxMorphology <- mean( Leverage_LM_TACoactivationRatiovsATxMorphology ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_LM_TACoactivationRatiovsATxMorphology > 2*AverageLeverage_LM_TACoactivationRatiovsATxMorphology )
#No data points with high leverage based on hat values alone, AFTER removal of ATx08 and ATx18



#Find Cook's Distance for PropulsionPhase_2Hz
( CookD_LM_TACoactivationRatiovsATxMorphology <- cooks.distance( LM_TACoactivationRatiovsATxMorphology ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_TACoactivationRatiovsATxMorphology > 3*mean(CookD_LM_TACoactivationRatiovsATxMorphology,na.rm=T) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_LM_TACoactivationRatiovsATxMorphology > 4/length( LM_TACoactivationRatiovsATxMorphology$fitted.values ) )

#Data Point 6 has high leverage







#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( LM_TACoactivationRatiovsATxMorphology ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=LM_TACoactivationRatiovsATxMorphology, aes(x=LM_TACoactivationRatiovsATxMorphology$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
# vif( LM_TACoactivationRatiovsATxMorphology, type = 'predictor' )

par( mfrow = c( 2, 2 ) )
plot( LM_TACoactivationRatiovsATxMorphology )

residualPlots(LM_TACoactivationRatiovsATxMorphology,type='rstudent')


```





#### Correlation

##### TS Contribution to PF Activity
```{r Propulsion}

Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   identify_outliers( Mean_TSContributiontoPFActivity_PropulsionPhase )

Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   identify_outliers( Mean_BetweenLimbTendonThickness_mm )

#Check normality of ATx Involved Limb PL iEMG
Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   shapiro_test( Mean_BetweenLimbTendonThickness_mm )
#Normally distributed
#



#Check normality of ATx Involved Limb PL iEMG
Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   shapiro_test( Mean_TSContributiontoPFActivity_PropulsionPhase )
#Normally distributed



#Compute Pearson's R for Ankle MEE vs PL iEMG
cor.test( Coactivation_ParticipantMeans_Involved_2.3Hz$Mean_TSContributiontoPFActivity_PropulsionPhase, Coactivation_ParticipantMeans_Involved_2.3Hz$Mean_BetweenLimbTendonThickness_mm, method = 'spearman' )


```



###### Between-Limb Diff
```{r Braking}


Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   mutate( BetweenLimbDiff_TSContributiontoPFActivity_BrakingPhase = ( Coactivation_ParticipantMeans_Involved_2.3Hz$Mean_TSContributiontoPFActivity_BrakingPhase - Coactivation_ParticipantMeans_NonInvolved_2.3Hz$Mean_TSContributiontoPFActivity_BrakingPhase ) )


Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   identify_outliers( BetweenLimbDiff_TSContributiontoPFActivity_BrakingPhase )

Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   identify_outliers( Mean_BetweenLimbTendonThickness_mm )

#Check normality of ATx Involved Limb PL iEMG
Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   shapiro_test( Mean_BetweenLimbTendonThickness_mm )
#Normally distributed
#



#Check normality of ATx Involved Limb PL iEMG
Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   shapiro_test( Mean_TSContributiontoPFActivity_BrakingPhase )
#Normally distributed



#Compute Pearson's R for Ankle MEE vs PL iEMG
cor.test( Coactivation_ParticipantMeans_Involved_2.3Hz$Mean_TSContributiontoPFActivity_BrakingPhase, Coactivation_ParticipantMeans_Involved_2.3Hz$Mean_BetweenLimbTendonThickness_mm, method = 'spearman' )


```

##### TA Coactivation
```{r Braking}

Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   identify_outliers( Mean_TAvsAllPF_CoactivationRatio_BrakingPhase )

Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   identify_outliers( Mean_BetweenLimbTendonThickness_mm )




Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50' )


Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50 %>%
   identify_outliers( Mean_TAvsAllPF_CoactivationRatio_BrakingPhase )





Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50', Participant_ID != 'ATx12' )


Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12 %>%
   identify_outliers( Mean_TAvsAllPF_CoactivationRatio_BrakingPhase )


Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12 %>%
   identify_outliers( Mean_BetweenLimbTendonThickness_mm )




#Check normality of ATx Involved Limb PL iEMG
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12 %>%
   shapiro_test( Mean_TAvsAllPF_CoactivationRatio_BrakingPhase )
#Normally distributed

#Check normality of ATx Involved Limb PL iEMG
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12 %>%
   shapiro_test( Mean_BetweenLimbTendonThickness_mm )
#Normally distributed




#Compute Pearson's R for Ankle MEE vs PL iEMG
cor.test( Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase, Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12$Mean_BetweenLimbTendonThickness_mm, method = 'pearson' )


```





```{r Propulsion}

Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   identify_outliers( Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase )

Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   identify_outliers( Mean_BetweenLimbTendonThickness_mm )




Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50' )


Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50 %>%
   identify_outliers( Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase )





Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12 <- Coactivation_ParticipantMeans_Involved_2.3Hz %>%
   filter( Participant_ID != 'ATx50', Participant_ID != 'ATx12' )


Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12 %>%
   identify_outliers( Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase )


Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12 %>%
   identify_outliers( Mean_BetweenLimbTendonThickness_mm )




#Check normality of ATx Involved Limb PL iEMG
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12 %>%
   shapiro_test( Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase )
#Normally distributed

#Check normality of ATx Involved Limb PL iEMG
Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12 %>%
   shapiro_test( Mean_BetweenLimbTendonThickness_mm )
#Normally distributed




#Compute Pearson's R for Ankle MEE vs PL iEMG
cor.test( Coactivation_ParticipantMeans_Involved_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase, Coactivation_ParticipantMeans_Involved_2.3Hz$Mean_BetweenLimbTendonThickness_mm, method = 'spearman' )


```


## PLOTS

## All 4 Limbs

### Contact Phase
```{r PF Contribution Index - Eugene Version }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGasSolContributiontoPFActivity_ContactPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGasSolContributiontoPFActivity_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGasSolContributiontoPFActivity_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGasSolContributiontoPFActivity_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGasSolContributiontoPFActivity_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_MedGasSolContributiontoPFActivity_ContactPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_MedGasSolContributiontoPFActivity_ContactPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGasSolContributiontoPFActivity_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_MedGasSolContributiontoPFActivity_ContactPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_MedGasSolContributiontoPFActivity_ContactPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
      
   #  #Use geom_signif to add significance bars 
   #  geom_signif( data = HopHeightvsLimb_2.3Hz_Braking_BothEffects_CI, aes( annotations = Label, y_position = YPosition, xmin = XMin, xmax = XMax, tip_length = c(0, rep(0.005, 3) ) ), manual = T, size = 4, textsize = 20, vjust = -0.1, fontface = 'bold', nudge_x = c(0.2, 0, 0, 0) ) +
   # 
   #  
   #    #Add label with Involved limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 1 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 1 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Non-Involved limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 2 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 2 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Matched Dominance limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 4 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 4 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Contralateral limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 3 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 3 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #    
      

    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  MedGas + Soleus Contribution to PF Activation vs Limb  \n 2.33 Hz Hopping Contact Phase ', x='Limb ID', y = ' Contribution Index (max = 1) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_GasMedSolContributiontoPFActivation_ContactPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```



```{r PF Contribution Index - All TS }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_AllTSContributiontoPFActivity_ContactPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_AllTSContributiontoPFActivity_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_AllTSContributiontoPFActivity_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_AllTSContributiontoPFActivity_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_AllTSContributiontoPFActivity_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_AllTSContributiontoPFActivity_ContactPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_AllTSContributiontoPFActivity_ContactPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_AllTSContributiontoPFActivity_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_AllTSContributiontoPFActivity_ContactPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_AllTSContributiontoPFActivity_ContactPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
 
      
      
      
      
   #  #Use geom_signif to add significance bars 
   #  geom_signif( data = HopHeightvsLimb_2.3Hz_Braking_BothEffects_CI, aes( annotations = Label, y_position = YPosition, xmin = XMin, xmax = XMax, tip_length = c(0, rep(0.005, 3) ) ), manual = T, size = 4, textsize = 20, vjust = -0.1, fontface = 'bold', nudge_x = c(0.2, 0, 0, 0) ) +
   # 
   #  
   #    #Add label with Involved limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 1 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 1 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Non-Involved limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 2 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 2 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Matched Dominance limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 4 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 4 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Contralateral limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 3 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 3 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #    
      

    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  All TS Contribution to PF Activation vs Limb  \n 2.33 Hz Hopping Contact Phase ', x='Limb ID', y = ' Contribution Index (max = 1) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_AllTSContributiontoPFActivation_ContactPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```





```{r TA Coactivation Ratio - Eugene Version }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase, na.rm = T )



Coactivation_ParticipantMeans_2.3Hz_NoHC01 <- Coactivation_ParticipantMeans_2.3Hz %>%
   filter( Participant_ID != 'HC01' )

SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x, na.rm = T ), ymin = mean( x, na.rm = T ) - 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ), ymax = mean( x, na.rm = T ) + 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Limb_ID )


Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz_NoHC01$Limb_ID == UniqueLimbID[ l ] ) ], na.rm = T )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz_NoHC01, aes(y = Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz_NoHC01, Limb_ID == 'Matched Dominance' ), label = '95% CI', size = 20, color = 'black', x = 0.75, y = 0.06, na.rm = T ) +
      
      
    #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz_NoHC01, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'black', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz_NoHC01, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz_NoHC01, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'black', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz_NoHC01, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 0.42, na.rm = T ) +
 
 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5, na.rm = T ) +
    
      
   #  #Use geom_signif to add significance bars 
   #  geom_signif( data = HopHeightvsLimb_2.3Hz_Braking_BothEffects_CI, aes( annotations = Label, y_position = YPosition, xmin = XMin, xmax = XMax, tip_length = c(0, rep(0.005, 3) ) ), manual = T, size = 4, textsize = 20, vjust = -0.1, fontface = 'bold', nudge_x = c(0.2, 0, 0, 0) ) +
   # 
   #  
   #    #Add label with Involved limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 1 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 1 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Non-Involved limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 2 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 2 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Matched Dominance limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 4 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 4 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Contralateral limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 3 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 3 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #    
      

    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23, na.rm = T ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1.6, by = 0.2 ), limits =  c( 0, 1.6 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  TA Coactivation Ratio with MedGas, Sol, PL vs Limb  \n 2.33 Hz Hopping Contact Phase ', x='Limb ID', y = ' Coactivation Ratio ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_TACoactivationRatiowithMedGasSolPL_ContactPhase_All4Limbs_ParticipantMeans_NoHC01.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```





```{r TA Coactivation Ratio - All TS }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase, na.rm = T )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x, na.rm = T ), ymin = mean( x, na.rm = T ) - 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ), ymax = mean( x, na.rm = T ) + 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ], na.rm = T )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), label = '95% CI', size = 20, color = 'black', x = 0.75, y = 0.06, na.rm = T ) +
      
      
    #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'black', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'black', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 0.42, na.rm = T ) +
 
 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_TAvsAllbutLGas_CoactivationRatio_ContactPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5, na.rm = T ) +
    
      
   #  #Use geom_signif to add significance bars 
   #  geom_signif( data = HopHeightvsLimb_2.3Hz_Braking_BothEffects_CI, aes( annotations = Label, y_position = YPosition, xmin = XMin, xmax = XMax, tip_length = c(0, rep(0.005, 3) ) ), manual = T, size = 4, textsize = 20, vjust = -0.1, fontface = 'bold', nudge_x = c(0.2, 0, 0, 0) ) +
   # 
   #  
   #    #Add label with Involved limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 1 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 1 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Non-Involved limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 2 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 2 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Matched Dominance limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 4 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 4 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Contralateral limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 3 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 3 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #    
      

    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23, na.rm = T ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1.6, by = 0.2 ), limits =  c( 0, 1.6 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  TA Coactivation Ratio with MedGas, LatGas, Sol, PL vs Limb  \n 2.33 Hz Hopping Contact Phase ', x='Limb ID', y = ' Coactivation Ratio ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_TACoactivationRatiowithMedGasLatGasSolPL_ContactPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```



### Braking Phase
```{r PF Contribution Index - All TS }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivityBrakingPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ), SE = sd( x )/sqrt( length( x ) ), CI_Arm = 2*( sd( x )/sqrt( length( x ) ) ) )
   
}

#Find SE and CI for Involved Limb
InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivityBrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivityBrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivityBrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivityBrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_TSContributiontoPFActivityBrakingPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

#Fill in data frame with means for each limb
for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_TSContributiontoPFActivityBrakingPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivityBrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_TSContributiontoPFActivityBrakingPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.8, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_TSContributiontoPFActivityBrakingPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  All TS Contribution to PF Activation vs Limb  \n 2.33 Hz Hopping Braking Phase ', x='Limb ID', y = ' Contribution Index (max = 1) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_AllTSContributiontoPFActivation_BrakingPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```



```{r Gastroc Contribution to PF Index  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_TwoJointTS_Contribution2AllPF_BrakingPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_TwoJointTS_Contribution2AllPF_BrakingPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_TwoJointTS_Contribution2AllPF_BrakingPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_TwoJointTS_Contribution2AllPF_BrakingPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Gastrocnemii Contribution to PF Activation vs Limb  \n 2.33 Hz Hopping Braking Phase ', x='Limb ID', y = ' Contribution Index (max = 1) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_GastrocContributiontoPFActivation_BrakingPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```







```{r Gastroc Contribution to TS Index  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_GastrocnemiiContributiontoAllTS_BrakingPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_GastrocnemiiContributiontoAllTS_BrakingPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_GastrocnemiiContributiontoAllTS_BrakingPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_GastrocnemiiContributiontoAllTS_BrakingPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Gastrocnemii Contribution to TS Activation vs Limb  \n 2.33 Hz Hopping Braking Phase ', x='Limb ID', y = ' Contribution Index (max = 1) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_GastrocContributiontoTSActivation_BrakingPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```





```{r Soleus Contribution to PF Index  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_BrakingPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_OneJointTS_Contribution2AllPF_BrakingPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_OneJointTS_Contribution2AllPF_BrakingPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_OneJointTS_Contribution2AllPF_BrakingPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_OneJointTS_Contribution2AllPF_BrakingPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Soleus Contribution to PF Activation vs Limb  \n 2.33 Hz Hopping Braking Phase ', x='Limb ID', y = ' Contribution Index (max = 1) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_SoleusContributiontoPFActivation_BrakingPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```


```{r TA Coactivation Ratio - All TS }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase, na.rm = T )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x, na.rm = T ), ymin = mean( x, na.rm = T ) - 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ), ymax = mean( x, na.rm = T ) + 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_TAvsAllPF_CoactivationRatio_BrakingPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_TAvsAllPF_CoactivationRatio_BrakingPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ], na.rm = T )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_TAvsAllPF_CoactivationRatio_BrakingPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), label = '95% CI', size = 20, color = 'black', x = 0.75, y = 0.06, na.rm = T ) +
      
      
    #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'black', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'black', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 0.42, na.rm = T ) +
 
 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_TAvsAllPF_CoactivationRatio_BrakingPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5, na.rm = T ) +
    
      
   #  #Use geom_signif to add significance bars 
   #  geom_signif( data = HopHeightvsLimb_2.3Hz_Braking_BothEffects_CI, aes( annotations = Label, y_position = YPosition, xmin = XMin, xmax = XMax, tip_length = c(0, rep(0.005, 3) ) ), manual = T, size = 4, textsize = 20, vjust = -0.1, fontface = 'bold', nudge_x = c(0.2, 0, 0, 0) ) +
   # 
   #  
   #    #Add label with Involved limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 1 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 1 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Non-Involved limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 2 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 2 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Matched Dominance limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 4 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 4 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #  
   # 
   #    #Add label with Contralateral limb mean
   # geom_text( label = paste( 'Mean = ', as.character( round( HopHeightAverages_FromRMME$Mean_HoppingHeight_cm[ 3 ], digits = 2 ) ) ), aes( x = HopHeightAverages_FromRMME$Limb_ID[ 3 ], y = -0.1 ), size = 20, fontface = 'bold' ) +
   #    
      

    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23, na.rm = T ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1.6, by = 0.2 ), limits =  c( 0, 1.6 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  TA Coactivation Ratio with MedGas, LatGas, Sol, PL vs Limb  \n 2.33 Hz Hopping Braking Phase ', x='Limb ID', y = ' Coactivation Ratio ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_TACoactivationRatiowithMedGasLatGasSolPL_BrakingPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```






```{r MedGas iEMG  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_BrakingPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


MedGas_iEMG_BrakingPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   MedGas_iEMG_BrakingPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_MedGas_iEMG_BrakingPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = MedGas_iEMG_BrakingPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 16, by = 2 ), limits =  c( 0, 16 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Medial Gastroc Integrated EMG vs Limb  \n 2.33 Hz Hopping Braking Phase ', x='Limb ID', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_MedGasiEMG_BrakingPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```




```{r LatGas iEMG  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_BrakingPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


LatGas_iEMG_BrakingPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   LatGas_iEMG_BrakingPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_GasLat_iEMG_BrakingPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = LatGas_iEMG_BrakingPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 16, by = 2 ), limits =  c( 0, 16 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Lateral Gastroc Integrated EMG vs Limb  \n 2.33 Hz Hopping Braking Phase ', x='Limb ID', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_LatGasiEMG_BrakingPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```







```{r Sol iEMG  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_BrakingPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Sol_iEMG_BrakingPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Sol_iEMG_BrakingPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_Sol_iEMG_BrakingPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Sol_iEMG_BrakingPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 16, by = 2 ), limits =  c( 0, 16 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Soleus Integrated EMG vs Limb  \n 2.33 Hz Hopping Braking Phase ', x='Limb ID', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_SoliEMG_BrakingPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```






```{r PL iEMG  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_BrakingPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


PL_iEMG_BrakingPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   PL_iEMG_BrakingPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_PL_iEMG_BrakingPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = PL_iEMG_BrakingPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 16, by = 2 ), limits =  c( 0, 16 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Per. Long. Integrated EMG vs Limb  \n 2.33 Hz Hopping Braking Phase ', x='Limb ID', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_PLiEMG_BrakingPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```







```{r TA iEMG  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_BrakingPhase, na.rm = T )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x, na.rm = T ), ymin = mean( x, na.rm = T ) - 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ), ymax = mean( x, na.rm = T ) + 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


TA_iEMG_BrakingPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   TA_iEMG_BrakingPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_BrakingPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ], na.rm = T )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_TA_iEMG_BrakingPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = TA_iEMG_BrakingPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black', na.rm = T ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5, na.rm = T ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23, na.rm = T ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 28, by = 4 ), limits =  c( 0, 28 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Tib. Ant. Integrated EMG vs Limb  \n 2.33 Hz Hopping Braking Phase ', x='Limb ID', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_TAiEMG_BrakingPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```



### Propulsion Phase
```{r PF Contribution Index - All TS }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivity_PropulsionPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_TSContributiontoPFActivity_PropulsionPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_TSContributiontoPFActivity_PropulsionPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_TSContributiontoPFActivity_PropulsionPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_TSContributiontoPFActivity_PropulsionPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  All TS Contribution to PF Activation vs Limb  \n 2.33 Hz Hopping Propulsion Phase ', x='Limb ID', y = ' Contribution Index (max = 1) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_AllTSContributiontoPFActivation_PropulsionPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```






```{r Gastroc Contribution to PF Index  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Gastrocnemii Contribution to PF Activation vs Limb  \n 2.33 Hz Hopping Propulsion Phase ', x='Limb ID', y = ' Contribution Index (max = 1) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_GastrocContributiontoPFActivation_PropulsionPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```







```{r Gastroc Contribution to TS Index  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 0.35, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Gastrocnemii Contribution to TS Activation vs Limb  \n 2.33 Hz Hopping Propulsion Phase ', x='Limb ID', y = ' Contribution Index (max = 1) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_GastrocContributiontoTSActivation_PropulsionPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```





```{r Soleus Contribution to PF Index  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_OneJointTS_Contribution2AllPF_PropulsionPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_OneJointTS_Contribution2AllPF_PropulsionPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_OneJointTS_Contribution2AllPF_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_OneJointTS_Contribution2AllPF_PropulsionPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_OneJointTS_Contribution2AllPF_PropulsionPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'black', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'black', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 0.35, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  Soleus Contribution to PF Activation vs Limb  \n 2.33 Hz Hopping Propulsion Phase ', x='Limb ID', y = ' Contribution Index (max = 1) ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_SoleusContributiontoPFActivation_PropulsionPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```







```{r TA Coactivation Ratio - All TS }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase, na.rm = T )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x, na.rm = T ), ymin = mean( x, na.rm = T ) - 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ), ymax = mean( x, na.rm = T ) + 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ], na.rm = T )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), label = '95% CI', size = 20, color = 'black', x = 0.75, y = 0.06, na.rm = T ) +
      
      
    #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'black', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'black', x = 1, y = 0.35, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 0.42, na.rm = T ) +
 
 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black', na.rm = T ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5, na.rm = T ) +
    
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23, na.rm = T ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1.6, by = 0.2 ), limits =  c( 0, 1.6 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title='  TA Coactivation Ratio with MedGas, LatGas, Sol, PL vs Limb  \n 2.33 Hz Hopping Propulsion Phase ', x='Limb ID', y = ' Coactivation Ratio ' ) +
   
   

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_TACoactivationRatiowithMedGasLatGasSolPL_PropulsionPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```



```{r MedGas iEMG  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_PropulsionPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


MedGas_iEMG_PropulsionPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   MedGas_iEMG_PropulsionPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_MedGas_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_MedGas_iEMG_PropulsionPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = MedGas_iEMG_PropulsionPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 16, by = 2 ), limits =  c( 0, 16 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Medial Gastroc Integrated EMG vs Limb  \n 2.33 Hz Hopping Propulsion Phase ', x='Limb ID', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_MedGasiEMG_PropulsionPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```




```{r LatGas iEMG  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_PropulsionPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


LatGas_iEMG_PropulsionPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   LatGas_iEMG_PropulsionPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_GasLat_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_GasLat_iEMG_PropulsionPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = LatGas_iEMG_PropulsionPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 16, by = 2 ), limits =  c( 0, 16 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Lateral Gastroc Integrated EMG vs Limb  \n 2.33 Hz Hopping Propulsion Phase ', x='Limb ID', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_LatGasiEMG_PropulsionPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```







```{r Sol iEMG  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_PropulsionPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


Sol_iEMG_PropulsionPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   Sol_iEMG_PropulsionPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_Sol_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ] )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_Sol_iEMG_PropulsionPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = Sol_iEMG_PropulsionPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'black', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 1, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'black', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'black', x = 2, y = 1, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 20, by = 2 ), limits =  c( 0, 20 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Soleus Integrated EMG vs Limb  \n 2.33 Hz Hopping Propulsion Phase ', x='Limb ID', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_SoliEMG_PropulsionPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```






```{r PL iEMG  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_PropulsionPhase )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x ), ymin = mean( x ) - 2*( sd( x )/sqrt( length( x ) ) ), ymax = mean( x ) + 2*( sd( x )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


PL_iEMG_PropulsionPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   PL_iEMG_PropulsionPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_PL_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ], na.rm = T )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_PL_iEMG_PropulsionPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = PL_iEMG_PropulsionPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5 ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 16, by = 2 ), limits =  c( 0, 16 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Per. Long. Integrated EMG vs Limb  \n 2.33 Hz Hopping Propulsion Phase ', x='Limb ID', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_PLiEMG_PropulsionPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```







```{r TA iEMG  }


range( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_PropulsionPhase, na.rm = T )


SE_function <- function( x ) {
   
   SE_DataFrame <- data.frame( y = mean( x, na.rm = T ), ymin = mean( x, na.rm = T ) - 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ), ymax = mean( x, na.rm = T ) + 2*( sd( x, na.rm = T )/sqrt( length( x ) ) ) )
   
}


InvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Involved' ) ] )

NonInvolvedLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Non-Involved' ) ] )

MatchedDominanceLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Matched Dominance' ) ] )

ContralateralLimbCI <- SE_function( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == 'Contralateral' ) ] )




UniqueLimbID <- unique( Coactivation_ParticipantMeans_2.3Hz$Limb_ID )


TA_iEMG_PropulsionPhase_LimbMean <- data.frame( Group_ID = c( 'ATx', 'ATx', 'Control', 'Control'), Limb_ID = UniqueLimbID, Mean = c( 0, 0, 0, 0 ) )

for ( l in 1 : length( UniqueLimbID ) ) {
   
   
   TA_iEMG_PropulsionPhase_LimbMean$Mean[ l ] <- mean( Coactivation_ParticipantMeans_2.3Hz$Mean_TA_iEMG_PropulsionPhase[ which( Coactivation_ParticipantMeans_2.3Hz$Limb_ID == UniqueLimbID[ l ] ) ], na.rm = T )
   
   
}


#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_2.3Hz, aes(y = Mean_TA_iEMG_PropulsionPhase, x = Limb_ID ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

      
    #Add Label for 95% CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), label = '95% CI', size = 20, color = 'black', x = 2.25, y = 0.7, na.rm = T ) +
      
      

 
 
   
    
   #Regression line for Control Group, CONTRALATERAL Limb
      geom_col( data = TA_iEMG_PropulsionPhase_LimbMean, aes( y = Mean, x = Limb_ID, fill = Limb_ID, group = Limb_ID ), color = 'black', na.rm = T ) +
      
      
      stat_summary( geom = 'errorbar', fun.data = SE_function, aes( group = Limb_ID ), linewidth = 5, na.rm = T ) +
    
      
      
      
          #Add Label for Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Involved' ), aes(  label = paste0( round( InvolvedLimbCI$y, digits = 2), ' (', round( InvolvedLimbCI$ymin, digits = 2), ', ', round( InvolvedLimbCI$ymax, digits = 2), ')' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Non-Involved Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Non-Involved' ), aes(  label = paste0( round( NonInvolvedLimbCI$y, digits = 2), ' (', round( NonInvolvedLimbCI$ymin, digits = 2), ', ', round( NonInvolvedLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
      
      
    #Add Label for Matched Dominance Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Matched Dominance' ), aes(  label = paste0( round( MatchedDominanceLimbCI$y, digits = 2), ' ( ', round( MatchedDominanceLimbCI$ymin, digits = 2), ', ', round( MatchedDominanceLimbCI$ymax, digits = 2), ') ' ) ), size = 18, color = 'white', x = 1, y = 1, na.rm = T ) +
      
      
    #Add Label for Contralateral Limb CI
    geom_text( data = subset( Coactivation_ParticipantMeans_2.3Hz, Limb_ID == 'Contralateral' ), aes(  label = paste0( round( ContralateralLimbCI$y, digits = 2), ' ( ', round( ContralateralLimbCI$ymin, digits = 2), ', ', round( ContralateralLimbCI$ymax, digits = 2), ' )' ) ), size = 18, color = 'white', x = 2, y = 1, na.rm = T ) +
 
      
      
      
      


    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID, group = Limb_ID ), size = 20, stroke = 3, colour = 'white', position = position_jitter(seed=1, height = 0, width = 0.35), shape = 23, na.rm = T ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 28, by = 4 ), limits =  c( 0, 28 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Tib. Ant. Integrated EMG vs Limb  \n 2.33 Hz Hopping Propulsion Phase ', x='Limb ID', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison/All 4 Limbs', filename = 'Dissertation_TAiEMG_PropulsionPhase_All4Limbs_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```




### Within ATx


##### 2.3 Hz


###### Total PF Activation
```{r Braking Phase }

(TotalPFAct_Braking1 <- ggplot(data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_TotalPFActivation_BrakingPhase, x = factor( Limb_ID )  ) ) +
      

      #geom_line( data = Coactivation_ParticipantMeans, aes(x = Limb_ID, y=Mean_PercentNegativeCoactivation_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape=Participant_ID ), size = 5, show.legend=FALSE ) +
      
        #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID, color = Limb_ID ), linewidth = 1, show.legend = F  )+ 
    
   
    geom_dotplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_TotalPFActivation_BrakingPhase, x = factor( Limb_ID ), fill = Participant_ID, group = interaction( Participant_ID, Limb_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 2 ) +
      

   


   scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
   
      
      
      scale_y_continuous(breaks=seq(0,45,by=5),limits=c(0, 45) )+
    
    
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
   
      labs(title=' Total PF Integrated EMG During Braking Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) 

 
)




```



```{r Propulsion Phase }

(TotalPFAct_Propulsion1 <- ggplot(data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_TotalPFActivation_PropulsionPhase, x = factor( Limb_ID )  ) ) +
      

      #geom_line( data = Coactivation_ParticipantMeans, aes(x = Limb_ID, y=Mean_PercentNegativeCoactivation_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape=Participant_ID ), size = 5, show.legend=FALSE ) +
      
        #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID, color = Limb_ID ), linewidth = 1, show.legend = F  )+ 
    
   
    geom_dotplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_TotalPFActivation_PropulsionPhase, x = factor( Limb_ID ), fill = Participant_ID, group = interaction( Participant_ID, Limb_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 2 ) +
      

   


      scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
   
      
      
      scale_y_continuous(breaks=seq(0,45,by=5),limits=c(0, 45) )+
    
    
       scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
   
      labs(title=' Total PF Integrated EMG During Propulsion Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) 

 
)




```






###### Total TS Activation
```{r Braking Phase }

(TotalTSAct_Braking1 <- ggplot(data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_TotalTSActivation_BrakingPhase, x = factor( Limb_ID )  ) ) +
      

      #geom_line( data = Coactivation_ParticipantMeans, aes(x = Limb_ID, y=Mean_PercentNegativeCoactivation_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape=Participant_ID ), size = 5, show.legend=FALSE ) +
      
        #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID, color = Limb_ID ), linewidth = 1, show.legend = F  )+ 
    
   
    geom_dotplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_TotalTSActivation_BrakingPhase, x = factor( Limb_ID ), fill = Participant_ID, group = interaction( Participant_ID, Limb_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 2 ) +
      

   


     scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
   
      
      
      scale_y_continuous(breaks=seq(0,45,by=5),limits=c(0, 45) )+
    
    
       scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
   
      labs(title=' Total TS Integrated EMG During Braking Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) 

 
)




```



```{r Propulsion Phase }

(TotalTSAct_Propulsion1 <- ggplot(data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes(y = Mean_TotalTSActivation_PropulsionPhase, x = factor( Limb_ID )  ) ) +
      

      #geom_line( data = Coactivation_ParticipantMeans, aes(x = Limb_ID, y=Mean_PercentNegativeCoactivation_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape=Participant_ID ), size = 5, show.legend=FALSE ) +
      
        #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID, color = Limb_ID ), linewidth = 1, show.legend = F  )+ 
    
   
    geom_dotplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( y = Mean_TotalTSActivation_PropulsionPhase, x = factor( Limb_ID ), fill = Participant_ID, group = interaction( Participant_ID, Limb_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 2 ) +
      

   


      scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
    
   
      
      
      scale_y_continuous(breaks=seq(0,45,by=5),limits=c(0, 45) )+
    
    
       scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
   
      labs(title=' Total TS Integrated EMG During Propulsion Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) 

 
)




```



###### TS Contribution
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( x = factor(Limb_ID) , y = Mean_TSContributiontoPFActivityBrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID , color = Limb_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, Limb_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
     
     
     labs(title='TS Contribution to PF Activation - Braking Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = ' Contribution (max = 1) ' ) +
     
   
               scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
   
   
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```


```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( x =  factor(Limb_ID), y = Mean_TSContributiontoPFActivity_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID , color = Limb_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, Limb_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
       scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
     
     
     
     labs(title='TS Contribution to PF Activation - Propulsion Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = ' Contribution (max = 1) ' ) +
     
     
   
               scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```



###### MedGas Contribution
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( x = factor(Limb_ID) , y = Mean_MedGasContributiontoAllTS_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID , color = Limb_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, Limb_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
     
     
     labs(title='MedGas Contribution to TS Activation - Braking Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = ' Contribution (max = 1) ' ) +
     
      scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```

```{r Propulsion Phase}

( PropulsionTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( x = factor(Limb_ID) , y = Mean_MedGasContributiontoAllTS_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID , color = Limb_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, Limb_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
     
     
     labs(title='MedGas Contribution to TS Activation - Propulsion Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = ' Contribution (max = 1) ' ) +
     
   
            scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     )

```



###### LatGas Contribution
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( x = factor(Limb_ID) , y = Mean_LatGasContributiontoAllTS_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID , color = Limb_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, Limb_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
     
     
     labs(title='LatGas Contribution to TS Activation - Braking Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = ' Contribution (max = 1) ' ) +
     
   
            scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
   guides(fill='none',size='none',shape='none',color='none' )+
   
   
      # guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
      #                              'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
      #                              'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
      #      'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
      #      'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
      #      'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
      #      'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```

```{r Propulsion Phase}

( PropulsionTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( x = factor(Limb_ID) , y = Mean_LatGasContributiontoAllTS_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID , color = Limb_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, Limb_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
     
     
     labs(title='LatGas Contribution to TS Activation - Propulsion Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = ' Contribution (max = 1) ' ) +
     
   
            scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```



###### Sol Contribution
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( x = factor(Limb_ID) , y = Mean_SolContributiontoAllTS_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID , color = Limb_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, Limb_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
     
     
     labs(title='Sol Contribution to TS Activation - Braking Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = ' Contribution (max = 1) ' ) +
     
      scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```


```{r Propulsion Phase}

( PropulsionTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_ATx_2.3Hz, aes( x = factor(Limb_ID) , y = Mean_SolContributiontoAllTS_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Limb_ID , color = Limb_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, Limb_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( 'Involved', ' Non-Involved ' ) )+
      
     
     
     labs(title='Sol Contribution to TS Activation - Propulsion Phase \n ATx Group - 2.3 Hz Hopping',x='Limb ID', y = ' Contribution (max = 1) ' ) +
     
   
             scale_color_manual(values = c( 'Involved' = met.brewer( 'Austria' )[1], 
'Non-Involved' = met.brewer( 'Austria' )[2]) ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('Involved','Non-Involved' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Renoir')[1], 
                                          'ATx08' = met.brewer('Renoir')[2],
                                          'ATx10'=met.brewer('Renoir')[3], 
                                          'ATx12'=met.brewer('Renoir')[4],
                                          'ATx17'=met.brewer('Renoir')[5],
                                          'ATx18'=met.brewer('Renoir')[6],
                                          'ATx19'=met.brewer('Renoir')[7],
                                          'ATx21'=met.brewer('Renoir')[8],
                                          'ATx24'=met.brewer('Renoir')[9],
                                          'ATx25'=met.brewer('Renoir')[10],
                                          'ATx27'=met.brewer('Renoir')[11],
                                          'ATx34'=met.brewer('Renoir')[12] ),
                               name = '',
                               aesthetics=c('fill'), labels=c( 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```


### Involved vs Control
##### 2.3 Hz


###### Total PF Activation
```{r Braking Phase }

(TotalPFAct_Braking1 <- ggplot(data = Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz, aes(y = Mean_TotalPFActivation_BrakingPhase, x = Limb_ID  ) ) +
      

      #geom_line( data = Coactivation_ParticipantMeans, aes(x = Limb_ID, y=Mean_PercentNegativeCoactivation_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape=Participant_ID ), size = 5, show.legend=FALSE ) +
      
        #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, factor( HoppingRate_ID ) ), color = Group_ID ), linewidth = 1, show.legend = F  )+ 
    
   
    geom_dotplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz, aes( y = Mean_TotalPFActivation_BrakingPhase, x = Limb_ID, fill = Participant_ID, group = interaction( Participant_ID, HoppingRate_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 2 ) +
      

   


   scale_color_manual(values = c( 'ATx' = met.brewer( 'Austria' )[1], 'Control' = met.brewer( 'Austria' )[3] ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 
                                          'HC01' = met.brewer('Redon')[1], 
                                          'ATx10'=met.brewer('Redon')[2], 
                                          'HC12'=met.brewer('Redon')[2],
                                          'ATx17'=met.brewer('Redon')[3],
                                          'HC06'=met.brewer('Redon')[3],
                                          'ATx18'=met.brewer('Redon')[4],
                                          'ATx19'=met.brewer('Redon')[5],
                                          'ATx21'=met.brewer('Redon')[6],
                                          'HC11'=met.brewer('Redon')[6],
                                          'HC05'=met.brewer('Redon')[7],
                                          'HP02'=met.brewer('Redon')[8],
                                          'HP08'=met.brewer('Redon')[9],
                                          'HP09'=met.brewer('Redon')[10]),
                               name = '',
                               aesthetics=c('fill'), labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
    
   
      
      
      scale_y_continuous(breaks=seq(0,45,by=5),limits=c(0, 45) )+
    

    
    
      scale_x_discrete(labels = c( 'Involved', ' Matched Control Limb ' ) )+
      
   
      labs(title=' Total PF Integrated EMG - Braking Phase \n 2.3 Hz - ATx vs Control',x='Limb ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) 
 
)




```



```{r Propulsion Phase }

(TotalPFAct_Propulsion1 <- ggplot(data = Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz, aes(y = Mean_TotalPFActivation_PropulsionPhase, x = Limb_ID  ) ) +
      

      #geom_line( data = Coactivation_ParticipantMeans, aes(x = Limb_ID, y=Mean_PercentNegativeCoactivation_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape=Participant_ID ), size = 5, show.legend=FALSE ) +
      
        #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, Limb_ID ), color = Group_ID ), linewidth = 1, show.legend = F  )+ 
    
   
    geom_dotplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.3Hz, aes( y = Mean_TotalPFActivation_PropulsionPhase, x = Limb_ID, fill = Participant_ID, group = interaction( Participant_ID, HoppingRate_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 2 ) +
      

   


   scale_color_manual(values = c( 'ATx' = met.brewer( 'Austria' )[1], 'Control' = met.brewer( 'Austria' )[3] ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 
                                          'HC01' = met.brewer('Redon')[1], 
                                          'ATx10'=met.brewer('Redon')[2], 
                                          'HC12'=met.brewer('Redon')[2],
                                          'ATx17'=met.brewer('Redon')[3],
                                          'HC06'=met.brewer('Redon')[3],
                                          'ATx18'=met.brewer('Redon')[4],
                                          'ATx19'=met.brewer('Redon')[5],
                                          'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],
                                          'HC05'=met.brewer('Redon')[7],
                                          'HP02'=met.brewer('Redon')[8],
                                          'HP08'=met.brewer('Redon')[9],
                                          'HP09'=met.brewer('Redon')[10]),
                               name = '',
                               aesthetics=c('fill'), labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
    
   
      
      
      scale_y_continuous(breaks=seq(0,45,by=5),limits=c(0, 45) )+
    
    
      scale_x_discrete(labels = c( 'Involved', ' Matched Control Limb ' ) )+
      
   
      labs(title=' Total PF Integrated EMG - Propulsion Phase \n 2.3 Hz - ATx vs Control',x='Limb ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) 
)




```



##### 2.0 vs 2.3 Hz


###### Total PF Activation
```{r Braking Phase }

(TotalPFAct_Braking1 <- ggplot(data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes(y = Mean_TotalPFActivation_BrakingPhase, x = factor( HoppingRate_ID )  ) ) +
      

      #geom_line( data = Coactivation_ParticipantMeans, aes(x = Limb_ID, y=Mean_PercentNegativeCoactivation_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape=Participant_ID ), size = 5, show.legend=FALSE ) +
      
        #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, factor( HoppingRate_ID ) ), color = Group_ID ), linewidth = 1, show.legend = F  )+ 
    
   
    geom_dotplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( y = Mean_TotalPFActivation_BrakingPhase, x = factor( HoppingRate_ID ), fill = Participant_ID, group = interaction( Participant_ID, HoppingRate_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 2 ) +
      

   


   scale_color_manual(values = c( 'ATx' = met.brewer( 'Austria' )[1], 'Control' = met.brewer( 'Austria' )[3] ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 
                                          'HC01' = met.brewer('Redon')[1], 
                                          'ATx10'=met.brewer('Redon')[2], 
                                          'HC12'=met.brewer('Redon')[2],
                                          'ATx17'=met.brewer('Redon')[3],
                                          'HC06'=met.brewer('Redon')[3],
                                          'ATx18'=met.brewer('Redon')[4],
                                          'ATx19'=met.brewer('Redon')[5],
                                          'ATx21'=met.brewer('Redon')[6],
                                          'HC11'=met.brewer('Redon')[6],
                                          'HC05'=met.brewer('Redon')[7],
                                          'HP02'=met.brewer('Redon')[8],
                                          'HP08'=met.brewer('Redon')[9],
                                          'HP09'=met.brewer('Redon')[10]),
                               name = '',
                               aesthetics=c('fill'), labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
    
   
      
      
      scale_y_continuous(breaks=seq(0,45,by=5),limits=c(0, 45) )+
    
    
      scale_x_discrete(labels = c( 'Involved', ' Matched Control Limb ' ) )+
      
   
      labs(title=' Total PF Integrated EMG During Braking Phase \n 2.0 vs 2.3 Hz - ATx vs Control',x='Limb ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) 

 
)




```



```{r Propulsion Phase }

(TotalPFAct_Propulsion1 <- ggplot(data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes(y = Mean_TotalPFActivation_PropulsionPhase, x = factor( HoppingRate_ID )  ) ) +
      

      #geom_line( data = Coactivation_ParticipantMeans, aes(x = Limb_ID, y=Mean_PercentNegativeCoactivation_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape=Participant_ID ), size = 5, show.legend=FALSE ) +
      
        #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, factor( HoppingRate_ID ) ), color = Group_ID ), linewidth = 1, show.legend = F  )+ 
    
   
    geom_dotplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( y = Mean_TotalPFActivation_PropulsionPhase, x = factor( HoppingRate_ID ), fill = Participant_ID, group = interaction( Participant_ID, HoppingRate_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 2 ) +
      

   


   scale_color_manual(values = c( 'ATx' = met.brewer( 'Austria' )[1], 'Control' = met.brewer( 'Austria' )[3] ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 
                                          'HC01' = met.brewer('Redon')[1], 
                                          'ATx10'=met.brewer('Redon')[2], 
                                          'HC12'=met.brewer('Redon')[2],
                                          'ATx17'=met.brewer('Redon')[3],
                                          'HC06'=met.brewer('Redon')[3],
                                          'ATx18'=met.brewer('Redon')[4],
                                          'ATx19'=met.brewer('Redon')[5],
                                          'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],
                                          'HC05'=met.brewer('Redon')[7],
                                          'HP02'=met.brewer('Redon')[8],
                                          'HP08'=met.brewer('Redon')[9],
                                          'HP09'=met.brewer('Redon')[10]),
                               name = '',
                               aesthetics=c('fill'), labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
    
   
      
      
      scale_y_continuous(breaks=seq(0,45,by=5),limits=c(0, 45) )+
    
    
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
   
      labs(title=' Total PF Integrated EMG During Propulsion Phase \n 2.0 vs 2.3 Hz - ATx vs Control',x='Hopping Rate ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) +
   
   
   facet_wrap( vars( Group_ID, Limb_ID ), labeller = labeller( Limb_ID = c( 'Involved' = 'Involved Limb', 'Matched Control' = 'Matched Limb' ) ) )

 
)




```






###### Total TS Activation
```{r Braking Phase }

(TotalTSAct_Braking1 <- ggplot(data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes(y = Mean_TotalTSActivation_BrakingPhase, x = factor( HoppingRate_ID )  ) ) +
      

      #geom_line( data = Coactivation_ParticipantMeans, aes(x = Limb_ID, y=Mean_PercentNegativeCoactivation_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape=Participant_ID ), size = 5, show.legend=FALSE ) +
      
        #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, factor( HoppingRate_ID ) ), color = Group_ID ), linewidth = 1, show.legend = F  )+ 
    
   
    geom_dotplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( y = Mean_TotalTSActivation_BrakingPhase, x = factor( HoppingRate_ID ), fill = Participant_ID, group = interaction( Participant_ID, HoppingRate_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 2 ) +
      

   


   scale_color_manual(values = c( 'ATx' = met.brewer( 'Austria' )[1], 'Control' = met.brewer( 'Austria' )[3] ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 
                                          'HC01' = met.brewer('Redon')[1], 
                                          'ATx10'=met.brewer('Redon')[2], 
                                          'HC12'=met.brewer('Redon')[2],
                                          'ATx17'=met.brewer('Redon')[3],
                                          'HC06'=met.brewer('Redon')[3],
                                          'ATx18'=met.brewer('Redon')[4],
                                          'ATx19'=met.brewer('Redon')[5],
                                          'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],
                                          'HC05'=met.brewer('Redon')[7],
                                          'HP02'=met.brewer('Redon')[8],
                                          'HP08'=met.brewer('Redon')[9],
                                          'HP09'=met.brewer('Redon')[10]),
                               name = '',
                               aesthetics=c('fill'), labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
    
   
      
      
      scale_y_continuous(breaks=seq(0,45,by=5),limits=c(0, 45) )+
    
    
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
   
      labs(title=' Total TS Integrated EMG During Braking Phase \n 2.0 vs 2.3 Hz - ATx vs Control',x='Hopping Rate ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) +
   
   
   facet_wrap( vars( Group_ID, Limb_ID ), labeller = labeller( Limb_ID = c( 'Involved' = 'Involved Limb', 'Matched Control' = 'Matched Limb' ) ) )

 
)




```



```{r Propulsion Phase }

(TotalTSAct_Propulsion1 <- ggplot(data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes(y = Mean_TotalTSActivation_PropulsionPhase, x = factor( HoppingRate_ID )  ) ) +
      

      #geom_line( data = Coactivation_ParticipantMeans, aes(x = Limb_ID, y=Mean_PercentNegativeCoactivation_JointContribution_EntireContactPhase, group = interaction( Joint_ID, Limb_ID) , color = Joint_ID, shape=Participant_ID ), size = 5, show.legend=FALSE ) +
      
        #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) ), color = 'white', size = 3, inherit.aes = F ) +
    
    
   #geom_segment( data = Coactivation_ParticipantMeans__ATx_2.3Hz, aes( y = Mean_Joint_Absorption_MEE, yend = Mean_Joint_Absorption_MEE, x = c( rep(0.8, 9), rep( 1.8, 9) ), xend = c( rep(1.2, 9), rep( 2.2, 9) ), group = interaction( Joint_ID, Limb_ID ) , color = Joint_ID), size = 1.5, inherit.aes = F ) +
    
    

    
      stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( Group_ID, factor( HoppingRate_ID ) ), color = Group_ID ), linewidth = 1, show.legend = F  )+ 
    
   
    geom_dotplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( y = Mean_TotalTSActivation_PropulsionPhase, x = factor( HoppingRate_ID ), fill = Participant_ID, group = interaction( Participant_ID, HoppingRate_ID ) ), color = 'white', stackdir = 'center' , binaxis = 'y', dotsize = 1, inherit.aes = F, stroke = 2 ) +
      

   


   scale_color_manual(values = c( 'ATx' = met.brewer( 'Austria' )[1], 'Control' = met.brewer( 'Austria' )[3] ) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 
                                          'HC01' = met.brewer('Redon')[1], 
                                          'ATx10'=met.brewer('Redon')[2], 
                                          'HC12'=met.brewer('Redon')[2],
                                          'ATx17'=met.brewer('Redon')[3],
                                          'HC06'=met.brewer('Redon')[3],
                                          'ATx18'=met.brewer('Redon')[4],
                                          'ATx19'=met.brewer('Redon')[5],
                                          'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],
                                          'HC05'=met.brewer('Redon')[7],
                                          'HP02'=met.brewer('Redon')[8],
                                          'HP08'=met.brewer('Redon')[9],
                                          'HP09'=met.brewer('Redon')[10]),
                               name = '',
                               aesthetics=c('fill'), labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
    
   
      
      
      scale_y_continuous(breaks=seq(0,45,by=5),limits=c(0, 45) )+
    
    
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
   
      labs(title=' Total TS Integrated EMG During Propulsion Phase \n 2.0 vs 2.3 Hz - ATx vs Control',x='Hopping Rate ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
      
      
      guides(color='none',size='none',fill= 'none', alpha = 'none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),legend.key.height=unit(0,'lines'),legend.key.width=unit(0.5,'lines'),legend.box.background=element_rect(color='black',linewidth=1),panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),panel.grid.major.y=element_line(color='darkgrey'),panel.grid.minor.y=element_line(color='darkgrey'),strip.text=element_text(size=22.5)  ) +
   
   
   facet_wrap( vars( Group_ID, Limb_ID ), labeller = labeller( Limb_ID = c( 'Involved' = 'Involved Limb', 'Matched Control' = 'Matched Limb' ) ) )

 
)




```



###### TS Contribution
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( x = factor(HoppingRate_ID) , y = Mean_TSContributiontoPFActivityBrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
     
     
     labs(title='TS Contribution to PF Activation - Braking Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC11','HC12' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars( Group_ID, Limb_ID ), labeller = labeller( Limb_ID = c( 'Involved' = 'Involved Limb', 'Matched Control' = 'Matched Limb' ) ) )
     
     
     )

```


```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( x =  factor(HoppingRate_ID), y = Mean_TSContributiontoPFActivity_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='TS Contribution to PF Activation - Propulsion Phase',x='Group ID', y = ' Contribution (max = 1) ' ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars( Group_ID, Limb_ID ), labeller = labeller( Limb_ID = c( 'Involved' = 'Involved Limb', 'Matched Control' = 'Matched Limb' ) ) )
     
     
     )

```



###### MedGas Contribution
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( x = factor(HoppingRate_ID) , y = Mean_MedGasContributiontoAllTS_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
     
     
     labs(title='MedGas Contribution to TS Activation - Braking Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```

```{r Propulsion Phase}

( PropulsionTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( x = factor(HoppingRate_ID) , y = Mean_MedGasContributiontoAllTS_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
     
     
     labs(title='MedGas Contribution to TS Activation - Propulsion Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```



###### LatGas Contribution
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( x = factor(HoppingRate_ID) , y = Mean_LatGasContributiontoAllTS_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
     
     
     labs(title='LatGas Contribution to TS Activation - Braking Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
   guides(fill='none',size='none',shape='none',color='none' )+
   
   
      # guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
      #                              'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
      #                              'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
      #      'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
      #      'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
      #      'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
      #      'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```

```{r Propulsion Phase}

( PropulsionTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( x = factor(HoppingRate_ID) , y = Mean_LatGasContributiontoAllTS_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
     
     
     labs(title='LatGas Contribution to TS Activation - Propulsion Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```



###### Sol Contribution
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( x = factor(HoppingRate_ID) , y = Mean_SolContributiontoAllTS_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
     
     
     labs(title='Sol Contribution to TS Activation - Braking Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```


```{r Propulsion Phase}

( PropulsionTAiEMG_2Hz <- ggplot( data = Coactivation_ParticipantMeans_InvolvedvsControl_2.0and2.3Hz, aes( x = factor(HoppingRate_ID) , y = Mean_SolContributiontoAllTS_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
     
     
     labs(title='Sol Contribution to TS Activation - Propulsion Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```


### Before Regression

#### vs Morphology
```{r MedGas iEMG  }





#Use ggplot to create the figure. X-axis = segment ID, y = average energy
(Power1 <- ggplot(data = Coactivation_ParticipantMeans_Involved_2.3Hz, aes(y = Mean_MedGas_iEMG_BrakingPhase, x = Mean_BetweenLimbTendonThickness_mm ) ) +
    
      facet_wrap( vars( Group_ID ), scales = 'free_x' ) +
    

 
   
    
   # #Regression line for Control Group, CONTRALATERAL Limb
   #    geom_smooth( data = oactivation_ParticipantMeans_Involved_2.3Hz, aes( y = Mean_MedGas_iEMG_BrakingPhase, x = Mean_BetweenLimbTendonThickness_mm, fill = Limb_ID, group = Limb_ID ), color = 'black' ) +
      

    
      
      

    
#Add data points for participant means, based on RMME
         geom_point( aes( fill = Participant_ID, alpha = Participant_ID ), size = 20, stroke = 3, colour = 'white', shape = 23 ) +

      
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits =  c( 0, 4 ) )+
   
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 16, by = 2 ), limits =  c( 0, 16 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Involved Limb Medial Gastroc Integrated EMG vs \n InterLimb Difference in Tendon Thickness  \n 2.33 Hz Hopping Braking Phase ', x='InterLimb Difference in Tendon Thickness (mm)', y = expression( ' Integrated EMG (% Reference Contraction ' %*% ' sec )' ), parse = T ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison', filename = 'Dissertation_InvolvedLimbMedGasiEMGvsInterlimbDifferenceinTendonThickness_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```

#### Group Comparison

##### Joint %MEE
```{r Braking Phase}

( BrakingMedGasiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_EugeneContributionIndx  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 7, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE - Braking Phase',x='Group ID', y = ' MEE Contribution (%) ' ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=17,fill=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```




```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Group_ID, y = Mean_Joint_Percent_MEE_Generation  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 7, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(labels=c('Tendinosis','Control') )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE - Propulsion Phase',x='Group ID', y = ' MEE Contribution (%) ' ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=17
                                                            ,fill=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```


##### Raw Joint MEE

###### 2.33 Hz
```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Group_ID, y = Mean_Joint_Generation_MEE  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3.3, stackgroups = T, binpositions = 'all', stackdir = 'center' ) +
   
   geom_text( label = expression( paste( mu ) ), size = 13, aes( x = 0.725, y = 0.634 ) )+
   
   
   geom_segment( aes( x = 1.27, xend = 1.27, y = 0.634, yend = 0.60 ), linewidth = 2.5, arrow=arrow(length=unit(3,'mm'), ends = 'both', type = 'open', angle = 20 )  ) +
   
   geom_text( label = 'SE', size = 10, aes( x = 1.32, y = 0.615 ) )+
     
   
   
   
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_discrete(labels=c('Tendinosis \n (Involved Limb)','Control \n (Matched Limb)') )+
     
     
     
     labs(title='Between-Group Comparison of Ankle Mechanical Energy Expenditure \n Propulsion Phase',x='Group ID', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
   
   
                scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
     
   
             scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 34,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```

##### MedGas
```{r Contact Phase}

( ContactMedGasiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_MedGas_iEMG_ContactPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Medial Gastroc Integrated EMG During Contact Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
   
   
          scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
     
   
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,fill=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
   
   
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```


```{r Braking Phase}

( BrakingMedGasiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_MedGas_iEMG_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Medial Gastroc Integrated EMG During Braking Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```




```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Group_ID, y = Mean_MedGas_iEMG_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(labels=c('Tendinosis','Control') )+
     
     
     
     labs(title='Medial Gastroc Integrated EMG During Propulsion Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```

###### 2.33 Hz
```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Group_ID, y = Mean_MedGas_iEMG_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 0.6, stackgroups = T, binpositions = 'all', binwidth = 1, stackdir = 'center' ) +
   
   geom_text( label = expression( paste( mu ) ), size = 15, aes( x = 0.725, y = 6.96 ) )+
   
   #geom_segment( aes( x = 1.26, xend = 1.295, y = 6.96, yend = 6.96 ), linewidth = 1.5  ) +
   
   geom_segment( aes( x = 1.27, xend = 1.27, y = 6.97, yend = 6.2 ), linewidth = 2.5, arrow=arrow(length=unit(3,'mm'), ends = 'both', type = 'open', angle = 20 )  ) +
   
   geom_text( label = 'SE (of mean)', size = 10, aes( x = 1.45, y = 6.58 ) )+
     
     scale_y_continuous(breaks=seq(0,16,by=2),limits=c(0,16) )+
    
     
      scale_x_discrete(labels=c('Tendinosis \n (Involved Limb)','Control \n (Matched Limb)') )+
     
     
     
     labs(title='Between-Group Comparison of Medial Gastroc Integrated EMG \n Propulsion Phase of Unipedal Hopping',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 34,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```



##### GasLat
```{r Contact Phase}

( ContactGasLatiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_GasLat_iEMG_ContactPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Lateral Gastroc Integrated EMG During Contact Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
   
   
          scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
     
   
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,fill=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
   
   
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```


```{r Braking Phase}

( BrakingGasLatiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_GasLat_iEMG_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Lateral Gastroc Integrated EMG During Braking Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```




```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Group_ID, y = Mean_GasLat_iEMG_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(labels=c('Tendinosis','Control') )+
     
     
     
     labs(title='Lateral Gastroc Integrated EMG During Propulsion Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```


###### 2.33 Hz
```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Group_ID, y = Mean_GasLat_iEMG_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 0.6, stackgroups = T, binpositions = 'all', binwidth = 1, stackdir = 'center' ) +
   
   geom_text( label = expression( paste( mu ) ), size = 15, aes( x = 1.725, y = 5.51 ) )+
   
   #geom_segment( aes( x = 1.26, xend = 1.295, y = 6.96, yend = 6.96 ), linewidth = 1.5  ) +
   
   geom_segment( aes( x = 2.27, xend = 2.27, y = 5.51, yend = 4.5 ), linewidth = 2.5, arrow=arrow(length=unit(4,'mm'), ends = 'both', type = 'open', angle = 25 )  ) +
   
   geom_text( label = 'SE (of mean)', size = 9.75, aes( x = 2.44, y = 5.13 ) )+
     
     scale_y_continuous(breaks=seq(0,16,by=2),limits=c(0,16) )+
    
     
      scale_x_discrete(labels=c('Tendinosis \n (Involved Limb)','Control \n (Matched Limb)') )+
     
     
     
     labs(title='Between-Group Comparison of Lateral Gastroc Integrated EMG \n Propulsion Phase of Unipedal Hopping',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec) ' ) ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 34,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```

##### Sol
```{r Contact Phase}

( ContactSoliEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_Sol_iEMG_ContactPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Soleus Integrated EMG During Contact Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
   
   
          scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
     
   
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,fill=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
   
   
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```


```{r Braking Phase}

( BrakingSoliEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_Sol_iEMG_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Soleus Integrated EMG During Braking Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```




```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Group_ID, y = Mean_Sol_iEMG_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(labels=c('Tendinosis','Control') )+
     
     
     
     labs(title='Soleus Integrated EMG During Propulsion Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```


###### 2.33 Hz
```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Group_ID, y = Mean_Sol_iEMG_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 0.6, stackgroups = T, binpositions = 'all', binwidth = 1, stackdir = 'center' ) +
   
   geom_text( label = expression( paste( mu ) ), size = 15, aes( x = 0.725, y = 6.96 ) )+
   
   #geom_segment( aes( x = 1.26, xend = 1.295, y = 6.96, yend = 6.96 ), linewidth = 1.5  ) +
   
   geom_segment( aes( x = 1.27, xend = 1.27, y = 7.12, yend = 6.1 ), linewidth = 2.5, arrow=arrow(length=unit(3,'mm'), ends = 'both', type = 'open', angle = 20 )  ) +
   
   geom_text( label = 'SE (of mean)', size = 10, aes( x = 1.45, y = 6.58 ) )+
     
     scale_y_continuous(breaks=seq(0,16,by=2),limits=c(0,16) )+
    
     
      scale_x_discrete(labels=c('Tendinosis \n (Involved Limb)','Control \n (Matched Limb)') )+
     
     
     
     labs(title='Between-Group Comparison of Soleus Integrated EMG \n Propulsion Phase of Unipedal Hopping',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec) ' ) ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 34,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )

```


##### PL
```{r Contact Phase}

( ContactPLiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_PL_iEMG_ContactPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Peroneus Longus Integrated EMG During Contact Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
   
   
          scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
     
   
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,fill=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
   
   
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```


```{r Braking Phase}

( BrakingPLiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_PL_iEMG_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Peroneus Longus Integrated EMG During Braking Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```




```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Group_ID, y = Mean_PL_iEMG_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(labels=c('Tendinosis','Control') )+
     
     
     
     labs(title='Peroneus Longus Integrated EMG During Propulsion Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```




##### TA
```{r Contact Phase}

( ContactTAiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_TA_iEMG_ContactPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Tibialis Anterior Integrated EMG During Contact Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
   
   
          scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
     
   
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,fill=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
   
   
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```


```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Group_ID , y = Mean_TA_iEMG_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = Participant_ID), color = 'white', binaxis = 'y', dotsize = 3, stackgroups = T, binpositions = 'all', binwidth = 1 ) +
     
     
     scale_y_continuous(breaks=seq(0,30,by=5),limits=c(0,30) )+
    
     
      scale_x_discrete(breaks=c('Tendinosis','Control') )+
     
     
     
     labs(title='Tibialis Anterior Integrated EMG During Braking Phase',x='Group ID', y = expression( ' iEMG (%Single Leg Vertical Jump' %*% 'sec)' ) ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```




##### TS Contribution
```{r Contact Phase}

( ContactTAiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2and2.3Hz_InvolvedvsControlAnkle, aes( x = factor( HoppingRate_ID ) , y = Mean_TSContributiontoPFActivity_ContactPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(HoppingRate_ID, Participant_ID) ), color = 'white', binaxis = 'y', dotsize = 2, stroke =3, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
      
     
     scale_y_continuous(breaks=seq(0,1.1,by=0.1),limits=c(0,1.1) )+
    
     
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='TS Contribution to PF Activation \n During Contact Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
   
          scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
     
   
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,fill=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
   
   
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```


```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2and2.3Hz_InvolvedvsControlAnkle, aes( x = factor(HoppingRate_ID) , y = Mean_TSContributiontoPFActivity_BrakingPhase/100  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
      
     
     
     labs(title='TS Contribution to PF Activation - Braking Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```


```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2and2.3Hz_InvolvedvsControlAnkle, aes( x =  factor(HoppingRate_ID), y = Mean_TSContributiontoPFActivity_PropulsionPhase/100  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='TS Contribution to PF Activation During Propulsion Phase',x='Group ID', y = ' Contribution (max = 1) ' ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```


###### ATx Only
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2and2.3Hz_InvolvedAnkle, aes( x = factor(HoppingRate_ID) , y = TSContributiontoPFActivity_BrakingPhase/100  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Participant_ID) , color = Participant_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Triceps Surae Contribution to PF Activation - Braking Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill','color'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Participant_ID), nrow = 2 )
     
     
     )

```



```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2and2.3Hz_InvolvedAnkle, aes( x =  factor(HoppingRate_ID), y = TSContributiontoPFActivity_PropulsionPhase/100  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Participant_ID) , color = Participant_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Triceps Surae Contribution to PF Activation - Propulsion Phase',x='Group ID', y = ' Contribution (max = 1) ' ) +
     
     

     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('color','fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Participant_ID), nrow = 2 )
     
     
     )

```





###### Control Only
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2and2.3Hz_ControlAnkle, aes( x = factor(HoppingRate_ID) , y = TSContributiontoPFActivity_BrakingPhase/100  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Participant_ID) , color = Participant_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Triceps Surae Contribution to PF Activation - Braking Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill','color'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Participant_ID), nrow = 2 )
     
     
     )

```


```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2and2.3Hz_ControlAnkle, aes( x =  factor(HoppingRate_ID), y = TSContributiontoPFActivity_PropulsionPhase/100  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Participant_ID) , color = Participant_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Triceps Surae Contribution to PF Activation - Propulsion Phase',x='Group ID', y = ' Contribution (max = 1) ' ) +
     
     

     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('color','fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Participant_ID), nrow = 2 )
     
     
     )

```



##### Gastroc Contribution to TS
```{r Contact Phase}

( ContactTAiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2and2.3Hz_InvolvedvsControlAnkle, aes( x = factor( HoppingRate_ID ) , y = Mean_GastrocnemiiContributiontoAllTS_ContactPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(HoppingRate_ID, Participant_ID) ), color = 'white', binaxis = 'y', dotsize = 2, stroke =3, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
      
     
     scale_y_continuous(breaks=seq(0,1.1,by=0.1),limits=c(0,1.1) )+
    
     
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Gastrocnemii Contribution to Triceps Surae Activation -  Contact Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
   
          scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
     
   
     scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = '',aesthetics=c('fill'),labels=c('ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,fill=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
   
   
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```





```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2and2.3Hz_InvolvedvsControlAnkle, aes( x = factor(HoppingRate_ID) , y = Mean_GastrocnemiiContributiontoAllTS_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Gastroc Contribution to Triceps Surae Activation - Braking Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```


```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2and2.3Hz_InvolvedvsControlAnkle, aes( x =  factor(HoppingRate_ID), y = Mean_GastrocnemiiContributiontoAllTS_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Group_ID) , color = Group_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Gastroc Contribution to Triceps Surae Activation - Propulsion Phase',x='Group ID', y = ' Contribution (max = 1) ' ) +
     
     
   
             scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color'),labels=c('ATx','Control' ) ) +
   
   
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill=guide_legend(aes=c('fill'),title='',override.aes=list(size=12,color=c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]) ), nrow = 2 ),size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Group_ID), nrow = 1, labeller=labeller( Group_ID =c( 'ATx' = 'Tendinosis', 'Control' = 'Healthy Control'  ) ) )
     
     
     )

```


###### ATx Only
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2and2.3Hz_InvolvedAnkle, aes( x = factor(HoppingRate_ID) , y = GastrocnemiiContributiontoAllTS_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Participant_ID) , color = Participant_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Gastroc Contribution to Triceps Surae Activation - Braking Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill','color'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Participant_ID), nrow = 2 )
     
     
     )

```



```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2and2.3Hz_InvolvedAnkle, aes( x =  factor(HoppingRate_ID), y = GastrocnemiiContributiontoAllTS_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Participant_ID) , color = Participant_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Gastroc Contribution to Triceps Surae Activation - Propulsion Phase',x='Group ID', y = ' Contribution (max = 1) ' ) +
     
     

     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('color','fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Participant_ID), nrow = 2 )
     
     
     )

```





###### Control Only
```{r Braking Phase}

( BrakingTAiEMG_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2and2.3Hz_ControlAnkle, aes( x = factor(HoppingRate_ID) , y = GastrocnemiiContributiontoAllTS_BrakingPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Participant_ID) , color = Participant_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
     scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Gastroc Contribution to Triceps Surae Activation - Braking Phase',x='Hopping Rate ID', y = ' Contribution (max = 1) ' ) +
     
     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill','color'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Participant_ID), nrow = 2 )
     
     
     )

```


```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2and2.3Hz_ControlAnkle, aes( x =  factor(HoppingRate_ID), y = GastrocnemiiContributiontoAllTS_PropulsionPhase  ) ) +
     
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = interaction( factor(HoppingRate_ID), Participant_ID) , color = Participant_ID ), size = 1, show.legend = F  )+ 
   
     
     geom_dotplot( aes( fill = Participant_ID, group = interaction(Participant_ID, HoppingRate_ID) ), color = 'white', binaxis = 'y', dotsize = 1, stroke =1, stackgroups = T, binpositions = 'all', position = 'identity', stackdir = 'center', binwidth = 1/40 ) +
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_discrete(labels = c( '2.0 Hz', ' 2.3 Hz ' ) )+
     
     
     
     labs(title='Gastroc Contribution to Triceps Surae Activation - Propulsion Phase',x='Group ID', y = ' Contribution (max = 1) ' ) +
     
     

     
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2], 'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('color','fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21','HC01','HC05','HC06','HC12','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
   
      guides(fill='none',size='none',shape='none',color='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(Participant_ID), nrow = 2 )
     
     
     )

```


#### TS Contribution to PF Activation vs Morphology

```{r Braking Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Coactivation_ParticipantMeans_Involved_2.3Hz, aes( x , y  ) ) +
     
     
#Add data points for participant means, based on RMME
         geom_point( data = Coactivation_ParticipantMeans_Involved_2.3Hz, aes( fill = Participant_ID, alpha = Participant_ID, x = Mean_BetweenLimbTendonThickness_mm, y = Mean_TSContributiontoPFActivityBrakingPhase ), size = 20, stroke = 3, colour = 'white', shape = 23 ) +

   
   geom_abline( slope = coef(LM_TSContributionIndxvsATxMorphology)[2], intercept = coef( LM_TSContributionIndxvsATxMorphology)[1], linewidth = 3 ) +
      
   
   geom_text( label = expression( 'Contribution = 0.70 + 0.02 ' %*% 'Interlimb Difference' ), size = 20, aes( x = 2, y = 0.87 ), parse = T ) +
   
   
   
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits =  c( 0, 4 ) )+
   
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Involved Limb TS Contribution to PF Activation vs \n InterLimb Difference in Tendon Thickness  \n 2.33 Hz Hopping Braking Phase ', x='Interlimb Difference in Tendon Thickness (mm)', y = ' Contribution Index ' ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison', filename = 'Dissertation_InvolvedLimbTSContributiontoPFActivationvsInterlimbDifferenceinTendonThickness_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```


```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx38or49or50, aes( x , y  ) ) +
     
     
#Add data points for participant means, based on RMME
         geom_point( data = Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx38or49or50, aes( fill = Participant_ID, alpha = Participant_ID, x = Mean_BetweenLimbTendonThickness_mm, y = Mean_TSContributiontoPFActivity_PropulsionPhase ), size = 20, stroke = 3, colour = 'white', shape = 23 ) +

   
   geom_abline( slope = 0.0052, intercept = 0.71, linewidth = 3 ) +
      
   
   geom_text( label = expression( 'Spearmans Rho: Contribution = 0.71 + 0.0052 ' %*% 'Interlimb Difference' ), size = 20, aes( x = 2, y = 0.87 ), parse = T ) +
   
   
   
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits =  c( 0, 4 ) )+
   
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Involved Limb TS Contribution to PF Activation vs \n InterLimb Difference in Tendon Thickness  \n 2.33 Hz Hopping Propulsion Phase ', x='Interlimb Difference in Tendon Thickness (mm)', y = ' Contribution Index ' ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison', filename = 'Dissertation_InvolvedLimbTSContributiontoPFActivationvsInterlimbDifferenceinTendonThickness_PropulsionPhase_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```



#### TA Coactivation vs Morphology

```{r Braking Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12, aes( x , y  ) ) +
     
     
#Add data points for participant means, based on RMME
         geom_point( data = Coactivation_ParticipantMeans_ATxInvolvedAnkle_2.3Hz_NoATx50or12, aes( fill = Participant_ID, alpha = Participant_ID, x = Mean_BetweenLimbTendonThickness_mm, y = Mean_TAvsAllPF_CoactivationRatio_BrakingPhase ), size = 20, stroke = 3, colour = 'white', shape = 23 ) +

   
   geom_abline( slope = -0.4, intercept = 0.14, linewidth = 3 ) +
      
   
   geom_text( label = expression( 'Spearman Rho: Coactivation Ratio = 0.14 - 0.4 ' %*% 'Interlimb Difference' ), size = 20, aes( x = 2, y = 0.87 ), parse = T ) +
   
   
   
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits =  c( 0, 4 ) )+
   
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Involved Limb TA Coactivation Ratio with PF Activation vs \n InterLimb Difference in Tendon Thickness  \n 2.33 Hz Hopping Braking Phase ', x='Interlimb Difference in Tendon Thickness (mm)', y = ' Coactivation Ratio ' ) +

      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison', filename = 'Dissertation_InvolvedLimbTACoactivationvsInterlimbDifferenceinTendonThickness_BrakingPhase_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```




```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Coactivation_ParticipantMeans_Involved_2.3Hz, aes( x , y  ) ) +
     
     
#Add data points for participant means, based on RMME
         geom_point( data = Coactivation_ParticipantMeans_Involved_2.3Hz, aes( fill = Participant_ID, alpha = Participant_ID, x = Mean_BetweenLimbTendonThickness_mm, y = Mean_TAvsAllPF_CoactivationRatio_PropulsionPhase ), size = 20, stroke = 3, colour = 'white', shape = 23 ) +

   
   geom_abline( slope = -0.21, intercept = 0.11, linewidth = 3 ) +
      
   
   geom_text( label = expression( 'Spearmans Rho: Contribution = 0.11 - 0.21 ' %*% 'Interlimb Difference' ), size = 20, aes( x = 2, y = 0.87 ), parse = T ) +
   
   
   
      # #Specify the limits and ticks of the y-axis
      # scale_x_discrete( labels = c( 'Involved' = 'Involved Limb', 'Non-Involved' = 'Non-Involved Limb', 'Matched Dominance' = 'Dominance Matched Limb', 'Contralateral' = 'Contralateral Limb' ), limits =  c( 'Involved', 'Non-Involved', 'Matched Dominance', 'Contralateral') )+
      
      
   
      #Specify the limits and ticks of the x-axis
      scale_x_continuous( breaks = seq( 0, 4, by = 0.5 ), limits =  c( 0, 4 ) )+
   
   
      #Specify the limits and ticks of the y-axis
      scale_y_continuous( breaks = seq( 0, 1, by = 0.1 ), limits =  c( 0, 1 ) )+
   

      
      #Specify the labels for the plot in general, followed by the x-axis then the y-axis
      labs(title=' Involved Limb TS Contribution to PF Activation vs \n InterLimb Difference in Tendon Thickness  \n 2.33 Hz Hopping Propulsion Phase ', x='Interlimb Difference in Tendon Thickness (mm)', y = ' Contribution Index ' ) +

   
   
      #Specify the crossbar colors and data point outline colors. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_color_manual(values = c( 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9] ),
                         labels = c( 'LessThan_2mm_Diff' = '< 2 mm ATx Group', 'Minimum_2mm_Diff' = 'Min of 2 mm ATx Group', 'Control' = 'Healthy Control' ),
                         name = 'Group ID',aesthetics=c('color') ) +
      
    
      
      #Specify the fill colors for the data points. Use the categorical variable name to ensure the color is assigned appropriately.
      scale_fill_manual(values = c('Ankle'='#1b9e77','Knee' = '#7570b3','Hip'='#d95f02',
                                 'Involved' = '#c51b7d',
                                 'Non-Involved' = '#7fbc41',
                                 'Matched Dominance' = '#7fbc41',
                                 'Contralateral' = '#4d9221', 'ATx07'=met.brewer('OKeeffe1')[1], 
                                    
                                    'ATx08' = met.brewer('OKeeffe1')[2],
                                    'ATx10'=met.brewer('OKeeffe1')[3], 
                                    'ATx12'=met.brewer('OKeeffe1')[4],
                                    'ATx17'=met.brewer('OKeeffe1')[5],
                                    'ATx18'=met.brewer('OKeeffe1')[6],
                                    'ATx19'=met.brewer('OKeeffe1')[7],
                                    'ATx21'=met.brewer('OKeeffe1')[8],
                                    'ATx24'=met.brewer('OKeeffe1')[9],
                                    'ATx25'=met.brewer('OKeeffe1')[10],
                                    'ATx27'=met.brewer('OKeeffe1')[11],
                                    'ATx34'=met.brewer('OKeeffe1')[ 7],
                                    'ATx38'=met.brewer('OKeeffe1')[1],
                                    'ATx41'=met.brewer('OKeeffe1')[2],
                                    'ATx44'=met.brewer('OKeeffe1')[3],
                                    'ATx50'=met.brewer('OKeeffe1')[4],
                                    'ATx36'=met.brewer('OKeeffe1')[5],
                                    'ATx49'=met.brewer('OKeeffe1')[6],
                                    'HC01'=met.brewer('OKeeffe1')[1], 
                                    'HC19' = met.brewer('OKeeffe1')[2],
                                    'HC12'=met.brewer('OKeeffe1')[1], 
                                    'HC05'=met.brewer('OKeeffe1')[4],
                                    'HC06'=met.brewer('OKeeffe1')[5],
                                    'HC20'=met.brewer('OKeeffe1')[7],
                                    'HC11'=met.brewer('OKeeffe1')[7],
                                    'HC17'=met.brewer('OKeeffe1')[9],
                                    'HC21'=met.brewer('OKeeffe1')[11],
                                    'HC25'=met.brewer('OKeeffe1')[ 7],
                                    'HC18'=met.brewer('OKeeffe1')[8],
                                    'HC45'=met.brewer('OKeeffe1')[6],
                                    'HC42'=met.brewer('OKeeffe1')[10],
                                    'HC48'=met.brewer('OKeeffe1')[3],
                                    'HC44'=met.brewer('OKeeffe1')[6],
                                    'HC65'=met.brewer('OKeeffe1')[9],
                                 'Minimum_2mm_Diff' = '#c51b7d', 
                                 'LessThan_2mm_Diff' = '#7fbc41'  ) , labels=c('Ankle', 'Knee', 'Hip', 'ATx07', 'ATx08', 'ATx10','ATx12', 'ATx17','ATx18','ATx19','ATx21', 'ATx24', 'ATx25', 'ATx27', 'ATx34', 'ATx38', 'ATx41', 'ATx44', 'ATx50', 'HC01', 'HC05', 'HC06','HC08', 'HC11','HC12','HC17','HC18','HC19', 'HC20', 'HC21', 'HC25', 'Matched Dominance' ),
                         name = 'Participant ID',aesthetics=c('fill') ) +
      
      scale_alpha_manual( values = c( 'ATx07'= 1, 
                                    'ATx08' = 1,
                                    'ATx10'=1, 
                                    'ATx12'=1,
                                    'ATx17'=1,
                                    'ATx18'=1,
                                    'ATx19'=1,
                                    'ATx21' = 1,
                                    'ATx24'=1,
                                    'ATx25'=1,
                                    'ATx27'=1,
                                    'ATx34'=0.75,
                                    'ATx38'=0.75,
                                    'ATx41'=0.75,
                                    'ATx44'=0.75,
                                    'ATx50'=0.75,
                                    'ATx49' = 0.75,
                                    'ATx36' = 0.75,
                                    'HC01'= 1, 
                                    'HC19' = 1,
                                    'HC05'= 1,
                                    'HC06'= 1,
                                    'HC45' = 1,
                                    'HC20'= 1,
                                    'HC18' = 1,
                                    'HC17' = 1,
                                    'HC11'= 1,
                                    'HC42' = 1,
                                    'HC21'= 1,
                                    'HC11' = 0.75,
                                    'HC12' = 0.75,
                                    'HC48' = 0.75,
                                    'HC25'= 0.75,
                                    'HC18'=0.75,
                                    'HC44' = 0.75,
                                    'HC65' = 0.75) ) +
      
      
      
      
      #Specify shapes
      scale_shape_manual( values = c( 'Involved' = 21,
                                 'Non-Involved' = 23,
                                 'Matched Dominance' = 21,
                                 'Contralateral' = 23 ) ) +
      
    
      #Remove all legends
      guides( color='none', size='none', fill = 'none', alpha = 'none', shape = 'none', stroke = 'none' )+ 
      
      #Adjust the plot theme
      theme(plot.title = element_text(size = 65,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 60,face = 'bold.italic'),
            axis.title.y.right = element_text(size = 60,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 45,face = 'bold.italic'),
            axis.text.y.right=element_text(size=45,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 50,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),
            #Adjust the plot margins to allow more space if needed. Order is top, right, bottom, left
            plot.margin = margin(5,3,3,3),
            #Adjust the plot background color - this is the color outside the area where data is plotted
            plot.background=element_rect(color=rgb(245,245,220,maxColorValue = 255),fill=rgb(245,245,220,maxColorValue = 255)),
            # #Adjust the color of the boxes around each symbol in the legend
            #legend.key  =  element_rect( fill = 'white', color = 'white' ),
            #Adjust the height and width of the legend key symbol boxes
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            #Adjust the box around the entire legend
            legend.box.background = element_rect( color='black', linewidth=1 ),
            #Adjust the outline and fill colors of the entire plot background
            panel.background = element_rect( color = 'black', fill = rgb( 245, 245, 220, maxColorValue = 255) ),
            #Adjust the major grid lines for the entire plot
            panel.grid.major.y = element_line( color = 'darkgrey' ),
            #Adjust the minor grid lines for the entire plot
            panel.grid.minor.y = element_line( color = 'darkgrey' ),
            #Strip text affects the subplot labels when using facet_wrap
            strip.text=element_text( size = 50, face = 'bold' )  )
 
)




ggsave(  path = '/Users/dortiz23/Documents/R Scripts/Dissertation/Post-Quals/Figures/Hopping/EMG/2.3 Hz/Group Comparison', filename = 'Dissertation_InvolvedLimbTACoActivationvsInterlimbDifferenceinTendonThickness_PropulsionPhase_ParticipantMeans.png', width = 9000, height = 9000, units = 'px', limitsize = F )


```







#### Raw Ankle MEE vs TS Contribution to PF Activation

##### All Hz
```{r Braking Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Mean_TSContributiontoPFActivity_BrakingPhase, y = Mean_Joint_Absorption_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
     
     
     
     labs(title='Normalized Ankle MEE During Braking Phase vs \n TS Contribution to PF Activation \n ',x='TS Contribution to PF Activation (max = 1)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```



```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Mean_TSContributiontoPFActivity_PropulsionPhase, y = Mean_Joint_Generation_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
     
     
     
     labs(title='Normalized Ankle MEE During Propulsion Phase vs \n TS Contribution to PF Activation \n ',x='TS Contribution to PF Activation (max = 1)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```



##### 2.3 Hz

###### Split Contact Phase
```{r Braking Phase}


( AnkleMEEvsTSContribution_Braking_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19, aes( x = Mean_TSContributiontoPFActivity_BrakingPhase, y = Mean_Joint_Absorption_MEE  ) ) +
   
     geom_smooth( method = 'lm', aes( group = Group_ID, color = Group_ID ), se = F, linewidth = 4)+

     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     geom_text( label = 'Tendinosis', color = met.brewer('Austria')[1], size =10, x = 75, y = 0.82 ) +
     
     geom_text( label = 'Control', color = met.brewer('Austria')[3], size = 10, x = 75, y = 0.78 ) +
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.10),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(40,100,by=10),limits=c(40,100) )+
     
     
     
     labs(title='Normalized Ankle MEE During Braking Phase vs \n TS Contribution to PF Activation',x='TS Contribution to PF Activation (%)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',size='none',shape='none', fill='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=28)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '2.3' = '2.3 Hz Hopping (140 bpm)'  ) ) )
     
     
     )

```



```{r Propulsion Phase}

( AnkleMEEvsTSContribution_Propulsion_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Mean_TSContributiontoPFActivity_PropulsionPhase, y = Mean_Joint_Generation_MEE  ) ) +
   
     geom_smooth( method = 'lm', aes( group = Group_ID, color = Group_ID ), se = F, linewidth = 4)+
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
      geom_text( label = 'Tendinosis', color = met.brewer('Austria')[1], size = 10, x = 80, y = 0.82 ) +
     
     geom_text( label = 'Control', color = met.brewer('Austria')[3], size = 10, x = 80, y = 0.78 ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.10),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(40,100,by=10),limits=c(40,100) )+
     
     
     
     labs(title='Normalized Ankle MEE During Propulsion Phase vs \n Triceps Surae Contribution to PF Activation',x='TS Contribution to PF Activation (%)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',size='none',shape='none',fill='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=28)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '2.3' = '2.3 Hz Hopping (140 bpm)'  ) ) )
     
     
     )

```

###### GG Arrange
```{r}

ggarrange(AnkleMEEvsTSContribution_Braking_2.3Hz,AnkleMEEvsTSContribution_Propulsion_2.3Hz,nrow=1)

```




###### Contact Phase
```{r Contact Phase}

( AnkleMEEvsTSContribution_Contact_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_ContactPhase, aes( x = Mean_A, y = Mean_Joint_Absorption_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     geom_text( label = 'Tendinosis', color = met.brewer('Austria')[1], size =10, x = 75, y = 0.82 ) +
     
     geom_text( label = 'Control', color = met.brewer('Austria')[3], size = 10, x = 75, y = 0.78 ) +
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.10),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(40,100,by=10),limits=c(40,100) )+
     
     
     
     labs(title='Normalized Ankle MEE During Braking Phase vs \n TS Contribution to PF Activation',x='TS Contribution to PF Activation (%)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',size='none',shape='none', fill='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=28)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '2.3' = '2.3 Hz Hopping (140 bpm)'  ) ) )
     
     
     )

```




#### Raw Ankle MEE vs iEMG

```{r MedGas Braking Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Mean_MedGas_iEMG_BrakingPhase, y = Mean_Joint_Absorption_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Braking Phase vs \n MedGas iEMG ',x='MedGas iEMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz (120 bpm)', '2.3' = '2.3 Hz (140 bpm)'  ) ) )
     
     
     )   

```



```{r MedGas Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Mean_MedGas_iEMG_PropulsionPhase, y = Mean_Joint_Generation_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Propulsion Phase vs \n MedGas iEMG ',x='Integrated EMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```




```{r LatGas Braking Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Mean_GasLat_iEMG_BrakingPhase, y = Mean_Joint_Absorption_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Braking Phase vs \n LatGas iEMG ',x='LatGas iEMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz (120 bpm)', '2.3' = '2.3 Hz (140 bpm)'  ) ) )
     
     
     )   

```



```{r LatGas Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Mean_GasLat_iEMG_PropulsionPhase, y = Mean_Joint_Generation_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Propulsion Phase vs \n LatGas iEMG ',x='Integrated EMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```





```{r Sol Braking Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Mean_Sol_iEMG_BrakingPhase, y = Mean_Joint_Absorption_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Braking Phase vs \n Sol iEMG ',x='Sol iEMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz (120 bpm)', '2.3' = '2.3 Hz (140 bpm)'  ) ) )
     
     
     )   

```



```{r Sol Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Mean_Sol_iEMG_PropulsionPhase, y = Mean_Joint_Generation_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Propulsion Phase vs \n Sol iEMG ',x='Integrated EMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```




```{r PL Braking Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Mean_PL_iEMG_BrakingPhase, y = Mean_Joint_Absorption_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Braking Phase vs \n PL iEMG ',x='PL iEMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz (120 bpm)', '2.3' = '2.3 Hz (140 bpm)'  ) ) )
     
     
     )   

```



```{r PL Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Mean_PL_iEMG_PropulsionPhase, y = Mean_Joint_Generation_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Propulsion Phase vs \n PL iEMG ',x='Integrated EMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```


##### 2.3 Hz

```{r PL Contact Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Mean_PL_iEMG_BrakingPhase, y = Mean_Joint_Absorption_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Braking Phase vs \n PL iEMG ',x='PL iEMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )   

```



```{r PL Braking Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Mean_PL_iEMG_BrakingPhase, y = Mean_Joint_Absorption_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Braking Phase vs \n PL iEMG ',x='PL iEMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )   

```



```{r PL Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Mean_PL_iEMG_PropulsionPhase, y = Mean_Joint_Generation_MEE  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,14,by=2),limits=c(0,14) )+
     
     
     
     labs(title='Normalized Ankle MEE During Propulsion Phase vs \n PL iEMG ',x='Integrated EMG (%Single Leg Vertical Jump)', y = ' Ankle MEE ( J/kg ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     )

```


#### Ankle MEE Contribution

##### vs TS Contribution to PF Activation
```{r Braking Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Mean_TSContributiontoPFActivity_BrakingPhase, y = Mean_EugeneContributionIndx  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 3, se = FALSE  ) +
     
     #r values for ATx group
     geom_text( label = 'ATx Group: r (95% CI) = -0.93 (-1, 0.28)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 95 ) +
     
   #r values for Control group
   geom_text( label = 'Control Group: r (95% CI) = -0.69 (-0.95, 0.13)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 85 ) +
     
     
     scale_y_continuous(breaks=seq(30,100,by=10),limits=c(30,100) )+
    
     
      scale_x_continuous(breaks=seq(30,100,by=10),limits=c(30,100) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Triceps Surae Contribution to PF Activation \n Braking Phase',x='Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Mean_TSContributiontoPFActivity_PropulsionPhase, y = Mean_Joint_Percent_MEE_Generation  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 3, se = FALSE  ) +
     
     
          #r values for ATx group
     geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 95 ) +
     
   #r values for Control group
   geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 85 ) +
     
     
     scale_y_continuous(breaks=seq(30,100,by=10),limits=c(30,100) )+
    
     
      scale_x_continuous(breaks=seq(30,100,by=10),limits=c(30,100) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



##### vs PL Contribution to PF Activation
```{r Braking Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x = Mean_PLContributiontoPFActivity_BrakingPhase, y = Mean_EugeneContributionIndx  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(0,50,by=5),limits=c(0,50) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE Absorption vs \n TS Contribution to PF Activation \n ',x='PL Contribution to PF Activation (max = 1)', y = ' Ankle Contribution to Whole-Limb MEE Absorption ( max = 1 ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```



```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_InvolvedvsControlAnkle, aes( x =  Mean_PLContributiontoPFActivity_PropulsionPhase, y = Mean_Joint_Percent_MEE_Generation  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 5 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 2, se = FALSE  ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
    
     
      scale_x_continuous(breaks=seq(0,0.5,by=0.1),limits=c(0,0.5) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE Generation vs \n TS Contribution to PF Activation \n ',x='PL Contribution to PF Activation (max = 1)', y = ' Ankle Contribution to Whole-Limb MEE Generation ( max = 1 ) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) + 
     
     
      facet_wrap( vars(HoppingRate_ID), nrow = 3, labeller=labeller( HoppingRate_ID =c( '0' = 'Self-Selected Hz', '2' = '2 Hz', '2.3' = '2.3 Hz'  ) ) )
     
     
     )

```



#### Ankle:Knee MEE Ratio

##### vs TS Contribution to PF Activation

```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Mean_TSContributiontoPFActivity_PropulsionPhase/100, y = Mean_KneetoAnkleMEERatio_Propulsion  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 3, se = FALSE  ) +
     
     
   #        #r values for ATx group
   #   geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 95 ) +
   #   
   # #r values for Control group
   # geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 85 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.10),limits=c(0,1) )+
    
     
      scale_x_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
     
     
     
     labs(title='Knee:Ankle MEE Ratio vs \n Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Contribution to PF Activation', y = ' Knee:Ankle MEE Ratio (1 = Equal MEE)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```


##### vs Gastrocemii Contribution to PF Activation

###### Individual Hos
```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  TwoJointTS_Contribution2AllPF_PropulsionPhase/100, y = KneetoAnkleMEERatio_Propulsion  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 3, se = FALSE  ) +
     
     
   #        #r values for ATx group
   #   geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 95 ) +
   #   
   # #r values for Control group
   # geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 85 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.10),limits=c(0,1) )+
    
     
      scale_x_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
     
     
     
     labs(title='Knee:Ankle MEE Ratio vs \n Gastrocnemii Contribution to PF Activation \n Propulsion Phase',x='Contribution to PF Activation', y = ' Knee:Ankle MEE Ratio (1 = Equal MEE)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



###### Participant Means
```{r Propulsion Phase}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase/100, y = Mean_KneetoAnkleMEERatio_Propulsion  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 3, se = FALSE  ) +
     
     
   #        #r values for ATx group
   #   geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 95 ) +
   #   
   # #r values for Control group
   # geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 85 ) +
     
     
     scale_y_continuous(breaks=seq(0,1,by=0.10),limits=c(0,1) )+
    
     
      scale_x_continuous(breaks=seq(0,1,by=0.1),limits=c(0,1) )+
     
     
     
     labs(title='Knee:Ankle MEE Ratio vs \n Gastrocnemii Contribution to PF Activation \n Propulsion Phase',x='Contribution to PF Activation', y = ' Knee:Ankle MEE Ratio (1 = Equal MEE)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```




### FOR ABSTRACT SUBMISSION
#### Ankle MEE Contribution

##### vs TS Contribution to PF Activation
```{r Braking Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx10or19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID != 'ATx10' & Participant_ID != 'ATx19' )


Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_OnlyATx10and19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID == 'ATx10' | Participant_ID == 'ATx19' )


( AnklePercentMEEvsTSContribution_Braking <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx10or19, aes( x = Mean_TSContributiontoPFActivity_BrakingPhase, y = Mean_EugeneContributionIndx  ) ) +
     
     

      


            geom_smooth( method = 'lm', aes( group = Group_ID ), color = 'white', linewidth = 4, se = FALSE  ) +
      
           geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 3, se = FALSE  ) +
      
      
                  geom_segment( x = 70.5, xend = 80, y = 64, yend = 60.5, color = 'white' , size = 4 )+

      
                  geom_segment( x = 70.5, xend = 80, y = 64, yend = 60.5, color = met.brewer('Austria')[1] , size = 3 )+
      

      
           geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

            geom_point( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_OnlyATx10and19, aes( x = Mean_TSContributiontoPFActivity_BrakingPhase, y = Mean_EugeneContributionIndx, group = Participant_ID, shape = 'Open Circle'  ), inherit.aes = F, size = 6, stroke = 2, fill = met.brewer('Austria')[1], alpha = 0.65 ) +
      
      
     
     #r values for ATx group
     geom_text( label = 'ATx Group: r (95% CI) = -0.93 (-1, 0.28)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 87.5 ) +
     
   #r values for Control group
   geom_text( label = 'Control Group: r (95% CI) = -0.69 (-0.95, 0.13)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 82.5 ) +
     
     
      geom_text( label = '1(a)', size = 10, x = 35, y = 95 )+
      
      
     scale_y_continuous(breaks=seq(35,95,by=10),limits=c(35,95) )+
    
     
      scale_x_continuous(breaks=seq(35,95,by=10),limits=c(35,95) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Triceps Surae Contribution to PF Activation \n Braking Phase',x='Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',size='none',shape='none', fill = 'none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



```{r Propulsion Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07or21 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID != 'ATx07' & Participant_ID != 'ATx21' )


Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_OnlyATx07and21 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID == 'ATx07' | Participant_ID == 'ATx21' )



( AnklePercentMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07or21, aes( x =  Mean_TSContributiontoPFActivity_PropulsionPhase, y = Mean_Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
      
            geom_point( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_OnlyATx07and21, aes( x = Mean_TSContributiontoPFActivity_BrakingPhase, y = Mean_EugeneContributionIndx, group = Participant_ID, shape = 'Open Circle'  ), inherit.aes = F, size = 6, stroke = 2, fill = met.brewer('Austria')[1], alpha = 0.65 ) +
      


      
      geom_smooth( method = 'lm', aes( group = Group_ID ), color = 'white', linewidth = 4, se = FALSE  ) +
      
           geom_smooth( method = 'lm', aes( color = Group_ID, group = Group_ID ), linewidth = 3, se = FALSE  ) +

      #Create a new regression line for the ATx group. The previous one was too short and hard to see. First line of code creates a thicker white line for the outside, second line creates a thinner red line for the insdie
                  geom_segment( x = 68.75, y = 51.75, xend = 75, yend = 59.5, color = 'white', size = 4 ) +

                        geom_segment( x = 68.75, y = 51.75, xend = 75, yend = 59.5, color = met.brewer('Austria')[1], size = 3 ) +
     
      
     #r values for ATx group
     geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 87.5 ) +
     
   #r values for Control group
   geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 82.5 ) +
     
     

     geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(35,95,by=10),limits=c(35,95) )+
    
     
      scale_x_continuous(breaks=seq(35,95,by=10),limits=c(35,95) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```


```{r}

ggarrange( AnklePercentMEEvsTSContribution_Braking, AnklePercentMEEvsTSContribution_Propulsion, nrow = 1 )

```



## T-test

### 2.3 Hz

#### Raw Joint MEE
```{r Braking Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Absorption_MEE %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_Joint_Absorption_MEE)


t.test(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Absorption_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Absorption_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )

```


```{r Propulsion Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_Joint_Generation_MEE)


t.test(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )

```



#### Ankle MEE Contribution
```{r Braking Phase }


Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_EugeneContributionIndx %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_EugeneContributionIndx)



Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID != 'ATx19' )


Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Mean_EugeneContributionIndx %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19 %>%
   identify_outliers(Mean_EugeneContributionIndx)


t.test(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Mean_EugeneContributionIndx[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Mean_EugeneContributionIndx[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Group_ID == 'Control' ) ] )




```


```{r Propulsion Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Percent_MEE_Generation %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_Joint_Percent_MEE_Generation)


t.test(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Percent_MEE_Generation[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Percent_MEE_Generation[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )

```


##Hedge's G
### 2.3 Hz

#### Limb MEE
```{r Braking Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Limb_Absorption_MEE %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_Limb_Absorption_MEE)


cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Limb_Absorption_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Limb_Absorption_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ], hedges.correction = T )
#No significant difference in limb MEE


mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Limb_Absorption_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Limb_Absorption_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )



```


```{r Propulsion Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx17orHP09 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID != 'ATx17' & Participant_ID != 'HP09' )




Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Limb_Generation_MEE %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx17orHP09 %>%
   identify_outliers(Mean_Limb_Generation_MEE)


cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx17orHP09$Mean_Limb_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx17orHP09$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx17orHP09$Mean_Limb_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx17orHP09$Group_ID == 'Control' ) ], hedges.correction = T )


mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx17orHP09$Mean_Limb_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx17orHP09$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx17orHP09$Mean_Limb_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx17orHP09$Group_ID == 'Control' ) ] )

```



#### Raw Joint MEE
```{r Braking Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Absorption_MEE %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_Joint_Absorption_MEE)


cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Absorption_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Absorption_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ], hedges.correction = T )
#No significant difference in ankle MEE


mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Absorption_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Absorption_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )



```


```{r Propulsion Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_Joint_Generation_MEE)


cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ], hedges.correction = T )


mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )

```


#### Joint %MEE
```{r Braking Phase }

#ATx19 is an outlier. Remove from data set
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19andHP08andHP09 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID != 'ATx19' & Participant_ID != 'ATx10' & Participant_ID != 'HP08' & Participant_ID != 'HP09' )

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19 %>%
   shapiro_test(Mean_EugeneContributionIndx)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19 %>%
   identify_outliers(Mean_EugeneContributionIndx)


cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Mean_EugeneContributionIndx[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Mean_EugeneContributionIndx[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Group_ID == 'Control' ) ], hedges.correction = T )
#No significant difference in ankle MEE


mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Mean_EugeneContributionIndx[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Mean_EugeneContributionIndx[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19$Group_ID == 'Control' ) ] )



```


```{r Propulsion Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   shapiro_test(Mean_Joint_Percent_MEE_Generation)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_Joint_Percent_MEE_Generation)


cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Percent_MEE_Generation[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Percent_MEE_Generation[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ], hedges.correction = T )


mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Percent_MEE_Generation[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Percent_MEE_Generation[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )

```


#### PL iEMG
```{r Braking Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_BrakingPhase %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_PL_iEMG_BrakingPhase)


cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ], hedges.correction = T )
#No significant difference in PL iEMG


mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )

```


```{r Propulsion Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_PropulsionPhase %>%
   shapiro.test()

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_PL_iEMG_PropulsionPhase)


cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ], hedges.correction = T )


mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )



```



#### TS Contribution to Activation (with LatGas)
```{r Braking Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   shapiro_test(Mean_TSContributiontoPFActivity_BrakingPhase)
#Normally distributed!

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_TSContributiontoPFActivity_BrakingPhase)
#No extreme outliers


cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ], hedges.correction = T )
#No significant difference in TS contribution



mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )

```


```{r Propulsion Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   shapiro_test(Mean_TSContributiontoPFActivity_PropulsionPhase)
#Normally distributed

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_TSContributiontoPFActivity_PropulsionPhase)
#No extreme outliers

cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ], hedges.correction = T )
#Effect size not significant

mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )



```



#### TS Contribution to Activation (without LatGas)
```{r Braking Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   shapiro_test(Mean_MedGasandSolContributiontoPFActivity_BrakingPhase)
#Normally distributed!

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_MedGasandSolContributiontoPFActivity_BrakingPhase)
#No extreme outliers


cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_MedGasandSolContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_MedGasandSolContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ], hedges.correction = T )
#No significant difference in TS contribution



mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_MedGasandSolContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_MedGasandSolContributiontoPFActivity_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )

```


```{r Propulsion Phase }

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   shapiro_test(Mean_MedGasandSolContributiontoPFActivity_PropulsionPhase)
#Normally distributed

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   identify_outliers(Mean_MedGasandSolContributiontoPFActivity_PropulsionPhase)
#No extreme outliers

cohen.d(Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_MedGasandSolContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ], Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_MedGasandSolContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ], hedges.correction = T )
#Effect size not significant

mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_MedGasandSolContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'ATx' ) ] ) - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_MedGasandSolContributiontoPFActivity_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )


```


## Correlation

### Ankle MEE vs PL iEMG

#### ATx
```{r Braking Phase}

#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Joint_Absorption_MEE )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_Joint_Absorption_MEE )
#Normally distributed

#Check ATx Involved Limb PL iEMG for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_PL_iEMG_BrakingPhase )
#No extreme outliers

#Check normality of ATx Involved Limb PL iEMG
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_PL_iEMG_BrakingPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs PL iEMG
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_PL_iEMG_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Absorption_MEE, method = 'pearson' )

```


```{r Propulsion Phase}

#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Joint_Generation_MEE )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_Joint_Generation_MEE )
#Normally distributed

#Check ATx Involved Limb PL iEMG for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_PL_iEMG_PropulsionPhase )
#No extreme outliers

#Check normality of ATx Involved Limb PL iEMG
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_PL_iEMG_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs PL iEMG
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_PL_iEMG_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Generation_MEE, method = 'pearson' )

```


#### Control
```{r Braking Phase}

#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_Joint_Absorption_MEE )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_Joint_Absorption_MEE )
#Normally distributed

#Check Control Limb PL iEMG for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_PL_iEMG_BrakingPhase )
#No extreme outliers

#Check normality of Control Limb PL iEMG
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_PL_iEMG_BrakingPhase )
#NOT Normally distributed

#Compute Spearman's p for Ankle MEE vs PL iEMG
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_PL_iEMG_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Absorption_MEE, method = 'spearman' )

```


```{r Propulsion Phase}

#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_Joint_Generation_MEE )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_Joint_Generation_MEE )
#Normally distributed

#Check Control Limb PL iEMG for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_PL_iEMG_PropulsionPhase )
#No extreme outliers

#Check normality of Control Limb PL iEMG
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_PL_iEMG_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs PL iEMG
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_PL_iEMG_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Generation_MEE, method = 'pearson' )

```



### Ankle MEE vs Uncentered TS Contribution

#### ATx
```{r Braking Phase}

#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Joint_Absorption_MEE )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_Joint_Absorption_MEE )
#Normally distributed

#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_TSContributiontoPFActivity_BrakingPhase )
#No extreme outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_TSContributiontoPFActivity_BrakingPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_TSContributiontoPFActivity_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Absorption_MEE, method = 'pearson' )

```


```{r Propulsion Phase}

#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Joint_Generation_MEE )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_Joint_Generation_MEE )
#Normally distributed

#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_TSContributiontoPFActivity_PropulsionPhase )
#No extreme outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_TSContributiontoPFActivity_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Generation_MEE, method = 'pearson' )

```


#### Control
```{r Braking Phase}

#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_Joint_Absorption_MEE )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_Joint_Absorption_MEE )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_TSContributiontoPFActivity_BrakingPhase )
#No extreme outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_TSContributiontoPFActivity_BrakingPhase )
#NOT Normally distributed

#Compute Spearman's p for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_TSContributiontoPFActivity_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Absorption_MEE, method = 'pearson' )

```


```{r Propulsion Phase}

#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_Joint_Generation_MEE )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_Joint_Generation_MEE )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_TSContributiontoPFActivity_PropulsionPhase )
#No extreme outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_TSContributiontoPFActivity_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Generation_MEE, method = 'pearson' )

```

### Ankle %MEE vs Uncentered TS Contribution

#### ATx
```{r Braking Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   filter( Participant_ID != 'ATx19' & Participant_ID != 'ATx10' )
#ATx10 and 19 are outliers


Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_OnlyATx10and19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   filter( Participant_ID == 'ATx10' | Participant_ID == 'ATx19' )
#ATx10 and 19 are outliers



#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   identify_outliers( Mean_EugeneContributionIndx )
#No longer have any outliers


#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   shapiro_test( Mean_EugeneContributionIndx )
#Normally distributed



#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   identify_outliers( Mean_TSContributiontoPFActivity_BrakingPhase )
#No extreme outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   shapiro_test( Mean_TSContributiontoPFActivity_BrakingPhase )
#Normally distributed


#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19$Mean_TSContributiontoPFActivity_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19$Mean_EugeneContributionIndx, method = 'pearson' )

```


```{r Propulsion Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   filter( Participant_ID != 'ATx07' & Participant_ID != 'ATx21' )
#ATx07 and 21 are outliers for TS contribution to PF activation



#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21 %>%
   identify_outliers( Mean_Joint_Percent_MEE_Generation )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21 %>%
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
#Normally distributed

#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21 %>%
   identify_outliers( Mean_TSContributiontoPFActivity_PropulsionPhase )
#No longer have any outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21 %>%
   shapiro_test( Mean_TSContributiontoPFActivity_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21$Mean_TSContributiontoPFActivity_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21$Mean_Joint_Percent_MEE_Generation, method = 'pearson' )

```


#### Control
```{r Braking Phase}

#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_EugeneContributionIndx )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_EugeneContributionIndx )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_TSContributiontoPFActivity_BrakingPhase )
#No extreme outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_TSContributiontoPFActivity_BrakingPhase )
#NOT Normally distributed

#Compute Spearman's p for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_TSContributiontoPFActivity_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_EugeneContributionIndx, method = 'pearson' )

```


```{r Propulsion Phase}

#Check Control Limb Ankle %MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_Joint_Percent_MEE_Generation )
#No extreme outliers

#Check normality of Control Limb Ankle %MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_TSContributiontoPFActivity_PropulsionPhase )
#No extreme outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_TSContributiontoPFActivity_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle %MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Percent_MEE_Generation, method = 'pearson' )

```



### Ankle MEE vs Centered TS Contribution

#### ATx
```{r Braking Phase}

#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx19 %>%
   identify_outliers( Mean_Joint_Absorption_MEE )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx19 %>%
   shapiro_test( Mean_Joint_Absorption_MEE )
#Normally distributed

#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx19 %>%
   identify_outliers( Mean_TSContributiontoPFActivity_BrakingPhase_Centered )
#No extreme outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_TSContributiontoPFActivity_BrakingPhase_Centered )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_TSContributiontoPFActivity_BrakingPhase_Centered, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Absorption_MEE, method = 'pearson' )

```


```{r Propulsion Phase}

#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Joint_Generation_MEE )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_Joint_Generation_MEE )
#Normally distributed

#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_TSContributiontoPFActivity_PropulsionPhase_Centered )
#No extreme outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_TSContributiontoPFActivity_PropulsionPhase_Centered )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase_Centered, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Generation_MEE, method = 'pearson' )

```


#### Control
```{r Braking Phase}

#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_Joint_Absorption_MEE )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_Joint_Absorption_MEE )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_TSContributiontoPFActivity_BrakingPhase_Centered )
#No extreme outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_TSContributiontoPFActivity_BrakingPhase_Centered )
#NOT Normally distributed

#Compute Spearman's p for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_TSContributiontoPFActivity_BrakingPhase_Centered, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Absorption_MEE, method = 'pearson' )

```


```{r Propulsion Phase}

#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_Joint_Generation_MEE )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_Joint_Generation_MEE )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_TSContributiontoPFActivity_PropulsionPhase )
#No extreme outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_TSContributiontoPFActivity_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Generation_MEE, method = 'pearson' )

```



### Ankle %MEE vs iEMG

#### MedGas iEMG


##### ATx
```{r Braking Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   filter( Participant_ID != 'ATx19' & Participant_ID != 'ATx10' )
#ATx10 and 19 are outliers for Ankle % MEE



#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   identify_outliers( Mean_EugeneContributionIndx )
#No longer have any outliers


#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   shapiro_test( Mean_EugeneContributionIndx )
#Normally distributed



#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   identify_outliers( Mean_MedGas_iEMG_BrakingPhase )
#No extreme outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   shapiro_test( Mean_MedGas_iEMG_BrakingPhase )
#Normally distributed


#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19$Mean_MedGas_iEMG_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19$Mean_EugeneContributionIndx, method = 'pearson' )

```


```{r Propulsion Phase}


#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Joint_Percent_MEE_Generation )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
#Normally distributed

#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_MedGas_iEMG_PropulsionPhase )
#No longer have any outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_MedGas_iEMG_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_MedGas_iEMG_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Percent_MEE_Generation, method = 'pearson' )

```


##### Control
```{r Braking Phase}


#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_EugeneContributionIndx )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_EugeneContributionIndx )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_MedGas_iEMG_BrakingPhase )
#No remaining outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_MedGas_iEMG_BrakingPhase )
#NOT Normally distributed

#Compute Spearman's p for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_MedGas_iEMG_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_EugeneContributionIndx, method = 'pearson' )

```


```{r Propulsion Phase}

#Check Control Limb Ankle %MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_Joint_Percent_MEE_Generation )
#No extreme outliers

#Check normality of Control Limb Ankle %MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_MedGas_iEMG_PropulsionPhase )
#No extreme outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_MedGas_iEMG_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle %MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_MedGas_iEMG_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Percent_MEE_Generation, method = 'pearson' )

```


#### GasLat iEMG


##### ATx
```{r Braking Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   filter( Participant_ID != 'ATx19' & Participant_ID != 'ATx10' )
#ATx10 and 19 are outliers for %MEE


#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   identify_outliers( Mean_EugeneContributionIndx )
#No longer have any outliers


#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   shapiro_test( Mean_EugeneContributionIndx )
#Normally distributed



#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   identify_outliers( Mean_GasLat_iEMG_BrakingPhase )
#No extreme outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   shapiro_test( Mean_GasLat_iEMG_BrakingPhase )
#Normally distributed


#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19$Mean_GasLat_iEMG_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19$Mean_EugeneContributionIndx, method = 'pearson' )

```


```{r Propulsion Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   filter( Participant_ID != 'ATx07' & Participant_ID != 'ATx21' )
#ATx10 and 19 are outliers for TS contribution to PF activation



#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Joint_Percent_MEE_Generation )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
#Normally distributed

#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_GasLat_iEMG_PropulsionPhase )
#No longer have any outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_GasLat_iEMG_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_GasLat_iEMG_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Percent_MEE_Generation, method = 'pearson' )

```


##### Control
```{r Braking Phase}


#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_EugeneContributionIndx )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_EugeneContributionIndx )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_GasLat_iEMG_BrakingPhase )
#No remaining outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_GasLat_iEMG_BrakingPhase )
#NOT Normally distributed

#Compute Spearman's p for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_GasLat_iEMG_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_EugeneContributionIndx, method = 'pearson' )

```


```{r Propulsion Phase}

#Check Control Limb Ankle %MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_Joint_Percent_MEE_Generation )
#No extreme outliers

#Check normality of Control Limb Ankle %MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_GasLat_iEMG_PropulsionPhase )
#No extreme outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_GasLat_iEMG_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle %MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_GasLat_iEMG_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Percent_MEE_Generation, method = 'pearson' )

```
#### Sol iEMG


##### ATx
```{r Braking Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   filter( Participant_ID != 'ATx19' & Participant_ID != 'ATx10' )
#ATx10 and 19 are outliers


#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   identify_outliers( Mean_EugeneContributionIndx )
#No longer have any outliers


#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   shapiro_test( Mean_EugeneContributionIndx )
#Normally distributed



#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   identify_outliers( Mean_Sol_iEMG_BrakingPhase )
#No extreme outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   shapiro_test( Mean_Sol_iEMG_BrakingPhase )
#Normally distributed


#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19$Mean_Sol_iEMG_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19$Mean_EugeneContributionIndx, method = 'pearson' )

```


```{r Propulsion Phase}


#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Joint_Percent_MEE_Generation )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
#Normally distributed

#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   identify_outliers( Mean_Sol_iEMG_PropulsionPhase )
#No longer have any outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   shapiro_test( Mean_Sol_iEMG_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Sol_iEMG_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Percent_MEE_Generation, method = 'pearson' )

```


##### Control
```{r Braking Phase}

#HC05 is an outlier for Sol iEMG. After removing, HC01 and HC06 are also outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC01andHC05andHC06 <- Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   filter( Participant_ID != 'HC05' & Participant_ID != 'HC01' & Participant_ID != 'HC06')


#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC01andHC05andHC06 %>%
   identify_outliers( Mean_EugeneContributionIndx )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC01andHC05andHC06 %>%
   shapiro_test( Mean_EugeneContributionIndx )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC01andHC05andHC06 %>%
   identify_outliers( Mean_Sol_iEMG_BrakingPhase )
#No remaining outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC01andHC05andHC06 %>%
   shapiro_test( Mean_Sol_iEMG_BrakingPhase )
#NOT Normally distributed

#Compute Spearman's p for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC01andHC05andHC06$Mean_Sol_iEMG_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC01andHC05andHC06$Mean_EugeneContributionIndx, method = 'spearman')

```


```{r Propulsion Phase}

#HC05 is an outlier for Sol iEMG. After removing, HP08 is also an outlier
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05andHP08 <- Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   filter( Participant_ID != 'HC05' & Participant_ID != 'HP08')


#Check Control Limb Ankle %MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05andHP08 %>%
   identify_outliers( Mean_Joint_Percent_MEE_Generation )
#No extreme outliers

#Check normality of Control Limb Ankle %MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05andHP08 %>%
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05andHP08 %>%
   identify_outliers( Mean_Sol_iEMG_PropulsionPhase )
#No extreme outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05andHP08 %>%
   shapiro_test( Mean_Sol_iEMG_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle %MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05andHP08$Mean_Sol_iEMG_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05andHP08$Mean_Joint_Percent_MEE_Generation, method = 'pearson' )

```




#### PL iEMG


##### ATx
```{r Braking Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   filter( Participant_ID != 'ATx19' & Participant_ID != 'ATx10' )
#ATx10 and 19 are outliers


#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   identify_outliers( Mean_EugeneContributionIndx )
#No longer have any outliers


#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   shapiro_test( Mean_EugeneContributionIndx )
#Normally distributed



#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   identify_outliers( Mean_PL_iEMG_BrakingPhase )
#No extreme outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19 %>%
   shapiro_test( Mean_PL_iEMG_BrakingPhase )
#Normally distributed


#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19$Mean_PL_iEMG_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx10and19$Mean_EugeneContributionIndx, method = 'pearson' )

```


```{r Propulsion Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle %>%
   filter( Participant_ID != 'ATx07' & Participant_ID != 'ATx21' )
#ATx10 and 19 are outliers for TS contribution to PF activation



#Check ATx Involved Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21 %>%
   identify_outliers( Mean_Joint_Percent_MEE_Generation )
#No extreme outliers

#Check normality of ATx Involved Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21 %>%
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
#Normally distributed

#Check ATx Involved Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21 %>%
   identify_outliers( Mean_PL_iEMG_PropulsionPhase )
#No longer have any outliers

#Check normality of ATx Involved Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21 %>%
   shapiro_test( Mean_PL_iEMG_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21$Mean_PL_iEMG_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle_NoATx07and21$Mean_Joint_Percent_MEE_Generation, method = 'pearson' )

```


##### Control
```{r Braking Phase}

#HC05 is an outlier for PL iEMG
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05 <- Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   filter( Participant_ID != 'HC05' )

#Check Control Limb ankle MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05 %>%
   identify_outliers( Mean_EugeneContributionIndx )
#No extreme outliers

#Check normality of Control Limb ankle MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05 %>%
   shapiro_test( Mean_EugeneContributionIndx )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05 %>%
   identify_outliers( Mean_PL_iEMG_BrakingPhase )
#No remaining outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05 %>%
   shapiro_test( Mean_PL_iEMG_BrakingPhase )
#NOT Normally distributed

#Compute Spearman's p for Ankle MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05$Mean_PL_iEMG_BrakingPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle_NoHC05$Mean_EugeneContributionIndx, method = 'pearson' )

```


```{r Propulsion Phase}

#Check Control Limb Ankle %MEE for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_Joint_Percent_MEE_Generation )
#No extreme outliers

#Check normality of Control Limb Ankle %MEE
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_Joint_Percent_MEE_Generation )
#Normally distributed

#Check Control Limb TS Activation Contribution for outliers
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   identify_outliers( Mean_PL_iEMG_PropulsionPhase )
#No extreme outliers

#Check normality of Control Limb TS Activation Contribution
Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle %>%
   shapiro_test( Mean_PL_iEMG_PropulsionPhase )
#Normally distributed

#Compute Pearson's R for Ankle %MEE vs TS Activation Contribution
cor.test( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_PL_iEMG_PropulsionPhase, Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Percent_MEE_Generation, method = 'pearson' )

```





## Original Regressions


### SLR

#### 2.0 Hz

##### MEE vs PL Contribution



###### Both Groups
```{r Braking Phase}

#Need to remove ATx10 for the 2.0 Hz Braking phase regression
Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle_NoATx10 <- Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle %>% filter( Participant_ID != 'ATx10' )


BrakingPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_EugeneContributionIndx ~ Mean_TSContributiontoPFActivity_BrakingPhase )

summary( BrakingPhase_2Hz )

confint( BrakingPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_BrakingPhase_2Hz <- hatvalues( BrakingPhase_2Hz ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_BrakingPhase_2Hz <- mean( Leverage_BrakingPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2Hz > 2*AverageLeverage_BrakingPhase_2Hz )

#Find Cook's Distance for BrakingPhase_2Hz
( CookD_BrakingPhase_2Hz <- cooks.distance( BrakingPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2Hz > 3*mean(CookD_BrakingPhase_2Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2Hz, aes(x=BrakingPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2Hz, type = 'predictor' )


plot( BrakingPhase_2Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle, aes( x = Mean_TSContributiontoPFActivity_BrakingPhase, y = Mean_EugeneContributionIndx  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2Hz$coefficients[2], intercept = BrakingPhase_2Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = 'Not Significant', x = 25, y = 67.5, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE Contribution = ', round(BrakingPhase_2Hz$coefficients[1], digits = 2), ' + ', round(BrakingPhase_2Hz$coefficients[2], digits = 2), '*TS Contribution' ), x = 25, y = 71.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE Absorption vs \n TS Contribution to PF Activation \n ',x='TS Contribution to PF Activation (% PF Activation)', y = ' Ankle Contribution to Whole-Limb MEE Absorption (% Whole-Limb MEE) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```




```{r Propulsion Phase}

#Remove ATx21
Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle_NoATx21 <- Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID != 'ATx21' )

PropulsionPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle_NoATx21,Mean_Joint_Percent_MEE_Generation ~ Mean_PLContributiontoPFActivity_PropulsionPhase )

summary( PropulsionPhase_2Hz )

confint( PropulsionPhase_2Hz )

```



```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_PropulsionPhase_2Hz <- hatvalues( PropulsionPhase_2Hz ) )

#Find average leverage value for PropulsionPhase_2Hz.
( AverageLeverage_PropulsionPhase_2Hz <- mean( Leverage_PropulsionPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2Hz > 2*AverageLeverage_PropulsionPhase_2Hz )


#Find Cook's Distance for PropulsionPhase_2Hz
( CookD_PropulsionPhase_2Hz <- cooks.distance( PropulsionPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2Hz > 3*mean(CookD_PropulsionPhase_2Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2Hz, aes(x=PropulsionPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2Hz, type = 'predictor' )


plot( PropulsionPhase_2Hz )
```



```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle, aes( x = Mean_PLContributiontoPFActivity_PropulsionPhase, y = Mean_EugeneContributionIndx  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2Hz$coefficients[2], intercept = PropulsionPhase_2Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = 'Not Significant', x = 25, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE Contribution = ', round(PropulsionPhase_2Hz$coefficients[1], digits = 2), ' + ', round(PropulsionPhase_2Hz$coefficients[2], digits = 2), '*PL Contribution' ), x = 25, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(0,50,by=5),limits=c(0,50) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE Generation vs \n TS Contribution to PF Activation \n ',x='PL Contribution to PF Activation (% PF Activation)', y = ' Ankle Contribution to Whole-Limb MEE Generation (% Whole-Limb MEE) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


##### Ankle Contribution vs Group
```{r Braking Phase}


BrakingPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_EugeneContributionIndx ~ Group_ID )

summary( BrakingPhase_2Hz )

confint( BrakingPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_BrakingPhase_2Hz <- hatvalues( BrakingPhase_2Hz ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_BrakingPhase_2Hz <- mean( Leverage_BrakingPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2Hz > 2*AverageLeverage_BrakingPhase_2Hz )

#Find Cook's Distance for BrakingPhase_2Hz
( CookD_BrakingPhase_2Hz <- cooks.distance( BrakingPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2Hz, aes(x=BrakingPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2Hz, type = 'predictor' )


plot( BrakingPhase_2Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_EugeneContributionIndx  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2Hz$coefficients[2], intercept = BrakingPhase_2Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE Contribution = ', round(BrakingPhase_2Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Ankle Contribution to \n Whole-Limb MEE During 2.0 Hz Braking Phase',x='Group ID', y = ' Ankle Contribution to Whole-Limb MEE (% Whole-Limb MEE) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}


PropulsionPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_Joint_Percent_MEE_Generation ~ Group_ID )

summary( PropulsionPhase_2Hz )

confint( PropulsionPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_PropulsionPhase_2Hz <- hatvalues( PropulsionPhase_2Hz ) )

#Find average leverage value for PropulsionPhase_2Hz.
( AverageLeverage_PropulsionPhase_2Hz <- mean( Leverage_PropulsionPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2Hz > 2*AverageLeverage_PropulsionPhase_2Hz )

#Find Cook's Distance for PropulsionPhase_2Hz
( CookD_PropulsionPhase_2Hz <- cooks.distance( PropulsionPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2Hz, aes(x=PropulsionPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2Hz, type = 'predictor' )


plot( PropulsionPhase_2Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_Joint_Percent_MEE_Generation  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2Hz$coefficients[2], intercept = PropulsionPhase_2Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE Contribution = ', round(PropulsionPhase_2Hz$coefficients[1], digits = 2), '* + ', round(PropulsionPhase_2Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Ankle Contribution to \n Whole-Limb MEE During 2.0 Hz Propulsion Phase',x='Group ID', y = ' Ankle Contribution to Whole-Limb MEE (% Whole-Limb MEE) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```



##### TS Contribution vs Group
```{r Braking Phase}


BrakingPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_TSContributiontoPFActivity_BrakingPhase ~ Group_ID )

summary( BrakingPhase_2Hz )

confint( BrakingPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_BrakingPhase_2Hz <- hatvalues( BrakingPhase_2Hz ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_BrakingPhase_2Hz <- mean( Leverage_BrakingPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2Hz > 2*AverageLeverage_BrakingPhase_2Hz )

#Find Cook's Distance for BrakingPhase_2Hz
( CookD_BrakingPhase_2Hz <- cooks.distance( BrakingPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2Hz, aes(x=BrakingPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2Hz, type = 'predictor' )


plot( BrakingPhase_2Hz )


```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_TSContributiontoPFActivity_BrakingPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2Hz$coefficients[2], intercept = BrakingPhase_2Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'TS Activation Contribution = ', round(BrakingPhase_2Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2Hz$coefficients[2], digits = 2), '(Group ID)*' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Triceps Surae Contribution to \n Plantar Flexor Activation During 2.0 Hz Braking Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}


PropulsionPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_TSContributiontoPFActivity_PropulsionPhase ~ Group_ID )

summary( PropulsionPhase_2Hz )

confint( PropulsionPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_PropulsionPhase_2Hz <- hatvalues( PropulsionPhase_2Hz ) )

#Find average leverage value for PropulsionPhase_2Hz.
( AverageLeverage_PropulsionPhase_2Hz <- mean( Leverage_PropulsionPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2Hz > 2*AverageLeverage_PropulsionPhase_2Hz )

#Find Cook's Distance for PropulsionPhase_2Hz
( CookD_PropulsionPhase_2Hz <- cooks.distance( PropulsionPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2Hz, aes(x=PropulsionPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2Hz, type = 'predictor' )


plot( PropulsionPhase_2Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_TSContributiontoPFActivity_PropulsionPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2Hz$coefficients[2], intercept = PropulsionPhase_2Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'TS Activation Contribution = ', round(PropulsionPhase_2Hz$coefficients[1], digits = 2), '* + ', round(PropulsionPhase_2Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Triceps Surae Contribution to \n Plantar Flexor Activation During 2.0 Hz Propulsion Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```





##### Gastroc Contribution vs Group
```{r Braking Phase}


BrakingPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_TwoJointTS_Contribution2AllPF_BrakingPhase ~ Group_ID )

summary( BrakingPhase_2Hz )

confint( BrakingPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_BrakingPhase_2Hz <- hatvalues( BrakingPhase_2Hz ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_BrakingPhase_2Hz <- mean( Leverage_BrakingPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2Hz > 2*AverageLeverage_BrakingPhase_2Hz )

#Find Cook's Distance for BrakingPhase_2Hz
( CookD_BrakingPhase_2Hz <- cooks.distance( BrakingPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2Hz, aes(x=BrakingPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2Hz, type = 'predictor' )


plot( BrakingPhase_2Hz )


```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_TwoJointTS_Contribution2AllPF_BrakingPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2Hz$coefficients[2], intercept = BrakingPhase_2Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Gastroc Activation Contribution = ', round(BrakingPhase_2Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2Hz$coefficients[2], digits = 2), '(Group ID)*' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Gastrocnemii Contribution to \n Plantar Flexor Activation During 2.0 Hz Braking Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}


PropulsionPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase ~ Group_ID )

summary( PropulsionPhase_2Hz )

confint( PropulsionPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_PropulsionPhase_2Hz <- hatvalues( PropulsionPhase_2Hz ) )

#Find average leverage value for PropulsionPhase_2Hz.
( AverageLeverage_PropulsionPhase_2Hz <- mean( Leverage_PropulsionPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2Hz > 2*AverageLeverage_PropulsionPhase_2Hz )

#Find Cook's Distance for PropulsionPhase_2Hz
( CookD_PropulsionPhase_2Hz <- cooks.distance( PropulsionPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2Hz, aes(x=PropulsionPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2Hz, type = 'predictor' )


plot( PropulsionPhase_2Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2Hz$coefficients[2], intercept = PropulsionPhase_2Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Gastroc Activation Contribution = ', round(PropulsionPhase_2Hz$coefficients[1], digits = 2), '* + ', round(PropulsionPhase_2Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Gastrocnemii Contribution to \n Plantar Flexor Activation During 2.0 Hz Propulsion Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```





##### Sol Contribution vs Group
```{r Braking Phase}


BrakingPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_OneJointTS_Contribution2AllPF_BrakingPhase ~ Group_ID )

summary( BrakingPhase_2Hz )

confint( BrakingPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_BrakingPhase_2Hz <- hatvalues( BrakingPhase_2Hz ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_BrakingPhase_2Hz <- mean( Leverage_BrakingPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2Hz > 2*AverageLeverage_BrakingPhase_2Hz )

#Find Cook's Distance for BrakingPhase_2Hz
( CookD_BrakingPhase_2Hz <- cooks.distance( BrakingPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2Hz, aes(x=BrakingPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2Hz, type = 'predictor' )


plot( BrakingPhase_2Hz )


```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_OneJointTS_Contribution2AllPF_BrakingPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2Hz$coefficients[2], intercept = BrakingPhase_2Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Soleus Activation Contribution = ', round(BrakingPhase_2Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2Hz$coefficients[2], digits = 2), '(Group ID)*' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Soleus Contribution to \n Plantar Flexor Activation During 2.0 Hz Braking Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}


PropulsionPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_OneJointTS_Contribution2AllPF_PropulsionPhase ~ Group_ID )

summary( PropulsionPhase_2Hz )

confint( PropulsionPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_PropulsionPhase_2Hz <- hatvalues( PropulsionPhase_2Hz ) )

#Find average leverage value for PropulsionPhase_2Hz.
( AverageLeverage_PropulsionPhase_2Hz <- mean( Leverage_PropulsionPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2Hz > 2*AverageLeverage_PropulsionPhase_2Hz )

#Find Cook's Distance for PropulsionPhase_2Hz
( CookD_PropulsionPhase_2Hz <- cooks.distance( PropulsionPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2Hz, aes(x=PropulsionPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2Hz, type = 'predictor' )


plot( PropulsionPhase_2Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_OneJointTS_Contribution2AllPF_PropulsionPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2Hz$coefficients[2], intercept = PropulsionPhase_2Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Soleus Activation Contribution = ', round(PropulsionPhase_2Hz$coefficients[1], digits = 2), '* + ', round(PropulsionPhase_2Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Soleus Contribution to \n Plantar Flexor Activation During 2.0 Hz Propulsion Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```



#### 2.3 Hz
##### MEE vs PL Contribution

###### Both Groups
```{r Braking Phase}

#Remove ATx19 - these had high leverage
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>% filter( Participant_ID != 'ATx19')

BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx19,
                          Mean_EugeneContributionIndx ~ I(Mean_PLContributiontoPFActivity_BrakingPhase^2 ) )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )

```


```{r Check Assumptions of 2.3 Hz Braking Phase}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 3*mean(CookD_BrakingPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )
```


```{r Plot Regression Results}


( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = I(Mean_PLContributiontoPFActivity_BrakingPhase^2), y = Mean_EugeneContributionIndx  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = 'Not Significant', x = 25, y = 67.5, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE Contribution = ', round(BrakingPhase_2.3Hz$coefficients[1], digits = 2), ' + ', round(BrakingPhase_2.3Hz$coefficients[2], digits = 2), '*PL Contribution' ), x = 25, y = 71.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(0,250,by=50),limits=c(0,250) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE Absorption vs \n TS Contribution to PF Activation \n ',x='PL Contribution to PF Activation (% PF Activation)', y = ' Ankle Contribution to Whole-Limb MEE Absorption (% Whole-Limb MEE) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}

PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_Joint_Percent_MEE_Generation ~ Mean_TSContributiontoPFActivity_PropulsionPhase )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )

```



```{r Check Assumptions of 2.3 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2.3Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 3*mean(CookD_PropulsionPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Mean_TSContributiontoPFActivity_PropulsionPhase, y = Mean_EugeneContributionIndx  ) ) +
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2.3Hz$coefficients[2], intercept = PropulsionPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = 'Not Significant', x = 25, y = 67.5, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE Contribution = ', round(PropulsionPhase_2.3Hz$coefficients[1], digits = 2), ' + ', round(PropulsionPhase_2.3Hz$coefficients[2], digits = 2), '*PL Contribution' ), x = 25, y = 71.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE Generation vs \n TS Contribution to PF Activation \n ',x='PL Contribution to PF Activation (% PF Activation)', y = ' Ankle Contribution to Whole-Limb MEE Generation (% Whole-Limb MEE) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```



##### 'Raw' Ankle MEE vs Group
```{r Braking Phase}


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_Joint_Absorption_MEE ~ Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_EugeneContributionIndx  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE Contribution = ', round(BrakingPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)*' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Ankle Contribution to \n Whole-Limb MEE During 2.3 Hz Braking Phase',x='Group ID', y = ' Ankle Contribution to Whole-Limb MEE (% Whole-Limb MEE) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}


PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_Joint_Generation_MEE ~ Group_ID )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2.3Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_Joint_Percent_MEE_Generation  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2.3Hz$coefficients[2], intercept = PropulsionPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE Contribution = ', round(PropulsionPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(PropulsionPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Ankle Contribution to \n Whole-Limb MEE During 2.3 Hz Propulsion Phase',x='Group ID', y = ' Ankle Contribution to Whole-Limb MEE (% Whole-Limb MEE) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',size='none',shape='none',fill='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```




##### Ankle Contribution vs Group
```{r Braking Phase}


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_EugeneContributionIndx ~ Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_EugeneContributionIndx  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE Contribution = ', round(BrakingPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)*' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Ankle Contribution to \n Whole-Limb MEE During 2.3 Hz Braking Phase',x='Group ID', y = ' Ankle Contribution to Whole-Limb MEE (% Whole-Limb MEE) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}


PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_Joint_Percent_MEE_Generation ~ Group_ID )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2.3Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_Joint_Percent_MEE_Generation  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2.3Hz$coefficients[2], intercept = PropulsionPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE Contribution = ', round(PropulsionPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(PropulsionPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Ankle Contribution to \n Whole-Limb MEE During 2.3 Hz Propulsion Phase',x='Group ID', y = ' Ankle Contribution to Whole-Limb MEE (% Whole-Limb MEE) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',size='none',shape='none',fill='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```



##### TS Contribution vs Group
```{r Braking Phase}


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_TSContributiontoPFActivity_BrakingPhase ~ Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )



d<-density(BrakingPhase_2.3Hz[['residuals']])
plot(d,main='Residual KDE Plot',xlab='Residual value')

```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_TSContributiontoPFActivity_BrakingPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'TS Activation Contribution = ', round(BrakingPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)*' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Triceps Surae Contribution to \n Plantar Flexor Activation During 2.0 Hz Braking Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}


PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_TSContributiontoPFActivity_PropulsionPhase ~ Group_ID )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2.3Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_TSContributiontoPFActivity_PropulsionPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2.3Hz$coefficients[2], intercept = PropulsionPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'TS Activation Contribution = ', round(PropulsionPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(PropulsionPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Triceps Surae Contribution to \n Plantar Flexor Activation During 2.0 Hz Propulsion Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```

##### Gastroc Contribution vs Group
```{r Braking Phase}


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_TwoJointTS_Contribution2AllPF_BrakingPhase ~ Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )


```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_TwoJointTS_Contribution2AllPF_BrakingPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Gastroc Activation Contribution = ', round(BrakingPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)*' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Gastrocnemii Contribution to \n Plantar Flexor Activation During 2.0 Hz Braking Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}


PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase ~ Group_ID )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2.3Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_TwoJointTS_Contribution2AllPF_PropulsionPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2.3Hz$coefficients[2], intercept = PropulsionPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Gastroc Activation Contribution = ', round(PropulsionPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(PropulsionPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Gastrocnemii Contribution to \n Plantar Flexor Activation During 2.0 Hz Propulsion Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```





##### Sol Contribution vs Group
```{r Braking Phase}


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_OneJointTS_Contribution2AllPF_BrakingPhase ~ Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )


```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_OneJointTS_Contribution2AllPF_BrakingPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Soleus Activation Contribution = ', round(BrakingPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)*' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Soleus Contribution to \n Plantar Flexor Activation During 2.0 Hz Braking Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}


PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_OneJointTS_Contribution2AllPF_PropulsionPhase ~ Group_ID )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2.3Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )


d<-density(PropulsionPhase_2.3Hz[['residuals']])
plot(d,main='Residual KDE Plot',xlab='Residual value')
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_OneJointTS_Contribution2AllPF_PropulsionPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2.3Hz$coefficients[2], intercept = PropulsionPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'Soleus Activation Contribution = ', round(PropulsionPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(PropulsionPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Soleus Contribution to \n Plantar Flexor Activation During 2.0 Hz Propulsion Phase',x='Group ID', y = ' PF Activation Contribution (%)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```



##### PL Activation vs Group
```{r Contact Phase}


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, Mean_PL_iEMG_BrakingPhase ~ Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )


```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_PL_iEMG_BrakingPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'PL iEMG = ', round(BrakingPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)*' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,40,by=5),limits=c(0,40) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Peroneus Longus \n Integrated Activation During 2.0 Hz Braking Phase',x='Group ID', y = ' iEMG (%MVIC)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```




```{r Braking Phase}


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, Mean_PL_iEMG_BrakingPhase ~ Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )


```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_PL_iEMG_BrakingPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'PL iEMG = ', round(BrakingPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(BrakingPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)*' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,40,by=5),limits=c(0,40) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Peroneus Longus \n Integrated Activation During 2.0 Hz Braking Phase',x='Group ID', y = ' iEMG (%MVIC)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


```{r Propulsion Phase}


PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_PL_iEMG_PropulsionPhase ~ Group_ID )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )



```


```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2.3Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 1 )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )


d<-density(PropulsionPhase_2.3Hz[['residuals']])
plot(d,main='Residual KDE Plot',xlab='Residual value')
```


```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Group_ID, y = Mean_PL_iEMG_PropulsionPhase  ) ) +
     
     stat_summary( fun.args = list(mult=5),
geom="crossbar", width=0.5, aes( group = Group_ID, color = Group_ID ), size = 1, show.legend = F  )+ 
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_abline( slope = PropulsionPhase_2.3Hz$coefficients[2], intercept = PropulsionPhase_2.3Hz$coefficients[1], linewidth = 2) +
     
     
     geom_text( label = '* = Significant', x = 1.5, y = 87.5, size = 8 ) +
     
     geom_text( label = paste( 'PL iEMG = ', round(PropulsionPhase_2.3Hz$coefficients[1], digits = 2), '* + ', round(PropulsionPhase_2.3Hz$coefficients[2], digits = 2), '(Group ID)' ), x = 1.5, y = 91.5, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,40,by=5),limits=c(0,40) )+
    
     
      scale_x_discrete(breaks=c('ATx', 'Control') )+
     
     
     
     labs(title='Group Effect on Peroneus Longus \n Integrated Activation During 2.0 Hz Propulsion Phase',x='Group ID', y = ' iEMG (%MVIC)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color=guide_legend(aes=c('color','fill'),title='Group ID',override.aes=list(size=5) ),size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```


### MLR

#### 2.0 Hz

##### Raw MEE
```{r Braking Phase}

#Need to remove ATx10 for the 2.0 Hz Braking phase regression
Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle_NoATx10 <- Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle %>% filter( Participant_ID != 'ATx10' )


BrakingPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle_NoATx10,log10(Mean_Joint_Absorption_MEE) ~ log10(Mean_TSContributiontoPFActivity_BrakingPhase) + Group_ID + Mean_TSContributiontoPFActivity_BrakingPhase*Group_ID )

summary( BrakingPhase_2Hz )

confint( BrakingPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_BrakingPhase_2Hz <- hatvalues( BrakingPhase_2Hz ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_BrakingPhase_2Hz <- mean( Leverage_BrakingPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2Hz > 2*AverageLeverage_BrakingPhase_2Hz )

#Find Cook's Distance for BrakingPhase_2Hz
( CookD_BrakingPhase_2Hz <- cooks.distance( BrakingPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2Hz > 3*mean(CookD_BrakingPhase_2Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
StudResiduals <- studres( BrakingPhase_2Hz )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2Hz, aes(x=BrakingPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2Hz, type = 'predictor' )


plot( BrakingPhase_2Hz )
```




```{r Propulsion Phase}

PropulsionPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_Joint_MEE_Generation ~ Mean_TSContributiontoPFActivity_PropulsionPhase + Group_ID + Mean_TSContributiontoPFActivity_PropulsionPhase*Group_ID )

summary( PropulsionPhase_2Hz )

confint( PropulsionPhase_2Hz )

```



```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_PropulsionPhase_2Hz <- hatvalues( PropulsionPhase_2Hz ) )

#Find average leverage value for PropulsionPhase_2Hz.
( AverageLeverage_PropulsionPhase_2Hz <- mean( Leverage_PropulsionPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2Hz > 2*AverageLeverage_PropulsionPhase_2Hz )

#Find Cook's Distance for PropulsionPhase_2Hz
( CookD_PropulsionPhase_2Hz <- cooks.distance( PropulsionPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2Hz > 3*mean(CookD_PropulsionPhase_2Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2Hz, aes(x=PropulsionPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2Hz, type = 'predictor' )


plot( PropulsionPhase_2Hz )
```



##### MEE Contribution
```{r Braking Phase}

#Need to remove ATx10 for the 2.0 Hz Braking phase regression
Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle_NoATx10 <- Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle %>% filter( Participant_ID != 'ATx10' )


BrakingPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle_NoATx10,Mean_Joint_Absorption_MEE ~ Mean_TSContributiontoPFActivity_BrakingPhase + Group_ID + Mean_TSContributiontoPFActivity_BrakingPhase*Group_ID )

summary( BrakingPhase_2Hz )

confint( BrakingPhase_2Hz )



```


```{r Check Assumptions of 2.0 Hz Braking Phase}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_BrakingPhase_2Hz <- hatvalues( BrakingPhase_2Hz ) )

#Find average leverage value for BrakingPhase_2Hz.
( AverageLeverage_BrakingPhase_2Hz <- mean( Leverage_BrakingPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2Hz > 2*AverageLeverage_BrakingPhase_2Hz )

#Find Cook's Distance for BrakingPhase_2Hz
( CookD_BrakingPhase_2Hz <- cooks.distance( BrakingPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2Hz > 3*mean(CookD_BrakingPhase_2Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
StudResiduals <- studres( BrakingPhase_2Hz )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2Hz, aes(x=BrakingPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2Hz, type = 'predictor' )


plot( BrakingPhase_2Hz )
```




```{r Propulsion Phase}

PropulsionPhase_2Hz <- lm( data = Dissertation_CombinedMEEandEMG_2Hz_InvolvedvsControlAnkle,Mean_Joint_Generation_MEE ~ Mean_TSContributiontoPFActivity_PropulsionPhase + Group_ID + Mean_TSContributiontoPFActivity_PropulsionPhase*Group_ID )

summary( PropulsionPhase_2Hz )

confint( PropulsionPhase_2Hz )

```



```{r Check Assumptions of 2.0 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_PropulsionPhase_2Hz <- hatvalues( PropulsionPhase_2Hz ) )

#Find average leverage value for PropulsionPhase_2Hz.
( AverageLeverage_PropulsionPhase_2Hz <- mean( Leverage_PropulsionPhase_2Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2Hz > 2*AverageLeverage_PropulsionPhase_2Hz )

#Find Cook's Distance for PropulsionPhase_2Hz
( CookD_PropulsionPhase_2Hz <- cooks.distance( PropulsionPhase_2Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2Hz > 3*mean(CookD_PropulsionPhase_2Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2Hz, aes(x=PropulsionPhase_2Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2Hz, type = 'predictor' )


plot( PropulsionPhase_2Hz )
```




#### 2.3 Hz

##### MEE Contribution
```{r Braking Phase}



#Remove ATx10 and ATx19 - these had high leverage
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx10or19orHP02 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>% filter( Participant_ID != 'ATx10', Participant_ID != 'ATx19', Participant_ID != 'HP02')


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_EugeneContributionIndx ~ Mean_TSContributiontoPFActivity_BrakingPhase_Centered*Group_ID )



wt <- 1/(lm( abs(BrakingPhase_2.3Hz$residuals) ~ BrakingPhase_2.3Hz$fitted.values )$fitted.values^2)

BrakingPhase_2.3Hz_weighted <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_EugeneContributionIndx ~ Mean_TSContributiontoPFActivity_BrakingPhase_Centered*Group_ID,weights = wt )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )

```


```{r Check Assumptions of 2.3 Hz Braking Phase}

#Find leverage values for BrakingPhase_2Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 3*mean(CookD_BrakingPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( BrakingPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )
```





```{r Propulsion Phase}

PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, log10(Mean_Joint_Percent_MEE_Generation) ~ Mean_TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )

```

```{r Check Assumptions of 2.3 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 3*mean(CookD_PropulsionPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )
```



```{r}

MeanJointGenerationMEErank <- rank( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE )

MeanJointGenerationMEElength <- length( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE )

MeanJointGenerationMEEmeanrank <- mean( MeanJointGenerationMEErank )

MeanJointGenerationMEEsdrank <- sd( MeanJointGenerationMEErank )

pnorm( ( MeanJointGenerationMEErank - MeanJointGenerationMEEmeanrank ) / MeanJointGenerationMEEsdrank )

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE_ranked <- pnorm( ( MeanJointGenerationMEErank - MeanJointGenerationMEEmeanrank ) / MeanJointGenerationMEEsdrank )

```




##### Raw MEE vs Uncentered TS Contribution
```{r Braking Phase}

#Need to remove ATx10 for the 2.3 Hz Braking phase regression
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx10 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>% filter( Participant_ID != 'ATx10' )


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_Joint_Absorption_MEE ~ Mean_TSContributiontoPFActivity_BrakingPhase*Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )


```



```{r Check Assumptions of 2.3 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 3*mean(CookD_BrakingPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
StudResiduals <- studres( BrakingPhase_2.3Hz )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )
```









```{r Propulsion Phase}

#ATx07 has high Cook's D. Need to remove from data set
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID != 'ATx07' )

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_Joint_Generation_MEE <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_Joint_Generation_MEE, center = T, scale = T )

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_TSContributiontoPFActivity_PropulsionPhase <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_TSContributiontoPFActivity_PropulsionPhase, center = T, scale = T )



Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE, scale = T, center = T )


Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase, scale = T, center = T )


PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, Mean_Joint_Generation_MEE ~ Mean_TSContributiontoPFActivity_PropulsionPhase + Group_ID )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )

```



```{r Check Assumptions of 2.3 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2.3Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 3*mean(CookD_PropulsionPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )
```



##### Raw MEE vs Centered TS Contribution
```{r Braking Phase}

#Need to remove ATx10 for the 2.3 Hz Braking phase regression
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx10 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>% filter( Participant_ID != 'ATx10' )


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,Mean_Joint_Absorption_MEE ~ Mean_TSContributiontoPFActivity_BrakingPhase_Centered*Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )


```



```{r Check Assumptions of 2.3 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )

#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 3*mean(CookD_BrakingPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
StudResiduals <- studres( BrakingPhase_2.3Hz )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )
```




```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Mean_TSContributiontoPFActivity_BrakingPhase_Centered, y = Mean_Joint_Absorption_MEE  ) ) +
     

     
     
     #Line for ATx Group - outline color
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 3, color = 'black' ) +
     
     #Line for ATx Group - inside color
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 2, color = met.brewer('Austria')[1] ) +
     
     #Line for Control Group - outline color
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2]+BrakingPhase_2.3Hz$coefficients[4], intercept = BrakingPhase_2.3Hz$coefficients[1]+BrakingPhase_2.3Hz$coefficients[3], linewidth = 3,  color = 'black' ) +
     
     #Line for Control Group - inside color
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2]+BrakingPhase_2.3Hz$coefficients[4], intercept = BrakingPhase_2.3Hz$coefficients[1]+BrakingPhase_2.3Hz$coefficients[3], linewidth = 2,  color = met.brewer('Austria')[3] ) +
     
     
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     # geom_text( label = '* = Significant', x = 0, y = 0.86, size = 8 ) +
     # 
     # geom_text( label = paste( 'Ankle MEE = ', round(BrakingPhase_2.3Hz$coefficients[1], digits = 2), '* ', round(BrakingPhase_2.3Hz$coefficients[2], digits = 2), '(TS Contribution) + ', round( BrakingPhase_2.3Hz$coefficients[3], digits = 2 ), '(Group ID) +', round( BrakingPhase_2.3Hz$coefficients[4], digits = 2), '(TS Contribution)(Group ID)', sep = '' ), x = 3, y = 0.9, size = 8 ) +
     
   #Pearson's Correlation for ATx
     geom_text( label = 'r (95% CI) = -0.23 (-0.88, 0.71)', size = 10, x = 4, y = 0.42, color = met.brewer('Austria')[1] ) +  
     
     geom_text( label = 'r (95% CI) = -0.31 (-0.86, 0.58)', size = 10, x = 4, y = 0.66, color = met.brewer('Austria')[3] ) + 

     
     
      #Leftwards arrow - from text to 0   
      geom_segment( aes(x= -0.03,
                             xend = -8,
                            y = 0.02 ,
                            yend = 0.02 ),
                     na.rm=FALSE,inherit.aes=FALSE,size=4,arrow=arrow(length=unit(0.25,'inches')),show.legend=FALSE,color='black' ) +  
   
   
#Add black to leftwards arrow
           geom_segment( aes(x= -0.03,
                             xend = -8,
                            y = 0.02,
                            yend = 0.02 ),                        na.rm=FALSE,inherit.aes=FALSE,size=2,arrow=arrow(length=unit(0.25,'inches')),show.legend=FALSE,color='gold3' ) + 
     
     
     
     
   
   
   
      #Rightwards arrow - from text to 0   
      geom_segment( aes(x= 0.03,
                             xend = 12,
                            y = 0.02 ,
                            yend = 0.02 ),
                     na.rm=FALSE,inherit.aes=FALSE,size=4,arrow=arrow(length=unit(0.25,'inches')),show.legend=FALSE,color='black' ) +  
   
   
#Add black to rightwards arrow
           geom_segment( aes(x= 0.03,
                             xend = 12,
                            y = 0.02,
                            yend = 0.02 ),                        na.rm=FALSE,inherit.aes=FALSE,size=2,arrow=arrow(length=unit(0.25,'inches')),show.legend=FALSE,color='gold3' ) +    
   
   
   
   geom_text( label = 'TS Contribution < Group Average', x = -4.5, y = 0.05, size = 10 ) +
   
   geom_text( label = 'TS Contribution > Group Average', x = 6, y = 0.05, size = 10 ) +
   

     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(-8,12,by=2),limits=c(-8,12) )+
     
     
     
     labs(title='Ankle MEE vs Group Mean-Centered \n TS Contribution to PF Activation \n 2.3 Hz Hopping - Braking Phase',x='Difference from Group Average TS Contribution (%)', y = 'MEE (J/kg)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```





```{r Propulsion Phase}

#ATx07 has high Cook's D. Need to remove from data set
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID != 'ATx07' )

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_Joint_Generation_MEE <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_Joint_Generation_MEE, center = T, scale = T )

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_TSContributiontoPFActivity_PropulsionPhase <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_TSContributiontoPFActivity_PropulsionPhase, center = T, scale = T )



Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE, scale = T, center = T )


Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TSContributiontoPFActivity_PropulsionPhase, scale = T, center = T )


PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, Mean_Joint_Generation_MEE ~ Mean_TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )

```



```{r Check Assumptions of 2.3 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2.3Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 3*mean(CookD_PropulsionPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )
```


##### Raw MEE vs PL iEMG
```{r Braking Phase}

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Absorption_MEE_Scaled <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Absorption_MEE, center = T, scale = T)

#Create mean-centered PL iEMG for braking phase. Center all values by control group mean
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_BrakingPhase_Centered <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_BrakingPhase - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_BrakingPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )

#Create mean-centered PL iEMG for propulsion phase. Center all values by control group mean
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_PropulsionPhase_Centered <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_PropulsionPhase - mean( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID == 'Control' ) ] )







BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, Mean_Joint_Absorption_MEE ~  Mean_PL_iEMG_BrakingPhase*Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )


```



```{r Check Assumptions of 2.3 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )



#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 3*mean(CookD_BrakingPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
StudResiduals <- studres( BrakingPhase_2.3Hz )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )
```




```{r Plot Regression Results}

( AnkleMEEvsTSContribution_2.3Hz <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x = Mean_PL_iEMG_BrakingPhase, y = Mean_Joint_Absorption_MEE  ) ) +
     

     
     
     #Line for ATx Group - outline color
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 3, color = 'black' ) +
     
     #Line for ATx Group - inside color
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2], intercept = BrakingPhase_2.3Hz$coefficients[1], linewidth = 2, color = met.brewer('Austria')[1] ) +
     
     #Line for Control Group - outline color
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2]+BrakingPhase_2.3Hz$coefficients[4], intercept = BrakingPhase_2.3Hz$coefficients[1]+BrakingPhase_2.3Hz$coefficients[3], linewidth = 3,  color = 'black' ) +
     
     #Line for Control Group - inside color
     geom_abline( slope = BrakingPhase_2.3Hz$coefficients[2]+BrakingPhase_2.3Hz$coefficients[4], intercept = BrakingPhase_2.3Hz$coefficients[1]+BrakingPhase_2.3Hz$coefficients[3], linewidth = 2,  color = met.brewer('Austria')[3] ) +
     
     
     
     
     geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +
     
     
     geom_text( label = '* = Significant', x = 10, y = 0.1, size = 8 ) +
     
     geom_text( label = paste( 'Ankle MEE = ', round(BrakingPhase_2.3Hz$coefficients[1], digits = 2), ' + ', round(BrakingPhase_2.3Hz$coefficients[2], digits = 2), '(PL iEMG)* +\n ', round( BrakingPhase_2.3Hz$coefficients[3], digits = 2 ), '(Group ID) ', round( BrakingPhase_2.3Hz$coefficients[4], digits = 2), '(PL iEMG)(Group ID)' ), x = 10, y = 0.2, size = 8 ) +
     
     
     scale_y_continuous(breaks=seq(0,0.9,by=0.1),limits=c(0,0.9) )+
    
     
      scale_x_continuous(breaks=seq(0,20,by=2),limits=c(0,20) )+
     
     
     
     labs(title='Ankle MEE vs PL iEMG and Group ID \n 2.3 Hz Hopping - Braking Phase',x='PL iEMG (%Single Leg Vertical Jump)', y = 'MEE (J/kg)' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  ) 
     
     
     )


```











```{r Propulsion Phase}

#ATx07 has high Cook's D. Need to remove from data set
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>%
   filter( Participant_ID != 'ATx07' )

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_Joint_Generation_MEE <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_Joint_Generation_MEE, center = T, scale = T )

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_PL_iEMG_PropulsionPhase <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07$Mean_PL_iEMG_PropulsionPhase, center = T, scale = T )



Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE, scale = T, center = T )


Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_PropulsionPhase <- scale( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_PL_iEMG_PropulsionPhase, scale = T, center = T )


PropulsionPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, Mean_Joint_Generation_MEE ~ Mean_PL_iEMG_PropulsionPhase*Group_ID )

summary( PropulsionPhase_2.3Hz )

confint( PropulsionPhase_2.3Hz )

```



```{r Check Assumptions of 2.3 Hz Propulsion Phase}

#Find leverage values for PropulsionPhase_2.3Hz MLR
( Leverage_PropulsionPhase_2.3Hz <- hatvalues( PropulsionPhase_2.3Hz ) )

#Find average leverage value for PropulsionPhase_2.3Hz.
( AverageLeverage_PropulsionPhase_2.3Hz <- mean( Leverage_PropulsionPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_PropulsionPhase_2.3Hz > 2*AverageLeverage_PropulsionPhase_2.3Hz )

#Find Cook's Distance for PropulsionPhase_2.3Hz
( CookD_PropulsionPhase_2.3Hz <- cooks.distance( PropulsionPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_PropulsionPhase_2.3Hz > 3*mean(CookD_PropulsionPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
( StudResiduals <- studres( PropulsionPhase_2.3Hz ) )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=PropulsionPhase_2.3Hz, aes(x=PropulsionPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( PropulsionPhase_2.3Hz, type = 'predictor' )


plot( PropulsionPhase_2.3Hz )
```




###### No ATx07 and ATx19
```{r Braking Phase}

#Need to remove ATx10 for the 2.3 Hz Braking phase regression
Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07and19 <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle %>% filter( Participant_ID != 'ATx07' & Participant_ID != 'ATx19' )


BrakingPhase_2.3Hz <- lm( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle_NoATx07and19, log10(Mean_Joint_Absorption_MEE) ~  Mean_PL_iEMG_BrakingPhase*Group_ID )

summary( BrakingPhase_2.3Hz )

confint( BrakingPhase_2.3Hz )



```



```{r Check Assumptions of 2.3 Hz Braking Phase}

#Find leverage values for BrakingPhase_2.3Hz MLR
( Leverage_BrakingPhase_2.3Hz <- hatvalues( BrakingPhase_2.3Hz ) )

#Find average leverage value for BrakingPhase_2.3Hz.
( AverageLeverage_BrakingPhase_2.3Hz <- mean( Leverage_BrakingPhase_2.3Hz ) )

#Any data points with values > 2x the average leverage should be removed
which( Leverage_BrakingPhase_2.3Hz > 2*AverageLeverage_BrakingPhase_2.3Hz )



#Find Cook's Distance for BrakingPhase_2.3Hz
( CookD_BrakingPhase_2.3Hz <- cooks.distance( BrakingPhase_2.3Hz ) )

#Any data points with Cook's Distance of >3x the mean CookD have high leverage
which( CookD_BrakingPhase_2.3Hz > 3*mean(CookD_BrakingPhase_2.3Hz,na.rm=T) )

#No data points have high leverage!

#Calculate studentized residuals to check for outliers
StudResiduals <- studres( BrakingPhase_2.3Hz )

#Check for any studentized residuals > 3. This is indication of outliers
ggplot(data=BrakingPhase_2.3Hz, aes(x=BrakingPhase_2.3Hz$fitted.values,y = StudResiduals ))+
     geom_point()+
     stat_smooth(method="lm", se=FALSE)
#No outliers


#Check for multicollinearity
vif( BrakingPhase_2.3Hz, type = 'predictor' )


plot( BrakingPhase_2.3Hz )
```



## Mixed Effects

### Ankle MEE
```{r %MEE vs TS Contribution - Propulsion}

LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion,method='boot') # significant


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC <- lme(fixed=Joint_Percent_MEE_Generation~1,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random=~1|Participant_ID)


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_VarExplained = (8.630181^2) /( (8.630181^2) + (3.823851^2) ) )
#ICC = 0.84 - significant clustering

MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly <- lme(fixed=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= ~1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly <- lme(fixed=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= ~TSContributiontoPFActivity_PropulsionPhase_Centered-1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects <- lme(fixed=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= ~TSContributiontoPFActivity_PropulsionPhase_Centered|Participant_ID,method='REML')


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)#significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)#significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)#significant, but positive-definite covariance may not be necessary


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar <- lme(fixed=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= list(Participant_ID=pdDiag(~TSContributiontoPFActivity_PropulsionPhase_Centered)),method='REML')
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar) #significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)

logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)*-2


### No diff between Both Effects and Both Effects with Diagonal Covar Matrix - Diagonal Matrix for effect of time on Gastroc Hz is best model. Intercept is 64.9 (62.1, 67.7); p=0, slope is -0.3 (-0.5, -0.2); p=0.  


anova(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
##MME improves up on LM



plot(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered,abline=c(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1],MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]) )


plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnklePercentMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  TSContributiontoPFActivity_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[2], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[4], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[5], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[6], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[7], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[8], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[9], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[10], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[11], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[12], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[13], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 87.5 ) +
     
   #r values for Control group
   geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 82.5 ) +
     
     

     geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(35,95,by=10),limits=c(35,95) )+
    
     
      scale_x_continuous(breaks=seq(-20,20,by=5),limits=c(-20,20) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



```{r %MEE vs Gastrocnemii Contribution - Propulsion}

LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion,method='boot') # significant intercept, effect of group ID, interaction effect


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC <- lme(fixed=Joint_Percent_MEE_Generation~1,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random=~1|Participant_ID)


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_VarExplained = (8.630181^2) /( (8.630181^2) + (3.823851^2) ) )
#ICC = 0.84 - significant clustering

MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly_GastrocContribution <- lme(fixed=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= ~1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly <- lme(fixed=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= ~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered-1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects <- lme(fixed=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= ~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered|Participant_ID,method='REML')


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)#significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)#significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)#significant, but positive-definite covariance may not be necessary


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar <- lme(fixed=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= list(Participant_ID=pdDiag(~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered)),method='REML')
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar) #significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)

logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)*-2


### No diff between Both Effects and Both Effects with Diagonal Covar Matrix - Diagonal Matrix for effect of time on Gastroc Hz is best model. Intercept is 64.9 (62.1, 67.7); p=0, slope is -0.3 (-0.5, -0.2); p=0.  


anova(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
##MME improves up on LM



plot(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered,abline=c(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1],MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]) )


plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnklePercentMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[2], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[4], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[5], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[6], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[7], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[8], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[9], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[10], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[11], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[12], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[13], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 87.5 ) +
     
   #r values for Control group
   geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 82.5 ) +
     
     

     geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



```{r %MEE vs Sol Contribution - Propulsion}

LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion,method='boot') # significant intercept, effect of group ID, interaction effect


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC <- lme(fixed=Joint_Percent_MEE_Generation~1,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random=~1|Participant_ID)


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_VarExplained = (8.630181^2) /( (8.630181^2) + (3.823851^2) ) )
#ICC = 0.84 - significant clustering

MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly <- lme(fixed=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= ~1|Participant_ID,method='REML')



MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly <- lme(fixed=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= ~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered-1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects <- lme(fixed=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= ~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered|Participant_ID,method='REML')


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)#significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)#significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)#significant, but positive-definite covariance may not be necessary


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar <- lme(fixed=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle,random= list(Participant_ID=pdDiag(~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered)),method='REML')
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar) #significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)

logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)*-2


### No diff between Both Effects and Both Effects with Diagonal Covar Matrix - Diagonal Matrix for effect of time on Gastroc Hz is best model. Intercept is 64.9 (62.1, 67.7); p=0, slope is -0.3 (-0.5, -0.2); p=0.  


anova(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
##MME improves up on LM



plot(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered,abline=c(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1],MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]) )


plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnklePercentMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  OneJointTS_Contribution2AllPF_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[2], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[4], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[5], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[6], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[7], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[8], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[9], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[10], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[11], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[12], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[13], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 87.5 ) +
     
   #r values for Control group
   geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 82.5 ) +
     
     

     geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```






### Knee MEE
```{r %MEE vs TS Contribution - Propulsion}

LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion,method='boot') # significant


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC <- lme(fixed=Joint_Percent_MEE_Generation~1,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random=~1|Participant_ID)


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_VarExplained = (6.362369^2) /( (6.362369^2) + (3.829884^2) ) )
#ICC = 0.73 - significant clustering

MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly <- lme(fixed=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= ~1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly <- lme(fixed=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= ~TSContributiontoPFActivity_PropulsionPhase_Centered-1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects <- lme(fixed=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= ~TSContributiontoPFActivity_PropulsionPhase_Centered|Participant_ID,method='REML')


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)#significant fixed effect intercept
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)#significant fixed effect intercept and effect of group on fixed effect intercept
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)#significant, but positive-definite covariance may not be necessary


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar <- lme(fixed=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= list(Participant_ID=pdDiag(~TSContributiontoPFActivity_PropulsionPhase_Centered)),method='REML')
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar) #significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)

logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)*-2


### No diff between Both Effects and Both Effects with Diagonal Covar Matrix - Diagonal Matrix for effect of time on Gastroc Hz is best model. Intercept is 64.9 (62.1, 67.7); p=0, slope is -0.3 (-0.5, -0.2); p=0.  


anova(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
##MME improves up on LM



plot(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered,abline=c(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1],MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]) )


plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( KneePercentMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee, aes( x =  TSContributiontoPFActivity_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[2], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[4], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[5], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[6], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[7], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[8], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[9], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[10], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[11], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[12], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[13], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 87.5 ) +
     
   #r values for Control group
   geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 82.5 ) +
     
     

     geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-20,20,by=5),limits=c(-20,20) )+
     
     
     
     labs(title='Knee Contribution to Whole-Limb MEE vs \n Group Mean-Centered Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



```{r %MEE vs Gastrocnemii Contribution - Propulsion}

LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion,method='boot') # significant intercept, fixed effect slope


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC <- lme(fixed=Joint_Percent_MEE_Generation~1,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random=~1|Participant_ID)


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_VarExplained = (8.630181^2) /( (8.630181^2) + (3.823851^2) ) )
#ICC = 0.84 - significant clustering

MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly <- lme(fixed=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= ~1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly <- lme(fixed=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= ~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered-1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects <- lme(fixed=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= ~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered|Participant_ID,method='REML')


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)#significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)#significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)#significant, but positive-definite covariance may not be necessary


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar <- lme(fixed=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= list(Participant_ID=pdDiag(~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered)),method='REML')
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar) #significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)

logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)*-2


### No diff between Both Effects and Both Effects with Diagonal Covar Matrix - Diagonal Matrix for effect of time on Gastroc Hz is best model. Intercept is 64.9 (62.1, 67.7); p=0, slope is -0.3 (-0.5, -0.2); p=0.  


anova(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar,LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
##MME improves up on LM



plot(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered,abline=c(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1],MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]) )


plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( KneePercentMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee, aes( x =  TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[2], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[4], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[5], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[6], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[7], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[8], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[9], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[10], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[11], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[12], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$random$Participant_ID[13], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar$coefficients$fixed[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 87.5 ) +
     
   #r values for Control group
   geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 82.5 ) +
     
     

     geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Knee Contribution to Whole-Limb MEE vs \n Group Mean-Centered Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



```{r %MEE vs Sol Contribution - Propulsion}

LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion,method='boot') # significant intercept, effect of group ID, interaction effect


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC <- lme(fixed=Joint_Percent_MEE_Generation~1,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random=~1|Participant_ID)


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_VarExplained = (8.630181^2) /( (8.630181^2) + (3.823851^2) ) )
#ICC = 0.84 - significant clustering

MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly <- lme(fixed=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= ~1|Participant_ID,method='REML')



MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly <- lme(fixed=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= ~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered-1|Participant_ID,method='REML')


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects <- lme(fixed=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= ~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered|Participant_ID,method='REML')


summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)#significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)#significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)#significant, but positive-definite covariance may not be necessary


MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar <- lme(fixed=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee,random= list(Participant_ID=pdDiag(~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered)),method='REML')
summary(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar) #significant
intervals(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)

logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)*-2
logLik(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffectsDiagonalCovar)*-2


### No diff between Both Effects and Both Effects with Diagonal Covar Matrix - Diagonal Matrix for effect of time on Gastroc Hz is best model. Intercept is 64.9 (62.1, 67.7); p=0, slope is -0.3 (-0.5, -0.2); p=0.  


anova(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
##MME improves up on LM



plot(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered,abline=c(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1],MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]) )


plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( KneePercentMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee, aes( x =  OneJointTS_Contribution2AllPF_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[2], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[4], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[5], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[6], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[7], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[8], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[9], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[10], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[11], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[12], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$random$Participant_ID[13], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[1]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[3], slope = MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[2]+MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly$coefficients$fixed[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = 'ATx Group: r (95% CI) = 0.32 (-0.93, 0.98)', size = 10, color = met.brewer('Austria')[1], x = 65, y = 87.5 ) +
     
   #r values for Control group
   geom_text( label = 'Control Group: r (95% CI) = -0.83 (-0.97, -0.19)', size = 10, color = met.brewer('Austria')[3], x = 65, y = 82.5 ) +
     
     

     geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Knee Contribution to Whole-Limb MEE vs \n Group Mean-Centered Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



## Robust MME

### Ankle %MEE

```{r %MEE vs TS Contribution - Propulsion}

LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion,method='boot') # significant


RMME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsTSContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )





RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(TSContributiontoPFActivity_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


( AdjustR2_AnklePercentvsTSContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(TSContributiontoPFActivity_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.



##Random intercept is best model. Now calculate MSE
(MSE_AnklePercentMEEvsTSContribution_Propulsion <- mean( ( getME(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance

summary(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)





plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnklePercentMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  TSContributiontoPFActivity_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'w_e' ), alpha = 0.75  ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('ATx: Ankle %MEE = ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(TS Contribution)',sep=''), size = 10, color = met.brewer('Austria')[1], x =0, y = 92.5 ) +
   

   #r values for Control group
     geom_text( label = paste('Control: Ankle %MEE = ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3],digits=2), round(fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4],digits=2),'(TS Contribution)',sep=''), size = 10, color = met.brewer('Austria')[3], x =0, y = 32.5 ) +
     
     
     geom_text( label = 'Mean Contribution to PF Activation = 70.25%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 87.5 ) +
     
      geom_text( label = 'Mean Contribution to PF Activation = 72.00%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +
   

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```






```{r %MEE vs Gastrocnemii Contribution - Propulsion}

LM_Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion,method='boot') # significant intercept, effect of group, and interaction effect. Non-significant slope for ATx group


RMME_Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsGastrocContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsGastrocContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.



##Both effects is best model. Now calculate MSE
(MSE_AnklePercentMEEvsGastrocContribution_Propulsion <- mean( ( getME(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Significant fixed effect intercept only

summary(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion_BothEffects)



plot( MME_Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnklePercentMEEvsGastrocContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('Both Groups: Ankle %MEE = ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Ankle_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(TS Contribution)'), size = 10, x =0, y = 92.5 ) +
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 47.47%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 32.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 45.98%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Gastrocnemii Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```





```{r %MEE vs Soleus Contribution - Propulsion}

LM_Joint_Percent_MEE_GenerationvsSolContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsSolContribution_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsSolContribution_Propulsion,method='boot') # significant


RMME_Joint_Percent_MEE_GenerationvsSolContribution_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Joint_Percent_MEE_GenerationvsSolContribution_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsSolContribution_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsSolContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(OneJointTS_Contribution2AllPF_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsSolContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Joint_Percent_MEE_GenerationvsSolContribution_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(OneJointTS_Contribution2AllPF_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random Intercept is best model. Now calculate MSE
(MSE_AnklePercentMEEvsSolContribution_Propulsion <- mean( ( getME(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Joint_Percent_MEE_GenerationvsSolContribution_Propulsion_BothEffects)

compare(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Joint_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnklePercentMEEvsSolContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  OneJointTS_Contribution2AllPF_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('Both Groups: Ankle %MEE = ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Ankle_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(TS Contribution)'), size = 10, color = met.brewer('Austria')[1], x =0, y = 92.5 ) +
     
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 22.78%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 32.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 26.02%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Soleus Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```





```{r %MEE vs PL Contribution - Propulsion}

LM_Joint_Percent_MEE_GenerationvsPLContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~PLContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsPLContribution_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsPLContribution_Propulsion,method='boot') # significant


RMME_Joint_Percent_MEE_GenerationvsPLContribution_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Joint_Percent_MEE_GenerationvsPLContribution_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsPLContribution_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~PLContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsPLContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~PLContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(PLContributiontoPFActivity_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsPLContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Joint_Percent_MEE_GenerationvsPLContribution_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~PLContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(PLContributiontoPFActivity_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random intercept is best model. Now calculate MSE
(MSE_AnklePercentMEEvsPLContribution_Propulsion <- mean( ( getME(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Joint_Percent_MEE_GenerationvsPLContribution_Propulsion_BothEffects)

compare(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Joint_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```




```{r Plot - Propulsion Phase}



( AnklePercentMEEvsPLContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  PLContributiontoPFActivity_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,'w_e' ), alpha = 0.75 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('ATx Group: Ankle %MEE = ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1],digits=2),' + ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(PL Contribution)',sep=''), size = 10, x =0, y = 92.5, color = met.brewer('Austria')[1] ) +
     
   #r values for Control group
     geom_text( label = paste('Control Group: Ankle %MEE = ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3],digits=2),' + ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4],digits=2),'(PL Contribution)',sep=''), size = 10, x =0, y = 87.5, color = met.brewer('Austria')[3] ) +
   
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 29.75%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 32.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 28%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Peroneus Longus Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```




```{r %MEE vs PL iEMG - Propulsion}

LM_Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~PL_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion,method='boot') # significant


RMME_Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~PL_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsPLiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~PL_iEMG_PropulsionPhase_Centered*Group_ID+(PL_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsPLiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~PL_iEMG_PropulsionPhase_Centered*Group_ID+(PL_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random intercept is best model. Now calculate MSE
(MSE_AnklePercentMEEvsPLiEMG_Propulsion <- mean( ( getME(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion_BothEffects)

compare(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```




```{r Plot - Propulsion Phase}



( AnklePercentMEEvsPLiEMG_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  PL_iEMG_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,'w_e' ), alpha = 0.75 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('ATx Group: Ankle %MEE = ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1],digits=2),' + ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2],digits=2),'(PL Contribution)',sep=''), size = 10, x =0, y = 92.5, color = met.brewer('Austria')[1] ) +
     
   #r values for Control group
     geom_text( label = paste('Control Group: Ankle %MEE = ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3],digits=2),' + ', round(fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4],digits=2),'(PL Contribution)',sep=''), size = 10, x =0, y = 87.5, color = met.brewer('Austria')[3] ) +
   
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 29.75%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 32.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 28%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Peroneus Longus Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```




```{r %MEE vs MedGas iEMG - Propulsion}

LM_Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~MedGas_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion,method='boot') # significant


RMME_Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~MedGas_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsMedGasiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~MedGas_iEMG_PropulsionPhase_Centered*Group_ID+(MedGas_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsMedGasiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~MedGas_iEMG_PropulsionPhase_Centered*Group_ID+(MedGas_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random intercept is best model. Now calculate MSE
(MSE_AnklePercentMEEvsMedGasiEMG_Propulsion <- mean( ( getME(RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)

compare(RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,RMME_Ankle_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```








```{r %MEE vs GasLat iEMG - Propulsion}

LM_Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~GasLat_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion,method='boot') # significant


RMME_Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~GasLat_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsGasLatiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~GasLat_iEMG_PropulsionPhase_Centered*Group_ID+(GasLat_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsGasLatiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~GasLat_iEMG_PropulsionPhase_Centered*Group_ID+(GasLat_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random intercept is best model. Now calculate MSE
(MSE_AnklePercentMEEvsGasLatiEMG_Propulsion <- mean( ( getME(RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_BothEffects)

compare(RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,RMME_Ankle_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```











```{r %MEE vs Sol iEMG - Propulsion}

LM_Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~Sol_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion,method='boot') # significant


RMME_Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~Sol_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsSoliEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~Sol_iEMG_PropulsionPhase_Centered*Group_ID+(Sol_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsSoliEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~Sol_iEMG_PropulsionPhase_Centered*Group_ID+(Sol_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random intercept is best model. Now calculate MSE
(MSE_AnklePercentMEEvsSoliEMG_Propulsion <- mean( ( getME(RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion_BothEffects)

compare(RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,RMME_Ankle_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```










```{r %MEE vs TA iEMG - Propulsion}

LM_Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~TA_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion)
confint(LM_Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion,method='boot') # significant


RMME_Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion_forICC)
(Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~TA_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsTAiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~TA_iEMG_PropulsionPhase_Centered*Group_ID+(TA_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklePercentvsTAiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~TA_iEMG_PropulsionPhase_Centered*Group_ID+(TA_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random intercept is best model. Now calculate MSE
(MSE_AnklePercentMEEvsTAiEMG_Propulsion <- mean( ( getME(RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion_BothEffects)

compare(RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,RMME_Ankle_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Joint_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```


### Knee %MEE

```{r %MEE vs TS Contribution - Propulsion}

LM_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion)
confint(LM_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion,method='boot') # significant


RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


summary(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_forICC)
(Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_VarExplained = (47.88^2) /( (47.88^2) + (14.17^2) ) )
#ICC = 0.92 - significant clustering

RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsTSContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(TSContributiontoPFActivity_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsTSContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(TSContributiontoPFActivity_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


( AdjustR2_KneePercentvsTSContribution_Propulsion_BothEffects <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects,'y'))) ) )*(116/(116-4-1)) )




##Both effects is best model. Now calculate MSE
(MSE_KneePercentMEEvsTSContribution_Propulsion <- mean( ( getME(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects,'y') - residuals(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects,type='response') )^2 ) )



summary(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Get mean square error
(MSE_KneePercentMEEvsTSContribution_Propulsion <- sqrt( mean( ( getME(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) ) )

summary(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)#significant

summary(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects)


compare(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly,RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_BothEffects,show.rho.functions = F)


plot( MME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( KneePercentMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee, aes( x =  TSContributiontoPFActivity_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('Both Groups: Knee %MEE = ', round(fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Knee_Percent_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(TS Contribution)'), size = 10, color = met.brewer('Austria')[1], x =0, y = 92.5 ) +
     
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 70.25%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 32.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 72.00%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +
   

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Knee Contribution to Whole-Limb MEE vs \n Group Mean-Centered Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```






```{r %MEE vs Gastrocnemii Contribution - Propulsion}

LM_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion)
confint(LM_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion,method='boot') # significant intercept, effect of group, and interaction effect. Non-significant slope for ATx group


RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


summary(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_forICC)
(Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
#Singular fit. Do not use.



summary(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Significant fixed effect intercept only

( AdjustR2_KneePercentvsGastrocContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )


summary(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly)#significant

( AdjustR2_KneePercentvsGastrocContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



summary(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_BothEffects)


( AdjustR2_KneePercentvsGastrocContribution_Propulsion_BothEffects <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_BothEffects,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_BothEffects,'y'))) ) )*(116/(116-4-1)) )


##Both effects is best model. Now calculate MSE
(MSE_KneePercentMEEvsGastrocContribution_Propulsion <- mean( ( getME(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_BothEffects,'y') - residuals(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_BothEffects,type='response') )^2 ) )


compare(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly,RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_BothEffects,show.rho.functions = F)



plot( RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_BothEffects, Participant_ID~resid(.,type='p'))

plot( RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( KneePercentMEEvsGastrocContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee, aes( x =  TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('Both Groups: Knee %MEE = ', round(fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Knee_Percent_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(TS Contribution)'), size = 10, x =0, y = 92.5 ) +
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 47.47%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 32.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 45.98%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Knee Contribution to Whole-Limb MEE vs \n Group Mean-Centered Gastrocnemii Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```





```{r %MEE vs Soleus Contribution - Propulsion}

LM_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion)
confint(LM_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion,method='boot') # significant


RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


summary(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_forICC)
(Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering



RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsSolContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(OneJointTS_Contribution2AllPF_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsSolContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(OneJointTS_Contribution2AllPF_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
#Singular fit. Do not use.



##Random intercept is best model. Now calculate MSE
(MSE_KneePercentMEEvsSolContribution_Propulsion <- mean( ( getME(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )







summary(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_BothEffects)

compare(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( KneePercentMEEvsSolContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee, aes( x =  OneJointTS_Contribution2AllPF_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly, 'w_e' ), alpha = 0.75 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
   
   
     #r values for ATx group
     geom_text( label = paste('ATx: Knee %MEE = ', round(fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(Soleus Contribution)',sep=''), size = 10, color = met.brewer('Austria')[1], x =0, y = 92.5, sep = '' ) +
   
   
   geom_text( label = paste('Control: Knee %MEE = ', round(fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3],digits=2), round(fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4],digits=2),'(Soleus Contribution)',sep=''), size = 10, x =0, y = 87.5, color = met.brewer('Austria')[3] ) +
     
   
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 22.78%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 7.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 26.02%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 2.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Knee Contribution to Whole-Limb MEE vs \n Group Mean-Centered Soleus Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```






```{r %MEE vs PL Contribution - Propulsion}

LM_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~PLContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion)
confint(LM_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion,method='boot') # significant


RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


summary(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_forICC)
(Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering



RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~PLContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsPLContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~PLContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(PLContributiontoPFActivity_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsPLContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~PLContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(PLContributiontoPFActivity_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


( AdjustR2_KneePercentvsPLContribution_Propulsion_BothEffects <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_BothEffects,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_BothEffects,'y'))) ) )*(116/(116-4-1)) )



##Both effects is best model. Now calculate MSE
(MSE_KneePercentMEEvsPLContribution_Propulsion <- mean( ( getME(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_BothEffects,'y') - residuals(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_BothEffects,type='response') )^2 ) )







summary(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_BothEffects)

compare(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( KneePercentMEEvsPLContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee, aes( x =  PLContributiontoPFActivity_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('Both Groups: Knee %MEE = ', round(fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Knee_Percent_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(TS Contribution)'), size = 10, color = met.brewer('Austria')[1], x =0, y = 92.5 ) +
     
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 22.78%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 32.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 26.02%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Knee Contribution to Whole-Limb MEE vs \n Group Mean-Centered Peroneus Longus Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```


```{r %MEE vs MedGas iEMG - Propulsion}

LM_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~MedGas_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion)
confint(LM_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion,method='boot') # significant


RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


summary(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_forICC)
(Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~MedGas_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsMedGasiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~MedGas_iEMG_PropulsionPhase_Centered*Group_ID+(MedGas_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsMedGasiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~MedGas_iEMG_PropulsionPhase_Centered*Group_ID+(MedGas_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


( AdjustR2_KneePercentvsMedGasiEMG_Propulsion_BothEffects <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects,'y'))) ) )*(116/(116-4-1)) )


##Both Effects is best model. Now calculate MSE
(MSE_KneePercentMEEvsMedGasiEMG_Propulsion <- mean( ( getME(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects,'y') - residuals(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects,type='response') )^2 ) )



summary(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly)#significant

summary(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)


compare(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects, Participant_ID~resid(.,type='p'))

plot( MME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```


```{r Plot - Propulsion Phase}



( KneePercentMEEvsMedGasiEMG_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee, aes( x =  MedGas_iEMG_PropulsionPhase_Centered, y = Joint_Percent_MEE_Generation  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[1,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[2,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[3,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[4,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[5,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[6,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[7,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[8,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[9,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[10,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[11,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[12,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[3]+ranef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)$Participant_ID[13,1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2], linewidth = 4, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[3], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[4], linewidth = 4, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[3], slope = fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('ATx: Knee %MEE = ', round(fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1],digits=2), ' + ', round(fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2],digits=2),'(Medial Gastroc iEMG)'), size = 10, color = met.brewer('Austria')[1], x =0, y = 92.5 ) +
   
   #r values for Control group
     geom_text( label = paste('Control: Knee %MEE = ', round(fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[1]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[3],digits=2), ' + ', round(fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[2]+fixef(RMME_Knee_Percent_MEE_GenerationvsMedGasiEMG_Propulsion_BothEffects)[4],digits=2),'(Medial Gastroc iEMG)'), size = 10, color = met.brewer('Austria')[3], x =0, y = 77.5 ) +
     
     
     geom_text( label = 'Mean Medial Gastroc iEMG = 6.89%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 87.5 ) +
     
      geom_text( label = 'Mean Medial Gastroc iEMG = 5.83%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 72.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-10,10,by=2),limits=c(-10,10) )+
     
     
     
     labs(title='Knee Contribution to Whole-Limb MEE vs \n Group Mean-Centered Medial Gastrocnemius Integrated EMG \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Integrated EMG (%Maximum Height Single Leg Vertical Jump) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```





```{r %MEE vs GasLat iEMG - Propulsion}

LM_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~GasLat_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion)
confint(LM_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion,method='boot') # significant


RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


summary(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_forICC)
(Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~GasLat_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsGasLatiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~GasLat_iEMG_PropulsionPhase_Centered*Group_ID+(GasLat_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsGasLatiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~GasLat_iEMG_PropulsionPhase_Centered*Group_ID+(GasLat_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsGasLatiEMG_Propulsion_BothEffects <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_BothEffects,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_BothEffects,'y'))) ) )*(116/(116-4-1)) )




##Both Effects is best model. Now calculate MSE
(MSE_KneePercentMEEvsGasLatiEMG_Propulsion <- mean( ( getME(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_BothEffects,'y') - residuals(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_BothEffects,type='response') )^2 ) )



summary(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_BothEffects)

compare(RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,RMME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Knee_Percent_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```











```{r %MEE vs Sol iEMG - Propulsion}

LM_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~Sol_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion)
confint(LM_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion,method='boot') # significant


RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


summary(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_forICC)
(Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~Sol_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsSoliEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~Sol_iEMG_PropulsionPhase_Centered*Group_ID+(Sol_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsSoliEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~Sol_iEMG_PropulsionPhase_Centered*Group_ID+(Sol_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
#Singular fit. Do not use





##Random intercept is best model. Now calculate MSE
(MSE_KneePercentMEEvsSoliEMG_Propulsion <- mean( ( getME(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_BothEffects)

compare(RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,RMME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Knee_Percent_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```






```{r %MEE vs PL iEMG - Propulsion}

LM_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~PL_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion)
confint(LM_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion,method='boot') # significant


RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


summary(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_forICC)
(Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~PL_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsPLiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~PL_iEMG_PropulsionPhase_Centered*Group_ID+(PL_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsPLiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~PL_iEMG_PropulsionPhase_Centered*Group_ID+(PL_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsPLiEMG_Propulsion_BothEffects <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_BothEffects,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_BothEffects,'y'))) ) )*(116/(116-4-1)) )




##Both effects is best model. Now calculate MSE
(MSE_KneePercentMEEvsPLiEMG_Propulsion <- mean( ( getME(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_BothEffects,'y') - residuals(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_BothEffects,type='response') )^2 ) )



summary(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_BothEffects)

compare(RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,RMME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Knee_Percent_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r %MEE vs TA iEMG - Propulsion}

LM_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion <- lm(formula=Joint_Percent_MEE_Generation~TA_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
summary(LM_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion)
confint(LM_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion,method='boot') # significant


RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_forICC <- rlmer(Joint_Percent_MEE_Generation~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)


summary(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_forICC)
(Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Percent_MEE_Generation~TA_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsTAiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Percent_MEE_Generation~TA_iEMG_PropulsionPhase_Centered*Group_ID+(TA_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)

( AdjustR2_KneePercentvsTAiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_BothEffects <- rlmer(Joint_Percent_MEE_Generation~TA_iEMG_PropulsionPhase_Centered*Group_ID+(TA_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlKnee)
#singular fit. do not use




##Random intercept is best model. Now calculate MSE
(MSE_KneePercentMEEvsTAiEMG_Propulsion <- mean( ( getME(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_BothEffects)

compare(RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,RMME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Knee_Percent_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



### Ankle MEE

```{r MEE vs PF Activation Ratio (Hop:SLVJ) - Propulsion}

#Regular multiple linear regression
LM_Ankle_Generation_MEEvsPFActivationRatio_Propulsion <- lm(formula=Joint_Generation_MEE~PFActivationRatio_HopvsMSLVJ_PropulsionPhase*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsPFActivationRatio_Propulsion)
confint(LM_Ankle_Generation_MEEvsPFActivationRatio_Propulsion,method='boot') # significant intercept only



#Create robust mixed effects model for assessing ICC - check whether we need random effects at all
RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

#Use summary to obtain variances for random intercept and residual
summary(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_forICC)

#Calculate ICC
(Ankle_Generation_MEEvsPFActivationRatio_Propulsion_VarExplained = (0.007057^2) /( (0.007057^2) + (0.002514^2) ) )
#ICC = 0.88 - significant clustering





RMME_Ankle_MEE_GenerationvsPFActivationRatio_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~PFActivationRatio_HopvsMSLVJ_PropulsionPhase*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsPFActivationRatio_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsPFActivationRatio_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsPFActivationRatio_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )





RMME_Ankle_MEE_GenerationvsPFActivationRatio_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~PFActivationRatio_HopvsMSLVJ_PropulsionPhase*Group_ID+(PFActivationRatio_HopvsMSLVJ_PropulsionPhase-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


( AdjustR2_AnklevsPFActivationRatio_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsPFActivationRatio_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsPFActivationRatio_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~PFActivationRatio_HopvsMSLVJ_PropulsionPhase*Group_ID+(PFActivationRatio_HopvsMSLVJ_PropulsionPhase|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.

( AdjustR2_AnklevsPFActivationRatio_Propulsion_BothEffects <- (1 - ( var(residuals(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects,type='response' )) / (var(getME(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects,'y'))) ) )*(116/(116-4-1)) )




##Both effects is best model. Now calculate MSE
(MSE_AnkleMEEvsPFActivationRatio_Propulsion <- mean( ( getME(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects,'y') - residuals(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsPFActivationRatio_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance

summary(RMME_Ankle_MEE_GenerationvsPFActivationRatio_Propulsion_RandomSlopeOnly)#significant

summary(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)





plot( RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects, Participant_ID~resid(.,type='p'))

plot( RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnkleMEEvsPFActivationRatio_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  PFActivationRatio_HopvsMSLVJ_PropulsionPhase, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects,'w_e' ), alpha = 0.75  ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[1,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[2,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[3,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[4,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[5,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[6,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[3]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[7,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[3]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[8,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[3]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[9,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[3]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[10,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[3]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[11,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[3]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[12,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[3]+ranef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)$Participant_ID[13,1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2], linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[3], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[4], linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[3], slope = fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[4], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('ATx: Ankle MEE = ', round(fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1],digits=2), ' + ', round(fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2],digits=2),'(PF Activation Ratio)',sep=''), size = 10, color = met.brewer('Austria')[1], x =0.25, y = 0.375 ) +
   

   #r values for Control group
     geom_text( label = paste('Control: Ankle MEE = ', round(fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[1]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[3],digits=2),' + ', round(fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[2]+fixef(RMME_Ankle_Generation_MEEvsPFActivationRatio_Propulsion_BothEffects)[4],digits=2),'(PF Activation Ratio)',sep=''), size = 10, color = met.brewer('Austria')[3], x =0.25, y = 0.225 ) +
     
     
     geom_text( label = 'Mean PF Activation Ratio  = 0.20', size = 10, color = met.brewer('Austria')[1], x = 0.25, y = 0.325 ) +
     
      geom_text( label = 'Mean PF Activation Ratio = 0.19', size = 10, color = met.brewer('Austria')[3], x = 0.25, y = 0.175 ) +
   

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(0,0.50,by=0.10),limits=c(0,0.50) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs \n PF Activation Ratio \n Propulsion Phase',x='PF Activation Ratio \n(Total Activation During Hopping/Total Activation During SLVJ)', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



```{r MEE vs TS Activation - Propulsion}


LM_Ankle_Generation_MEEvsTSActivation_Propulsion <- lm(formula=Joint_Generation_MEE~TotalTSActivation_PropulsionPhase*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsTSActivation_Propulsion)
confint(LM_Ankle_Generation_MEEvsTSActivation_Propulsion,method='boot') # significant

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to ATx07
ATx07rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx07' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to ATx10
ATx10rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx10' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to ATx17
ATx17rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx17' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to ATx18
ATx18rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx18' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to ATx19
ATx19rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx19' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to ATx21
ATx21rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx21' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to HC01
HC01rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HC01' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to HC05
HC05rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HC05' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to HC06
HC06rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HC06' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to HC12
HC12rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HC12' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to HP02
HP02rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HP02' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to HP08
HP08rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HP08' )

##Find all rows in Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle belonging to HP09
HP09rows <- which( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HP09' )


ATx07ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ ATx07rows ]^2

ATx10ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ ATx10rows ]^2

ATx17ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ ATx17rows ]^2

ATx18ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ ATx18rows ]^2

ATx19ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ ATx19rows ]^2

ATx21ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ ATx21rows ]^2

HC01ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ HC01rows ]^2

HC05ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ HC05rows ]^2

HC06ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ HC06rows ]^2

HC12ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ HC12rows ]^2

HP02ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ HP02rows ]^2

HP08ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ HP08rows ]^2

HP09ResidualVariance <- LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals[ HP09rows ]^2


Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights <- 1/mean(ATx07ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx10' ) ] <- 1/mean(ATx10ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx17' ) ] <- 1/mean(ATx17ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx18' ) ] <- 1/mean(ATx18ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx19' ) ] <- 1/mean(ATx19ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'ATx21' ) ] <- 1/mean(ATx21ResidualVariance)




Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HC01' ) ] <- 1/mean(HC01ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HC05' ) ] <- 1/mean(HC05ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HC06' ) ] <- 1/mean(HC06ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HC12' ) ] <- 1/mean(HC12ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HP02' ) ] <- 1/mean(HP02ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HP08' ) ] <- 1/mean(HP08ResidualVariance)

Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Weights[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == 'HP09' ) ] <- 1/mean(HP09ResidualVariance)


RLM_Ankle_Generation_MEEvsTSActivation_Propulsion <- rlm(formula=Mean_Joint_Generation_MEE~Mean_TotalTSActivation_PropulsionPhase*Group_ID,data=Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,weights=Weights)
summary(RLM_Ankle_Generation_MEEvsTSActivation_Propulsion)
confint(RLM_Ankle_Generation_MEEvsTSActivation_Propulsion,method='boot')


LM_Ankle_Generation_MEEvsTSActivation_Propulsion <- rlm(formula=Mean_Joint_Generation_MEE~Mean_TotalTSActivation_PropulsionPhase*Group_ID,data=Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle)


RLM_Ankle_Generation_MEEvsTSActivation_Propulsion <- lm(formula=Mean_Joint_Generation_MEE~Mean_TotalTSActivation_PropulsionPhase*Group_ID,data=Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle,weights=1/(LM_Ankle_Generation_MEEvsTSActivation_Propulsion$residuals^2) )
summary(RLM_Ankle_Generation_MEEvsTSActivation_Propulsion)
confint(RLM_Ankle_Generation_MEEvsTSActivation_Propulsion,method='boot')


plot(RLM_Ankle_Generation_MEEvsTSActivation_Propulsion)




RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_forICC)
(Ankle_Generation_MEEvsTSActivation_Propulsion_VarExplained = (0.007057^2) /( (0.007057^2) + (0.002514^2) ) )
#ICC = 0.88 - significant clustering

RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly <- rlmer( Joint_Generation_MEE~TotalTSActivation_PropulsionPhase*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsTSActivation_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )





RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~TotalTSActivation_PropulsionPhase*Group_ID+(TotalTSActivation_PropulsionPhase-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


( AdjustR2_AnklevsTSActivation_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~TotalTSActivation_PropulsionPhase*Group_ID+(TotalTSActivation_PropulsionPhase|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.



##Random intercept is best model. Now calculate MSE
(MSE_AnkleMEEvsTSActivation_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance

summary(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_BothEffects)





plot( RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_RandomInterceptOnly,abline=c(0,1))

```




```{r Plot - Propulsion Phase}



( AnkleMEEvsTSActivation_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  TotalTSActivation_PropulsionPhase, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Participant_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,'w_e' ), alpha = 0.75  ) +



#Regression line for ATx07
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0, slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0, slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2, slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2, slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
   
     #r values for ATx group
     geom_text( label = paste('ATx: Ankle MEE = ', round(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0,digits=2), ' ', round(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1,digits=4),'(TS Activation)',sep=''), size = 10, color = met.brewer('Austria')[1], x =20, y = 0.375 ) +
   

   
   #r values for Control group
     geom_text( label = paste('Control: Ankle MEE = ', round(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2,digits=2), ' ', round(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3,digits=4),'(TS Activation)',sep=''), size = 10, color = met.brewer('Austria')[3], x =20, y = 0.175 ) +
     
     
   
     geom_text( label = 'Mean TS Activation = 21.9 %Single Leg Vertical Jump*sec', size = 10, color = met.brewer('Austria')[1], x = 20, y = 0.325 ) +
   
   geom_text( label = 'Mean Ankle MEE = 0.63 J/kg', size = 10, color = met.brewer('Austria')[1], x = 20, y = 0.275 ) +
   
     
      geom_text( label = 'Mean TS Activation = 17.8 %Single Leg Vertical Jump*sec', size = 10, color = met.brewer('Austria')[3], x = 20, y = 0.125 ) +
   
   geom_text( label = 'Mean Ankle MEE = 0.71 J/kg', size = 10, color = met.brewer('Austria')[3], x = 20, y = 0.075 ) +
   

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(0,40,by=5),limits=c(0,40) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs \n Total Triceps Surae Activation \n Propulsion Phase',x='Total Triceps Surae Activation (%Single Leg Vertical Jump*sec)', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



```{r Plot - Participant Means Propulsion Phase}



( AnkleMEEvsTSActivation_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Mean_TotalTSActivation_PropulsionPhase, y = Mean_Joint_Generation_MEE  ) ) +
     




#Regression line for ATx07
         geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0, slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 10, color = 'yellow' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0, slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1, linewidth = 9, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2, slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 10, color = 'orange' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2, slope = FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3, linewidth = 9, color = met.brewer('Austria')[3] ) +
   
   
         geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 10.5, stroke = 4.5) +
   
   
   
     #r values for ATx group
     geom_text( label = paste('ATx: Ankle MEE = ', round(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0,digits=2), ' - ', abs(round(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1,digits=4)),'(TS Activation)',sep=''), size = 15, color = met.brewer('Austria')[1], x =20, y = 0.375, fontface = 'bold' ) +
   

   
   #r values for Control group
     geom_text( label = paste('Control: Ankle MEE = ', round(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2,digits=2), ' - ', abs(round(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1+FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3,digits=4)),'(TS Activation)',sep=''), size = 15, color = met.brewer('Austria')[3], x =20, y = 0.175, fontface = 'bold' ) +
     
     
   
     geom_text( label = 'Mean TS Activation = 21.9 %Single Leg Vertical Jump*sec', size = 15, color = met.brewer('Austria')[1], x = 20, y = 0.325, fontface = 'bold' ) +
   
   geom_text( label = 'Mean Ankle MEE = 0.63 J/kg', size = 15, color = met.brewer('Austria')[1], x = 20, y = 0.275, fontface = 'bold' ) +
   
     
      geom_text( label = 'Mean TS Activation = 17.8 %Single Leg Vertical Jump*sec', size = 15, color = met.brewer('Austria')[3], x = 20, y = 0.125, fontface = 'bold' ) +
   
   geom_text( label = 'Mean Ankle MEE = 0.71 J/kg', size = 15, color = met.brewer('Austria')[3], x = 20, y = 0.075, fontface = 'bold' ) +
   

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(0,40,by=5),limits=c(0,40) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs Total Triceps Surae Activation \n Propulsion Phase',x='Total Triceps Surae Activation (%Single Leg Vertical Jump*sec)', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```




```{r Bootstrap Function}

#Set number of iterations for bootstrap
iter <- 1000

BootStrapDataFrame <- data.frame( Iteration = 1:1000, FixedBeta0 = rep( 0, iter ), FixedBeta1 = rep( 0, iter ), FixedBeta2 = rep( 0, iter ), FixedBeta3 = rep( 0, iter ), RandomEffect1  = rep( 0, iter ),  RandomEffect2  = rep( 0, iter ), RandomEffect3  = rep( 0, iter ), RandomEffect4  = rep( 0, iter ), RandomEffect5  = rep( 0, iter ), RandomEffect6  = rep( 0, iter ), RandomEffect7  = rep( 0, iter ), RandomEffect8  = rep( 0, iter ), RandomEffect9  = rep( 0, iter ), RandomEffect10  = rep( 0, iter ), RandomEffect11  = rep( 0, iter ), RandomEffect12  = rep( 0, iter ), RandomEffect13  = rep( 0, iter ),RMSE = rep( 0, iter )  )


UniqueParticipantID <- unique( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID )
NumberofParticipants <- length( UniqueParticipantID )
UniqueATxID <- unique( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Participant_ID )
NumberofATxParticipants <- length( UniqueATxID )
UniqueControlID <- unique( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Participant_ID )
NumberofControlParticipants <- length( UniqueControlID )

for (j in 1 : 1000) {
   

   
   ATxRandomSample <- sample( NumberofATxParticipants, 6, replace = T )
   ATxRandomSample_Names <- UniqueATxID[ ATxRandomSample ]
   ControlRandomSample <- sample( NumberofControlParticipants, 7, replace = T )
   ControlRandomSample_Names <- UniqueControlID[ ControlRandomSample ]
   AllNames <- c( ATxRandomSample_Names, ControlRandomSample_Names )
   NumberofParticipants <- 13
   
   IterationDataFrame <- data.frame( Participant_ID = c( ATxRandomSample_Names, ControlRandomSample_Names ) )
   IterationDataFrame$Group_ID <- rep( 'ATx', 13)
   
   IterationDataFrame$Mean_TotalTSActivation_PropulsionPhase <- rep( 0, 13)
   
   IterationDataFrame$Mean_Joint_Generation_MEE <- rep( 0, 13)
   
   
   for ( k in 1 : NumberofParticipants ) {
      
      IterationDataFrame$Group_ID[ k ] <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Group_ID[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == AllNames[ k ] ) ]
      
      IterationDataFrame$Mean_TotalTSActivation_PropulsionPhase[ k ] <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_TotalTSActivation_PropulsionPhase[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == AllNames[ k ] ) ]
      
      IterationDataFrame$Mean_Joint_Generation_MEE[ k ] <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Mean_Joint_Generation_MEE[ which( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID == AllNames[ k ] ) ]
      
      
   }
   
   
   BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly <- rlmer( Mean_Joint_Generation_MEE~Mean_TotalTSActivation_PropulsionPhase*Group_ID+(1|Participant_ID), data = IterationDataFrame, max.iter=100000, rel.tol = 10 )

   ATxResiduals <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Generation_MEE - ( fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[1] + ( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_TotalTSActivation_PropulsionPhase * fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[2] ) )
   
   ControlResiduals <- Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Generation_MEE - ( ( fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[1] + fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[3] ) + ( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_TotalTSActivation_PropulsionPhase * ( fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[2] + fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[4]  ) ) )

   
   
   #Calculate MSE
   BootStrapDataFrame$RMSE[ j ] <- mean( c( ATxResiduals^2, ControlResiduals^2 ) )
   
   BootStrapDataFrame$FixedBeta0[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[1]
   
   BootStrapDataFrame$FixedBeta1[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[2]
   
   BootStrapDataFrame$FixedBeta2[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[3]
   
   BootStrapDataFrame$FixedBeta3[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[4]
   
   BootStrapDataFrame$RandomEffect1[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[1,1]

   BootStrapDataFrame$RandomEffect2[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[2,1]
   
   BootStrapDataFrame$RandomEffect3[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[3,1]
   
   BootStrapDataFrame$RandomEffect4[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[4,1]
   
   BootStrapDataFrame$RandomEffect5[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[5,1]
   
   BootStrapDataFrame$RandomEffect6[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[6,1]
   
   BootStrapDataFrame$RandomEffect7[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[7,1]
   
   BootStrapDataFrame$RandomEffect8[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[8,1]
   
   BootStrapDataFrame$RandomEffect9[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[9,1]
   
   BootStrapDataFrame$RandomEffect10[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[10,1]
   
   BootStrapDataFrame$RandomEffect11[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[11,1]
   
   BootStrapDataFrame$RandomEffect12[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[12,1]
   
   BootStrapDataFrame$RandomEffect13[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[13,1]
   
}


min( BootStrapDataFrame$RMSE[1:40] )

FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly <- BootStrapDataFrame %>% filter( RMSE == min( BootStrapDataFrame$RMSE[1:40] ) )


B0_SE <- sqrt( (1/(40-1) )*sum( ( BootStrapDataFrame$FixedBeta0[1:40] - mean(BootStrapDataFrame$FixedBeta0[1:40] ) )^2 ) )
( B0_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0 - 2*B0_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0 + 2*B0_SE) )

B1_SE <- sqrt( (1/(40-1) )*sum( ( BootStrapDataFrame$FixedBeta1[1:40] - mean(BootStrapDataFrame$FixedBeta1[1:40] ) )^2 ) )
( B1_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1 - 2*B1_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1 + 2*B1_SE) )

B2_SE <- sqrt( (1/(40-1) )*sum( ( BootStrapDataFrame$FixedBeta2[1:40] - mean(BootStrapDataFrame$FixedBeta2[1:40] ) )^2 ) )
( B2_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2 - 2*B2_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2 + 2*B2_SE) )

B3_SE <- sqrt( (1/(40-1) )*sum( ( BootStrapDataFrame$FixedBeta3[1:40] - mean(BootStrapDataFrame$FixedBeta3[1:40] ) )^2 ) )
( B3_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3 - 2*B3_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3 + 2*B3_SE) )

```



```{r Bootstrap Function}

#Set number of iterations for bootstrap
iter <- 1000

BootStrapDataFrame_IndividualHops <- data.frame( Iteration = 1:1000, FixedBeta0 = rep( 0, iter ), FixedBeta1 = rep( 0, iter ), FixedBeta2 = rep( 0, iter ), FixedBeta3 = rep( 0, iter ), RandomEffect1  = rep( 0, iter ),  RandomEffect2  = rep( 0, iter ), RandomEffect3  = rep( 0, iter ), RandomEffect4  = rep( 0, iter ), RandomEffect5  = rep( 0, iter ), RandomEffect6  = rep( 0, iter ), RandomEffect7  = rep( 0, iter ), RandomEffect8  = rep( 0, iter ), RandomEffect9  = rep( 0, iter ), RandomEffect10  = rep( 0, iter ), RandomEffect11  = rep( 0, iter ), RandomEffect12  = rep( 0, iter ), RandomEffect13  = rep( 0, iter ),RMSE = rep( 0, iter )  )


UniqueParticipantID <- unique( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID )
NumberofParticipants <- length( UniqueParticipantID )
UniqueATxID <- unique( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Participant_ID )
NumberofATxParticipants <- length( UniqueATxID )
NumberofATxRows <- dim( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedAnkle )[1]
                           
UniqueControlID <- unique( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Participant_ID )
NumberofControlParticipants <- length( UniqueControlID )
NumberofControlRows <- dim( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_ControlAnkle )[1]




for (j in 1 : 1000) {
   

   
   ATxRandomSample <- sample( NumberofATxRows, 60, replace = T )
   ATxRandomSample_Names <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID[ ATxRandomSample ]
   ControlRandomSample <- sample( NumberofControlRows, 70, replace = T ) + NumberofATxRows
   ControlRandomSample_Names <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID[ ATxRandomSample ][ ControlRandomSample ]
   AllNames <- c( ATxRandomSample_Names, ControlRandomSample_Names )
   AllSamplePointsforBootstrap <- c( ATxRandomSample, ControlRandomSample )
   NumberofDataPoints <- 130
   
   
   IterationDataFrame <- data.frame( Participant_ID = c( ATxRandomSample_Names, ControlRandomSample_Names ) )
   IterationDataFrame$Group_ID <- rep( 'ATx', NumberofDataPoints)
   
   IterationDataFrame$Mean_TotalTSActivation_PropulsionPhase <- rep( 0, NumberofDataPoints)
   
   IterationDataFrame$Mean_Joint_Generation_MEE <- rep( 0, NumberofDataPoints)
   
   
   for ( k in 1 : NumberofDataPoints ) {
      
      IterationDataFrame$Participant_ID[ k ] <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID[ AllSamplePointsforBootstrap[ k ] ]
   
      
      IterationDataFrame$Group_ID[ k ] <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Group_ID[ AllSamplePointsforBootstrap[ k ] ]
      
      IterationDataFrame$Mean_TotalTSActivation_PropulsionPhase[ k ] <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$TotalTSActivation_PropulsionPhase[ AllSamplePointsforBootstrap[ k ] ]
      
      IterationDataFrame$Mean_Joint_Generation_MEE[ k ] <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Joint_Generation_MEE[ AllSamplePointsforBootstrap[ k ] ]
      
      
   }
   
   
   BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly <- rlmer( Mean_Joint_Generation_MEE~Mean_TotalTSActivation_PropulsionPhase*Group_ID+(1|Participant_ID), data = IterationDataFrame )

   ATxResiduals <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Generation_MEE - ( fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[1] + ( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_TotalTSActivation_PropulsionPhase * fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[2] ) )
   
   ControlResiduals <- Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Generation_MEE - ( ( fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[1] + fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[3] ) + ( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_TotalTSActivation_PropulsionPhase * ( fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[2] + fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[4]  ) ) )

   
   
   #Calculate MSE
   BootStrapDataFrame_IndividualHops$RMSE[ j ] <- mean( c( ATxResiduals^2, ControlResiduals^2 ) )
   
   BootStrapDataFrame_IndividualHops$FixedBeta0[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[1]
   
   BootStrapDataFrame_IndividualHops$FixedBeta1[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[2]
   
   BootStrapDataFrame_IndividualHops$FixedBeta2[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[3]
   
   BootStrapDataFrame_IndividualHops$FixedBeta3[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly )[4]
   
   BootStrapDataFrame_IndividualHops$RandomEffect1[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[1,1]

   BootStrapDataFrame_IndividualHops$RandomEffect2[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[2,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect3[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[3,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect4[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[4,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect5[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[5,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect6[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[6,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect7[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[7,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect8[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[8,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect9[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[9,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect10[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[10,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect11[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[11,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect12[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[12,1]
   
   BootStrapDataFrame_IndividualHops$RandomEffect13[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[13,1]
   
}


min( BootStrapDataFrame_IndividualHops$RMSE )

FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly <- BootStrapDataFrame_IndividualHops %>% filter( RMSE == min( BootStrapDataFrame_IndividualHops$RMSE ) )


B0_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_IndividualHops$FixedBeta0 - mean(BootStrapDataFrame_IndividualHops$FixedBeta0 ) )^2 ) )
( B0_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0 - 2*B0_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0 + 2*B0_SE) )

B1_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_IndividualHops$FixedBeta1 - mean(BootStrapDataFrame_IndividualHops$FixedBeta1 ) )^2 ) )
( B1_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1 - 2*B1_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1 + 2*B1_SE) )

B2_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_IndividualHops$FixedBeta2 - mean(BootStrapDataFrame_IndividualHops$FixedBeta2 ) )^2 ) )
( B2_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2 - 2*B2_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2 + 2*B2_SE) )

B3_SE <- sqrt( (1/(iter-1) )*sum( ( BootStrapDataFrame_IndividualHops$FixedBeta3 - mean(BootStrapDataFrame_IndividualHops$FixedBeta3 ) )^2 ) )
( B3_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3 - 2*B3_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3 + 2*B3_SE) )

```


```{r Control MEE vs TS Activation - Propulsion}

LM_Ankle_Generation_MEEvsTSActivation_Propulsion <- lm(formula=Joint_Generation_MEE~TotalTSActivation_PropulsionPhase,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_ControlAnkle)
summary(LM_Ankle_Generation_MEEvsTSActivation_Propulsion)
confint(LM_Ankle_Generation_MEEvsTSActivation_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_ControlAnkle)


summary(RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_forICC)
(Ankle_Generation_MEEvsTSActivation_Propulsion_VarExplained = (0.007834^2) /( (0.007834^2) + (0.002119^2) ) )
#ICC = 0.93 - significant clustering

RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly <- rlmer( Joint_Generation_MEE~TotalTSActivation_PropulsionPhase+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_ControlAnkle)

( AdjustR2_AnklevsTSActivation_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )





RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly <- rlmer( Joint_Generation_MEE~TotalTSActivation_PropulsionPhase+(TotalTSActivation_PropulsionPhase-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_ControlAnkle)


( AdjustR2_AnklevsTSActivation_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~TotalTSActivation_PropulsionPhase+(TotalTSActivation_PropulsionPhase|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_ControlAnkle)
#Failed to converge



##Random slope is best model. Now calculate MSE
(MSE_AnkleMEEvsTSActivation_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance

summary(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_BothEffects)





plot( RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsTSActivation_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )


df <- data.frame(y = residuals( RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly ) )

( ggplot( df, aes( sample = y ) ) + stat_qq() + stat_qq_line() )


```



```{r Plot - Propulsion Phase}



( AnkleMEEvsTSActivation_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_ControlAnkle, aes( x =  TotalTSActivation_PropulsionPhase, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Participant_ID, group = Participant_ID, shape = 'Open Circle' ), color = 'white', size = 10*getME( RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly,'w_e' ) ) +

      


   
# #Regression line for ATx07
#       geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
#    
# #Regression line for ATx10
#       geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
#    
#    
# #Regression line for ATx17
#       geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
#    
#    
# #Regression line for ATx18
#       geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
#    
#    
# #Regression line for ATx19
#       geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
#    
#    
# #Regression line for ATx21
#       geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( aes( color = 'HC01', intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], 
                  slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[1,1] ), 
                  linewidth = 2.5, show.legend =F ) +      
   
   
   
#Regression line for HC05
     geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], 
                  slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[2,1], color = 'HC05'),
                  linewidth = 2.5, show.legend =F ) +      
   
   
   
#Regression line for HC06
     geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], 
                  slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[3,1], color = 'HC06' ), 
                  linewidth =2.5, show.legend =F) +      
   
   
   
#Regression line for HC12
     geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], 
                  slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[4,1], color = 'HC12' ),
                  linewidth = 2.5, show.legend =F ) +      
   
   
   
#Regression line for HP02
     geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], 
                  slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[5,1], color = 'HP02' ),
                  linewidth = 2.5, show.legend =F ) +      
   
   
   
#Regression line for HP08
     geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], 
                  slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[6,1], color = 'HP08' ),
                  linewidth = 2.5, show.legend =F ) +      
   
   
   
#Regression line for HP09
     geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], 
                  slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)$Participant_ID[7,1], color = 'HP09' ),
                  linewidth = 2.5, show.legend =F ) +
   
   
   # #Regression line for ATx Group
   #    geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2], linewidth = 6, color = 'black' ) +
   # 
   # #Regression line for ATx Group
   #    geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], 
                  slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2], 
                  linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1], 
                  slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
   
     # #r values for ATx group
     # geom_text( label = paste('ATx: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1],digits=2), ' + ', round(fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2],digits=2),'(TS Activation)',sep=''), size = 10, color = met.brewer('Austria')[1], x =20, y = 0.375 ) +
   

   
   #r values for Control group
     geom_text( label = paste('Control: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[1],digits=2), ' + ', round(fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)[2],digits=5),'(TS Activation)',sep=''), size = 10, color = met.brewer('Austria')[3], x =20, y = 0.375 ) +
     
     
   
     # geom_text( label = 'Mean TS Activation = 21.9', size = 10, color = met.brewer('Austria')[1], x = 20, y = 0.325 ) +
     
      geom_text( label = 'Mean TS Activation = 17.8', size = 10, color = met.brewer('Austria')[3], x = 20, y = 0.325 ) +
   

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(0,40,by=5),limits=c(0,40) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs Total Triceps Surae Activation \n Control Group, Propulsion Phase',x='Total TS Activation (%Single Leg Vertical Jump*sec)', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1],'ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('color'),labels=c('ATx Group Mean', 'Control Group Mean', 'ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
   
   
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('HC01','HC12','HC06','HC05','HP02','HP08','HP09' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill=guide_legend(nrow=2,override.aes = list(size=7 ,color = c(met.brewer('Redon')[1], 
                                    met.brewer('Redon')[2],
                                   met.brewer('Redon')[3],
           met.brewer('Redon')[7],
           met.brewer('Redon')[8],met.brewer('Redon')[9],
           met.brewer('Redon')[10]) ) ),size='none',shape='none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```




```{r ATx MEE vs TS Activation - Propulsion}

LM_Ankle_Generation_MEEvsTSActivation_Propulsion <- lm(formula=Joint_Generation_MEE~TotalTSActivation_PropulsionPhase,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedAnkle)
summary(LM_Ankle_Generation_MEEvsTSActivation_Propulsion)
confint(LM_Ankle_Generation_MEEvsTSActivation_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedAnkle)


summary(RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_forICC)
(Ankle_Generation_MEEvsTSActivation_Propulsion_VarExplained = (0.008152^2) /( (0.008152^2) + (0.003020^2) ) )
#ICC = 0.88 - significant clustering


RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly <- rlmer( Joint_Generation_MEE~TotalTSActivation_PropulsionPhase+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedAnkle)

( AdjustR2_AnklevsTSActivation_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )





RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly <- rlmer( Joint_Generation_MEE~TotalTSActivation_PropulsionPhase+(TotalTSActivation_PropulsionPhase-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedAnkle)


( AdjustR2_AnklevsTSActivation_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~TotalTSActivation_PropulsionPhase+(TotalTSActivation_PropulsionPhase|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedAnkle)
#Singular fit. Don't use



##Random slope is best model. Now calculate MSE
(MSE_AnkleMEEvsTSActivation_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance

summary(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsTSActivation_Propulsion_BothEffects)





plot( RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsTSActivation_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )


df <- data.frame(y = residuals( RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly ) )

( ggplot( df, aes( sample = y ) ) + stat_qq() + stat_qq_line() )


```



```{r Plot - Propulsion Phase}



( AnkleMEEvsTSActivation_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedAnkle, aes( x =  TotalTSActivation_PropulsionPhase, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Participant_ID, group = Participant_ID, shape = 'Open Circle' ), color = 'white', size = 10*getME( RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly,'w_e' ) ) +

      


   
#Regression line for ATx07
      geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], 
                   slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[2], color = 'ATx07' ), linewidth = 3.5 ) +

   
#Regression line for ATx10
      geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], 
                   slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[2], color = 'ATx10' ), linewidth = 2.5 ) +


#Regression line for ATx17
      geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], 
                   slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[2], color = 'ATx17' ), linewidth = 2.5) +


#Regression line for ATx18
      geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], 
                   slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[2], color = 'ATx18' ), linewidth = 2.5) +


#Regression line for ATx19
      geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], 
                   slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[2], color = 'ATx19' ), linewidth = 2.5) +


#Regression line for ATx21
      geom_abline( aes( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], 
                   slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[2], color = 'ATx21' ), linewidth = 2.5 ) +
   
   
   

   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[2], linewidth = 6, color = 'black' ) +

   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   

   
   
   
     #r values for ATx group
     geom_text( label = paste('ATx: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[1],digits=2), ' + ', round(fixef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)[2],digits=5),'(TS Activation)',sep=''), size = 10, color = met.brewer('Austria')[1], x =20, y = 0.375 ) +


     
     
   
     geom_text( label = 'Mean TS Activation = 21.9', size = 10, color = met.brewer('Austria')[1], x = 20, y = 0.325 ) +


     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(0,40,by=5),limits=c(0,40) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs \n Total Triceps Surae Activation \n ATx Group, Propulsion Phase',x='Total TS Activation (%Single Leg Vertical Jump*sec)', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1],'ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('color'),labels=c('ATx Group Mean', 'Control Group Mean', 'ATx07','HC01','ATx10','HC12','ATx17','HC06','ATx18','ATx19','ATx21','HC05','HP02','HP08','HP09' ) ) +
   
   
   
        scale_fill_manual(values = c('ATx07'=met.brewer('Redon')[1], 'HC01' = met.brewer('Redon')[1], 
                                   'ATx10'=met.brewer('Redon')[2], 'HC12'=met.brewer('Redon')[2],
                                   'ATx17'=met.brewer('Redon')[3],'HC06'=met.brewer('Redon')[3],
           'ATx18'=met.brewer('Redon')[4],'ATx19'=met.brewer('Redon')[5],
           'ATx21'=met.brewer('Redon')[6],                                           'HC11'=met.brewer('Redon')[6],'HC05'=met.brewer('Redon')[7],
           'HP02'=met.brewer('Redon')[8],'HP08'=met.brewer('Redon')[9],
           'HP09'=met.brewer('Redon')[10]),
                         name = 'Participant ID',aesthetics=c('fill'),labels=c('ATx07','ATx10','ATx17','ATx18','ATx19','ATx21') ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill=guide_legend(nrow=2,override.aes = list(size=5 ,color = c(met.brewer('Redon')[1], 
                                    met.brewer('Redon')[2],
                                   met.brewer('Redon')[3],
           met.brewer('Redon')[4],
           met.brewer('Redon')[5],met.brewer('Redon')[6]) ) ),size='none',shape='none' )+
      
   
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



```{r MEE vs TS Contribution - Propulsion}

Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$TSContributiontoPFActivity_PropulsionPhase_Centered

LM_Ankle_Generation_MEEvsTSContribution_Propulsion <- lm(formula=Joint_Generation_MEE~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsTSContribution_Propulsion)
confint(LM_Ankle_Generation_MEEvsTSContribution_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsTSContribution_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsTSContribution_Propulsion_forICC)
(Ankle_Generation_MEEvsTSContribution_Propulsion_VarExplained = (0.007057^2) /( (0.007057^2) + (0.002514^2) ) )
#ICC = 0.88 - significant clustering

RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~TSContributiontoPFActivity_PropulsionPhase_Maxof1_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsTSContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )





RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(TSContributiontoPFActivity_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


( AdjustR2_AnklevsTSContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Ankle_Generation_MEEvsTSContribution_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~TSContributiontoPFActivity_PropulsionPhase_Centered*Group_ID+(TSContributiontoPFActivity_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.



##Random intercept is best model. Now calculate MSE
(MSE_AnkleMEEvsTSContribution_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance

summary(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsTSContribution_Propulsion_BothEffects)





plot( RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsTSContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Ankle_Generation_MEEvsTSContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnkleMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  TSContributiontoPFActivity_PropulsionPhase_Maxof1_Centered, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'w_e' ), alpha = 0.75  ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('ATx: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(TS Contribution)',sep=''), size = 10, color = met.brewer('Austria')[1], x =0, y = 0.375 ) +
   

   #r values for Control group
     geom_text( label = paste('Control: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3],digits=2), round(fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4],digits=2),'(TS Contribution)',sep=''), size = 10, color = met.brewer('Austria')[3], x =0, y = 0.225 ) +
     
     
     geom_text( label = 'Mean Contribution to PF Activation = 0.70', size = 10, color = met.brewer('Austria')[1], x = 0, y = 0.325 ) +
     
      geom_text( label = 'Mean Contribution to PF Activation = 0.72', size = 10, color = met.brewer('Austria')[3], x = 0, y = 0.175 ) +
   

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(-0.40,0.40,by=0.10),limits=c(-0.40,0.40) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs \n Group Mean-Centered Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Group Mean-Centered Contribution to PF Activation (max of 1)', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```



```{r MEE vs Eugene Contribution - Propulsion}

Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$MedGasandSolContributiontoPFActivity_PropulsionPhase

LM_Ankle_Generation_MEEvsTSContribution_Propulsion <- lm(formula=Joint_Generation_MEE~MedGasandSolContributiontoPFActivity_PropulsionPhase*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsTSContribution_Propulsion)
confint(LM_Ankle_Generation_MEEvsTSContribution_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsTSContribution_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsTSContribution_Propulsion_forICC)
(Ankle_Generation_MEEvsTSContribution_Propulsion_VarExplained = (0.007057^2) /( (0.007057^2) + (0.002514^2) ) )
#ICC = 0.88 - significant clustering

RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~MedGasandSolContributiontoPFActivity_PropulsionPhase*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsTSContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )





RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~MedGasandSolContributiontoPFActivity_PropulsionPhase*Group_ID+(MedGasandSolContributiontoPFActivity_PropulsionPhase-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


( AdjustR2_AnklevsTSContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Ankle_Generation_MEEvsTSContribution_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~MedGasandSolContributiontoPFActivity_PropulsionPhase*Group_ID+(MedGasandSolContributiontoPFActivity_PropulsionPhase|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


##Random intercept is best model. Now calculate MSE
(MSE_AnkleMEEvsTSContribution_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance

summary(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsTSContribution_Propulsion_BothEffects)





plot( RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsTSContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Ankle_Generation_MEEvsTSContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnkleMEEvsTSContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  MedGasandSolContributiontoPFActivity_PropulsionPhase, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly,'w_e' ), alpha = 0.75  ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('ATx: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(TS Contribution)',sep=''), size = 10, color = met.brewer('Austria')[1], x =0, y = 0.375 ) +
   

   #r values for Control group
     geom_text( label = paste('Control: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[3],digits=2), round(fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsTSContribution_Propulsion_RandomInterceptOnly)[4],digits=2),'(TS Contribution)',sep=''), size = 10, color = met.brewer('Austria')[3], x =0, y = 0.225 ) +
     
     
     geom_text( label = 'Mean Contribution to PF Activation = 0.70', size = 10, color = met.brewer('Austria')[1], x = 0, y = 0.325 ) +
     
      geom_text( label = 'Mean Contribution to PF Activation = 0.72', size = 10, color = met.brewer('Austria')[3], x = 0, y = 0.175 ) +
   

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(-0.40,0.40,by=0.10),limits=c(-0.40,0.40) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs \n Group Mean-Centered Triceps Surae Contribution to PF Activation \n Propulsion Phase',x='Group Mean-Centered Contribution to PF Activation (max of 1)', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```






```{r MEE vs Gastrocnemii Contribution - Propulsion}

LM_Ankle_Generation_MEEvsGastrocContribution_Propulsion <- lm(formula=Joint_Generation_MEE~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsGastrocContribution_Propulsion)
confint(LM_Ankle_Generation_MEEvsGastrocContribution_Propulsion,method='boot') # significant intercept, effect of group, and interaction effect. Non-significant slope for ATx group


RMME_Ankle_Generation_MEEvsGastrocContribution_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsGastrocContribution_Propulsion_forICC)
(Ankle_Generation_MEEvsGastrocContribution_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsGastrocContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsGastrocContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Generation_MEEvsGastrocContribution_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.



##Both effects is best model. Now calculate MSE
(MSE_AnkleMEEvsGastrocContribution_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Significant fixed effect intercept only

summary(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsGastrocContribution_Propulsion_BothEffects)



plot( MME_Ankle_Generation_MEEvsGastrocContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsGastrocContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Ankle_Generation_MEEvsGastrocContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnkleMEEvsGastrocContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  TwoJointTS_Contribution2AllPF_PropulsionPhase_Centered, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('Both Groups: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Ankle_MEE_GenerationvsGastrocContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(TS Contribution)'), size = 10, x =0, y = 92.5 ) +
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 47.47%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 32.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 45.98%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Gastrocnemii Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```





```{r MEE vs Soleus Contribution - Propulsion}

LM_Ankle_Generation_MEEvsSolContribution_Propulsion <- lm(formula=Joint_Generation_MEE~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsSolContribution_Propulsion)
confint(LM_Ankle_Generation_MEEvsSolContribution_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsSolContribution_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsSolContribution_Propulsion_forICC)
(Ankle_Generation_MEEvsSolContribution_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsSolContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(OneJointTS_Contribution2AllPF_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsSolContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Generation_MEEvsSolContribution_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~OneJointTS_Contribution2AllPF_PropulsionPhase_Centered*Group_ID+(OneJointTS_Contribution2AllPF_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random Intercept is best model. Now calculate MSE
(MSE_AnkleMEEvsSolContribution_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsSolContribution_Propulsion_BothEffects)

compare(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly,RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Ankle_Generation_MEEvsSolContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsSolContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Ankle_Generation_MEEvsSolContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Plot - Propulsion Phase}



( AnkleMEEvsSolContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  OneJointTS_Contribution2AllPF_PropulsionPhase_Centered, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = 'white' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 3, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = 'white' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 3, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('Both Groups: Ankle %MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[1],digits=2), round(fixef(RMME_Ankle_MEE_GenerationvsSolContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(TS Contribution)'), size = 10, color = met.brewer('Austria')[1], x =0, y = 92.5 ) +
     
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 22.78%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 32.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 26.02%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Soleus Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```


```{r MEE vs Uncentered PL Contribution - Propulsion}

LM_Ankle_Generation_MEEvsPLContribution_Propulsion <- lm(formula=Joint_Generation_MEE~PLContributiontoPFActivity_PropulsionPhase_Maxof1*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsPLContribution_Propulsion)
confint(LM_Ankle_Generation_MEEvsPLContribution_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_forICC)
(Ankle_Generation_MEEvsPLContribution_Propulsion_VarExplained = (0.007057^2) /( (0.007057^2) + (0.002514^2) ) )
#ICC = 0.89 - significant clustering



RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~PLContributiontoPFActivity_PropulsionPhase_Maxof1*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsPLContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~PLContributiontoPFActivity_PropulsionPhase_Maxof1*Group_ID+(PLContributiontoPFActivity_PropulsionPhase_Maxof1-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsPLContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~PLContributiontoPFActivity_PropulsionPhase_Maxof1*Group_ID+(PLContributiontoPFActivity_PropulsionPhase_Maxof1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.

( AdjustR2_AnklevsPLContribution_Propulsion_BothEffects <- (1 - ( var(residuals(RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_BothEffects,type='response' )) / (var(getME(RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_BothEffects,'y'))) ) )*(116/(116-4-1)) )



##Random intercept is best model. Now calculate MSE
(MSE_AnkleMEEvsPLContribution_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly)#significant

summary(RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_BothEffects)

compare(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```




```{r Plot - Propulsion Phase}



( AnkleMEEvsPLContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  PLContributiontoPFActivity_PropulsionPhase_Maxof1, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,'w_e' ), alpha = 0.75 ) +



   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('ATx Group: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1],digits=2),' + ', round(fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(PL Contribution)',sep=''), size = 15.5, x =0.3, y = 0.325, color = met.brewer('Austria')[1], fontface = 'bold' ) +
     
   #r values for Control group
     geom_text( label = paste('Control Group: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3],digits=2),' + ', round(fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4],digits=2),'(PL Contribution)',sep=''), size = 15.5, x =0.3, y = 0.175, color = met.brewer('Austria')[3], fontface = 'bold' ) +
   
     
     geom_text( label = 'Mean Contribution to PF Activation = 0.30', size = 15.5, color = met.brewer('Austria')[1], x = 0.3, y = 0.275, fontface = 'bold' ) +
     
      geom_text( label = 'Mean Contribution to PF Activation = 0.28', size = 15.5, color = met.brewer('Austria')[3], x = 0.3, y = 0.125, fontface = 'bold' ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(0,0.60,by=0.10),limits=c(0,0.60) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs \n Peroneus Longus Contribution to PF Activation',x='Contribution to PF Activation (Max of 1)', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 41,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 41,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 41,face = 'bold.italic'),,axis.title.y.right = element_text(size = 41,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 39,face = 'bold.italic'),
            axis.text.y.right=element_text(size=39,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 39,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```




```{r MEE vs Centered PL Contribution - Propulsion}

LM_Ankle_Generation_MEEvsPLContribution_Propulsion <- lm(formula=Joint_Generation_MEE~PLContributiontoPFActivity_PropulsionPhase_Maxof1_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsPLContribution_Propulsion)
confint(LM_Ankle_Generation_MEEvsPLContribution_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_forICC)
(Ankle_Generation_MEEvsPLContribution_Propulsion_VarExplained = (0.007057^2) /( (0.007057^2) + (0.002514^2) ) )
#ICC = 0.89 - significant clustering



RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~PLContributiontoPFActivity_PropulsionPhase_Maxof1_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsPLContribution_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~PLContributiontoPFActivity_PropulsionPhase_Maxof1_Centered*Group_ID+(PLContributiontoPFActivity_PropulsionPhase_Maxof1_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsPLContribution_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~PLContributiontoPFActivity_PropulsionPhase_Maxof1_Centered*Group_ID+(PLContributiontoPFActivity_PropulsionPhase_Maxof1_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.

( AdjustR2_AnklevsPLContribution_Propulsion_BothEffects <- (1 - ( var(residuals(RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_BothEffects,type='response' )) / (var(getME(RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_BothEffects,'y'))) ) )*(116/(116-4-1)) )



##Random intercept is best model. Now calculate MSE
(MSE_AnkleMEEvsPLContribution_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly)#significant

summary(RMME_Ankle_Generation_MEEvsPLContribution_Propulsion_BothEffects)

compare(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,abline=c(0,1))

```




```{r Plot - Propulsion Phase}



( AnkleMEEvsPLContribution_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  PLContributiontoPFActivity_PropulsionPhase_Maxof1_Centered, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly,'w_e' ), alpha = 0.75 ) +



   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('ATx Group: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1],digits=2),' + ', round(fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2],digits=2),'(PL Contribution)',sep=''), size = 10, x =0, y = 0.325, color = met.brewer('Austria')[1] ) +
     
   #r values for Control group
     geom_text( label = paste('Control Group: Ankle MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[3],digits=2),' + ', round(fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLContribution_Propulsion_RandomInterceptOnly)[4],digits=2),'(PL Contribution)',sep=''), size = 10, x =0, y = 0.175, color = met.brewer('Austria')[3] ) +
   
     
     geom_text( label = 'Mean Contribution to PF Activation = 0.30', size = 10, color = met.brewer('Austria')[1], x = 0, y = 0.275 ) +
     
      geom_text( label = 'Mean Contribution to PF Activation = 0.28', size = 10, color = met.brewer('Austria')[3], x = 0, y = 0.125 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(-0.40,0.40,by=0.10),limits=c(-0.40,0.40) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs \n Group Mean-Centered Peroneus Longus Contribution to PF Activation \n Propulsion Phase',x='Group Mean-Centered Contribution to PF Activation (Max of 1)', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```




```{r MEE vs PL iEMG - Propulsion}

LM_Ankle_Generation_MEEvsPLiEMG_Propulsion <- lm(formula=Joint_Generation_MEE~PL_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsPLiEMG_Propulsion)
confint(LM_Ankle_Generation_MEEvsPLiEMG_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsPLiEMG_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsPLiEMG_Propulsion_forICC)
(Ankle_Generation_MEEvsPLiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~PL_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsPLiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~PL_iEMG_PropulsionPhase_Centered*Group_ID+(PL_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsPLiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Generation_MEEvsPLiEMG_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~PL_iEMG_PropulsionPhase_Centered*Group_ID+(PL_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random intercept is best model. Now calculate MSE
(MSE_AnkleMEEvsPLiEMG_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsPLiEMG_Propulsion_BothEffects)

compare(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Ankle_Generation_MEEvsPLiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsPLiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Ankle_Generation_MEEvsPLiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```


```{r Bootstrap Function}

#Set number of iterations for bootstrap
iter <- 1000

PLBootStrapDataFrame_IndividualHops <- data.frame( Iteration = 1:1000, FixedBeta0 = rep( 0, iter ), FixedBeta1 = rep( 0, iter ), FixedBeta2 = rep( 0, iter ), FixedBeta3 = rep( 0, iter ), RandomEffect1  = rep( 0, iter ),  RandomEffect2  = rep( 0, iter ), RandomEffect3  = rep( 0, iter ), RandomEffect4  = rep( 0, iter ), RandomEffect5  = rep( 0, iter ), RandomEffect6  = rep( 0, iter ), RandomEffect7  = rep( 0, iter ), RandomEffect8  = rep( 0, iter ), RandomEffect9  = rep( 0, iter ), RandomEffect10  = rep( 0, iter ), RandomEffect11  = rep( 0, iter ), RandomEffect12  = rep( 0, iter ), RandomEffect13  = rep( 0, iter ),RMSE = rep( 0, iter )  )


UniqueParticipantID <- unique( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle$Participant_ID )
NumberofParticipants <- length( UniqueParticipantID )
UniqueATxID <- unique( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Participant_ID )
NumberofATxParticipants <- length( UniqueATxID )
NumberofATxRows <- dim( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedAnkle )[1]
                           
UniqueControlID <- unique( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Participant_ID )
NumberofControlParticipants <- length( UniqueControlID )
NumberofControlRows <- dim( Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_ControlAnkle )[1]




for (j in 1 : 1000) {
   

   
   ATxRandomSample <- sample( NumberofATxRows, 60, replace = T )
   ATxRandomSample_Names <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID[ ATxRandomSample ]
   ControlRandomSample <- sample( NumberofControlRows, 70, replace = T ) + NumberofATxRows
   ControlRandomSample_Names <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID[ ATxRandomSample ][ ControlRandomSample ]
   AllNames <- c( ATxRandomSample_Names, ControlRandomSample_Names )
   AllSamplePointsforBootstrap <- c( ATxRandomSample, ControlRandomSample )
   NumberofDataPoints <- 130
   
   
   IterationDataFrame <- data.frame( Participant_ID = c( ATxRandomSample_Names, ControlRandomSample_Names ) )
   IterationDataFrame$Group_ID <- rep( 'ATx', NumberofDataPoints)
   
   IterationDataFrame$PL_iEMG_PropulsionPhase <- rep( 0, NumberofDataPoints)
   
   IterationDataFrame$Mean_Joint_Generation_MEE <- rep( 0, NumberofDataPoints)
   
   
   for ( k in 1 : NumberofDataPoints ) {
      
      IterationDataFrame$Participant_ID[ k ] <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Participant_ID[ AllSamplePointsforBootstrap[ k ] ]
   
      
      IterationDataFrame$Group_ID[ k ] <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Group_ID[ AllSamplePointsforBootstrap[ k ] ]
      
      IterationDataFrame$PL_iEMG_PropulsionPhase[ k ] <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$PL_iEMG_PropulsionPhase[ AllSamplePointsforBootstrap[ k ] ]
      
      IterationDataFrame$Mean_Joint_Generation_MEE[ k ] <- Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle$Joint_Generation_MEE[ AllSamplePointsforBootstrap[ k ] ]
      
      
   }
   
   
   BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly <- rlmer( Mean_Joint_Generation_MEE~PL_iEMG_PropulsionPhase*Group_ID+(1|Participant_ID), data = IterationDataFrame )

   
   ATxResiduals <- Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_Joint_Generation_MEE - ( fixef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly )[1] + ( Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedAnkle$Mean_TotalTSActivation_PropulsionPhase * fixef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly )[2] ) )
   
   ControlResiduals <- Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_Joint_Generation_MEE - ( ( fixef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly )[1] + fixef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly )[3] ) + ( Dissertation_CombinedMEEandEMG_2.3Hz_ControlAnkle$Mean_TotalTSActivation_PropulsionPhase * ( fixef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly )[2] + fixef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly )[4]  ) ) )

   
   
   #Calculate MSE
   PLBootStrapDataFrame_IndividualHops$RMSE[ j ] <- mean( c( ATxResiduals^2, ControlResiduals^2 ) )
   
   PLBootStrapDataFrame_IndividualHops$FixedBeta0[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly )[1]
   
   PLBootStrapDataFrame_IndividualHops$FixedBeta1[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly )[2]
   
   PLBootStrapDataFrame_IndividualHops$FixedBeta2[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly )[3]
   
   PLBootStrapDataFrame_IndividualHops$FixedBeta3[ j ] <- fixef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly )[4]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect1[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[1,1]

   PLBootStrapDataFrame_IndividualHops$RandomEffect2[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[2,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect3[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[3,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect4[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[4,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect5[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[5,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect6[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[6,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect7[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[7,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect8[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[8,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect9[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[9,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect10[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[10,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect11[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[11,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect12[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[12,1]
   
   PLBootStrapDataFrame_IndividualHops$RandomEffect13[ j ] <- ranef( BootstrapRMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[13,1]
   
}


min( PLBootStrapDataFrame_IndividualHops$RMSE )

FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly <- PLBootStrapDataFrame_IndividualHops %>% filter( RMSE == min( PLBootStrapDataFrame_IndividualHops$RMSE ) )


B0_SE <- sqrt( (1/(iter-1) )*sum( ( PLBootStrapDataFrame_IndividualHops$FixedBeta0 - mean(PLBootStrapDataFrame_IndividualHops$FixedBeta0 ) )^2 ) )
( B0_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0 - 2*B0_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta0 + 2*B0_SE) )

B1_SE <- sqrt( (1/(iter-1) )*sum( ( PLBootStrapDataFrame_IndividualHops$FixedBeta1 - mean(PLBootStrapDataFrame_IndividualHops$FixedBeta1 ) )^2 ) )
( B1_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1 - 2*B1_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta1 + 2*B1_SE) )

B2_SE <- sqrt( (1/(iter-1) )*sum( ( PLBootStrapDataFrame_IndividualHops$FixedBeta2 - mean(PLBootStrapDataFrame_IndividualHops$FixedBeta2 ) )^2 ) )
( B2_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2 - 2*B2_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta2 + 2*B2_SE) )

B3_SE <- sqrt( (1/(iter-1) )*sum( ( PLBootStrapDataFrame_IndividualHops$FixedBeta3 - mean(PLBootStrapDataFrame_IndividualHops$FixedBeta3 ) )^2 ) )
( B3_CI <- c(FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3 - 2*B3_SE, FinalRMMEValues_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly$FixedBeta3 + 2*B3_SE) )

```


```{r Plot - Propulsion Phase}



( AnkleMEEvsPLiEMG_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x =  PL_iEMG_PropulsionPhase_Centered, y = Joint_Generation_MEE  ) ) +
     
      geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 8*getME( RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly,'w_e' ), alpha = 0.75 ) +

      


   
#Regression line for ATx07
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3]+ranef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 6, color = 'black' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2], linewidth = 4, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 6, color = 'black' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3], slope = fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4], linewidth = 4, color = met.brewer('Austria')[3] ) +
   
   
     #r values for ATx group
     geom_text( label = paste('ATx Group: Ankle %MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1],digits=2),' + ', round(fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2],digits=2),'(PL Contribution)',sep=''), size = 10, x =0, y = 92.5, color = met.brewer('Austria')[1] ) +
     
   #r values for Control group
     geom_text( label = paste('Control Group: Ankle %MEE = ', round(fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[1]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[3],digits=2),' + ', round(fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[2]+fixef(RMME_Ankle_MEE_GenerationvsPLiEMG_Propulsion_RandomInterceptOnly)[4],digits=2),'(PL Contribution)',sep=''), size = 10, x =0, y = 87.5, color = met.brewer('Austria')[3] ) +
   
     
     geom_text( label = 'ATx Mean Contribution to PF Activation = 29.75%', size = 10, color = met.brewer('Austria')[1], x = 0, y = 32.5 ) +
     
      geom_text( label = 'Control Mean Contribution to PF Activation = 28%', size = 10, color = met.brewer('Austria')[3], x = 0, y = 27.5 ) +

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,100,by=10),limits=c(0,100) )+
    
     
      scale_x_continuous(breaks=seq(-40,40,by=10),limits=c(-40,40) )+
     
     
     
     labs(title='Ankle Contribution to Whole-Limb MEE vs \n Group Mean-Centered Peroneus Longus Contribution to PF Activation \n Propulsion Phase',x='Centered Contribution to PF Activation (%)', y = ' Contribution to Whole-Limb MEE (%) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```




```{r MEE vs MedGas iEMG - Propulsion}

LM_Ankle_Generation_MEEvsMedGasiEMG_Propulsion <- lm(formula=Joint_Generation_MEE~MedGas_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsMedGasiEMG_Propulsion)
confint(LM_Ankle_Generation_MEEvsMedGasiEMG_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_forICC)
(Ankle_Generation_MEEvsMedGasiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~MedGas_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsMedGasiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~MedGas_iEMG_PropulsionPhase_Centered*Group_ID+(MedGas_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsMedGasiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~MedGas_iEMG_PropulsionPhase_Centered*Group_ID+(MedGas_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsMedGasiEMG_Propulsion_BothEffects <- (1 - ( var(residuals(RMME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_BothEffects,type='response' )) / (var(getME(RMME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_BothEffects,'y'))) ) )*(116/(116-4-1)) )



##Both effects is best model. Now calculate MSE
(MSE_AnkleMEEvsMedGasiEMG_Propulsion <- mean( ( getME(RMME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_BothEffects,'y') - residuals(RMME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_BothEffects,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_BothEffects)

compare(RMME_Ankle_MEE_GenerationvsMedGasiEMG_Propulsion_RandomInterceptOnly,RMME_Ankle_MEE_GenerationvsMedGasiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Ankle_Generation_MEEvsMedGasiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```








```{r MEE vs GasLat iEMG - Propulsion}

LM_Ankle_Generation_MEEvsGasLatiEMG_Propulsion <- lm(formula=Joint_Generation_MEE~GasLat_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsGasLatiEMG_Propulsion)
confint(LM_Ankle_Generation_MEEvsGasLatiEMG_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsGasLatiEMG_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsGasLatiEMG_Propulsion_forICC)
(Ankle_Generation_MEEvsGasLatiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~GasLat_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsGasLatiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~GasLat_iEMG_PropulsionPhase_Centered*Group_ID+(GasLat_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsGasLatiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )




RMME_Ankle_Generation_MEEvsGasLatiEMG_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~GasLat_iEMG_PropulsionPhase_Centered*Group_ID+(GasLat_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random intercept is best model. Now calculate MSE
(MSE_AnkleMEEvsGasLatiEMG_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsGasLatiEMG_Propulsion_BothEffects)

compare(RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomInterceptOnly,RMME_Ankle_MEE_GenerationvsGasLatiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Ankle_Generation_MEEvsGasLatiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsGasLatiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Ankle_Generation_MEEvsGasLatiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```











```{r MEE vs Sol iEMG - Propulsion}

LM_Ankle_Generation_MEEvsSoliEMG_Propulsion <- lm(formula=Joint_Generation_MEE~Sol_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsSoliEMG_Propulsion)
confint(LM_Ankle_Generation_MEEvsSoliEMG_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsSoliEMG_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsSoliEMG_Propulsion_forICC)
(Ankle_Generation_MEEvsSoliEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering

RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~Sol_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsSoliEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~Sol_iEMG_PropulsionPhase_Centered*Group_ID+(Sol_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsSoliEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Generation_MEEvsSoliEMG_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~Sol_iEMG_PropulsionPhase_Centered*Group_ID+(Sol_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random intercept is best model. Now calculate MSE
(MSE_AnkleMEEvsSoliEMG_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsSoliEMG_Propulsion_BothEffects)

compare(RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomInterceptOnly,RMME_Ankle_MEE_GenerationvsSoliEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Ankle_Generation_MEEvsSoliEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsSoliEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Ankle_Generation_MEEvsSoliEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```










```{r MEE vs TA iEMG - Propulsion}

LM_Ankle_Generation_MEEvsTAiEMG_Propulsion <- lm(formula=Joint_Generation_MEE~TA_iEMG_PropulsionPhase_Centered*Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_Ankle_Generation_MEEvsTAiEMG_Propulsion)
confint(LM_Ankle_Generation_MEEvsTAiEMG_Propulsion,method='boot') # significant


RMME_Ankle_Generation_MEEvsTAiEMG_Propulsion_forICC <- rlmer(Joint_Generation_MEE~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_Ankle_Generation_MEEvsTAiEMG_Propulsion_forICC)
(Ankle_Generation_MEEvsTAiEMG_Propulsion_VarExplained = (77.48^2) /( (77.48^2) + (15.07^2) ) )
#ICC = 0.96 - significant clustering


RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly <- rlmer(Joint_Generation_MEE~TA_iEMG_PropulsionPhase_Centered*Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsTAiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly <- rlmer(Joint_Generation_MEE~TA_iEMG_PropulsionPhase_Centered*Group_ID+(TA_iEMG_PropulsionPhase_Centered-1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsTAiEMG_Propulsion_RSOnly <- (1 - ( var(residuals(RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly,type='response' )) / (var(getME(RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly,'y'))) ) )*(116/(116-4-1)) )



RMME_Ankle_Generation_MEEvsTAiEMG_Propulsion_BothEffects <- rlmer(Joint_Generation_MEE~TA_iEMG_PropulsionPhase_Centered*Group_ID+(TA_iEMG_PropulsionPhase_Centered|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
#Singular fit. Do not use.


##Random intercept is best model. Now calculate MSE
(MSE_AnkleMEEvsTAiEMG_Propulsion <- mean( ( getME(RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,'y') - residuals(RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,type='response') )^2 ) )



summary(RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant

summary(RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly)#significant

#summary(RMME_Ankle_Generation_MEEvsTAiEMG_Propulsion_BothEffects)

compare(RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomInterceptOnly,RMME_Ankle_MEE_GenerationvsTAiEMG_Propulsion_RandomSlopeOnly,show.rho.functions = F)


plot( MME_Ankle_Generation_MEEvsTAiEMG_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_Ankle_Generation_MEEvsTAiEMG_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_Ankle_Generation_MEEvsTAiEMG_Propulsion_RandomInterceptOnly,abline=c(0,1))

```



```{r Ankle MEE}

pander( cbind( MSE_AnkleMEEvsTSContribution_Propulsion, MSE_AnkleMEEvsGastrocContribution_Propulsion, MSE_AnkleMEEvsSolContribution_Propulsion, MSE_AnkleMEEvsPLContribution_Propulsion,MSE_AnkleMEEvsMedGasiEMG_Propulsion,MSE_AnkleMEEvsGasLatiEMG_Propulsion,MSE_AnkleMEEvsSoliEMG_Propulsion,MSE_AnkleMEEvsPLiEMG_Propulsion,MSE_AnkleMEEvsTAiEMG_Propulsion ) )

#MedGas iEMG is best model

```



#### Pander Table
```{r Ankle %MEE}

pander( cbind( MSE_AnklePercentMEEvsTSContribution_Propulsion, MSE_AnklePercentMEEvsGastrocContribution_Propulsion, MSE_AnklePercentMEEvsSolContribution_Propulsion, MSE_AnklePercentMEEvsPLContribution_Propulsion,MSE_AnklePercentMEEvsMedGasiEMG_Propulsion,MSE_AnklePercentMEEvsGasLatiEMG_Propulsion,MSE_AnklePercentMEEvsSoliEMG_Propulsion,MSE_AnklePercentMEEvsPLiEMG_Propulsion,MSE_AnklePercentMEEvsTAiEMG_Propulsion ) )

#MedGas iEMG is best model

```

```{r Knee %MEE}

pander( cbind( MSE_KneePercentMEEvsTSContribution_Propulsion, MSE_KneePercentMEEvsGastrocContribution_Propulsion, MSE_KneePercentMEEvsSolContribution_Propulsion, MSE_KneePercentMEEvsPLContribution_Propulsion,MSE_KneePercentMEEvsMedGasiEMG_Propulsion,MSE_KneePercentMEEvsGasLatiEMG_Propulsion,MSE_KneePercentMEEvsSoliEMG_Propulsion,MSE_KneePercentMEEvsPLiEMG_Propulsion,MSE_KneePercentMEEvsTAiEMG_Propulsion ) )

#MedGas iEMG is best model

```



### Individual Muscle iEMG
```{r MedGas iEMG vs Group - Propulsion}

LM_MedGasiEMGvsGroup_Propulsion <- lm(formula=MedGas_iEMG_PropulsionPhase~Group_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)
summary(LM_MedGasiEMGvsGroup_Propulsion)
confint(LM_MedGasiEMGvsGroup_Propulsion,method='boot') # significant


RMME_MedGasiEMGvsGroup_Propulsion_forICC <- rlmer(MedGas_iEMG_PropulsionPhase~1|Participant_ID,data=Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)


summary(RMME_MedGasiEMGvsGroup_Propulsion_forICC)
(MedGasiEMGvsGroup_Propulsion_VarExplained = (5.2590^2) /( (5.2590^2) + (0.7899^2) ) )
#ICC = 0.98 - significant clustering


RMME_MedGasiEMGvsGroup_Propulsion_RandomInterceptOnly <- rlmer(MedGas_iEMG_PropulsionPhase~Group_ID+(1|Participant_ID), data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle)

( AdjustR2_AnklevsMedGasiEMG_Propulsion_RIOnly <- (1 - ( var(residuals(RMME_MedGasiEMGvsGroup_Propulsion_RandomInterceptOnly,type='response' )) / (var(getME(RMME_MedGasiEMGvsGroup_Propulsion_RandomInterceptOnly,'y'))) ) )*(116/(116-4-1)) )





(MSE_AnkleMEEvsMedGasiEMG_Propulsion <- mean( ( getME(RMME_MedGasiEMGvsGroup_Propulsion_RIOnly,'y') - residuals(RMME_MedGasiEMGvsGroup_Propulsion_RIOnly,type='response') )^2 ) )



summary(RMME_MedGasiEMGvsGroup_Propulsion_RandomInterceptOnly)#Random Intercept is best model - reduces residual variance
#Only fixed effect intercept is significant



plot( MME_MedGasiEMGvsGroup_Propulsion_RandomInterceptOnly, Participant_ID~resid(.,type='p'))

plot( MME_MedGasiEMGvsGroup_Propulsion_RandomInterceptOnly, resid(.,type='p')~fitted(.),abline=0  )

qqnorm(MME_MedGasiEMGvsGroup_Propulsion_RandomInterceptOnly,abline=c(0,1))

```


## FINAL ASB 2023 ABSTRACT PLOT
```{r FINAL Plot - Participant Means Propulsion Phase}



( AnkleMEEvsTSActivation_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Mean_TotalTSActivation_PropulsionPhase, y = Mean_Joint_Generation_MEE  ) ) +
     




#Regression line for ATx07
         geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = 0.69, slope = -0.0027, linewidth = 10, color = 'yellow' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = 0.69, slope = -0.0027, linewidth = 9, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = 0.69+0.14, slope = -0.0027+-0.0041, linewidth = 10, color = 'orange' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = 0.69+0.14, slope = -0.0027+-0.0041, linewidth = 9, color = met.brewer('Austria')[3] ) +
   
   #Scatter plot points - participant means
         geom_point( aes( fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 10.5, stroke = 4.5) +
   
      #Scatter plot points - participant means
         geom_point(data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle aes( x = TotalTSActivation_PropulsionPhase, y = fill = Group_ID, group = Group_ID, shape = 'Open Circle' ), color = 'white', size = 10.5, stroke = 4.5) +
   
   
   
     #r values for ATx group
     geom_text( label = paste('ATx: Ankle MEE = ', round(0.69,digits=2), ' - ', abs(round(-0.0027,digits=4)),'(TS Activation)',sep=''), size = 15, color = met.brewer('Austria')[1], x =20, y = 0.375, fontface = 'bold' ) +
   

   
   #r values for Control group
     geom_text( label = paste('Control: Ankle MEE = ', round(0.69+0.14,digits=2), ' - ', abs(round(-0.0027+-0.0041,digits=4)),'(TS Activation)',sep=''), size = 15, color = met.brewer('Austria')[3], x =20, y = 0.175, fontface = 'bold' ) +
     
     
   
     geom_text( label = 'Mean TS Activation = 21.9 %Single Leg Vertical Jump*sec', size = 15, color = met.brewer('Austria')[1], x = 20, y = 0.325, fontface = 'bold' ) +
   
   geom_text( label = 'Mean Ankle MEE = 0.63 J/kg', size = 15, color = met.brewer('Austria')[1], x = 20, y = 0.275, fontface = 'bold' ) +
   
     
      geom_text( label = 'Mean TS Activation = 17.8 %Single Leg Vertical Jump*sec', size = 15, color = met.brewer('Austria')[3], x = 20, y = 0.125, fontface = 'bold' ) +
   
   geom_text( label = 'Mean Ankle MEE = 0.71 J/kg', size = 15, color = met.brewer('Austria')[3], x = 20, y = 0.075, fontface = 'bold' ) +
   

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(0,40,by=5),limits=c(0,40) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs Total Triceps Surae Activation \n Propulsion Phase',x='Total Triceps Surae Activation (%Single Leg Vertical Jump*sec)', y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1]) ,
                         name = 'Group ID',aesthetics=c('color','fill'),labels=c('ATx','Control' ) ) +
     
     
     scale_shape_manual( values = c( 'Open Circle' = 21 ) )+
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 35,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 35,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 35,face = 'bold.italic'),,axis.title.y.right = element_text(size = 35,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```





## FINAL ASB 2023 POSTER PLOTS
```{r FINAL Plot - Propulsion Phase Regression}


( AnkleMEEvsTSActivation_Propulsion <- ggplot( data = Dissertation_CombinedMEEandEMG_2.3Hz_InvolvedvsControlAnkle, aes( x =  Mean_TotalTSActivation_PropulsionPhase, y = Mean_Joint_Generation_MEE  ) ) +
     




#Regression line for ATx07
         geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[1,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
#Regression line for ATx10
      geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[2,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx17
      geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[3,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx18
      geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[4,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx19
      geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[5,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +   
   
   
#Regression line for ATx21
      geom_abline( intercept = 0.69+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[6,1], slope = -0.0027, linewidth = 1.5, color = met.brewer('Austria')[1], alpha = 0.6 ) +      
   
   
   
#Regression line for HC01
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[7,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC05
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[8,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC06
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[9,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HC12
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[10,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP02
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[11,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP08
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[12,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +      
   
   
   
#Regression line for HP09
     geom_abline( intercept = 0.69+0.14+ranef(RMME_Ankle_MEE_GenerationvsTSActivation_Propulsion_RandomInterceptOnly)$Participant_ID[13,1], slope = -0.0027+-0.0041, linewidth = 1.5, color = met.brewer('Austria')[3], alpha = 0.65 ) +
   
   
   #Regression line for ATx Group
      geom_abline( intercept = 0.69, slope = -0.0027, linewidth = 10, color = 'yellow' ) +
   
   #Regression line for ATx Group
      geom_abline( intercept = 0.69, slope = -0.0027, linewidth = 9, color = met.brewer('Austria')[1] ) +
   
   
#Regression line for Control Group
     geom_abline( intercept = 0.69+0.14, slope = -0.0027+-0.0041, linewidth = 10, color = 'orange' ) +   
   
#Regression line for Control Group
     geom_abline( intercept = 0.69+0.14, slope = -0.0027+-0.0041, linewidth = 9, color = met.brewer('Austria')[3] ) +
   
   
         #Scatter plot points - individual hops
         geom_point(data = Dissertation_CombinedMEEandEMG_IndividualHops_2.3Hz_InvolvedvsControlAnkle, aes( x = TotalTSActivation_PropulsionPhase, y = Joint_Generation_MEE, fill = Group_ID, group = Group_ID, shape = Participant_ID, color = Participant_ID ), size = 6, stroke = 2, alpha = 0.55) +
   
   
   
   #Scatter plot points - participant means
         geom_point( aes( fill = Group_ID, group = Group_ID, shape = Participant_ID, color = Participant_ID ), size = 15.5, stroke = 4.5) +
   

   
     #r values for ATx group
     geom_text( label = paste('ATx: Ankle MEE = ', round(0.69,digits=2), ' - ', abs(round(-0.0027,digits=4)),'(TS Activation)',sep=''), size = 15, color = met.brewer('Austria')[1], x =20, y = 0.375 ) +
   

   
   
   #r values for Control group
     geom_text( label = paste('Control: Ankle MEE = ', round(0.69+0.14,digits=2), ' - ', abs(round(-0.0027+-0.0041,digits=4)),'(TS Activation)',sep=''), size = 15, color = met.brewer('Austria')[3], x =20, y = 0.175 ) +
     
     
   
     geom_text( label = expression( 'Mean TS Activation = 21.9 %Single Leg Vertical Jump' %*% 'sec' ), size = 15, color = met.brewer('Austria')[1], x = 20, y = 0.325, ) +
   
   geom_text( label = 'Mean Ankle MEE = 0.63 J/kg', size = 15, color = met.brewer('Austria')[1], x = 20, y = 0.275 ) +
   
     
      geom_text( label = expression( 'Mean TS Activation = 17.8 %Single Leg Vertical Jump' %*% 'sec' ), size = 15, color = met.brewer('Austria')[3], x = 20, y = 0.125 ) +
   
   geom_text( label = 'Mean Ankle MEE = 0.71 J/kg', size = 15, color = met.brewer('Austria')[3], x = 20, y = 0.075 ) +
   

     #geom_text( label = '1(b)', size = 10, x = 35, y = 95 )+

     
     scale_y_continuous(breaks=seq(0,1.1,by=0.10),limits=c(0,1.1) )+
    
     
      scale_x_continuous(breaks=seq(0,40,by=5),limits=c(0,40) )+
     
     
     
     labs(title='Ankle Mechanical Energy Expenditure vs Total Triceps Surae Integrated EMG \n Propulsion Phase of Unipedal Hopping',x=expression( 'Total Triceps Surae iEMG (%Single Leg Vertical Jump' %*% 'sec)' ), y = ' Mechanical Energy Expenditure (J/kg) ' ) +
     
     
     
     scale_color_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1], 'ATx07' = 'white', 'ATx10' = 'white', 'ATx17' = 'white', 'ATx18' = 'white', 'ATx19' = 'white', 'ATx21' = 'wheat2', 'HC01' = 'white', 'HC05' = 'white', 'HC06' = 'white', 'HC12' = 'white', 'HP02' = 'white', 'HP08' = 'wheat2', 'HP09' = 'wheat2' ) ,
                         name = 'Group ID',aesthetics=c('color') ) +
     

        scale_fill_manual(values = c('Control'=met.brewer('Austria')[3], 'ATx'=met.brewer('Austria')[1] ) ,
                         name = 'Group ID',
                         aesthetics=c('fill') ) +
   
     
     scale_shape_manual( values = c( 'Open Circle' = 21, 'ATx07' = 22, 'ATx10' = 21, 'ATx17' = 24, 'ATx18' = 23, 'ATx19' = 25, 'ATx21' = 22, 'HC01' = 22, 'HC05' = 21, 'HC06' = 24, 'HC12' = 23, 'HP02' = 25, 'HP08' = 22, 'HP09' = 24 ) )+
   
   
      
      guides(color='none',fill='none',size='none',shape='none' )+
      
      theme(plot.title = element_text(size = 33,hjust = 0.5,face = 'bold'),
            axis.title.x = element_text(size = 33,face = 'bold.italic'),
            axis.title.y.left = element_text(size = 33),
            axis.title.y.right = element_text(size = 33,face = 'bold.italic',vjust=0.9,color='darkred'),
            axis.text.y.left  =  element_text(size = 30,face = 'bold.italic'),
            axis.text.y.right=element_text(size=30,color='darkred',face = 'bold.italic'),
            axis.text.x  =  element_text(size = 30,face = 'bold.italic'),
            legend.position = 'top', 
            legend.text = element_text(size = 24.47,lineheight=100),
            legend.title = element_text(size = 25.47),plot.margin = margin(5,3,3,3),
            legend.key  =  element_rect(color=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            legend.key.height=unit(0,'lines'),
            legend.key.width=unit(0.5,'lines'),
            legend.box.background=element_rect(color='black',linewidth=1),
            panel.background=element_rect(color='black',fill=rgb(173,216,231,maxColorValue = 255,alpha=55)),
            panel.grid.major.y=element_line(color='darkgrey'),
            panel.grid.minor.y=element_line(color='darkgrey'),
            strip.text=element_text(size=22.5)  )
     
     )

```